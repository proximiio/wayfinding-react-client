var we=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ef(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var t=function n(){return this instanceof n?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),t}var YT={},Ox={},Wu={},Cx={exports:{}},WT=function(r,t){return function(){for(var i=new Array(arguments.length),l=0;l<i.length;l++)i[l]=arguments[l];return r.apply(t,i)}},F3=WT,ch=Object.prototype.toString;function Tx(e){return ch.call(e)==="[object Array]"}function Eb(e){return typeof e>"u"}function k3(e){return e!==null&&!Eb(e)&&e.constructor!==null&&!Eb(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function B3(e){return ch.call(e)==="[object ArrayBuffer]"}function z3(e){return typeof FormData<"u"&&e instanceof FormData}function j3(e){var r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&e.buffer instanceof ArrayBuffer,r}function U3(e){return typeof e=="string"}function $3(e){return typeof e=="number"}function ZT(e){return e!==null&&typeof e=="object"}function ym(e){if(ch.call(e)!=="[object Object]")return!1;var r=Object.getPrototypeOf(e);return r===null||r===Object.prototype}function G3(e){return ch.call(e)==="[object Date]"}function q3(e){return ch.call(e)==="[object File]"}function V3(e){return ch.call(e)==="[object Blob]"}function HT(e){return ch.call(e)==="[object Function]"}function X3(e){return ZT(e)&&HT(e.pipe)}function Y3(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}function W3(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Z3(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Mx(e,r){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),Tx(e))for(var t=0,n=e.length;t<n;t++)r.call(null,e[t],t,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&r.call(null,e[i],i,e)}function Sb(){var e={};function r(i,l){ym(e[l])&&ym(i)?e[l]=Sb(e[l],i):ym(i)?e[l]=Sb({},i):Tx(i)?e[l]=i.slice():e[l]=i}for(var t=0,n=arguments.length;t<n;t++)Mx(arguments[t],r);return e}function H3(e,r,t){return Mx(r,function(i,l){t&&typeof i=="function"?e[l]=F3(i,t):e[l]=i}),e}function J3(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}var yu={isArray:Tx,isArrayBuffer:B3,isBuffer:k3,isFormData:z3,isArrayBufferView:j3,isString:U3,isNumber:$3,isObject:ZT,isPlainObject:ym,isUndefined:Eb,isDate:G3,isFile:q3,isBlob:V3,isFunction:HT,isStream:X3,isURLSearchParams:Y3,isStandardBrowserEnv:Z3,forEach:Mx,merge:Sb,extend:H3,trim:W3,stripBOM:J3},Uh=yu;function bA(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var JT=function(r,t,n){if(!t)return r;var i;if(n)i=n(t);else if(Uh.isURLSearchParams(t))i=t.toString();else{var l=[];Uh.forEach(t,function(_,m){_===null||typeof _>"u"||(Uh.isArray(_)?m=m+"[]":_=[_],Uh.forEach(_,function(P){Uh.isDate(P)?P=P.toISOString():Uh.isObject(P)&&(P=JSON.stringify(P)),l.push(bA(m)+"="+bA(P))}))}),i=l.join("&")}if(i){var p=r.indexOf("#");p!==-1&&(r=r.slice(0,p)),r+=(r.indexOf("?")===-1?"?":"&")+i}return r},K3=yu;function dv(){this.handlers=[]}dv.prototype.use=function(r,t,n){return this.handlers.push({fulfilled:r,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};dv.prototype.eject=function(r){this.handlers[r]&&(this.handlers[r]=null)};dv.prototype.forEach=function(r){K3.forEach(this.handlers,function(n){n!==null&&r(n)})};var Q3=dv,eB=yu,tB=function(r,t){eB.forEach(r,function(i,l){l!==t&&l.toUpperCase()===t.toUpperCase()&&(r[t]=i,delete r[l])})},KT=function(r,t,n,i,l){return r.config=t,n&&(r.code=n),r.request=i,r.response=l,r.isAxiosError=!0,r.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},r},t1,xA;function QT(){if(xA)return t1;xA=1;var e=KT;return t1=function(t,n,i,l,p){var u=new Error(t);return e(u,n,i,l,p)},t1}var r1,wA;function rB(){if(wA)return r1;wA=1;var e=QT();return r1=function(t,n,i){var l=i.config.validateStatus;!i.status||!l||l(i.status)?t(i):n(e("Request failed with status code "+i.status,i.config,null,i.request,i))},r1}var n1,EA;function nB(){if(EA)return n1;EA=1;var e=yu;return n1=e.isStandardBrowserEnv()?function(){return{write:function(n,i,l,p,u,_){var m=[];m.push(n+"="+encodeURIComponent(i)),e.isNumber(l)&&m.push("expires="+new Date(l).toGMTString()),e.isString(p)&&m.push("path="+p),e.isString(u)&&m.push("domain="+u),_===!0&&m.push("secure"),document.cookie=m.join("; ")},read:function(n){var i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),n1}var i1,SA;function iB(){return SA||(SA=1,i1=function(r){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(r)}),i1}var o1,PA;function oB(){return PA||(PA=1,o1=function(r,t){return t?r.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):r}),o1}var a1,AA;function aB(){if(AA)return a1;AA=1;var e=iB(),r=oB();return a1=function(n,i){return n&&!e(i)?r(n,i):i},a1}var s1,IA;function sB(){if(IA)return s1;IA=1;var e=yu,r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return s1=function(n){var i={},l,p,u;return n&&e.forEach(n.split(`
`),function(m){if(u=m.indexOf(":"),l=e.trim(m.substr(0,u)).toLowerCase(),p=e.trim(m.substr(u+1)),l){if(i[l]&&r.indexOf(l)>=0)return;l==="set-cookie"?i[l]=(i[l]?i[l]:[]).concat([p]):i[l]=i[l]?i[l]+", "+p:p}}),i},s1}var u1,OA;function uB(){if(OA)return u1;OA=1;var e=yu;return u1=e.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),i;function l(p){var u=p;return t&&(n.setAttribute("href",u),u=n.href),n.setAttribute("href",u),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return i=l(window.location.href),function(u){var _=e.isString(u)?l(u):u;return _.protocol===i.protocol&&_.host===i.host}}():function(){return function(){return!0}}(),u1}var l1,CA;function TA(){if(CA)return l1;CA=1;var e=yu,r=rB(),t=nB(),n=JT,i=aB(),l=sB(),p=uB(),u=QT();return l1=function(m){return new Promise(function(P,O){var M=m.data,B=m.headers,$=m.responseType;e.isFormData(M)&&delete B["Content-Type"];var q=new XMLHttpRequest;if(m.auth){var X=m.auth.username||"",R=m.auth.password?unescape(encodeURIComponent(m.auth.password)):"";B.Authorization="Basic "+btoa(X+":"+R)}var k=i(m.baseURL,m.url);q.open(m.method.toUpperCase(),n(k,m.params,m.paramsSerializer),!0),q.timeout=m.timeout;function U(){if(q){var ue="getAllResponseHeaders"in q?l(q.getAllResponseHeaders()):null,ie=!$||$==="text"||$==="json"?q.responseText:q.response,ee={data:ie,status:q.status,statusText:q.statusText,headers:ue,config:m,request:q};r(P,O,ee),q=null}}if("onloadend"in q?q.onloadend=U:q.onreadystatechange=function(){!q||q.readyState!==4||q.status===0&&!(q.responseURL&&q.responseURL.indexOf("file:")===0)||setTimeout(U)},q.onabort=function(){q&&(O(u("Request aborted",m,"ECONNABORTED",q)),q=null)},q.onerror=function(){O(u("Network Error",m,null,q)),q=null},q.ontimeout=function(){var ie="timeout of "+m.timeout+"ms exceeded";m.timeoutErrorMessage&&(ie=m.timeoutErrorMessage),O(u(ie,m,m.transitional&&m.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",q)),q=null},e.isStandardBrowserEnv()){var H=(m.withCredentials||p(k))&&m.xsrfCookieName?t.read(m.xsrfCookieName):void 0;H&&(B[m.xsrfHeaderName]=H)}"setRequestHeader"in q&&e.forEach(B,function(ie,ee){typeof M>"u"&&ee.toLowerCase()==="content-type"?delete B[ee]:q.setRequestHeader(ee,ie)}),e.isUndefined(m.withCredentials)||(q.withCredentials=!!m.withCredentials),$&&$!=="json"&&(q.responseType=m.responseType),typeof m.onDownloadProgress=="function"&&q.addEventListener("progress",m.onDownloadProgress),typeof m.onUploadProgress=="function"&&q.upload&&q.upload.addEventListener("progress",m.onUploadProgress),m.cancelToken&&m.cancelToken.promise.then(function(ie){q&&(q.abort(),O(ie),q=null)}),M||(M=null),q.send(M)})},l1}var Ba=yu,MA=tB,lB=KT,cB={"Content-Type":"application/x-www-form-urlencoded"};function LA(e,r){!Ba.isUndefined(e)&&Ba.isUndefined(e["Content-Type"])&&(e["Content-Type"]=r)}function hB(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=TA()),e}function fB(e,r,t){if(Ba.isString(e))try{return(r||JSON.parse)(e),Ba.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(e)}var gv={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:hB(),transformRequest:[function(r,t){return MA(t,"Accept"),MA(t,"Content-Type"),Ba.isFormData(r)||Ba.isArrayBuffer(r)||Ba.isBuffer(r)||Ba.isStream(r)||Ba.isFile(r)||Ba.isBlob(r)?r:Ba.isArrayBufferView(r)?r.buffer:Ba.isURLSearchParams(r)?(LA(t,"application/x-www-form-urlencoded;charset=utf-8"),r.toString()):Ba.isObject(r)||t&&t["Content-Type"]==="application/json"?(LA(t,"application/json"),fB(r)):r}],transformResponse:[function(r){var t=this.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,l=!n&&this.responseType==="json";if(l||i&&Ba.isString(r)&&r.length)try{return JSON.parse(r)}catch(p){if(l)throw p.name==="SyntaxError"?lB(p,this,"E_JSON_PARSE"):p}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(r){return r>=200&&r<300}};gv.headers={common:{Accept:"application/json, text/plain, */*"}};Ba.forEach(["delete","get","head"],function(r){gv.headers[r]={}});Ba.forEach(["post","put","patch"],function(r){gv.headers[r]=Ba.merge(cB)});var Lx=gv,pB=yu,dB=Lx,gB=function(r,t,n){var i=this||dB;return pB.forEach(n,function(p){r=p.call(i,r,t)}),r},c1,RA;function eM(){return RA||(RA=1,c1=function(r){return!!(r&&r.__CANCEL__)}),c1}var DA=yu,h1=gB,mB=eM(),vB=Lx;function f1(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var yB=function(r){f1(r),r.headers=r.headers||{},r.data=h1.call(r,r.data,r.headers,r.transformRequest),r.headers=DA.merge(r.headers.common||{},r.headers[r.method]||{},r.headers),DA.forEach(["delete","get","head","post","put","patch","common"],function(i){delete r.headers[i]});var t=r.adapter||vB.adapter;return t(r).then(function(i){return f1(r),i.data=h1.call(r,i.data,i.headers,r.transformResponse),i},function(i){return mB(i)||(f1(r),i&&i.response&&(i.response.data=h1.call(r,i.response.data,i.response.headers,r.transformResponse))),Promise.reject(i)})},as=yu,tM=function(r,t){t=t||{};var n={},i=["url","method","data"],l=["headers","auth","proxy","params"],p=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],u=["validateStatus"];function _(O,M){return as.isPlainObject(O)&&as.isPlainObject(M)?as.merge(O,M):as.isPlainObject(M)?as.merge({},M):as.isArray(M)?M.slice():M}function m(O){as.isUndefined(t[O])?as.isUndefined(r[O])||(n[O]=_(void 0,r[O])):n[O]=_(r[O],t[O])}as.forEach(i,function(M){as.isUndefined(t[M])||(n[M]=_(void 0,t[M]))}),as.forEach(l,m),as.forEach(p,function(M){as.isUndefined(t[M])?as.isUndefined(r[M])||(n[M]=_(void 0,r[M])):n[M]=_(void 0,t[M])}),as.forEach(u,function(M){M in t?n[M]=_(r[M],t[M]):M in r&&(n[M]=_(void 0,r[M]))});var S=i.concat(l).concat(p).concat(u),P=Object.keys(r).concat(Object.keys(t)).filter(function(M){return S.indexOf(M)===-1});return as.forEach(P,m),n};const _B="axios",bB="0.21.4",xB="Promise based HTTP client for the browser and node.js",wB="index.js",EB={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},SB={type:"git",url:"https://github.com/axios/axios.git"},PB=["xhr","http","ajax","promise","node"],AB="Matt Zabriskie",IB="MIT",OB={url:"https://github.com/axios/axios/issues"},CB="https://axios-http.com",TB={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},MB={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},LB="dist/axios.min.js",RB="dist/axios.min.js",DB="./index.d.ts",NB={"follow-redirects":"^1.14.0"},FB=[{path:"./dist/axios.min.js",threshold:"5kB"}],kB={name:_B,version:bB,description:xB,main:wB,scripts:EB,repository:SB,keywords:PB,author:AB,license:IB,bugs:OB,homepage:CB,devDependencies:TB,browser:MB,jsdelivr:LB,unpkg:RB,typings:DB,dependencies:NB,bundlesize:FB};var rM=kB,Rx={};["object","boolean","number","function","string","symbol"].forEach(function(e,r){Rx[e]=function(n){return typeof n===e||"a"+(r<1?"n ":" ")+e}});var NA={},BB=rM.version.split(".");function nM(e,r){for(var t=r?r.split("."):BB,n=e.split("."),i=0;i<3;i++){if(t[i]>n[i])return!0;if(t[i]<n[i])return!1}return!1}Rx.transitional=function(r,t,n){var i=t&&nM(t);function l(p,u){return"[Axios v"+rM.version+"] Transitional option '"+p+"'"+u+(n?". "+n:"")}return function(p,u,_){if(r===!1)throw new Error(l(u," has been removed in "+t));return i&&!NA[u]&&(NA[u]=!0),r?r(p,u,_):!0}};function zB(e,r,t){if(typeof e!="object")throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-- >0;){var l=n[i],p=r[l];if(p){var u=e[l],_=u===void 0||p(u,l,e);if(_!==!0)throw new TypeError("option "+l+" must be "+_);continue}if(t!==!0)throw Error("Unknown option "+l)}}var jB={isOlderVersion:nM,assertOptions:zB,validators:Rx},iM=yu,UB=JT,FA=Q3,kA=yB,mv=tM,oM=jB,$h=oM.validators;function fd(e){this.defaults=e,this.interceptors={request:new FA,response:new FA}}fd.prototype.request=function(r){typeof r=="string"?(r=arguments[1]||{},r.url=arguments[0]):r=r||{},r=mv(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var t=r.transitional;t!==void 0&&oM.assertOptions(t,{silentJSONParsing:$h.transitional($h.boolean,"1.0.0"),forcedJSONParsing:$h.transitional($h.boolean,"1.0.0"),clarifyTimeoutError:$h.transitional($h.boolean,"1.0.0")},!1);var n=[],i=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(r)===!1||(i=i&&O.synchronous,n.unshift(O.fulfilled,O.rejected))});var l=[];this.interceptors.response.forEach(function(O){l.push(O.fulfilled,O.rejected)});var p;if(!i){var u=[kA,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(l),p=Promise.resolve(r);u.length;)p=p.then(u.shift(),u.shift());return p}for(var _=r;n.length;){var m=n.shift(),S=n.shift();try{_=m(_)}catch(P){S(P);break}}try{p=kA(_)}catch(P){return Promise.reject(P)}for(;l.length;)p=p.then(l.shift(),l.shift());return p};fd.prototype.getUri=function(r){return r=mv(this.defaults,r),UB(r.url,r.params,r.paramsSerializer).replace(/^\?/,"")};iM.forEach(["delete","get","head","options"],function(r){fd.prototype[r]=function(t,n){return this.request(mv(n||{},{method:r,url:t,data:(n||{}).data}))}});iM.forEach(["post","put","patch"],function(r){fd.prototype[r]=function(t,n,i){return this.request(mv(i||{},{method:r,url:t,data:n}))}});var $B=fd,p1,BA;function aM(){if(BA)return p1;BA=1;function e(r){this.message=r}return e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,p1=e,p1}var d1,zA;function GB(){if(zA)return d1;zA=1;var e=aM();function r(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var n;this.promise=new Promise(function(p){n=p});var i=this;t(function(p){i.reason||(i.reason=new e(p),n(i.reason))})}return r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var n,i=new r(function(p){n=p});return{token:i,cancel:n}},d1=r,d1}var g1,jA;function qB(){return jA||(jA=1,g1=function(r){return function(n){return r.apply(null,n)}}),g1}var m1,UA;function VB(){return UA||(UA=1,m1=function(r){return typeof r=="object"&&r.isAxiosError===!0}),m1}var $A=yu,XB=WT,_m=$B,YB=tM,WB=Lx;function sM(e){var r=new _m(e),t=XB(_m.prototype.request,r);return $A.extend(t,_m.prototype,r),$A.extend(t,r),t}var Xu=sM(WB);Xu.Axios=_m;Xu.create=function(r){return sM(YB(Xu.defaults,r))};Xu.Cancel=aM();Xu.CancelToken=GB();Xu.isCancel=eM();Xu.all=function(r){return Promise.all(r)};Xu.spread=qB();Xu.isAxiosError=VB();Cx.exports=Xu;Cx.exports.default=Xu;var ZB=Cx.exports,HB=ZB;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getNestedObjectValue=e.uuidv4=e.getBase64FromImage=e.getImageFromBase64=e.kebabize=e.kebabToCamel=e.camelToKebab=e.axios=void 0;var r=HB;e.axios=r.default.create({baseURL:"https://api.proximi.fi",timeout:6e4});var t=function(m){return m.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()};e.camelToKebab=t;var n=function(m){return m.replace(/-([a-z])/g,function(S){return S[1].toUpperCase()})};e.kebabToCamel=n;var i=function(m){var S={};return Object.keys(m).forEach(function(P){typeof m[P]<"u"&&(S[(0,e.camelToKebab)(P)]=m[P])}),S};e.kebabize=i;var l=function(m){return new Promise(function(S,P){var O=new Image;O.src=m,O.onload=function(){return S(O)},O.onerror=function(M){return S(O)}})};e.getImageFromBase64=l;var p=function(m){return new Promise(function(S,P){var O=new FileReader;O.readAsDataURL(m),O.onload=function(){return S(O.result)},O.onerror=function(M){return P(M)}})};e.getBase64FromImage=p;var u=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(m){return(m!==crypto.getRandomValues(new Uint8Array(1))[0]&15>m/4).toString(16)})};e.uuidv4=u;var _=function(m,S){if(S!==""){var P=S.split(".")[0],O=S.slice(P.length+1),M=m[P];if(M!==void 0)return O===""?M:(0,e.getNestedObjectValue)(M,O)}};e.getNestedObjectValue=_})(Wu);(function(e){var r=we&&we.__awaiter||function(m,S,P,O){function M(B){return B instanceof P?B:new P(function($){$(B)})}return new(P||(P=Promise))(function(B,$){function q(k){try{R(O.next(k))}catch(U){$(U)}}function X(k){try{R(O.throw(k))}catch(U){$(U)}}function R(k){k.done?B(k.value):M(k.value).then(q,X)}R((O=O.apply(m,S||[])).next())})},t=we&&we.__generator||function(m,S){var P={label:0,sent:function(){if(B[0]&1)throw B[1];return B[1]},trys:[],ops:[]},O,M,B,$;return $={next:q(0),throw:q(1),return:q(2)},typeof Symbol=="function"&&($[Symbol.iterator]=function(){return this}),$;function q(R){return function(k){return X([R,k])}}function X(R){if(O)throw new TypeError("Generator is already executing.");for(;$&&($=0,R[0]&&(P=0)),P;)try{if(O=1,M&&(B=R[0]&2?M.return:R[0]?M.throw||((B=M.return)&&B.call(M),0):M.next)&&!(B=B.call(M,R[1])).done)return B;switch(M=0,B&&(R=[R[0]&2,B.value]),R[0]){case 0:case 1:B=R;break;case 4:return P.label++,{value:R[1],done:!1};case 5:P.label++,M=R[1],R=[0];continue;case 7:R=P.ops.pop(),P.trys.pop();continue;default:if(B=P.trys,!(B=B.length>0&&B[B.length-1])&&(R[0]===6||R[0]===2)){P=0;continue}if(R[0]===3&&(!B||R[1]>B[0]&&R[1]<B[3])){P.label=R[1];break}if(R[0]===6&&P.label<B[1]){P.label=B[1],B=R;break}if(B&&P.label<B[2]){P.label=B[2],P.ops.push(R);break}B[2]&&P.ops.pop(),P.trys.pop();continue}R=S.call(m,P)}catch(k){R=[6,k],M=0}finally{O=B=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getCurrentUser=e.getUserConfig=e.loginWithToken=e.login=void 0;var n=Wu,i=null,l=function(m,S){return r(void 0,void 0,void 0,function(){var P,O,M;return t(this,function(B){switch(B.label){case 0:if(B.trys.push([0,2,,3]),!m)throw new Error("Please provide your email");if(!S)throw new Error("Please provide your password");return P={email:m,password:S},[4,n.axios.post("core_auth/login",P)];case 1:return O=B.sent(),O.data&&(n.axios.defaults.headers.common.Authorization=O.data.token,i=O),[2,O];case 2:throw M=B.sent(),new Error("Login failed, ".concat(M.message));case 3:return[2]}})})};e.login=l;var p=function(m){return r(void 0,void 0,void 0,function(){var S,P;return t(this,function(O){switch(O.label){case 0:if(O.trys.push([0,2,,3]),!m)throw new Error("Please provide your token");return n.axios.defaults.headers.common.Authorization=m,[4,n.axios.get("core/current_user")];case 1:return S=O.sent(),S.data&&(i=S),[2,S];case 2:throw P=O.sent(),new Error("Login failed, ".concat(P.message));case 3:return[2]}})})};e.loginWithToken=p;var u=function(){return r(void 0,void 0,void 0,function(){var m,S;return t(this,function(P){switch(P.label){case 0:return P.trys.push([0,2,,3]),[4,n.axios.get("config")];case 1:return m=P.sent(),[2,m.data];case 2:throw S=P.sent(),new Error("Fetching config failed, ".concat(S.message));case 3:return[2]}})})};e.getUserConfig=u;var _=function(){return r(void 0,void 0,void 0,function(){var m,S,P;return t(this,function(O){switch(O.label){case 0:return O.trys.push([0,4,,5]),i?(S=i,[3,3]):[3,1];case 1:return[4,n.axios.get("core/current_user")];case 2:S=O.sent(),O.label=3;case 3:return m=S,[2,m.data];case 4:throw P=O.sent(),new Error("Fetching current user failed, ".concat(P.message));case 5:return[2]}})})};e.getCurrentUser=_,e.default={login:e.login,loginWithToken:e.loginWithToken,getUserConfig:e.getUserConfig,getCurrentUser:e.getCurrentUser}})(Ox);var pd={},dd={},Sf={};Object.defineProperty(Sf,"__esModule",{value:!0});var JB=function(){function e(r){this.id=r.id||(r.properties?r.properties.id:void 0),this.createdAt=r.createdAt,this.updatedAt=r.updatedAt}return Object.defineProperty(e.prototype,"exists",{get:function(){return typeof this.id<"u"},enumerable:!1,configurable:!0}),e}();Sf.default=JB;var KB=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(dd,"__esModule",{value:!0});dd.PlaceModel=void 0;var QB=Sf,ez=function(e){KB(r,e);function r(t){var n=e.call(this,t)||this;return n.name=t.name,n.address=t.address,n.location=t.location?t.location:{lat:60.1669635,lng:24.9217484},n.tags=t.tags,n.remoteId=t.remote_id,n}return Object.defineProperty(r.prototype,"hasLocation",{get:function(){return!isNaN(this.location.lat)&&!isNaN(this.location.lng)},enumerable:!1,configurable:!0}),r}(QB.default);dd.PlaceModel=ez;(function(e){var r=we&&we.__awaiter||function(u,_,m,S){function P(O){return O instanceof m?O:new m(function(M){M(O)})}return new(m||(m=Promise))(function(O,M){function B(X){try{q(S.next(X))}catch(R){M(R)}}function $(X){try{q(S.throw(X))}catch(R){M(R)}}function q(X){X.done?O(X.value):P(X.value).then(B,$)}q((S=S.apply(u,_||[])).next())})},t=we&&we.__generator||function(u,_){var m={label:0,sent:function(){if(O[0]&1)throw O[1];return O[1]},trys:[],ops:[]},S,P,O,M;return M={next:B(0),throw:B(1),return:B(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function B(q){return function(X){return $([q,X])}}function $(q){if(S)throw new TypeError("Generator is already executing.");for(;M&&(M=0,q[0]&&(m=0)),m;)try{if(S=1,P&&(O=q[0]&2?P.return:q[0]?P.throw||((O=P.return)&&O.call(P),0):P.next)&&!(O=O.call(P,q[1])).done)return O;switch(P=0,O&&(q=[q[0]&2,O.value]),q[0]){case 0:case 1:O=q;break;case 4:return m.label++,{value:q[1],done:!1};case 5:m.label++,P=q[1],q=[0];continue;case 7:q=m.ops.pop(),m.trys.pop();continue;default:if(O=m.trys,!(O=O.length>0&&O[O.length-1])&&(q[0]===6||q[0]===2)){m=0;continue}if(q[0]===3&&(!O||q[1]>O[0]&&q[1]<O[3])){m.label=q[1];break}if(q[0]===6&&m.label<O[1]){m.label=O[1],O=q;break}if(O&&m.label<O[2]){m.label=O[2],m.ops.push(q);break}O[2]&&m.ops.pop(),m.trys.pop();continue}q=_.call(u,m)}catch(X){q=[6,X],P=0}finally{S=O=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getPlaceById=e.getPlaces=void 0;var n=Wu,i=dd,l=function(u,_,m,S,P,O,M){return r(void 0,void 0,void 0,function(){var B,$,q;return t(this,function(X){switch(X.label){case 0:B="",u&&(B+="?limit=".concat(u)),_&&(B+="&skip=".concat(_)),m&&(B+="&order=".concat(m)),S&&(B+="&dir=".concat(S)),P&&(B+="&filterByIndex=".concat(P)),O&&(B+="&q=".concat(O)),M&&(B+="&filter=".concat(O)),X.label=1;case 1:return X.trys.push([1,3,,4]),[4,n.axios.get("core/places".concat(B))];case 2:return $=X.sent(),[2,{data:$.data.map(function(R){return new i.PlaceModel(R)}),total:+$.headers.searchcount}];case 3:throw q=X.sent(),new Error("Retrieving places failed, ".concat(q.message));case 4:return[2]}})})};e.getPlaces=l;var p=function(u){return r(void 0,void 0,void 0,function(){var _,m;return t(this,function(S){switch(S.label){case 0:return S.trys.push([0,2,,3]),[4,n.axios.get("core/places/".concat(u))];case 1:return _=S.sent(),[2,new i.PlaceModel(_.data)];case 2:throw m=S.sent(),new Error("Retrieving place by id '".concat(u,"' failed, ").concat(m.message));case 3:return[2]}})})};e.getPlaceById=p,e.default={getPlaces:e.getPlaces,getPlaceById:e.getPlaceById}})(pd);var Pf={},gd={},tz=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(gd,"__esModule",{value:!0});gd.FloorModel=void 0;var rz=Sf,nz=function(e){tz(r,e);function r(t){var n=e.call(this,t)||this;return n.name=t.name,n.placeId=t.place_id,n.placeName=t.place_name,n.floorplanImageUrl=t.floorplan_image_url,n.level=t.level||0,t.anchors&&(n.anchors=[[t.anchors[0].lng,t.anchors[0].lat],[t.anchors[1].lng,t.anchors[1].lat],[t.anchors[3].lng,t.anchors[3].lat],[t.anchors[2].lng,t.anchors[2].lat]]),n.editor=t.editor,n.geopoint=t.geopoint,n.remoteId=t.remote_id,n.metadata=t.metadata,n}return Object.defineProperty(r.prototype,"hasFloorplan",{get:function(){return!!(this.floorplanImageUrl&&this.floorplanImageUrl.length>1&&this.anchors)},enumerable:!1,configurable:!0}),r}(rz.default);gd.FloorModel=nz;(function(e){var r=we&&we.__awaiter||function(u,_,m,S){function P(O){return O instanceof m?O:new m(function(M){M(O)})}return new(m||(m=Promise))(function(O,M){function B(X){try{q(S.next(X))}catch(R){M(R)}}function $(X){try{q(S.throw(X))}catch(R){M(R)}}function q(X){X.done?O(X.value):P(X.value).then(B,$)}q((S=S.apply(u,_||[])).next())})},t=we&&we.__generator||function(u,_){var m={label:0,sent:function(){if(O[0]&1)throw O[1];return O[1]},trys:[],ops:[]},S,P,O,M;return M={next:B(0),throw:B(1),return:B(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function B(q){return function(X){return $([q,X])}}function $(q){if(S)throw new TypeError("Generator is already executing.");for(;M&&(M=0,q[0]&&(m=0)),m;)try{if(S=1,P&&(O=q[0]&2?P.return:q[0]?P.throw||((O=P.return)&&O.call(P),0):P.next)&&!(O=O.call(P,q[1])).done)return O;switch(P=0,O&&(q=[q[0]&2,O.value]),q[0]){case 0:case 1:O=q;break;case 4:return m.label++,{value:q[1],done:!1};case 5:m.label++,P=q[1],q=[0];continue;case 7:q=m.ops.pop(),m.trys.pop();continue;default:if(O=m.trys,!(O=O.length>0&&O[O.length-1])&&(q[0]===6||q[0]===2)){m=0;continue}if(q[0]===3&&(!O||q[1]>O[0]&&q[1]<O[3])){m.label=q[1];break}if(q[0]===6&&m.label<O[1]){m.label=O[1],O=q;break}if(O&&m.label<O[2]){m.label=O[2],m.ops.push(q);break}O[2]&&m.ops.pop(),m.trys.pop();continue}q=_.call(u,m)}catch(X){q=[6,X],P=0}finally{S=O=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getPlaceFloors=e.getFloors=void 0;var n=Wu,i=gd,l=function(u,_,m,S,P,O){return r(void 0,void 0,void 0,function(){var M,B,$;return t(this,function(q){switch(q.label){case 0:M="",u&&(M+="?limit=".concat(u)),_&&(M+="&skip=".concat(_)),m&&(M+="&order=".concat(m)),S&&(M+="&dir=".concat(S)),P&&(M+="&filterByIndex=".concat(P)),O&&(M+="&q=".concat(O)),q.label=1;case 1:return q.trys.push([1,3,,4]),[4,n.axios.get("core/floors".concat(M))];case 2:return B=q.sent(),[2,{data:B.data.map(function(X){return new i.FloorModel(X)}),total:+B.headers.searchcount}];case 3:throw $=q.sent(),new Error("Retrieving floors failed, ".concat($.message));case 4:return[2]}})})};e.getFloors=l;var p=function(u){return r(void 0,void 0,void 0,function(){var _,m;return t(this,function(S){switch(S.label){case 0:return S.trys.push([0,2,,3]),[4,n.axios.get("core/floors?skip=0&limit=1000&filter=place_id:".concat(u))];case 1:return _=S.sent(),[2,_.data.map(function(P){return new i.FloorModel(P)})];case 2:throw m=S.sent(),new Error("Retrieving floors for place '".concat(u,"' failed, ").concat(m.message));case 3:return[2]}})})};e.getPlaceFloors=p,e.default={getFloors:e.getFloors,getPlaceFloors:e.getPlaceFloors}})(Pf);var v1={},uM={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(we,function(){var t,n,i;function l(u,_){if(!t)t=_;else if(!n)n=_;else{var m="var sharedChunk = {}; ("+t+")(sharedChunk); ("+n+")(sharedChunk);",S={};t(S),i=_(S),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([m],{type:"text/javascript"})))}}l(["exports"],function(u){function _(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var m=S;function S(h,s){this.x=h,this.y=s}S.prototype={clone:function(){return new S(this.x,this.y)},add:function(h){return this.clone()._add(h)},sub:function(h){return this.clone()._sub(h)},multByPoint:function(h){return this.clone()._multByPoint(h)},divByPoint:function(h){return this.clone()._divByPoint(h)},mult:function(h){return this.clone()._mult(h)},div:function(h){return this.clone()._div(h)},rotate:function(h){return this.clone()._rotate(h)},rotateAround:function(h,s){return this.clone()._rotateAround(h,s)},matMult:function(h){return this.clone()._matMult(h)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(h){return this.x===h.x&&this.y===h.y},dist:function(h){return Math.sqrt(this.distSqr(h))},distSqr:function(h){var s=h.x-this.x,f=h.y-this.y;return s*s+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith:function(h){return this.angleWithSep(h.x,h.y)},angleWithSep:function(h,s){return Math.atan2(this.x*s-this.y*h,this.x*h+this.y*s)},_matMult:function(h){var s=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=s,this},_add:function(h){return this.x+=h.x,this.y+=h.y,this},_sub:function(h){return this.x-=h.x,this.y-=h.y,this},_mult:function(h){return this.x*=h,this.y*=h,this},_div:function(h){return this.x/=h,this.y/=h,this},_multByPoint:function(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint:function(h){return this.x/=h.x,this.y/=h.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var h=this.y;return this.y=this.x,this.x=-h,this},_rotate:function(h){var s=Math.cos(h),f=Math.sin(h),y=f*this.x+s*this.y;return this.x=s*this.x-f*this.y,this.y=y,this},_rotateAround:function(h,s){var f=Math.cos(h),y=Math.sin(h),E=s.y+y*(this.x-s.x)+f*(this.y-s.y);return this.x=s.x+f*(this.x-s.x)-y*(this.y-s.y),this.y=E,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},S.convert=function(h){return h instanceof S?h:Array.isArray(h)?new S(h[0],h[1]):h};var P=_(m),O=M;function M(h,s,f,y){this.cx=3*h,this.bx=3*(f-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(y-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=s,this.p2x=f,this.p2y=y}M.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,s){if(s===void 0&&(s=1e-6),h<0)return 0;if(h>1)return 1;for(var f=h,y=0;y<8;y++){var E=this.sampleCurveX(f)-h;if(Math.abs(E)<s)return f;var C=this.sampleCurveDerivativeX(f);if(Math.abs(C)<1e-6)break;f-=E/C}var T=0,D=1;for(f=h,y=0;y<20&&(E=this.sampleCurveX(f),!(Math.abs(E-h)<s));y++)h>E?T=f:D=f,f=.5*(D-T)+T;return f},solve:function(h,s){return this.sampleCurveY(this.solveCurveX(h,s))}};var B=_(O);function $(h,s,f,y){const E=new B(h,s,f,y);return function(C){return E.solve(C)}}const q=$(.25,.1,.25,1);function X(h,s,f){return Math.min(f,Math.max(s,h))}function R(h,s,f){const y=f-s,E=((h-s)%y+y)%y+s;return E===s?f:E}function k(h,...s){for(const f of s)for(const y in f)h[y]=f[y];return h}let U=1;function H(h,s,f){const y={};for(const E in h)y[E]=s.call(f||this,h[E],E,h);return y}function ue(h,s,f){const y={};for(const E in h)s.call(f||this,h[E],E,h)&&(y[E]=h[E]);return y}function ie(h){return Array.isArray(h)?h.map(ie):typeof h=="object"&&h?H(h,ie):h}const ee={};function W(h){ee[h]||(typeof console<"u",ee[h]=!0)}function J(h,s,f){return(f.y-h.y)*(s.x-h.x)>(s.y-h.y)*(f.x-h.x)}function be(h){let s=0;for(let f,y,E=0,C=h.length,T=C-1;E<C;T=E++)f=h[E],y=h[T],s+=(y.x-f.x)*(f.y+y.y);return s}function Oe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Ae=null;function ae(h){if(Ae==null){const s=h.navigator?h.navigator.userAgent:null;Ae=!!h.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Ae}function ct(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const Pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let V,Q;const he={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(h){const s=requestAnimationFrame(h);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(h,s=0){return this.getImageCanvasContext(h).getImageData(-s,-s,h.width+2*s,h.height+2*s)},getImageCanvasContext(h){const s=window.document.createElement("canvas"),f=s.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return s.width=h.width,s.height=h.height,f.drawImage(h,0,0,h.width,h.height),f},resolveURL:h=>(V||(V=document.createElement("a")),V.href=h,V.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Q==null&&(Q=matchMedia("(prefers-reduced-motion: reduce)")),Q.matches)}},fe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class ye extends Error{constructor(s,f,y,E){super(`AJAXError: ${f} (${s}): ${y}`),this.status=s,this.statusText=f,this.url=y,this.body=E}}const se=Oe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,De=h=>fe.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))];function ke(h,s){const f=new AbortController,y=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:se(),signal:f.signal});let E=!1,C=!1;return h.type==="json"&&y.headers.set("Accept","application/json"),C||fetch(y).then(T=>T.ok?(D=>{(h.type==="arrayBuffer"||h.type==="image"?D.arrayBuffer():h.type==="json"?D.json():D.text()).then(z=>{C||(E=!0,s(null,z,D.headers.get("Cache-Control"),D.headers.get("Expires")))}).catch(z=>{C||s(new Error(z.message))})})(T):T.blob().then(D=>s(new ye(T.status,T.statusText,h.url,D)))).catch(T=>{T.code!==20&&s(new Error(T.message))}),{cancel:()=>{C=!0,E||f.abort()}}}const We=function(h,s){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){if(Oe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,s);if(!Oe())return(De(h.url)||ke)(h,s)}if(!(/^file:/.test(f=h.url)||/^file:/.test(se())&&!/^\w+:/.test(f))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ke(h,s);if(Oe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,s,void 0,!0)}var f;return function(y,E){const C=new XMLHttpRequest;C.open(y.method||"GET",y.url,!0),y.type!=="arrayBuffer"&&y.type!=="image"||(C.responseType="arraybuffer");for(const T in y.headers)C.setRequestHeader(T,y.headers[T]);return y.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=y.credentials==="include",C.onerror=()=>{E(new Error(C.statusText))},C.onload=()=>{if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let T=C.response;if(y.type==="json")try{T=JSON.parse(C.response)}catch(D){return E(D)}E(null,T,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else{const T=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});E(new ye(C.status,C.statusText,y.url,T))}},C.send(y.body),{cancel:()=>C.abort()}}(h,s)},He=function(h,s){return We(k(h,{type:"arrayBuffer"}),s)};function dt(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const s=new URL(h),f=window.location;return s.protocol===f.protocol&&s.host===f.host}function yt(h,s,f){f[h]&&f[h].indexOf(s)!==-1||(f[h]=f[h]||[],f[h].push(s))}function Lt(h,s,f){if(f&&f[h]){const y=f[h].indexOf(s);y!==-1&&f[h].splice(y,1)}}class pt{constructor(s,f={}){k(this,f),this.type=s}}class Ct extends pt{constructor(s,f={}){super("error",k({error:s},f))}}class mt{on(s,f){return this._listeners=this._listeners||{},yt(s,f,this._listeners),this}off(s,f){return Lt(s,f,this._listeners),Lt(s,f,this._oneTimeListeners),this}once(s,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},yt(s,f,this._oneTimeListeners),this):new Promise(y=>this.once(s,y))}fire(s,f){typeof s=="string"&&(s=new pt(s,f||{}));const y=s.type;if(this.listens(y)){s.target=this;const E=this._listeners&&this._listeners[y]?this._listeners[y].slice():[];for(const D of E)D.call(this,s);const C=this._oneTimeListeners&&this._oneTimeListeners[y]?this._oneTimeListeners[y].slice():[];for(const D of C)Lt(y,D,this._oneTimeListeners),D.call(this,s);const T=this._eventedParent;T&&(k(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(s))}else s instanceof Ct;return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,f){return this._eventedParent=s,this._eventedParentData=f,this}}var Ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Zt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hr(h,s){const f={};for(const y in h)y!=="ref"&&(f[y]=h[y]);return Zt.forEach(y=>{y in s&&(f[y]=s[y])}),f}function $t(h,s){if(Array.isArray(h)){if(!Array.isArray(s)||h.length!==s.length)return!1;for(let f=0;f<h.length;f++)if(!$t(h[f],s[f]))return!1;return!0}if(typeof h=="object"&&h!==null&&s!==null){if(typeof s!="object"||Object.keys(h).length!==Object.keys(s).length)return!1;for(const f in h)if(!$t(h[f],s[f]))return!1;return!0}return h===s}const yr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function nn(h,s,f){f.push({command:yr.addSource,args:[h,s[h]]})}function rt(h,s,f){s.push({command:yr.removeSource,args:[h]}),f[h]=!0}function Se(h,s,f,y){rt(h,f,y),nn(h,s,f)}function ce(h,s,f){let y;for(y in h[f])if(Object.prototype.hasOwnProperty.call(h[f],y)&&y!=="data"&&!$t(h[f][y],s[f][y]))return!1;for(y in s[f])if(Object.prototype.hasOwnProperty.call(s[f],y)&&y!=="data"&&!$t(h[f][y],s[f][y]))return!1;return!0}function ge(h,s,f,y,E,C){let T;for(T in s=s||{},h=h||{})Object.prototype.hasOwnProperty.call(h,T)&&($t(h[T],s[T])||f.push({command:C,args:[y,T,s[T],E]}));for(T in s)Object.prototype.hasOwnProperty.call(s,T)&&!Object.prototype.hasOwnProperty.call(h,T)&&($t(h[T],s[T])||f.push({command:C,args:[y,T,s[T],E]}))}function Be(h){return h.id}function Xe(h,s){return h[s.id]=s,h}class $e{constructor(s,f,y,E){this.message=(s?`${s}: `:"")+y,E&&(this.identifier=E),f!=null&&f.__line__&&(this.line=f.__line__)}}function ht(h,...s){for(const f of s)for(const y in f)h[y]=f[y];return h}class Qe extends Error{constructor(s,f){super(f),this.message=f,this.key=s}}class Vt{constructor(s,f=[]){this.parent=s,this.bindings={};for(const[y,E]of f)this.bindings[y]=E}concat(s){return new Vt(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const ir={kind:"null"},it={kind:"number"},Tt={kind:"string"},Nt={kind:"boolean"},Ar={kind:"color"},Ir={kind:"object"},Rt={kind:"value"},sn={kind:"collator"},un={kind:"formatted"},Gn={kind:"padding"},rn={kind:"resolvedImage"},qr={kind:"variableAnchorOffsetCollection"};function Fn(h,s){return{kind:"array",itemType:h,N:s}}function Lr(h){if(h.kind==="array"){const s=Lr(h.itemType);return typeof h.N=="number"?`array<${s}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${s}>`}return h.kind}const Et=[ir,it,Tt,Nt,Ar,un,Ir,Fn(Rt),Gn,rn,qr];function li(h,s){if(s.kind==="error")return null;if(h.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!li(h.itemType,s.itemType))&&(typeof h.N!="number"||h.N===s.N))return null}else{if(h.kind===s.kind)return null;if(h.kind==="value"){for(const f of Et)if(!li(f,s))return null}}return`Expected ${Lr(h)} but found ${Lr(s)} instead.`}function Le(h,s){return s.some(f=>f.kind===h.kind)}function ne(h,s){return s.some(f=>f==="null"?h===null:f==="array"?Array.isArray(h):f==="object"?h&&!Array.isArray(h)&&typeof h=="object":f===typeof h)}function pe(h,s){return h.kind==="array"&&s.kind==="array"?h.itemType.kind===s.itemType.kind&&typeof h.N=="number":h.kind===s.kind}const Ie=.96422,Ne=.82521,Ue=4/29,et=6/29,Ve=3*et*et,qe=et*et*et,Ke=Math.PI/180,gt=180/Math.PI;function vt(h){return(h%=360)<0&&(h+=360),h}function ft([h,s,f,y]){let E,C;const T=ur((.2225045*(h=Ot(h))+.7168786*(s=Ot(s))+.0606169*(f=Ot(f)))/1);h===s&&s===f?E=C=T:(E=ur((.4360747*h+.3850649*s+.1430804*f)/Ie),C=ur((.0139322*h+.0971045*s+.7141733*f)/Ne));const D=116*T-16;return[D<0?0:D,500*(E-T),200*(T-C),y]}function Ot(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function ur(h){return h>qe?Math.pow(h,1/3):h/Ve+Ue}function jt([h,s,f,y]){let E=(h+16)/116,C=isNaN(s)?E:E+s/500,T=isNaN(f)?E:E-f/200;return E=1*Ht(E),C=Ie*Ht(C),T=Ne*Ht(T),[Xt(3.1338561*C-1.6168667*E-.4906146*T),Xt(-.9787684*C+1.9161415*E+.033454*T),Xt(.0719453*C-.2289914*E+1.4052427*T),y]}function Xt(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function Ht(h){return h>et?h*h*h:Ve*(h-Ue)}function Ur(h){return parseInt(h.padEnd(2,h),16)/255}function $r(h,s){return zr(s?h/100:h,0,1)}function zr(h,s,f){return Math.min(Math.max(s,h),f)}function Cr(h){return!h.some(Number.isNaN)}const Zi={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ut{constructor(s,f,y,E=1,C=!0){this.r=s,this.g=f,this.b=y,this.a=E,C||(this.r*=E,this.g*=E,this.b*=E,E||this.overwriteGetter("rgb",[s,f,y,E]))}static parse(s){if(s instanceof Ut)return s;if(typeof s!="string")return;const f=function(y){if((y=y.toLowerCase().trim())==="transparent")return[0,0,0,0];const E=Zi[y];if(E){const[T,D,z]=E;return[T/255,D/255,z/255,1]}if(y.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(y)){const T=y.length<6?1:2;let D=1;return[Ur(y.slice(D,D+=T)),Ur(y.slice(D,D+=T)),Ur(y.slice(D,D+=T)),Ur(y.slice(D,D+T)||"ff")]}if(y.startsWith("rgb")){const T=y.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[D,z,Z,te,oe,de,_e,Ee,Re,ze,Ge,nt]=T,Ze=[te||" ",_e||" ",ze].join("");if(Ze==="  "||Ze==="  /"||Ze===",,"||Ze===",,,"){const ot=[Z,de,Re].join(""),st=ot==="%%%"?100:ot===""?255:0;if(st){const xt=[zr(+z/st,0,1),zr(+oe/st,0,1),zr(+Ee/st,0,1),Ge?$r(+Ge,nt):1];if(Cr(xt))return xt}}return}}const C=y.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[T,D,z,Z,te,oe,de,_e,Ee]=C,Re=[z||" ",te||" ",de].join("");if(Re==="  "||Re==="  /"||Re===",,"||Re===",,,"){const ze=[+D,zr(+Z,0,100),zr(+oe,0,100),_e?$r(+_e,Ee):1];if(Cr(ze))return function([Ge,nt,Ze,ot]){function st(xt){const qt=(xt+Ge/30)%12,cr=nt*Math.min(Ze,1-Ze);return Ze-cr*Math.max(-1,Math.min(qt-3,9-qt,1))}return Ge=vt(Ge),nt/=100,Ze/=100,[st(0),st(8),st(4),ot]}(ze)}}}(s);return f?new Ut(...f,!1):void 0}get rgb(){const{r:s,g:f,b:y,a:E}=this,C=E||1/0;return this.overwriteGetter("rgb",[s/C,f/C,y/C,E])}get hcl(){return this.overwriteGetter("hcl",function(s){const[f,y,E,C]=ft(s),T=Math.sqrt(y*y+E*E);return[Math.round(1e4*T)?vt(Math.atan2(E,y)*gt):NaN,T,f,C]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ft(this.rgb))}overwriteGetter(s,f){return Object.defineProperty(this,s,{value:f}),f}toString(){const[s,f,y,E]=this.rgb;return`rgba(${[s,f,y].map(C=>Math.round(255*C)).join(",")},${E})`}}Ut.black=new Ut(0,0,0,1),Ut.white=new Ut(1,1,1,1),Ut.transparent=new Ut(0,0,0,0),Ut.red=new Ut(1,0,0,1);class Fr{constructor(s,f,y){this.sensitivity=s?f?"variant":"case":f?"accent":"base",this.locale=y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,f){return this.collator.compare(s,f)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class _t{constructor(s,f,y,E,C){this.text=s,this.image=f,this.scale=y,this.fontStack=E,this.textColor=C}}class Vr{constructor(s){this.sections=s}static fromString(s){return new Vr([new _t(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof Vr?s:Vr.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class vi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof vi)return s;if(typeof s=="number")return new vi([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const f of s)if(typeof f!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new vi(s)}}toString(){return JSON.stringify(this.values)}}const ii=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ci{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof ci)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let f=0;f<s.length;f+=2){const y=s[f],E=s[f+1];if(typeof y!="string"||!ii.has(y)||!Array.isArray(E)||E.length!==2||typeof E[0]!="number"||typeof E[1]!="number")return}return new ci(s)}}toString(){return JSON.stringify(this.values)}}class hi{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new hi({name:s,available:!1}):null}}function Bo(h,s,f,y){return typeof h=="number"&&h>=0&&h<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof f=="number"&&f>=0&&f<=255?y===void 0||typeof y=="number"&&y>=0&&y<=1?null:`Invalid rgba value [${[h,s,f,y].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof y=="number"?[h,s,f,y]:[h,s,f]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ji(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof Ut||h instanceof Fr||h instanceof Vr||h instanceof vi||h instanceof ci||h instanceof hi)return!0;if(Array.isArray(h)){for(const s of h)if(!ji(s))return!1;return!0}if(typeof h=="object"){for(const s in h)if(!ji(h[s]))return!1;return!0}return!1}function Qn(h){if(h===null)return ir;if(typeof h=="string")return Tt;if(typeof h=="boolean")return Nt;if(typeof h=="number")return it;if(h instanceof Ut)return Ar;if(h instanceof Fr)return sn;if(h instanceof Vr)return un;if(h instanceof vi)return Gn;if(h instanceof ci)return qr;if(h instanceof hi)return rn;if(Array.isArray(h)){const s=h.length;let f;for(const y of h){const E=Qn(y);if(f){if(f===E)continue;f=Rt;break}f=E}return Fn(f||Rt,s)}return Ir}function Eo(h){const s=typeof h;return h===null?"":s==="string"||s==="number"||s==="boolean"?String(h):h instanceof Ut||h instanceof Vr||h instanceof vi||h instanceof ci||h instanceof hi?h.toString():JSON.stringify(h)}class Xo{constructor(s,f){this.type=s,this.value=f}static parse(s,f){if(s.length!==2)return f.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!ji(s[1]))return f.error("invalid value");const y=s[1];let E=Qn(y);const C=f.expectedType;return E.kind!=="array"||E.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(E=C),new Xo(E,y)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Xn{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const kn={string:Tt,number:it,boolean:Nt,object:Ir};class Ui{constructor(s,f){this.type=s,this.args=f}static parse(s,f){if(s.length<2)return f.error("Expected at least one argument.");let y,E=1;const C=s[0];if(C==="array"){let D,z;if(s.length>2){const Z=s[1];if(typeof Z!="string"||!(Z in kn)||Z==="object")return f.error('The item type argument of "array" must be one of string, number, boolean',1);D=kn[Z],E++}else D=Rt;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return f.error('The length argument to "array" must be a positive integer literal',2);z=s[2],E++}y=Fn(D,z)}else{if(!kn[C])throw new Error(`Types doesn't contain name = ${C}`);y=kn[C]}const T=[];for(;E<s.length;E++){const D=f.parse(s[E],E,Rt);if(!D)return null;T.push(D)}return new Ui(y,T)}evaluate(s){for(let f=0;f<this.args.length;f++){const y=this.args[f].evaluate(s);if(!li(this.type,Qn(y)))return y;if(f===this.args.length-1)throw new Xn(`Expected value to be of type ${Lr(this.type)}, but found ${Lr(Qn(y))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const mo={"to-boolean":Nt,"to-color":Ar,"to-number":it,"to-string":Tt};class zo{constructor(s,f){this.type=s,this.args=f}static parse(s,f){if(s.length<2)return f.error("Expected at least one argument.");const y=s[0];if(!mo[y])throw new Error(`Can't parse ${y} as it is not part of the known types`);if((y==="to-boolean"||y==="to-string")&&s.length!==2)return f.error("Expected one argument.");const E=mo[y],C=[];for(let T=1;T<s.length;T++){const D=f.parse(s[T],T,Rt);if(!D)return null;C.push(D)}return new zo(E,C)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let f,y;for(const E of this.args){if(f=E.evaluate(s),y=null,f instanceof Ut)return f;if(typeof f=="string"){const C=s.parseColor(f);if(C)return C}else if(Array.isArray(f)&&(y=f.length<3||f.length>4?`Invalid rbga value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:Bo(f[0],f[1],f[2],f[3]),!y))return new Ut(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new Xn(y||`Could not parse color from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"padding":{let f;for(const y of this.args){f=y.evaluate(s);const E=vi.parse(f);if(E)return E}throw new Xn(`Could not parse padding from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"variableAnchorOffsetCollection":{let f;for(const y of this.args){f=y.evaluate(s);const E=ci.parse(f);if(E)return E}throw new Xn(`Could not parse variableAnchorOffsetCollection from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"number":{let f=null;for(const y of this.args){if(f=y.evaluate(s),f===null)return 0;const E=Number(f);if(!isNaN(E))return E}throw new Xn(`Could not convert ${JSON.stringify(f)} to number.`)}case"formatted":return Vr.fromString(Eo(this.args[0].evaluate(s)));case"resolvedImage":return hi.fromString(Eo(this.args[0].evaluate(s)));default:return Eo(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Ls=["Unknown","Point","LineString","Polygon"];class er{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ls[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let f=this._parseColorCache[s];return f||(f=this._parseColorCache[s]=Ut.parse(s)),f}}class Rs{constructor(s,f,y=[],E,C=new Vt,T=[]){this.registry=s,this.path=y,this.key=y.map(D=>`[${D}]`).join(""),this.scope=C,this.errors=T,this.expectedType=E,this._isConstant=f}parse(s,f,y,E,C={}){return f?this.concat(f,y,E)._parse(s,C):this._parse(s,C)}_parse(s,f){function y(E,C,T){return T==="assert"?new Ui(C,[E]):T==="coerce"?new zo(C,[E]):E}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const E=s[0];if(typeof E!="string")return this.error(`Expression name must be a string, but found ${typeof E} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[E];if(C){let T=C.parse(s,this);if(!T)return null;if(this.expectedType){const D=this.expectedType,z=T.type;if(D.kind!=="string"&&D.kind!=="number"&&D.kind!=="boolean"&&D.kind!=="object"&&D.kind!=="array"||z.kind!=="value")if(D.kind!=="color"&&D.kind!=="formatted"&&D.kind!=="resolvedImage"||z.kind!=="value"&&z.kind!=="string")if(D.kind!=="padding"||z.kind!=="value"&&z.kind!=="number"&&z.kind!=="array")if(D.kind!=="variableAnchorOffsetCollection"||z.kind!=="value"&&z.kind!=="array"){if(this.checkSubtype(D,z))return null}else T=y(T,D,f.typeAnnotation||"coerce");else T=y(T,D,f.typeAnnotation||"coerce");else T=y(T,D,f.typeAnnotation||"coerce");else T=y(T,D,f.typeAnnotation||"assert")}if(!(T instanceof Xo)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const D=new er;try{T=new Xo(T.type,T.evaluate(D))}catch(z){return this.error(z.message),null}}return T}return this.error(`Unknown expression "${E}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,f,y){const E=typeof s=="number"?this.path.concat(s):this.path,C=y?this.scope.concat(y):this.scope;return new Rs(this.registry,this._isConstant,E,f||null,C,this.errors)}error(s,...f){const y=`${this.key}${f.map(E=>`[${E}]`).join("")}`;this.errors.push(new Qe(y,s))}checkSubtype(s,f){const y=li(s,f);return y&&this.error(y),y}}class $i{constructor(s,f,y){this.type=sn,this.locale=y,this.caseSensitive=s,this.diacriticSensitive=f}static parse(s,f){if(s.length!==2)return f.error("Expected one argument.");const y=s[1];if(typeof y!="object"||Array.isArray(y))return f.error("Collator options argument must be an object.");const E=f.parse(y["case-sensitive"]!==void 0&&y["case-sensitive"],1,Nt);if(!E)return null;const C=f.parse(y["diacritic-sensitive"]!==void 0&&y["diacritic-sensitive"],1,Nt);if(!C)return null;let T=null;return y.locale&&(T=f.parse(y.locale,1,Tt),!T)?null:new $i(E,C,T)}evaluate(s){return new Fr(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const ha=8192;function Rr(h,s){h[0]=Math.min(h[0],s[0]),h[1]=Math.min(h[1],s[1]),h[2]=Math.max(h[2],s[0]),h[3]=Math.max(h[3],s[1])}function Ds(h,s){return!(h[0]<=s[0]||h[2]>=s[2]||h[1]<=s[1]||h[3]>=s[3])}function Il(h,s){const f=(180+h[0])/360,y=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,E=Math.pow(2,s.z);return[Math.round(f*E*ha),Math.round(y*E*ha)]}function Ws(h,s,f){const y=h[0]-s[0],E=h[1]-s[1],C=h[0]-f[0],T=h[1]-f[1];return y*T-C*E==0&&y*C<=0&&E*T<=0}function Hi(h,s){let f=!1;for(let T=0,D=s.length;T<D;T++){const z=s[T];for(let Z=0,te=z.length;Z<te-1;Z++){if(Ws(h,z[Z],z[Z+1]))return!1;(E=z[Z])[1]>(y=h)[1]!=(C=z[Z+1])[1]>y[1]&&y[0]<(C[0]-E[0])*(y[1]-E[1])/(C[1]-E[1])+E[0]&&(f=!f)}}var y,E,C;return f}function Yo(h,s){for(let f=0;f<s.length;f++)if(Hi(h,s[f]))return!0;return!1}function Zs(h,s,f,y){const E=y[0]-f[0],C=y[1]-f[1],T=(h[0]-f[0])*C-E*(h[1]-f[1]),D=(s[0]-f[0])*C-E*(s[1]-f[1]);return T>0&&D<0||T<0&&D>0}function Qu(h,s,f){for(const Z of f)for(let te=0;te<Z.length-1;++te)if((D=[(T=Z[te+1])[0]-(C=Z[te])[0],T[1]-C[1]])[0]*(z=[(E=s)[0]-(y=h)[0],E[1]-y[1]])[1]-D[1]*z[0]!=0&&Zs(y,E,C,T)&&Zs(C,T,y,E))return!0;var y,E,C,T,D,z;return!1}function Pt(h,s){for(let f=0;f<h.length;++f)if(!Hi(h[f],s))return!1;for(let f=0;f<h.length-1;++f)if(Qu(h[f],h[f+1],s))return!1;return!0}function Hs(h,s){for(let f=0;f<s.length;f++)if(Pt(h,s[f]))return!0;return!1}function io(h,s,f){const y=[];for(let E=0;E<h.length;E++){const C=[];for(let T=0;T<h[E].length;T++){const D=Il(h[E][T],f);Rr(s,D),C.push(D)}y.push(C)}return y}function Wo(h,s,f){const y=[];for(let E=0;E<h.length;E++){const C=io(h[E],s,f);y.push(C)}return y}function Js(h,s,f,y){if(h[0]<f[0]||h[0]>f[2]){const E=.5*y;let C=h[0]-f[0]>E?-y:f[0]-h[0]>E?y:0;C===0&&(C=h[0]-f[2]>E?-y:f[2]-h[0]>E?y:0),h[0]+=C}Rr(s,h)}function fi(h,s,f,y){const E=Math.pow(2,y.z)*ha,C=[y.x*ha,y.y*ha],T=[];for(const D of h)for(const z of D){const Z=[z.x+C[0],z.y+C[1]];Js(Z,s,f,E),T.push(Z)}return T}function an(h,s,f,y){const E=Math.pow(2,y.z)*ha,C=[y.x*ha,y.y*ha],T=[];for(const z of h){const Z=[];for(const te of z){const oe=[te.x+C[0],te.y+C[1]];Rr(s,oe),Z.push(oe)}T.push(Z)}if(s[2]-s[0]<=E/2){(D=s)[0]=D[1]=1/0,D[2]=D[3]=-1/0;for(const z of T)for(const Z of z)Js(Z,s,f,E)}var D;return T}class Xr{constructor(s,f){this.type=Nt,this.geojson=s,this.geometries=f}static parse(s,f){if(s.length!==2)return f.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(ji(s[1])){const y=s[1];if(y.type==="FeatureCollection")for(let E=0;E<y.features.length;++E){const C=y.features[E].geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new Xr(y,y.features[E].geometry)}else if(y.type==="Feature"){const E=y.geometry.type;if(E==="Polygon"||E==="MultiPolygon")return new Xr(y,y.geometry)}else if(y.type==="Polygon"||y.type==="MultiPolygon")return new Xr(y,y)}return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(f,y){const E=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=f.canonicalID();if(y.type==="Polygon"){const D=io(y.coordinates,C,T),z=fi(f.geometry(),E,C,T);if(!Ds(E,C))return!1;for(const Z of z)if(!Hi(Z,D))return!1}if(y.type==="MultiPolygon"){const D=Wo(y.coordinates,C,T),z=fi(f.geometry(),E,C,T);if(!Ds(E,C))return!1;for(const Z of z)if(!Yo(Z,D))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(f,y){const E=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=f.canonicalID();if(y.type==="Polygon"){const D=io(y.coordinates,C,T),z=an(f.geometry(),E,C,T);if(!Ds(E,C))return!1;for(const Z of z)if(!Pt(Z,D))return!1}if(y.type==="MultiPolygon"){const D=Wo(y.coordinates,C,T),z=an(f.geometry(),E,C,T);if(!Ds(E,C))return!1;for(const Z of z)if(!Hs(Z,D))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Bn{constructor(s,f){this.type=f.type,this.name=s,this.boundExpression=f}static parse(s,f){if(s.length!==2||typeof s[1]!="string")return f.error("'var' expression requires exactly one string literal argument.");const y=s[1];return f.scope.has(y)?new Bn(y,f.scope.get(y)):f.error(`Unknown variable "${y}". Make sure "${y}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class So{constructor(s,f,y,E){this.name=s,this.type=f,this._evaluate=y,this.args=E}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,f){const y=s[0],E=So.definitions[y];if(!E)return f.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(E)?E[0]:E.type,T=Array.isArray(E)?[[E[1],E[2]]]:E.overloads,D=T.filter(([Z])=>!Array.isArray(Z)||Z.length===s.length-1);let z=null;for(const[Z,te]of D){z=new Rs(f.registry,Ks,f.path,null,f.scope);const oe=[];let de=!1;for(let _e=1;_e<s.length;_e++){const Ee=s[_e],Re=Array.isArray(Z)?Z[_e-1]:Z.type,ze=z.parse(Ee,1+oe.length,Re);if(!ze){de=!0;break}oe.push(ze)}if(!de)if(Array.isArray(Z)&&Z.length!==oe.length)z.error(`Expected ${Z.length} arguments, but found ${oe.length} instead.`);else{for(let _e=0;_e<oe.length;_e++){const Ee=Array.isArray(Z)?Z[_e]:Z.type,Re=oe[_e];z.concat(_e+1).checkSubtype(Ee,Re.type)}if(z.errors.length===0)return new So(y,C,te,oe)}}if(D.length===1)f.errors.push(...z.errors);else{const Z=(D.length?D:T).map(([oe])=>{return de=oe,Array.isArray(de)?`(${de.map(Lr).join(", ")})`:`(${Lr(de.type)}...)`;var de}).join(" | "),te=[];for(let oe=1;oe<s.length;oe++){const de=f.parse(s[oe],1+te.length);if(!de)return null;te.push(Lr(de.type))}f.error(`Expected arguments of type ${Z}, but found (${te.join(", ")}) instead.`)}return null}static register(s,f){So.definitions=f;for(const y in f)s[y]=So}}function Ks(h){if(h instanceof Bn)return Ks(h.boundExpression);if(h instanceof So&&h.name==="error"||h instanceof $i||h instanceof Xr)return!1;const s=h instanceof zo||h instanceof Ui;let f=!0;return h.eachChild(y=>{f=s?f&&Ks(y):f&&y instanceof Xo}),!!f&&Ci(h)&&Ji(h,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ci(h){if(h instanceof So&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof Xr)return!1;let s=!0;return h.eachChild(f=>{s&&!Ci(f)&&(s=!1)}),s}function Ua(h){if(h instanceof So&&h.name==="feature-state")return!1;let s=!0;return h.eachChild(f=>{s&&!Ua(f)&&(s=!1)}),s}function Ji(h,s){if(h instanceof So&&s.indexOf(h.name)>=0)return!1;let f=!0;return h.eachChild(y=>{f&&!Ji(y,s)&&(f=!1)}),f}function Zr(h,s){const f=h.length-1;let y,E,C=0,T=f,D=0;for(;C<=T;)if(D=Math.floor((C+T)/2),y=h[D],E=h[D+1],y<=s){if(D===f||s<E)return D;C=D+1}else{if(!(y>s))throw new Xn("Input is not a number.");T=D-1}return 0}class Oa{constructor(s,f,y){this.type=s,this.input=f,this.labels=[],this.outputs=[];for(const[E,C]of y)this.labels.push(E),this.outputs.push(C)}static parse(s,f){if(s.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return f.error("Expected an even number of arguments.");const y=f.parse(s[1],1,it);if(!y)return null;const E=[];let C=null;f.expectedType&&f.expectedType.kind!=="value"&&(C=f.expectedType);for(let T=1;T<s.length;T+=2){const D=T===1?-1/0:s[T],z=s[T+1],Z=T,te=T+1;if(typeof D!="number")return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(E.length&&E[E.length-1][0]>=D)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Z);const oe=f.parse(z,te,C);if(!oe)return null;C=C||oe.type,E.push([D,oe])}return new Oa(C,y,E)}evaluate(s){const f=this.labels,y=this.outputs;if(f.length===1)return y[0].evaluate(s);const E=this.input.evaluate(s);if(E<=f[0])return y[0].evaluate(s);const C=f.length;return E>=f[C-1]?y[C-1].evaluate(s):y[Zr(f,E)].evaluate(s)}eachChild(s){s(this.input);for(const f of this.outputs)s(f)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Yn(h,s,f){return h+f*(s-h)}function Ns(h,s,f){return h.map((y,E)=>Yn(y,s[E],f))}const Ti={number:Yn,color:function(h,s,f,y="rgb"){switch(y){case"rgb":{const[E,C,T,D]=Ns(h.rgb,s.rgb,f);return new Ut(E,C,T,D,!1)}case"hcl":{const[E,C,T,D]=h.hcl,[z,Z,te,oe]=s.hcl;let de,_e;if(isNaN(E)||isNaN(z))isNaN(E)?isNaN(z)?de=NaN:(de=z,T!==1&&T!==0||(_e=Z)):(de=E,te!==1&&te!==0||(_e=C));else{let nt=z-E;z>E&&nt>180?nt-=360:z<E&&E-z>180&&(nt+=360),de=E+f*nt}const[Ee,Re,ze,Ge]=function([nt,Ze,ot,st]){return nt=isNaN(nt)?0:nt*Ke,jt([ot,Math.cos(nt)*Ze,Math.sin(nt)*Ze,st])}([de,_e??Yn(C,Z,f),Yn(T,te,f),Yn(D,oe,f)]);return new Ut(Ee,Re,ze,Ge,!1)}case"lab":{const[E,C,T,D]=jt(Ns(h.lab,s.lab,f));return new Ut(E,C,T,D,!1)}}},array:Ns,padding:function(h,s,f){return new vi(Ns(h.values,s.values,f))},variableAnchorOffsetCollection:function(h,s,f){const y=h.values,E=s.values;if(y.length!==E.length)throw new Xn(`Cannot interpolate values of different length. from: ${h.toString()}, to: ${s.toString()}`);const C=[];for(let T=0;T<y.length;T+=2){if(y[T]!==E[T])throw new Xn(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${y[T]}, to[${T}]: ${E[T]}`);C.push(y[T]);const[D,z]=y[T+1],[Z,te]=E[T+1];C.push([Yn(D,Z,f),Yn(z,te,f)])}return new ci(C)}};class Yr{constructor(s,f,y,E,C){this.type=s,this.operator=f,this.interpolation=y,this.input=E,this.labels=[],this.outputs=[];for(const[T,D]of C)this.labels.push(T),this.outputs.push(D)}static interpolationFactor(s,f,y,E){let C=0;if(s.name==="exponential")C=Mi(f,s.base,y,E);else if(s.name==="linear")C=Mi(f,1,y,E);else if(s.name==="cubic-bezier"){const T=s.controlPoints;C=new B(T[0],T[1],T[2],T[3]).solve(Mi(f,1,y,E))}return C}static parse(s,f){let[y,E,C,...T]=s;if(!Array.isArray(E)||E.length===0)return f.error("Expected an interpolation type expression.",1);if(E[0]==="linear")E={name:"linear"};else if(E[0]==="exponential"){const Z=E[1];if(typeof Z!="number")return f.error("Exponential interpolation requires a numeric base.",1,1);E={name:"exponential",base:Z}}else{if(E[0]!=="cubic-bezier")return f.error(`Unknown interpolation type ${String(E[0])}`,1,0);{const Z=E.slice(1);if(Z.length!==4||Z.some(te=>typeof te!="number"||te<0||te>1))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);E={name:"cubic-bezier",controlPoints:Z}}}if(s.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return f.error("Expected an even number of arguments.");if(C=f.parse(C,2,it),!C)return null;const D=[];let z=null;y==="interpolate-hcl"||y==="interpolate-lab"?z=Ar:f.expectedType&&f.expectedType.kind!=="value"&&(z=f.expectedType);for(let Z=0;Z<T.length;Z+=2){const te=T[Z],oe=T[Z+1],de=Z+3,_e=Z+4;if(typeof te!="number")return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',de);if(D.length&&D[D.length-1][0]>=te)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',de);const Ee=f.parse(oe,_e,z);if(!Ee)return null;z=z||Ee.type,D.push([te,Ee])}return pe(z,it)||pe(z,Ar)||pe(z,Gn)||pe(z,qr)||pe(z,Fn(it))?new Yr(z,y,E,C,D):f.error(`Type ${Lr(z)} is not interpolatable.`)}evaluate(s){const f=this.labels,y=this.outputs;if(f.length===1)return y[0].evaluate(s);const E=this.input.evaluate(s);if(E<=f[0])return y[0].evaluate(s);const C=f.length;if(E>=f[C-1])return y[C-1].evaluate(s);const T=Zr(f,E),D=Yr.interpolationFactor(this.interpolation,E,f[T],f[T+1]),z=y[T].evaluate(s),Z=y[T+1].evaluate(s);switch(this.operator){case"interpolate":return Ti[this.type.kind](z,Z,D);case"interpolate-hcl":return Ti.color(z,Z,D,"hcl");case"interpolate-lab":return Ti.color(z,Z,D,"lab")}}eachChild(s){s(this.input);for(const f of this.outputs)s(f)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Mi(h,s,f,y){const E=y-f,C=h-f;return E===0?0:s===1?C/E:(Math.pow(s,C)-1)/(Math.pow(s,E)-1)}class fa{constructor(s,f){this.type=s,this.args=f}static parse(s,f){if(s.length<2)return f.error("Expectected at least one argument.");let y=null;const E=f.expectedType;E&&E.kind!=="value"&&(y=E);const C=[];for(const D of s.slice(1)){const z=f.parse(D,1+C.length,y,void 0,{typeAnnotation:"omit"});if(!z)return null;y=y||z.type,C.push(z)}if(!y)throw new Error("No output type");const T=E&&C.some(D=>li(E,D.type));return new fa(T?Rt:y,C)}evaluate(s){let f,y=null,E=0;for(const C of this.args)if(E++,y=C.evaluate(s),y&&y instanceof hi&&!y.available&&(f||(f=y.name),y=null,E===this.args.length&&(y=f)),y!==null)break;return y}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class wi{constructor(s,f){this.type=f.type,this.bindings=[].concat(s),this.result=f}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const f of this.bindings)s(f[1]);s(this.result)}static parse(s,f){if(s.length<4)return f.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const y=[];for(let C=1;C<s.length-1;C+=2){const T=s[C];if(typeof T!="string")return f.error(`Expected string, but found ${typeof T} instead.`,C);if(/[^a-zA-Z0-9_]/.test(T))return f.error("Variable names must contain only alphanumeric characters or '_'.",C);const D=f.parse(s[C+1],C+1);if(!D)return null;y.push([T,D])}const E=f.parse(s[s.length-1],s.length-1,f.expectedType,y);return E?new wi(y,E):null}outputDefined(){return this.result.outputDefined()}}class oo{constructor(s,f,y){this.type=s,this.index=f,this.input=y}static parse(s,f){if(s.length!==3)return f.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const y=f.parse(s[1],1,it),E=f.parse(s[2],2,Fn(f.expectedType||Rt));return y&&E?new oo(E.type.itemType,y,E):null}evaluate(s){const f=this.index.evaluate(s),y=this.input.evaluate(s);if(f<0)throw new Xn(`Array index out of bounds: ${f} < 0.`);if(f>=y.length)throw new Xn(`Array index out of bounds: ${f} > ${y.length-1}.`);if(f!==Math.floor(f))throw new Xn(`Array index must be an integer, but found ${f} instead.`);return y[f]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class Gr{constructor(s,f){this.type=Nt,this.needle=s,this.haystack=f}static parse(s,f){if(s.length!==3)return f.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const y=f.parse(s[1],1,Rt),E=f.parse(s[2],2,Rt);return y&&E?Le(y.type,[Nt,Tt,it,ir,Rt])?new Gr(y,E):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(y.type)} instead`):null}evaluate(s){const f=this.needle.evaluate(s),y=this.haystack.evaluate(s);if(!y)return!1;if(!ne(f,["boolean","string","number","null"]))throw new Xn(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(Qn(f))} instead.`);if(!ne(y,["string","array"]))throw new Xn(`Expected second argument to be of type array or string, but found ${Lr(Qn(y))} instead.`);return y.indexOf(f)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class pa{constructor(s,f,y){this.type=it,this.needle=s,this.haystack=f,this.fromIndex=y}static parse(s,f){if(s.length<=2||s.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const y=f.parse(s[1],1,Rt),E=f.parse(s[2],2,Rt);if(!y||!E)return null;if(!Le(y.type,[Nt,Tt,it,ir,Rt]))return f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(y.type)} instead`);if(s.length===4){const C=f.parse(s[3],3,it);return C?new pa(y,E,C):null}return new pa(y,E)}evaluate(s){const f=this.needle.evaluate(s),y=this.haystack.evaluate(s);if(!ne(f,["boolean","string","number","null"]))throw new Xn(`Expected first argument to be of type boolean, string, number or null, but found ${Lr(Qn(f))} instead.`);if(!ne(y,["string","array"]))throw new Xn(`Expected second argument to be of type array or string, but found ${Lr(Qn(y))} instead.`);if(this.fromIndex){const E=this.fromIndex.evaluate(s);return y.indexOf(f,E)}return y.indexOf(f)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class Wn{constructor(s,f,y,E,C,T){this.inputType=s,this.type=f,this.input=y,this.cases=E,this.outputs=C,this.otherwise=T}static parse(s,f){if(s.length<5)return f.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return f.error("Expected an even number of arguments.");let y,E;f.expectedType&&f.expectedType.kind!=="value"&&(E=f.expectedType);const C={},T=[];for(let Z=2;Z<s.length-1;Z+=2){let te=s[Z];const oe=s[Z+1];Array.isArray(te)||(te=[te]);const de=f.concat(Z);if(te.length===0)return de.error("Expected at least one branch label.");for(const Ee of te){if(typeof Ee!="number"&&typeof Ee!="string")return de.error("Branch labels must be numbers or strings.");if(typeof Ee=="number"&&Math.abs(Ee)>Number.MAX_SAFE_INTEGER)return de.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ee=="number"&&Math.floor(Ee)!==Ee)return de.error("Numeric branch labels must be integer values.");if(y){if(de.checkSubtype(y,Qn(Ee)))return null}else y=Qn(Ee);if(C[String(Ee)]!==void 0)return de.error("Branch labels must be unique.");C[String(Ee)]=T.length}const _e=f.parse(oe,Z,E);if(!_e)return null;E=E||_e.type,T.push(_e)}const D=f.parse(s[1],1,Rt);if(!D)return null;const z=f.parse(s[s.length-1],s.length-1,E);return z?D.type.kind!=="value"&&f.concat(1).checkSubtype(y,D.type)?null:new Wn(y,E,D,C,T,z):null}evaluate(s){const f=this.input.evaluate(s);return(Qn(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class bu{constructor(s,f,y){this.type=s,this.branches=f,this.otherwise=y}static parse(s,f){if(s.length<4)return f.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return f.error("Expected an odd number of arguments.");let y;f.expectedType&&f.expectedType.kind!=="value"&&(y=f.expectedType);const E=[];for(let T=1;T<s.length-1;T+=2){const D=f.parse(s[T],T,Nt);if(!D)return null;const z=f.parse(s[T+1],T+1,y);if(!z)return null;E.push([D,z]),y=y||z.type}const C=f.parse(s[s.length-1],s.length-1,y);if(!C)return null;if(!y)throw new Error("Can't infer output type");return new bu(y,E,C)}evaluate(s){for(const[f,y]of this.branches)if(f.evaluate(s))return y.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[f,y]of this.branches)s(f),s(y);s(this.otherwise)}outputDefined(){return this.branches.every(([s,f])=>f.outputDefined())&&this.otherwise.outputDefined()}}class Ki{constructor(s,f,y,E){this.type=s,this.input=f,this.beginIndex=y,this.endIndex=E}static parse(s,f){if(s.length<=2||s.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const y=f.parse(s[1],1,Rt),E=f.parse(s[2],2,it);if(!y||!E)return null;if(!Le(y.type,[Fn(Rt),Tt,Rt]))return f.error(`Expected first argument to be of type array or string, but found ${Lr(y.type)} instead`);if(s.length===4){const C=f.parse(s[3],3,it);return C?new Ki(y.type,y,E,C):null}return new Ki(y.type,y,E)}evaluate(s){const f=this.input.evaluate(s),y=this.beginIndex.evaluate(s);if(!ne(f,["string","array"]))throw new Xn(`Expected first argument to be of type array or string, but found ${Lr(Qn(f))} instead.`);if(this.endIndex){const E=this.endIndex.evaluate(s);return f.slice(y,E)}return f.slice(y)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function Zn(h,s){return h==="=="||h==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function pi(h,s,f,y){return y.compare(s,f)===0}function Ca(h,s,f){const y=h!=="=="&&h!=="!=";return class lM{constructor(C,T,D){this.type=Nt,this.lhs=C,this.rhs=T,this.collator=D,this.hasUntypedArgument=C.type.kind==="value"||T.type.kind==="value"}static parse(C,T){if(C.length!==3&&C.length!==4)return T.error("Expected two or three arguments.");const D=C[0];let z=T.parse(C[1],1,Rt);if(!z)return null;if(!Zn(D,z.type))return T.concat(1).error(`"${D}" comparisons are not supported for type '${Lr(z.type)}'.`);let Z=T.parse(C[2],2,Rt);if(!Z)return null;if(!Zn(D,Z.type))return T.concat(2).error(`"${D}" comparisons are not supported for type '${Lr(Z.type)}'.`);if(z.type.kind!==Z.type.kind&&z.type.kind!=="value"&&Z.type.kind!=="value")return T.error(`Cannot compare types '${Lr(z.type)}' and '${Lr(Z.type)}'.`);y&&(z.type.kind==="value"&&Z.type.kind!=="value"?z=new Ui(Z.type,[z]):z.type.kind!=="value"&&Z.type.kind==="value"&&(Z=new Ui(z.type,[Z])));let te=null;if(C.length===4){if(z.type.kind!=="string"&&Z.type.kind!=="string"&&z.type.kind!=="value"&&Z.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(te=T.parse(C[3],3,sn),!te)return null}return new lM(z,Z,te)}evaluate(C){const T=this.lhs.evaluate(C),D=this.rhs.evaluate(C);if(y&&this.hasUntypedArgument){const z=Qn(T),Z=Qn(D);if(z.kind!==Z.kind||z.kind!=="string"&&z.kind!=="number")throw new Xn(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${z.kind}, ${Z.kind}) instead.`)}if(this.collator&&!y&&this.hasUntypedArgument){const z=Qn(T),Z=Qn(D);if(z.kind!=="string"||Z.kind!=="string")return s(C,T,D)}return this.collator?f(C,T,D,this.collator.evaluate(C)):s(C,T,D)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const Ol=Ca("==",function(h,s,f){return s===f},pi),Fs=Ca("!=",function(h,s,f){return s!==f},function(h,s,f,y){return!pi(0,s,f,y)}),el=Ca("<",function(h,s,f){return s<f},function(h,s,f,y){return y.compare(s,f)<0}),ds=Ca(">",function(h,s,f){return s>f},function(h,s,f,y){return y.compare(s,f)>0}),di=Ca("<=",function(h,s,f){return s<=f},function(h,s,f,y){return y.compare(s,f)<=0}),Gi=Ca(">=",function(h,s,f){return s>=f},function(h,s,f,y){return y.compare(s,f)>=0});class qn{constructor(s,f,y,E,C){this.type=Tt,this.number=s,this.locale=f,this.currency=y,this.minFractionDigits=E,this.maxFractionDigits=C}static parse(s,f){if(s.length!==3)return f.error("Expected two arguments.");const y=f.parse(s[1],1,it);if(!y)return null;const E=s[2];if(typeof E!="object"||Array.isArray(E))return f.error("NumberFormat options argument must be an object.");let C=null;if(E.locale&&(C=f.parse(E.locale,1,Tt),!C))return null;let T=null;if(E.currency&&(T=f.parse(E.currency,1,Tt),!T))return null;let D=null;if(E["min-fraction-digits"]&&(D=f.parse(E["min-fraction-digits"],1,it),!D))return null;let z=null;return E["max-fraction-digits"]&&(z=f.parse(E["max-fraction-digits"],1,it),!z)?null:new qn(y,C,T,D,z)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class $a{constructor(s){this.type=un,this.sections=s}static parse(s,f){if(s.length<2)return f.error("Expected at least one argument.");const y=s[1];if(!Array.isArray(y)&&typeof y=="object")return f.error("First argument must be an image or text section.");const E=[];let C=!1;for(let T=1;T<=s.length-1;++T){const D=s[T];if(C&&typeof D=="object"&&!Array.isArray(D)){C=!1;let z=null;if(D["font-scale"]&&(z=f.parse(D["font-scale"],1,it),!z))return null;let Z=null;if(D["text-font"]&&(Z=f.parse(D["text-font"],1,Fn(Tt)),!Z))return null;let te=null;if(D["text-color"]&&(te=f.parse(D["text-color"],1,Ar),!te))return null;const oe=E[E.length-1];oe.scale=z,oe.font=Z,oe.textColor=te}else{const z=f.parse(s[T],1,Rt);if(!z)return null;const Z=z.type.kind;if(Z!=="string"&&Z!=="value"&&Z!=="null"&&Z!=="resolvedImage")return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,E.push({content:z,scale:null,font:null,textColor:null})}}return new $a(E)}evaluate(s){return new Vr(this.sections.map(f=>{const y=f.content.evaluate(s);return Qn(y)===rn?new _t("",y,null,null,null):new _t(Eo(y),null,f.scale?f.scale.evaluate(s):null,f.font?f.font.evaluate(s).join(","):null,f.textColor?f.textColor.evaluate(s):null)}))}eachChild(s){for(const f of this.sections)s(f.content),f.scale&&s(f.scale),f.font&&s(f.font),f.textColor&&s(f.textColor)}outputDefined(){return!1}}class Zo{constructor(s){this.type=rn,this.input=s}static parse(s,f){if(s.length!==2)return f.error("Expected two arguments.");const y=f.parse(s[1],1,Tt);return y?new Zo(y):f.error("No image name provided.")}evaluate(s){const f=this.input.evaluate(s),y=hi.fromString(f);return y&&s.availableImages&&(y.available=s.availableImages.indexOf(f)>-1),y}eachChild(s){s(this.input)}outputDefined(){return!1}}class Qs{constructor(s){this.type=it,this.input=s}static parse(s,f){if(s.length!==2)return f.error(`Expected 1 argument, but found ${s.length-1} instead.`);const y=f.parse(s[1],1);return y?y.type.kind!=="array"&&y.type.kind!=="string"&&y.type.kind!=="value"?f.error(`Expected argument of type string or array, but found ${Lr(y.type)} instead.`):new Qs(y):null}evaluate(s){const f=this.input.evaluate(s);if(typeof f=="string"||Array.isArray(f))return f.length;throw new Xn(`Expected value to be of type string or array, but found ${Lr(Qn(f))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const zn={"==":Ol,"!=":Fs,">":ds,"<":el,">=":Gi,"<=":di,array:Ui,at:oo,boolean:Ui,case:bu,coalesce:fa,collator:$i,format:$a,image:Zo,in:Gr,"index-of":pa,interpolate:Yr,"interpolate-hcl":Yr,"interpolate-lab":Yr,length:Qs,let:wi,literal:Xo,match:Wn,number:Ui,"number-format":qn,object:Ui,slice:Ki,step:Oa,string:Ui,"to-boolean":zo,"to-color":zo,"to-number":zo,"to-string":zo,var:Bn,within:Xr};function or(h,[s,f,y,E]){s=s.evaluate(h),f=f.evaluate(h),y=y.evaluate(h);const C=E?E.evaluate(h):1,T=Bo(s,f,y,C);if(T)throw new Xn(T);return new Ut(s/255,f/255,y/255,C,!1)}function Cl(h,s){return h in s}function eu(h,s){const f=s[h];return f===void 0?null:f}function _i(h){return{type:h}}function Ho(h){return{result:"success",value:h}}function Jo(h){return{result:"error",value:h}}function Ga(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function tl(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function rl(h){return!!h.expression&&h.expression.interpolated}function tr(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Ko(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function ei(h){return h}function xu(h,s){const f=s.type==="color",y=h.stops&&typeof h.stops[0][0]=="object",E=y||!(y||h.property!==void 0),C=h.type||(rl(s)?"exponential":"interval");if(f||s.type==="padding"){const te=f?Ut.parse:vi.parse;(h=ht({},h)).stops&&(h.stops=h.stops.map(oe=>[oe[0],te(oe[1])])),h.default=te(h.default?h.default:s.default)}if(h.colorSpace&&(T=h.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var T;let D,z,Z;if(C==="exponential")D=ks;else if(C==="interval")D=Wr;else if(C==="categorical"){D=nc,z=Object.create(null);for(const te of h.stops)z[te[0]]=te[1];Z=typeof h.stops[0][0]}else{if(C!=="identity")throw new Error(`Unknown function type "${C}"`);D=Un}if(y){const te={},oe=[];for(let Ee=0;Ee<h.stops.length;Ee++){const Re=h.stops[Ee],ze=Re[0].zoom;te[ze]===void 0&&(te[ze]={zoom:ze,type:h.type,property:h.property,default:h.default,stops:[]},oe.push(ze)),te[ze].stops.push([Re[0].value,Re[1]])}const de=[];for(const Ee of oe)de.push([te[Ee].zoom,xu(te[Ee],s)]);const _e={name:"linear"};return{kind:"composite",interpolationType:_e,interpolationFactor:Yr.interpolationFactor.bind(void 0,_e),zoomStops:de.map(Ee=>Ee[0]),evaluate:({zoom:Ee},Re)=>ks({stops:de,base:h.base},s,Ee).evaluate(Ee,Re)}}if(E){const te=C==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:te,interpolationFactor:Yr.interpolationFactor.bind(void 0,te),zoomStops:h.stops.map(oe=>oe[0]),evaluate:({zoom:oe})=>D(h,s,oe,z,Z)}}return{kind:"source",evaluate(te,oe){const de=oe&&oe.properties?oe.properties[h.property]:void 0;return de===void 0?Ei(h.default,s.default):D(h,s,de,z,Z)}}}function Ei(h,s,f){return h!==void 0?h:s!==void 0?s:f!==void 0?f:void 0}function nc(h,s,f,y,E){return Ei(typeof f===E?y[f]:void 0,h.default,s.default)}function Wr(h,s,f){if(tr(f)!=="number")return Ei(h.default,s.default);const y=h.stops.length;if(y===1||f<=h.stops[0][0])return h.stops[0][1];if(f>=h.stops[y-1][0])return h.stops[y-1][1];const E=Zr(h.stops.map(C=>C[0]),f);return h.stops[E][1]}function ks(h,s,f){const y=h.base!==void 0?h.base:1;if(tr(f)!=="number")return Ei(h.default,s.default);const E=h.stops.length;if(E===1||f<=h.stops[0][0])return h.stops[0][1];if(f>=h.stops[E-1][0])return h.stops[E-1][1];const C=Zr(h.stops.map(te=>te[0]),f),T=function(te,oe,de,_e){const Ee=_e-de,Re=te-de;return Ee===0?0:oe===1?Re/Ee:(Math.pow(oe,Re)-1)/(Math.pow(oe,Ee)-1)}(f,y,h.stops[C][0],h.stops[C+1][0]),D=h.stops[C][1],z=h.stops[C+1][1],Z=Ti[s.type]||ei;return typeof D.evaluate=="function"?{evaluate(...te){const oe=D.evaluate.apply(void 0,te),de=z.evaluate.apply(void 0,te);if(oe!==void 0&&de!==void 0)return Z(oe,de,T,h.colorSpace)}}:Z(D,z,T,h.colorSpace)}function Un(h,s,f){switch(s.type){case"color":f=Ut.parse(f);break;case"formatted":f=Vr.fromString(f.toString());break;case"resolvedImage":f=hi.fromString(f.toString());break;case"padding":f=vi.parse(f);break;default:tr(f)===s.type||s.type==="enum"&&s.values[f]||(f=void 0)}return Ei(f,h.default,s.default)}So.register(zn,{error:[{kind:"error"},[Tt],(h,[s])=>{throw new Xn(s.evaluate(h))}],typeof:[Tt,[Rt],(h,[s])=>Lr(Qn(s.evaluate(h)))],"to-rgba":[Fn(it,4),[Ar],(h,[s])=>{const[f,y,E,C]=s.evaluate(h).rgb;return[255*f,255*y,255*E,C]}],rgb:[Ar,[it,it,it],or],rgba:[Ar,[it,it,it,it],or],has:{type:Nt,overloads:[[[Tt],(h,[s])=>Cl(s.evaluate(h),h.properties())],[[Tt,Ir],(h,[s,f])=>Cl(s.evaluate(h),f.evaluate(h))]]},get:{type:Rt,overloads:[[[Tt],(h,[s])=>eu(s.evaluate(h),h.properties())],[[Tt,Ir],(h,[s,f])=>eu(s.evaluate(h),f.evaluate(h))]]},"feature-state":[Rt,[Tt],(h,[s])=>eu(s.evaluate(h),h.featureState||{})],properties:[Ir,[],h=>h.properties()],"geometry-type":[Tt,[],h=>h.geometryType()],id:[Rt,[],h=>h.id()],zoom:[it,[],h=>h.globals.zoom],"heatmap-density":[it,[],h=>h.globals.heatmapDensity||0],"line-progress":[it,[],h=>h.globals.lineProgress||0],accumulated:[Rt,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[it,_i(it),(h,s)=>{let f=0;for(const y of s)f+=y.evaluate(h);return f}],"*":[it,_i(it),(h,s)=>{let f=1;for(const y of s)f*=y.evaluate(h);return f}],"-":{type:it,overloads:[[[it,it],(h,[s,f])=>s.evaluate(h)-f.evaluate(h)],[[it],(h,[s])=>-s.evaluate(h)]]},"/":[it,[it,it],(h,[s,f])=>s.evaluate(h)/f.evaluate(h)],"%":[it,[it,it],(h,[s,f])=>s.evaluate(h)%f.evaluate(h)],ln2:[it,[],()=>Math.LN2],pi:[it,[],()=>Math.PI],e:[it,[],()=>Math.E],"^":[it,[it,it],(h,[s,f])=>Math.pow(s.evaluate(h),f.evaluate(h))],sqrt:[it,[it],(h,[s])=>Math.sqrt(s.evaluate(h))],log10:[it,[it],(h,[s])=>Math.log(s.evaluate(h))/Math.LN10],ln:[it,[it],(h,[s])=>Math.log(s.evaluate(h))],log2:[it,[it],(h,[s])=>Math.log(s.evaluate(h))/Math.LN2],sin:[it,[it],(h,[s])=>Math.sin(s.evaluate(h))],cos:[it,[it],(h,[s])=>Math.cos(s.evaluate(h))],tan:[it,[it],(h,[s])=>Math.tan(s.evaluate(h))],asin:[it,[it],(h,[s])=>Math.asin(s.evaluate(h))],acos:[it,[it],(h,[s])=>Math.acos(s.evaluate(h))],atan:[it,[it],(h,[s])=>Math.atan(s.evaluate(h))],min:[it,_i(it),(h,s)=>Math.min(...s.map(f=>f.evaluate(h)))],max:[it,_i(it),(h,s)=>Math.max(...s.map(f=>f.evaluate(h)))],abs:[it,[it],(h,[s])=>Math.abs(s.evaluate(h))],round:[it,[it],(h,[s])=>{const f=s.evaluate(h);return f<0?-Math.round(-f):Math.round(f)}],floor:[it,[it],(h,[s])=>Math.floor(s.evaluate(h))],ceil:[it,[it],(h,[s])=>Math.ceil(s.evaluate(h))],"filter-==":[Nt,[Tt,Rt],(h,[s,f])=>h.properties()[s.value]===f.value],"filter-id-==":[Nt,[Rt],(h,[s])=>h.id()===s.value],"filter-type-==":[Nt,[Tt],(h,[s])=>h.geometryType()===s.value],"filter-<":[Nt,[Tt,Rt],(h,[s,f])=>{const y=h.properties()[s.value],E=f.value;return typeof y==typeof E&&y<E}],"filter-id-<":[Nt,[Rt],(h,[s])=>{const f=h.id(),y=s.value;return typeof f==typeof y&&f<y}],"filter->":[Nt,[Tt,Rt],(h,[s,f])=>{const y=h.properties()[s.value],E=f.value;return typeof y==typeof E&&y>E}],"filter-id->":[Nt,[Rt],(h,[s])=>{const f=h.id(),y=s.value;return typeof f==typeof y&&f>y}],"filter-<=":[Nt,[Tt,Rt],(h,[s,f])=>{const y=h.properties()[s.value],E=f.value;return typeof y==typeof E&&y<=E}],"filter-id-<=":[Nt,[Rt],(h,[s])=>{const f=h.id(),y=s.value;return typeof f==typeof y&&f<=y}],"filter->=":[Nt,[Tt,Rt],(h,[s,f])=>{const y=h.properties()[s.value],E=f.value;return typeof y==typeof E&&y>=E}],"filter-id->=":[Nt,[Rt],(h,[s])=>{const f=h.id(),y=s.value;return typeof f==typeof y&&f>=y}],"filter-has":[Nt,[Rt],(h,[s])=>s.value in h.properties()],"filter-has-id":[Nt,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[Nt,[Fn(Tt)],(h,[s])=>s.value.indexOf(h.geometryType())>=0],"filter-id-in":[Nt,[Fn(Rt)],(h,[s])=>s.value.indexOf(h.id())>=0],"filter-in-small":[Nt,[Tt,Fn(Rt)],(h,[s,f])=>f.value.indexOf(h.properties()[s.value])>=0],"filter-in-large":[Nt,[Tt,Fn(Rt)],(h,[s,f])=>function(y,E,C,T){for(;C<=T;){const D=C+T>>1;if(E[D]===y)return!0;E[D]>y?T=D-1:C=D+1}return!1}(h.properties()[s.value],f.value,0,f.value.length-1)],all:{type:Nt,overloads:[[[Nt,Nt],(h,[s,f])=>s.evaluate(h)&&f.evaluate(h)],[_i(Nt),(h,s)=>{for(const f of s)if(!f.evaluate(h))return!1;return!0}]]},any:{type:Nt,overloads:[[[Nt,Nt],(h,[s,f])=>s.evaluate(h)||f.evaluate(h)],[_i(Nt),(h,s)=>{for(const f of s)if(f.evaluate(h))return!0;return!1}]]},"!":[Nt,[Nt],(h,[s])=>!s.evaluate(h)],"is-supported-script":[Nt,[Tt],(h,[s])=>{const f=h.globals&&h.globals.isSupportedScript;return!f||f(s.evaluate(h))}],upcase:[Tt,[Tt],(h,[s])=>s.evaluate(h).toUpperCase()],downcase:[Tt,[Tt],(h,[s])=>s.evaluate(h).toLowerCase()],concat:[Tt,_i(Rt),(h,s)=>s.map(f=>Eo(f.evaluate(h))).join("")],"resolved-locale":[Tt,[sn],(h,[s])=>s.evaluate(h).resolvedLocale()]});class Hn{constructor(s,f){var y;this.expression=s,this._warningHistory={},this._evaluator=new er,this._defaultValue=f?(y=f).type==="color"&&Ko(y.default)?new Ut(0,0,0,0):y.type==="color"?Ut.parse(y.default)||null:y.type==="padding"?vi.parse(y.default)||null:y.type==="variableAnchorOffsetCollection"?ci.parse(y.default)||null:y.default===void 0?null:y.default:null,this._enumValues=f&&f.type==="enum"?f.values:null}evaluateWithoutErrorHandling(s,f,y,E,C,T){return this._evaluator.globals=s,this._evaluator.feature=f,this._evaluator.featureState=y,this._evaluator.canonical=E,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(s,f,y,E,C,T){this._evaluator.globals=s,this._evaluator.feature=f||null,this._evaluator.featureState=y||null,this._evaluator.canonical=E,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Xn(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"),this._defaultValue}}}function Li(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in zn}function Br(h,s){const f=new Rs(zn,Ks,[],s?function(E){const C={color:Ar,string:Tt,number:it,enum:Tt,boolean:Nt,formatted:un,padding:Gn,resolvedImage:rn,variableAnchorOffsetCollection:qr};return E.type==="array"?Fn(C[E.value]||Rt,E.length):C[E.type]}(s):void 0),y=f.parse(h,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?Ho(new Hn(y,s)):Jo(f.errors)}class wu{constructor(s,f){this.kind=s,this._styleExpression=f,this.isStateDependent=s!=="constant"&&!Ua(f.expression)}evaluateWithoutErrorHandling(s,f,y,E,C,T){return this._styleExpression.evaluateWithoutErrorHandling(s,f,y,E,C,T)}evaluate(s,f,y,E,C,T){return this._styleExpression.evaluate(s,f,y,E,C,T)}}class ln{constructor(s,f,y,E){this.kind=s,this.zoomStops=y,this._styleExpression=f,this.isStateDependent=s!=="camera"&&!Ua(f.expression),this.interpolationType=E}evaluateWithoutErrorHandling(s,f,y,E,C,T){return this._styleExpression.evaluateWithoutErrorHandling(s,f,y,E,C,T)}evaluate(s,f,y,E,C,T){return this._styleExpression.evaluate(s,f,y,E,C,T)}interpolationFactor(s,f,y){return this.interpolationType?Yr.interpolationFactor(this.interpolationType,s,f,y):0}}function dr(h,s){const f=Br(h,s);if(f.result==="error")return f;const y=f.value.expression,E=Ci(y);if(!E&&!Ga(s))return Jo([new Qe("","data expressions not supported")]);const C=Ji(y,["zoom"]);if(!C&&!tl(s))return Jo([new Qe("","zoom expressions not supported")]);const T=qa(y);return T||C?T instanceof Qe?Jo([T]):T instanceof Yr&&!rl(s)?Jo([new Qe("",'"interpolate" expressions cannot be used with this property')]):Ho(T?new ln(E?"camera":"composite",f.value,T.labels,T instanceof Yr?T.interpolation:void 0):new wu(E?"constant":"source",f.value)):Jo([new Qe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ri{constructor(s,f){this._parameters=s,this._specification=f,ht(this,xu(this._parameters,this._specification))}static deserialize(s){return new Ri(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function qa(h){let s=null;if(h instanceof wi)s=qa(h.result);else if(h instanceof fa){for(const f of h.args)if(s=qa(f),s)break}else(h instanceof Oa||h instanceof Yr)&&h.input instanceof So&&h.input.name==="zoom"&&(s=h);return s instanceof Qe||h.eachChild(f=>{const y=qa(f);y instanceof Qe?s=y:!s&&y?s=new Qe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&y&&s!==y&&(s=new Qe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function Qo(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const s of h.slice(1))if(!Qo(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const Po={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Si(h){if(h==null)return{filter:()=>!0,needGeometry:!1};Qo(h)||(h=ea(h));const s=Br(h,Po);if(s.result==="error")throw new Error(s.value.map(f=>`${f.key}: ${f.message}`).join(", "));return{filter:(f,y,E)=>s.value.evaluate(f,y,{},E),needGeometry:nl(h)}}function Nc(h,s){return h<s?-1:h>s?1:0}function nl(h){if(!Array.isArray(h))return!1;if(h[0]==="within")return!0;for(let s=1;s<h.length;s++)if(nl(h[s]))return!0;return!1}function ea(h){if(!h)return!0;const s=h[0];return h.length<=1?s!=="any":s==="=="?vo(h[1],h[2],"=="):s==="!="?Or(vo(h[1],h[2],"==")):s==="<"||s===">"||s==="<="||s===">="?vo(h[1],h[2],s):s==="any"?(f=h.slice(1),["any"].concat(f.map(ea))):s==="all"?["all"].concat(h.slice(1).map(ea)):s==="none"?["all"].concat(h.slice(1).map(ea).map(Or)):s==="in"?Va(h[1],h.slice(2)):s==="!in"?Or(Va(h[1],h.slice(2))):s==="has"?Qi(h[1]):s==="!has"?Or(Qi(h[1])):s!=="within"||h;var f}function vo(h,s,f){switch(h){case"$type":return[`filter-type-${f}`,s];case"$id":return[`filter-id-${f}`,s];default:return[`filter-${f}`,h,s]}}function Va(h,s){if(s.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(f=>typeof f!=typeof s[0])?["filter-in-large",h,["literal",s.sort(Nc)]]:["filter-in-small",h,["literal",s]]}}function Qi(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Or(h){return["!",h]}function Ao(h){const s=typeof h;if(s==="number"||s==="boolean"||s==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let E="[";for(const C of h)E+=`${Ao(C)},`;return`${E}]`}const f=Object.keys(h).sort();let y="{";for(let E=0;E<f.length;E++)y+=`${JSON.stringify(f[E])}:${Ao(h[f[E]])},`;return`${y}}`}function Ta(h){let s="";for(const f of Zt)s+=`/${Ao(h[f])}`;return s}function da(h){const s=h.value;return s?[new $e(h.key,s,"constants have been deprecated as of v8")]:[]}function Hr(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Eu(h){if(Array.isArray(h))return h.map(Eu);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const s={};for(const f in h)s[f]=Eu(h[f]);return s}return Hr(h)}function ta(h){const s=h.key,f=h.value,y=h.valueSpec||{},E=h.objectElementValidators||{},C=h.style,T=h.styleSpec,D=h.validateSpec;let z=[];const Z=tr(f);if(Z!=="object")return[new $e(s,f,`object expected, ${Z} found`)];for(const te in f){const oe=te.split(".")[0],de=y[oe]||y["*"];let _e;if(E[oe])_e=E[oe];else if(y[oe])_e=D;else if(E["*"])_e=E["*"];else{if(!y["*"]){z.push(new $e(s,f[te],`unknown property "${te}"`));continue}_e=D}z=z.concat(_e({key:(s&&`${s}.`)+te,value:f[te],valueSpec:de,style:C,styleSpec:T,object:f,objectKey:te,validateSpec:D},f))}for(const te in y)E[te]||y[te].required&&y[te].default===void 0&&f[te]===void 0&&z.push(new $e(s,f,`missing required property "${te}"`));return z}function eo(h){const s=h.value,f=h.valueSpec,y=h.style,E=h.styleSpec,C=h.key,T=h.arrayElementValidator||h.validateSpec;if(tr(s)!=="array")return[new $e(C,s,`array expected, ${tr(s)} found`)];if(f.length&&s.length!==f.length)return[new $e(C,s,`array length ${f.length} expected, length ${s.length} found`)];if(f["min-length"]&&s.length<f["min-length"])return[new $e(C,s,`array length at least ${f["min-length"]} expected, length ${s.length} found`)];let D={type:f.value,values:f.values};E.$version<7&&(D.function=f.function),tr(f.value)==="object"&&(D=f.value);let z=[];for(let Z=0;Z<s.length;Z++)z=z.concat(T({array:s,arrayIndex:Z,value:s[Z],valueSpec:D,validateSpec:h.validateSpec,style:y,styleSpec:E,key:`${C}[${Z}]`}));return z}function Xa(h){const s=h.key,f=h.value,y=h.valueSpec;let E=tr(f);return E==="number"&&f!=f&&(E="NaN"),E!=="number"?[new $e(s,f,`number expected, ${E} found`)]:"minimum"in y&&f<y.minimum?[new $e(s,f,`${f} is less than the minimum value ${y.minimum}`)]:"maximum"in y&&f>y.maximum?[new $e(s,f,`${f} is greater than the maximum value ${y.maximum}`)]:[]}function ga(h){const s=h.valueSpec,f=Hr(h.value.type);let y,E,C,T={};const D=f!=="categorical"&&h.value.property===void 0,z=!D,Z=tr(h.value.stops)==="array"&&tr(h.value.stops[0])==="array"&&tr(h.value.stops[0][0])==="object",te=ta({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(_e){if(f==="identity")return[new $e(_e.key,_e.value,'identity function may not have a "stops" property')];let Ee=[];const Re=_e.value;return Ee=Ee.concat(eo({key:_e.key,value:Re,valueSpec:_e.valueSpec,validateSpec:_e.validateSpec,style:_e.style,styleSpec:_e.styleSpec,arrayElementValidator:oe})),tr(Re)==="array"&&Re.length===0&&Ee.push(new $e(_e.key,Re,"array must have at least one stop")),Ee},default:function(_e){return _e.validateSpec({key:_e.key,value:_e.value,valueSpec:s,validateSpec:_e.validateSpec,style:_e.style,styleSpec:_e.styleSpec})}}});return f==="identity"&&D&&te.push(new $e(h.key,h.value,'missing required property "property"')),f==="identity"||h.value.stops||te.push(new $e(h.key,h.value,'missing required property "stops"')),f==="exponential"&&h.valueSpec.expression&&!rl(h.valueSpec)&&te.push(new $e(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(z&&!Ga(h.valueSpec)?te.push(new $e(h.key,h.value,"property functions not supported")):D&&!tl(h.valueSpec)&&te.push(new $e(h.key,h.value,"zoom functions not supported"))),f!=="categorical"&&!Z||h.value.property!==void 0||te.push(new $e(h.key,h.value,'"property" property is required')),te;function oe(_e){let Ee=[];const Re=_e.value,ze=_e.key;if(tr(Re)!=="array")return[new $e(ze,Re,`array expected, ${tr(Re)} found`)];if(Re.length!==2)return[new $e(ze,Re,`array length 2 expected, length ${Re.length} found`)];if(Z){if(tr(Re[0])!=="object")return[new $e(ze,Re,`object expected, ${tr(Re[0])} found`)];if(Re[0].zoom===void 0)return[new $e(ze,Re,"object stop key must have zoom")];if(Re[0].value===void 0)return[new $e(ze,Re,"object stop key must have value")];if(C&&C>Hr(Re[0].zoom))return[new $e(ze,Re[0].zoom,"stop zoom values must appear in ascending order")];Hr(Re[0].zoom)!==C&&(C=Hr(Re[0].zoom),E=void 0,T={}),Ee=Ee.concat(ta({key:`${ze}[0]`,value:Re[0],valueSpec:{zoom:{}},validateSpec:_e.validateSpec,style:_e.style,styleSpec:_e.styleSpec,objectElementValidators:{zoom:Xa,value:de}}))}else Ee=Ee.concat(de({key:`${ze}[0]`,value:Re[0],valueSpec:{},validateSpec:_e.validateSpec,style:_e.style,styleSpec:_e.styleSpec},Re));return Li(Eu(Re[1]))?Ee.concat([new $e(`${ze}[1]`,Re[1],"expressions are not allowed in function stops.")]):Ee.concat(_e.validateSpec({key:`${ze}[1]`,value:Re[1],valueSpec:s,validateSpec:_e.validateSpec,style:_e.style,styleSpec:_e.styleSpec}))}function de(_e,Ee){const Re=tr(_e.value),ze=Hr(_e.value),Ge=_e.value!==null?_e.value:Ee;if(y){if(Re!==y)return[new $e(_e.key,Ge,`${Re} stop domain type must match previous stop domain type ${y}`)]}else y=Re;if(Re!=="number"&&Re!=="string"&&Re!=="boolean")return[new $e(_e.key,Ge,"stop domain value must be a number, string, or boolean")];if(Re!=="number"&&f!=="categorical"){let nt=`number expected, ${Re} found`;return Ga(s)&&f===void 0&&(nt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(_e.key,Ge,nt)]}return f!=="categorical"||Re!=="number"||isFinite(ze)&&Math.floor(ze)===ze?f!=="categorical"&&Re==="number"&&E!==void 0&&ze<E?[new $e(_e.key,Ge,"stop domain values must appear in ascending order")]:(E=ze,f==="categorical"&&ze in T?[new $e(_e.key,Ge,"stop domain values must be unique")]:(T[ze]=!0,[])):[new $e(_e.key,Ge,`integer expected, found ${ze}`)]}}function Bs(h){const s=(h.expressionContext==="property"?dr:Br)(Eu(h.value),h.valueSpec);if(s.result==="error")return s.value.map(y=>new $e(`${h.key}${y.key}`,h.value,y.message));const f=s.value.expression||s.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!f.outputDefined())return[new $e(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Ua(f))return[new $e(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Ua(f))return[new $e(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!Ji(f,["zoom","feature-state"]))return[new $e(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Ci(f))return[new $e(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qi(h){const s=h.key,f=h.value,y=h.valueSpec,E=[];return Array.isArray(y.values)?y.values.indexOf(Hr(f))===-1&&E.push(new $e(s,f,`expected one of [${y.values.join(", ")}], ${JSON.stringify(f)} found`)):Object.keys(y.values).indexOf(Hr(f))===-1&&E.push(new $e(s,f,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(f)} found`)),E}function Tl(h){return Qo(Eu(h.value))?Bs(ht({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):il(h)}function il(h){const s=h.value,f=h.key;if(tr(s)!=="array")return[new $e(f,s,`array expected, ${tr(s)} found`)];const y=h.styleSpec;let E,C=[];if(s.length<1)return[new $e(f,s,"filter array must have at least 1 element")];switch(C=C.concat(qi({key:`${f}[0]`,value:s[0],valueSpec:y.filter_operator,style:h.style,styleSpec:h.styleSpec})),Hr(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&Hr(s[1])==="$type"&&C.push(new $e(f,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&C.push(new $e(f,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(E=tr(s[1]),E!=="string"&&C.push(new $e(`${f}[1]`,s[1],`string expected, ${E} found`)));for(let T=2;T<s.length;T++)E=tr(s[T]),Hr(s[1])==="$type"?C=C.concat(qi({key:`${f}[${T}]`,value:s[T],valueSpec:y.geometry_type,style:h.style,styleSpec:h.styleSpec})):E!=="string"&&E!=="number"&&E!=="boolean"&&C.push(new $e(`${f}[${T}]`,s[T],`string, number, or boolean expected, ${E} found`));break;case"any":case"all":case"none":for(let T=1;T<s.length;T++)C=C.concat(il({key:`${f}[${T}]`,value:s[T],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":E=tr(s[1]),s.length!==2?C.push(new $e(f,s,`filter array for "${s[0]}" operator must have 2 elements`)):E!=="string"&&C.push(new $e(`${f}[1]`,s[1],`string expected, ${E} found`));break;case"within":E=tr(s[1]),s.length!==2?C.push(new $e(f,s,`filter array for "${s[0]}" operator must have 2 elements`)):E!=="object"&&C.push(new $e(`${f}[1]`,s[1],`object expected, ${E} found`))}return C}function tu(h,s){const f=h.key,y=h.validateSpec,E=h.style,C=h.styleSpec,T=h.value,D=h.objectKey,z=C[`${s}_${h.layerType}`];if(!z)return[];const Z=D.match(/^(.*)-transition$/);if(s==="paint"&&Z&&z[Z[1]]&&z[Z[1]].transition)return y({key:f,value:T,valueSpec:C.transition,style:E,styleSpec:C});const te=h.valueSpec||z[D];if(!te)return[new $e(f,T,`unknown property "${D}"`)];let oe;if(tr(T)==="string"&&Ga(te)&&!te.tokens&&(oe=/^{([^}]+)}$/.exec(T)))return[new $e(f,T,`"${D}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(oe[1])} }\`.`)];const de=[];return h.layerType==="symbol"&&(D==="text-field"&&E&&!E.glyphs&&de.push(new $e(f,T,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&Ko(Eu(T))&&Hr(T.type)==="identity"&&de.push(new $e(f,T,'"text-font" does not support identity functions'))),de.concat(y({key:h.key,value:T,valueSpec:te,style:E,styleSpec:C,expressionContext:"property",propertyType:s,propertyKey:D}))}function ol(h){return tu(h,"paint")}function Ml(h){return tu(h,"layout")}function zs(h){let s=[];const f=h.value,y=h.key,E=h.style,C=h.styleSpec;f.type||f.ref||s.push(new $e(y,f,'either "type" or "ref" is required'));let T=Hr(f.type);const D=Hr(f.ref);if(f.id){const z=Hr(f.id);for(let Z=0;Z<h.arrayIndex;Z++){const te=E.layers[Z];Hr(te.id)===z&&s.push(new $e(y,f.id,`duplicate layer id "${f.id}", previously used at line ${te.id.__line__}`))}}if("ref"in f){let z;["type","source","source-layer","filter","layout"].forEach(Z=>{Z in f&&s.push(new $e(y,f[Z],`"${Z}" is prohibited for ref layers`))}),E.layers.forEach(Z=>{Hr(Z.id)===D&&(z=Z)}),z?z.ref?s.push(new $e(y,f.ref,"ref cannot reference another ref layer")):T=Hr(z.type):s.push(new $e(y,f.ref,`ref layer "${D}" not found`))}else if(T!=="background")if(f.source){const z=E.sources&&E.sources[f.source],Z=z&&Hr(z.type);z?Z==="vector"&&T==="raster"?s.push(new $e(y,f.source,`layer "${f.id}" requires a raster source`)):Z==="raster"&&T!=="raster"?s.push(new $e(y,f.source,`layer "${f.id}" requires a vector source`)):Z!=="vector"||f["source-layer"]?Z==="raster-dem"&&T!=="hillshade"?s.push(new $e(y,f.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!f.paint||!f.paint["line-gradient"]||Z==="geojson"&&z.lineMetrics||s.push(new $e(y,f,`layer "${f.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new $e(y,f,`layer "${f.id}" must specify a "source-layer"`)):s.push(new $e(y,f.source,`source "${f.source}" not found`))}else s.push(new $e(y,f,'missing required property "source"'));return s=s.concat(ta({key:y,value:f,valueSpec:C.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${y}.type`,value:f.type,valueSpec:C.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:f,objectKey:"type"}),filter:Tl,layout:z=>ta({layer:f,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":Z=>Ml(ht({layerType:T},Z))}}),paint:z=>ta({layer:f,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":Z=>ol(ht({layerType:T},Z))}})}})),s}function yo(h){const s=h.value,f=h.key,y=tr(s);return y!=="string"?[new $e(f,s,`string expected, ${y} found`)]:[]}const Vi={promoteId:function({key:h,value:s}){if(tr(s)==="string")return yo({key:h,value:s});{const f=[];for(const y in s)f.push(...yo({key:`${h}.${y}`,value:s[y]}));return f}}};function js(h){const s=h.value,f=h.key,y=h.styleSpec,E=h.style,C=h.validateSpec;if(!s.type)return[new $e(f,s,'"type" is required')];const T=Hr(s.type);let D;switch(T){case"vector":case"raster":case"raster-dem":return D=ta({key:f,value:s,valueSpec:y[`source_${T.replace("-","_")}`],style:h.style,styleSpec:y,objectElementValidators:Vi,validateSpec:C}),D;case"geojson":if(D=ta({key:f,value:s,valueSpec:y.source_geojson,style:E,styleSpec:y,validateSpec:C,objectElementValidators:Vi}),s.cluster)for(const z in s.clusterProperties){const[Z,te]=s.clusterProperties[z],oe=typeof Z=="string"?[Z,["accumulated"],["get",z]]:Z;D.push(...Bs({key:`${f}.${z}.map`,value:te,validateSpec:C,expressionContext:"cluster-map"})),D.push(...Bs({key:`${f}.${z}.reduce`,value:oe,validateSpec:C,expressionContext:"cluster-reduce"}))}return D;case"video":return ta({key:f,value:s,valueSpec:y.source_video,style:E,validateSpec:C,styleSpec:y});case"image":return ta({key:f,value:s,valueSpec:y.source_image,style:E,validateSpec:C,styleSpec:y});case"canvas":return[new $e(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qi({key:`${f}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:E,validateSpec:C,styleSpec:y})}}function ao(h){const s=h.value,f=h.styleSpec,y=f.light,E=h.style;let C=[];const T=tr(s);if(s===void 0)return C;if(T!=="object")return C=C.concat([new $e("light",s,`object expected, ${T} found`)]),C;for(const D in s){const z=D.match(/^(.*)-transition$/);C=C.concat(z&&y[z[1]]&&y[z[1]].transition?h.validateSpec({key:D,value:s[D],valueSpec:f.transition,validateSpec:h.validateSpec,style:E,styleSpec:f}):y[D]?h.validateSpec({key:D,value:s[D],valueSpec:y[D],validateSpec:h.validateSpec,style:E,styleSpec:f}):[new $e(D,s[D],`unknown property "${D}"`)])}return C}function Ya(h){const s=h.value,f=h.styleSpec,y=f.terrain,E=h.style;let C=[];const T=tr(s);if(s===void 0)return C;if(T!=="object")return C=C.concat([new $e("terrain",s,`object expected, ${T} found`)]),C;for(const D in s)C=C.concat(y[D]?h.validateSpec({key:D,value:s[D],valueSpec:y[D],validateSpec:h.validateSpec,style:E,styleSpec:f}):[new $e(D,s[D],`unknown property "${D}"`)]);return C}function ru(h){let s=[];const f=h.value,y=h.key;if(Array.isArray(f)){const E=[],C=[];for(const T in f)f[T].id&&E.includes(f[T].id)&&s.push(new $e(y,f,`all the sprites' ids must be unique, but ${f[T].id} is duplicated`)),E.push(f[T].id),f[T].url&&C.includes(f[T].url)&&s.push(new $e(y,f,`all the sprites' URLs must be unique, but ${f[T].url} is duplicated`)),C.push(f[T].url),s=s.concat(ta({key:`${y}[${T}]`,value:f[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return s}return yo({key:y,value:f})}const ic={"*":()=>[],array:eo,boolean:function(h){const s=h.value,f=h.key,y=tr(s);return y!=="boolean"?[new $e(f,s,`boolean expected, ${y} found`)]:[]},number:Xa,color:function(h){const s=h.key,f=h.value,y=tr(f);return y!=="string"?[new $e(s,f,`color expected, ${y} found`)]:Ut.parse(String(f))?[]:[new $e(s,f,`color expected, "${f}" found`)]},constants:da,enum:qi,filter:Tl,function:ga,layer:zs,object:ta,source:js,light:ao,terrain:Ya,string:yo,formatted:function(h){return yo(h).length===0?[]:Bs(h)},resolvedImage:function(h){return yo(h).length===0?[]:Bs(h)},padding:function(h){const s=h.key,f=h.value;if(tr(f)==="array"){if(f.length<1||f.length>4)return[new $e(s,f,`padding requires 1 to 4 values; ${f.length} values found`)];const y={type:"number"};let E=[];for(let C=0;C<f.length;C++)E=E.concat(h.validateSpec({key:`${s}[${C}]`,value:f[C],validateSpec:h.validateSpec,valueSpec:y}));return E}return Xa({key:s,value:f,valueSpec:{}})},variableAnchorOffsetCollection:function(h){const s=h.key,f=h.value,y=tr(f),E=h.styleSpec;if(y!=="array"||f.length<1||f.length%2!=0)return[new $e(s,f,"variableAnchorOffsetCollection requires a non-empty array of even length")];let C=[];for(let T=0;T<f.length;T+=2)C=C.concat(qi({key:`${s}[${T}]`,value:f[T],valueSpec:E.layout_symbol["text-anchor"]})),C=C.concat(eo({key:`${s}[${T+1}]`,value:f[T+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:E}));return C},sprite:ru};function gs(h){const s=h.value,f=h.valueSpec,y=h.styleSpec;return h.validateSpec=gs,f.expression&&Ko(Hr(s))?ga(h):f.expression&&Li(Eu(s))?Bs(h):f.type&&ic[f.type]?ic[f.type](h):ta(ht({},h,{valueSpec:f.type?y[f.type]:f}))}function Ma(h){const s=h.value,f=h.key,y=yo(h);return y.length||(s.indexOf("{fontstack}")===-1&&y.push(new $e(f,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&y.push(new $e(f,s,'"glyphs" url must include a "{range}" token'))),y}function Di(h,s=Ye){let f=[];return f=f.concat(gs({key:"",value:h,valueSpec:s.$root,styleSpec:s,style:h,validateSpec:gs,objectElementValidators:{glyphs:Ma,"*":()=>[]}})),h.constants&&(f=f.concat(da({key:"constants",value:h.constants,style:h,styleSpec:s,validateSpec:gs}))),Io(f)}function Kr(h){return function(s){return h({...s,validateSpec:gs})}}function Io(h){return[].concat(h).sort((s,f)=>s.line-f.line)}function gi(h){return function(...s){return Io(h.apply(this,s))}}Di.source=gi(Kr(js)),Di.sprite=gi(Kr(ru)),Di.glyphs=gi(Kr(Ma)),Di.light=gi(Kr(ao)),Di.terrain=gi(Kr(Ya)),Di.layer=gi(Kr(zs)),Di.filter=gi(Kr(Tl)),Di.paintProperty=gi(Kr(ol)),Di.layoutProperty=gi(Kr(Ml));const al=Di,nu=al.light,ms=al.paintProperty,to=al.layoutProperty;function Ni(h,s){let f=!1;if(s&&s.length)for(const y of s)h.fire(new Ct(new Error(y.message))),f=!0;return f}class jo{constructor(s,f,y){const E=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const T=new Int32Array(this.arrayBuffer);s=T[0],this.d=(f=T[1])+2*(y=T[2]);for(let z=0;z<this.d*this.d;z++){const Z=T[3+z],te=T[3+z+1];E.push(Z===te?null:T.subarray(Z,te))}const D=T[3+E.length+1];this.keys=T.subarray(T[3+E.length],D),this.bboxes=T.subarray(D),this.insert=this._insertReadonly}else{this.d=f+2*y;for(let T=0;T<this.d*this.d;T++)E.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=s,this.padding=y,this.scale=f/s,this.uid=0;const C=y/f*s;this.min=-C,this.max=s+C}insert(s,f,y,E,C){this._forEachCell(f,y,E,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(E),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,f,y,E,C,T){this.cells[C].push(T)}query(s,f,y,E,C){const T=this.min,D=this.max;if(s<=T&&f<=T&&D<=y&&D<=E&&!C)return Array.prototype.slice.call(this.keys);{const z=[];return this._forEachCell(s,f,y,E,this._queryCell,z,{},C),z}}_queryCell(s,f,y,E,C,T,D,z){const Z=this.cells[C];if(Z!==null){const te=this.keys,oe=this.bboxes;for(let de=0;de<Z.length;de++){const _e=Z[de];if(D[_e]===void 0){const Ee=4*_e;(z?z(oe[Ee+0],oe[Ee+1],oe[Ee+2],oe[Ee+3]):s<=oe[Ee+2]&&f<=oe[Ee+3]&&y>=oe[Ee+0]&&E>=oe[Ee+1])?(D[_e]=!0,T.push(te[_e])):D[_e]=!1}}}}_forEachCell(s,f,y,E,C,T,D,z){const Z=this._convertToCellCoord(s),te=this._convertToCellCoord(f),oe=this._convertToCellCoord(y),de=this._convertToCellCoord(E);for(let _e=Z;_e<=oe;_e++)for(let Ee=te;Ee<=de;Ee++){const Re=this.d*Ee+_e;if((!z||z(this._convertFromCellCoord(_e),this._convertFromCellCoord(Ee),this._convertFromCellCoord(_e+1),this._convertFromCellCoord(Ee+1)))&&C.call(this,s,f,y,E,Re,T,D,z))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,f=3+this.cells.length+1+1;let y=0;for(let T=0;T<this.cells.length;T++)y+=this.cells[T].length;const E=new Int32Array(f+y+this.keys.length+this.bboxes.length);E[0]=this.extent,E[1]=this.n,E[2]=this.padding;let C=f;for(let T=0;T<s.length;T++){const D=s[T];E[3+T]=C,E.set(D,C),C+=D.length}return E[3+s.length]=C,E.set(this.keys,C),C+=this.keys.length,E[3+s.length+1]=C,E.set(this.bboxes,C),C+=this.bboxes.length,E.buffer}static serialize(s,f){const y=s.toArrayBuffer();return f&&f.push(y),{buffer:y}}static deserialize(s){return new jo(s.buffer)}}const Pi={};function Yt(h,s,f={}){if(Pi[h])throw new Error(`${h} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:h,writeable:!1}),Pi[h]={klass:s,omit:f.omit||[],shallow:f.shallow||[]}}Yt("Object",Object),Yt("TransferableGridIndex",jo),Yt("Color",Ut),Yt("Error",Error),Yt("AJAXError",ye),Yt("ResolvedImage",hi),Yt("StylePropertyFunction",Ri),Yt("StyleExpression",Hn,{omit:["_evaluator"]}),Yt("ZoomDependentExpression",ln),Yt("ZoomConstantExpression",wu),Yt("CompoundExpression",So,{omit:["_evaluate"]});for(const h in zn)zn[h]._classRegistryKey||Yt(`Expression_${h}`,zn[h]);function Wa(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function La(h,s){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob)return h;if(Wa(h)||ct(h))return s&&s.push(h),h;if(ArrayBuffer.isView(h)){const f=h;return s&&s.push(f.buffer),f}if(h instanceof ImageData)return s&&s.push(h.data.buffer),h;if(Array.isArray(h)){const f=[];for(const y of h)f.push(La(y,s));return f}if(typeof h=="object"){const f=h.constructor,y=f._classRegistryKey;if(!y)throw new Error("can't serialize object of unregistered class");if(!Pi[y])throw new Error(`${y} is not registered.`);const E=f.serialize?f.serialize(h,s):{};if(f.serialize){if(s&&E===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in h){if(!h.hasOwnProperty(C)||Pi[y].omit.indexOf(C)>=0)continue;const T=h[C];E[C]=Pi[y].shallow.indexOf(C)>=0?T:La(T,s)}h instanceof Error&&(E.message=h.message)}if(E.$name)throw new Error("$name property is reserved for worker serialization logic.");return y!=="Object"&&(E.$name=y),E}throw new Error("can't serialize object of type "+typeof h)}function Fi(h){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||Wa(h)||ct(h)||ArrayBuffer.isView(h)||h instanceof ImageData)return h;if(Array.isArray(h))return h.map(Fi);if(typeof h=="object"){const s=h.$name||"Object";if(!Pi[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:f}=Pi[s];if(!f)throw new Error(`can't deserialize unregistered class ${s}`);if(f.deserialize)return f.deserialize(h);const y=Object.create(f.prototype);for(const E of Object.keys(h)){if(E==="$name")continue;const C=h[E];y[E]=Pi[s].shallow.indexOf(E)>=0?C:Fi(C)}return y}throw new Error("can't deserialize object of type "+typeof h)}class Ll{constructor(){this.first=!0}update(s,f){const y=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=y,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=y,!0):(this.lastFloorZoom>y?(this.lastIntegerZoom=y+1,this.lastIntegerZoomTime=f):this.lastFloorZoom<y&&(this.lastIntegerZoom=y,this.lastIntegerZoomTime=f),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=y,!0))}}const It={"Latin-1 Supplement":h=>h>=128&&h<=255,Arabic:h=>h>=1536&&h<=1791,"Arabic Supplement":h=>h>=1872&&h<=1919,"Arabic Extended-A":h=>h>=2208&&h<=2303,"Hangul Jamo":h=>h>=4352&&h<=4607,"Unified Canadian Aboriginal Syllabics":h=>h>=5120&&h<=5759,Khmer:h=>h>=6016&&h<=6143,"Unified Canadian Aboriginal Syllabics Extended":h=>h>=6320&&h<=6399,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"CJK Radicals Supplement":h=>h>=11904&&h<=12031,"Kangxi Radicals":h=>h>=12032&&h<=12255,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Bopomofo:h=>h>=12544&&h<=12591,"Hangul Compatibility Jamo":h=>h>=12592&&h<=12687,Kanbun:h=>h>=12688&&h<=12703,"Bopomofo Extended":h=>h>=12704&&h<=12735,"CJK Strokes":h=>h>=12736&&h<=12783,"Katakana Phonetic Extensions":h=>h>=12784&&h<=12799,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"CJK Unified Ideographs Extension A":h=>h>=13312&&h<=19903,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Yi Syllables":h=>h>=40960&&h<=42127,"Yi Radicals":h=>h>=42128&&h<=42191,"Hangul Jamo Extended-A":h=>h>=43360&&h<=43391,"Hangul Syllables":h=>h>=44032&&h<=55215,"Hangul Jamo Extended-B":h=>h>=55216&&h<=55295,"Private Use Area":h=>h>=57344&&h<=63743,"CJK Compatibility Ideographs":h=>h>=63744&&h<=64255,"Arabic Presentation Forms-A":h=>h>=64336&&h<=65023,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Arabic Presentation Forms-B":h=>h>=65136&&h<=65279,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function sl(h){for(const s of h)if(Oo(s.charCodeAt(0)))return!0;return!1}function Ra(h){for(const s of h)if(!Xi(s.charCodeAt(0)))return!1;return!0}function Xi(h){return!(It.Arabic(h)||It["Arabic Supplement"](h)||It["Arabic Extended-A"](h)||It["Arabic Presentation Forms-A"](h)||It["Arabic Presentation Forms-B"](h))}function Oo(h){return!(h!==746&&h!==747&&(h<4352||!(It["Bopomofo Extended"](h)||It.Bopomofo(h)||It["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||It["CJK Compatibility Ideographs"](h)||It["CJK Compatibility"](h)||It["CJK Radicals Supplement"](h)||It["CJK Strokes"](h)||!(!It["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||It["CJK Unified Ideographs Extension A"](h)||It["CJK Unified Ideographs"](h)||It["Enclosed CJK Letters and Months"](h)||It["Hangul Compatibility Jamo"](h)||It["Hangul Jamo Extended-A"](h)||It["Hangul Jamo Extended-B"](h)||It["Hangul Jamo"](h)||It["Hangul Syllables"](h)||It.Hiragana(h)||It["Ideographic Description Characters"](h)||It.Kanbun(h)||It["Kangxi Radicals"](h)||It["Katakana Phonetic Extensions"](h)||It.Katakana(h)&&h!==12540||!(!It["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!It["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||It["Unified Canadian Aboriginal Syllabics"](h)||It["Unified Canadian Aboriginal Syllabics Extended"](h)||It["Vertical Forms"](h)||It["Yijing Hexagram Symbols"](h)||It["Yi Syllables"](h)||It["Yi Radicals"](h))))}function Za(h){return!(Oo(h)||function(s){return!!(It["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||It["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||It["Letterlike Symbols"](s)||It["Number Forms"](s)||It["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||It["Control Pictures"](s)&&s!==9251||It["Optical Character Recognition"](s)||It["Enclosed Alphanumerics"](s)||It["Geometric Shapes"](s)||It["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||It["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||It["CJK Symbols and Punctuation"](s)||It.Katakana(s)||It["Private Use Area"](s)||It["CJK Compatibility Forms"](s)||It["Small Form Variants"](s)||It["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(h))}function iu(h){return h>=1424&&h<=2303||It["Arabic Presentation Forms-A"](h)||It["Arabic Presentation Forms-B"](h)}function Ha(h,s){return!(!s&&iu(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||It.Khmer(h))}function Su(h){for(const s of h)if(iu(s.charCodeAt(0)))return!0;return!1}const so="deferred",ra="loading",oi="loaded";let oc=null,na="unavailable",yi=null;const vs=function(h){h&&typeof h=="string"&&h.indexOf("NetworkError")>-1&&(na="error"),oc&&oc(h)};function Rl(){ou.fire(new pt("pluginStateChange",{pluginStatus:na,pluginURL:yi}))}const ou=new mt,ys=function(){return na},ki=function(){if(na!==so||!yi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");na=ra,Rl(),yi&&He({url:yi},h=>{h?vs(h):(na=oi,Rl())})},Jn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>na===oi||Jn.applyArabicShaping!=null,isLoading:()=>na===ra,setState(h){if(!Oe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");na=h.pluginStatus,yi=h.pluginURL},isParsed(){if(!Oe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Jn.applyArabicShaping!=null&&Jn.processBidirectionalText!=null&&Jn.processStyledBidirectionalText!=null},getPluginURL(){if(!Oe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return yi}};class Kn{constructor(s,f){this.zoom=s,f?(this.now=f.now,this.fadeDuration=f.fadeDuration,this.zoomHistory=f.zoomHistory,this.transition=f.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ll,this.transition={})}isSupportedScript(s){return function(f,y){for(const E of f)if(!Ha(E.charCodeAt(0),y))return!1;return!0}(s,Jn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,f=s-Math.floor(s),y=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:f+(1-f)*y}:{fromScale:.5,toScale:1,t:1-(1-y)*f}}}class uo{constructor(s,f){this.property=s,this.value=f,this.expression=function(y,E){if(Ko(y))return new Ri(y,E);if(Li(y)){const C=dr(y,E);if(C.result==="error")throw new Error(C.value.map(T=>`${T.key}: ${T.message}`).join(", "));return C.value}{let C=y;return E.type==="color"&&typeof y=="string"?C=Ut.parse(y):E.type!=="padding"||typeof y!="number"&&!Array.isArray(y)?E.type==="variableAnchorOffsetCollection"&&Array.isArray(y)&&(C=ci.parse(y)):C=vi.parse(y),{kind:"constant",evaluate:()=>C}}}(f===void 0?s.specification.default:f,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,f,y){return this.property.possiblyEvaluate(this,s,f,y)}}class Pu{constructor(s){this.property=s,this.value=new uo(s,void 0)}transitioned(s,f){return new Ai(this.property,this.value,f,k({},s.transition,this.transition),s.now)}untransitioned(){return new Ai(this.property,this.value,null,{},0)}}class Dl{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return ie(this._values[s].value.value)}setValue(s,f){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Pu(this._values[s].property)),this._values[s].value=new uo(this._values[s].property,f===null?void 0:ie(f))}getTransition(s){return ie(this._values[s].transition)}setTransition(s,f){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Pu(this._values[s].property)),this._values[s].transition=ie(f)||void 0}serialize(){const s={};for(const f of Object.keys(this._values)){const y=this.getValue(f);y!==void 0&&(s[f]=y);const E=this.getTransition(f);E!==void 0&&(s[`${f}-transition`]=E)}return s}transitioned(s,f){const y=new Ch(this._properties);for(const E of Object.keys(this._values))y._values[E]=this._values[E].transitioned(s,f._values[E]);return y}untransitioned(){const s=new Ch(this._properties);for(const f of Object.keys(this._values))s._values[f]=this._values[f].untransitioned();return s}}class Ai{constructor(s,f,y,E,C){this.property=s,this.value=f,this.begin=C+E.delay||0,this.end=this.begin+E.duration||0,s.specification.transition&&(E.delay||E.duration)&&(this.prior=y)}possiblyEvaluate(s,f,y){const E=s.now||0,C=this.value.possiblyEvaluate(s,f,y),T=this.prior;if(T){if(E>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(E<this.begin)return T.possiblyEvaluate(s,f,y);{const D=(E-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(s,f,y),C,function(z){if(z<=0)return 0;if(z>=1)return 1;const Z=z*z,te=Z*z;return 4*(z<.5?te:3*(z-Z)+te-.75)}(D))}}return C}}class Ch{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,f,y){const E=new au(this._properties);for(const C of Object.keys(this._values))E._values[C]=this._values[C].possiblyEvaluate(s,f,y);return E}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class _s{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return this._values[s].value!==void 0}getValue(s){return ie(this._values[s].value)}setValue(s,f){this._values[s]=new uo(this._values[s].property,f===null?void 0:ie(f))}serialize(){const s={};for(const f of Object.keys(this._values)){const y=this.getValue(f);y!==void 0&&(s[f]=y)}return s}possiblyEvaluate(s,f,y){const E=new au(this._properties);for(const C of Object.keys(this._values))E._values[C]=this._values[C].possiblyEvaluate(s,f,y);return E}}class Ja{constructor(s,f,y){this.property=s,this.value=f,this.parameters=y}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,f,y,E){return this.property.evaluate(this.value,this.parameters,s,f,y,E)}}class au{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class fr{constructor(s){this.specification=s}possiblyEvaluate(s,f){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(f)}interpolate(s,f,y){const E=Ti[this.specification.type];return E?E(s,f,y):s}}class Er{constructor(s,f){this.specification=s,this.overrides=f}possiblyEvaluate(s,f,y,E){return new Ja(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(f,null,{},y,E)}:s.expression,f)}interpolate(s,f,y){if(s.value.kind!=="constant"||f.value.kind!=="constant")return s;if(s.value.value===void 0||f.value.value===void 0)return new Ja(this,{kind:"constant",value:void 0},s.parameters);const E=Ti[this.specification.type];if(E){const C=E(s.value.value,f.value.value,y);return new Ja(this,{kind:"constant",value:C},s.parameters)}return s}evaluate(s,f,y,E,C,T){return s.kind==="constant"?s.value:s.evaluate(f,y,E,C,T)}}class ma extends Er{possiblyEvaluate(s,f,y,E){if(s.value===void 0)return new Ja(this,{kind:"constant",value:void 0},f);if(s.expression.kind==="constant"){const C=s.expression.evaluate(f,null,{},y,E),T=s.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,D=this._calculate(T,T,T,f);return new Ja(this,{kind:"constant",value:D},f)}if(s.expression.kind==="camera"){const C=this._calculate(s.expression.evaluate({zoom:f.zoom-1}),s.expression.evaluate({zoom:f.zoom}),s.expression.evaluate({zoom:f.zoom+1}),f);return new Ja(this,{kind:"constant",value:C},f)}return new Ja(this,s.expression,f)}evaluate(s,f,y,E,C,T){if(s.kind==="source"){const D=s.evaluate(f,y,E,C,T);return this._calculate(D,D,D,f)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(f.zoom)-1},y,E),s.evaluate({zoom:Math.floor(f.zoom)},y,E),s.evaluate({zoom:Math.floor(f.zoom)+1},y,E),f):s.value}_calculate(s,f,y,E){return E.zoom>E.zoomHistory.lastIntegerZoom?{from:s,to:f}:{from:y,to:f}}interpolate(s){return s}}class Au{constructor(s){this.specification=s}possiblyEvaluate(s,f,y,E){if(s.value!==void 0){if(s.expression.kind==="constant"){const C=s.expression.evaluate(f,null,{},y,E);return this._calculate(C,C,C,f)}return this._calculate(s.expression.evaluate(new Kn(Math.floor(f.zoom-1),f)),s.expression.evaluate(new Kn(Math.floor(f.zoom),f)),s.expression.evaluate(new Kn(Math.floor(f.zoom+1),f)),f)}}_calculate(s,f,y,E){return E.zoom>E.zoomHistory.lastIntegerZoom?{from:s,to:f}:{from:y,to:f}}interpolate(s){return s}}class Iu{constructor(s){this.specification=s}possiblyEvaluate(s,f,y,E){return!!s.expression.evaluate(f,null,{},y,E)}interpolate(){return!1}}class Uo{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const f in s){const y=s[f];y.specification.overridable&&this.overridableProperties.push(f);const E=this.defaultPropertyValues[f]=new uo(y,void 0),C=this.defaultTransitionablePropertyValues[f]=new Pu(y);this.defaultTransitioningPropertyValues[f]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=E.possiblyEvaluate({})}}}Yt("DataDrivenProperty",Er),Yt("DataConstantProperty",fr),Yt("CrossFadedDataDrivenProperty",ma),Yt("CrossFadedProperty",Au),Yt("ColorRampProperty",Iu);const Ka="-transition";class Co extends mt{constructor(s,f){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),f.layout&&(this._unevaluatedLayout=new _s(f.layout)),f.paint)){this._transitionablePaint=new Dl(f.paint);for(const y in s.paint)this.setPaintProperty(y,s.paint[y],{validate:!1});for(const y in s.layout)this.setLayoutProperty(y,s.layout[y],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new au(f.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,f,y={}){f!=null&&this._validate(to,`layers.${this.id}.layout.${s}`,s,f,y)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,f):this.visibility=f)}getPaintProperty(s){return s.endsWith(Ka)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,f,y={}){if(f!=null&&this._validate(ms,`layers.${this.id}.paint.${s}`,s,f,y))return!1;if(s.endsWith(Ka))return this._transitionablePaint.setTransition(s.slice(0,-11),f||void 0),!1;{const E=this._transitionablePaint._values[s],C=E.property.specification["property-type"]==="cross-faded-data-driven",T=E.value.isDataDriven(),D=E.value;this._transitionablePaint.setValue(s,f),this._handleSpecialPaintPropertyUpdate(s);const z=this._transitionablePaint._values[s].value;return z.isDataDriven()||T||C||this._handleOverridablePaintPropertyUpdate(s,D,z)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,f,y){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,f){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,f)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),ue(s,(f,y)=>!(f===void 0||y==="layout"&&!Object.keys(f).length||y==="paint"&&!Object.keys(f).length))}_validate(s,f,y,E,C={}){return(!C||C.validate!==!1)&&Ni(this,s.call(al,{key:f,layerType:this.type,objectKey:y,value:E,styleSpec:Ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const f=this.paint.get(s);if(f instanceof Ja&&Ga(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1}}const Nl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Us{constructor(s,f){this._structArray=s,this._pos1=f*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $n{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,f){return s._trim(),f&&(s.isTransferred=!0,f.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const f=Object.create(this.prototype);return f.arrayBuffer=s.arrayBuffer,f.length=s.length,f.capacity=s.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const f=this.uint8;this._refreshViews(),f&&this.uint8.set(f)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Kt(h,s=1){let f=0,y=0;return{members:h.map(E=>{const C=Nl[E.type].BYTES_PER_ELEMENT,T=f=$s(f,Math.max(s,C)),D=E.components||1;return y=Math.max(y,C),f+=C*D,{name:E.name,type:E.type,components:D,offset:T}}),size:$s(f,Math.max(y,s)),alignment:s}}function $s(h,s){return Math.ceil(h/s)*s}class To extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,f){const y=this.length;return this.resize(y+1),this.emplace(y,s,f)}emplace(s,f,y){const E=2*s;return this.int16[E+0]=f,this.int16[E+1]=y,s}}To.prototype.bytesPerElement=4,Yt("StructArrayLayout2i4",To);class Qa extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,f,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,f,y)}emplace(s,f,y,E){const C=3*s;return this.int16[C+0]=f,this.int16[C+1]=y,this.int16[C+2]=E,s}}Qa.prototype.bytesPerElement=6,Yt("StructArrayLayout3i6",Qa);class lo extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,f,y,E){const C=this.length;return this.resize(C+1),this.emplace(C,s,f,y,E)}emplace(s,f,y,E,C){const T=4*s;return this.int16[T+0]=f,this.int16[T+1]=y,this.int16[T+2]=E,this.int16[T+3]=C,s}}lo.prototype.bytesPerElement=8,Yt("StructArrayLayout4i8",lo);class Fl extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T){const D=this.length;return this.resize(D+1),this.emplace(D,s,f,y,E,C,T)}emplace(s,f,y,E,C,T,D){const z=6*s;return this.int16[z+0]=f,this.int16[z+1]=y,this.int16[z+2]=E,this.int16[z+3]=C,this.int16[z+4]=T,this.int16[z+5]=D,s}}Fl.prototype.bytesPerElement=12,Yt("StructArrayLayout2i4i12",Fl);class co extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T){const D=this.length;return this.resize(D+1),this.emplace(D,s,f,y,E,C,T)}emplace(s,f,y,E,C,T,D){const z=4*s,Z=8*s;return this.int16[z+0]=f,this.int16[z+1]=y,this.uint8[Z+4]=E,this.uint8[Z+5]=C,this.uint8[Z+6]=T,this.uint8[Z+7]=D,s}}co.prototype.bytesPerElement=8,Yt("StructArrayLayout2i4ub8",co);class ti extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,f){const y=this.length;return this.resize(y+1),this.emplace(y,s,f)}emplace(s,f,y){const E=2*s;return this.float32[E+0]=f,this.float32[E+1]=y,s}}ti.prototype.bytesPerElement=8,Yt("StructArrayLayout2f8",ti);class Fu extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T,D,z,Z,te){const oe=this.length;return this.resize(oe+1),this.emplace(oe,s,f,y,E,C,T,D,z,Z,te)}emplace(s,f,y,E,C,T,D,z,Z,te,oe){const de=10*s;return this.uint16[de+0]=f,this.uint16[de+1]=y,this.uint16[de+2]=E,this.uint16[de+3]=C,this.uint16[de+4]=T,this.uint16[de+5]=D,this.uint16[de+6]=z,this.uint16[de+7]=Z,this.uint16[de+8]=te,this.uint16[de+9]=oe,s}}Fu.prototype.bytesPerElement=20,Yt("StructArrayLayout10ui20",Fu);class bs extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T,D,z,Z,te,oe,de){const _e=this.length;return this.resize(_e+1),this.emplace(_e,s,f,y,E,C,T,D,z,Z,te,oe,de)}emplace(s,f,y,E,C,T,D,z,Z,te,oe,de,_e){const Ee=12*s;return this.int16[Ee+0]=f,this.int16[Ee+1]=y,this.int16[Ee+2]=E,this.int16[Ee+3]=C,this.uint16[Ee+4]=T,this.uint16[Ee+5]=D,this.uint16[Ee+6]=z,this.uint16[Ee+7]=Z,this.int16[Ee+8]=te,this.int16[Ee+9]=oe,this.int16[Ee+10]=de,this.int16[Ee+11]=_e,s}}bs.prototype.bytesPerElement=24,Yt("StructArrayLayout4i4ui4i24",bs);class o extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,f,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,f,y)}emplace(s,f,y,E){const C=3*s;return this.float32[C+0]=f,this.float32[C+1]=y,this.float32[C+2]=E,s}}o.prototype.bytesPerElement=12,Yt("StructArrayLayout3f12",o);class c extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const f=this.length;return this.resize(f+1),this.emplace(f,s)}emplace(s,f){return this.uint32[1*s+0]=f,s}}c.prototype.bytesPerElement=4,Yt("StructArrayLayout1ul4",c);class g extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T,D,z,Z){const te=this.length;return this.resize(te+1),this.emplace(te,s,f,y,E,C,T,D,z,Z)}emplace(s,f,y,E,C,T,D,z,Z,te){const oe=10*s,de=5*s;return this.int16[oe+0]=f,this.int16[oe+1]=y,this.int16[oe+2]=E,this.int16[oe+3]=C,this.int16[oe+4]=T,this.int16[oe+5]=D,this.uint32[de+3]=z,this.uint16[oe+8]=Z,this.uint16[oe+9]=te,s}}g.prototype.bytesPerElement=20,Yt("StructArrayLayout6i1ul2ui20",g);class v extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T){const D=this.length;return this.resize(D+1),this.emplace(D,s,f,y,E,C,T)}emplace(s,f,y,E,C,T,D){const z=6*s;return this.int16[z+0]=f,this.int16[z+1]=y,this.int16[z+2]=E,this.int16[z+3]=C,this.int16[z+4]=T,this.int16[z+5]=D,s}}v.prototype.bytesPerElement=12,Yt("StructArrayLayout2i2i2i12",v);class A extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C){const T=this.length;return this.resize(T+1),this.emplace(T,s,f,y,E,C)}emplace(s,f,y,E,C,T){const D=4*s,z=8*s;return this.float32[D+0]=f,this.float32[D+1]=y,this.float32[D+2]=E,this.int16[z+6]=C,this.int16[z+7]=T,s}}A.prototype.bytesPerElement=16,Yt("StructArrayLayout2f1f2i16",A);class N extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,f,y,E){const C=this.length;return this.resize(C+1),this.emplace(C,s,f,y,E)}emplace(s,f,y,E,C){const T=12*s,D=3*s;return this.uint8[T+0]=f,this.uint8[T+1]=y,this.float32[D+1]=E,this.float32[D+2]=C,s}}N.prototype.bytesPerElement=12,Yt("StructArrayLayout2ub2f12",N);class G extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,f,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,f,y)}emplace(s,f,y,E){const C=3*s;return this.uint16[C+0]=f,this.uint16[C+1]=y,this.uint16[C+2]=E,s}}G.prototype.bytesPerElement=6,Yt("StructArrayLayout3ui6",G);class le extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re,ze,Ge){const nt=this.length;return this.resize(nt+1),this.emplace(nt,s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re,ze,Ge)}emplace(s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re,ze,Ge,nt){const Ze=24*s,ot=12*s,st=48*s;return this.int16[Ze+0]=f,this.int16[Ze+1]=y,this.uint16[Ze+2]=E,this.uint16[Ze+3]=C,this.uint32[ot+2]=T,this.uint32[ot+3]=D,this.uint32[ot+4]=z,this.uint16[Ze+10]=Z,this.uint16[Ze+11]=te,this.uint16[Ze+12]=oe,this.float32[ot+7]=de,this.float32[ot+8]=_e,this.uint8[st+36]=Ee,this.uint8[st+37]=Re,this.uint8[st+38]=ze,this.uint32[ot+10]=Ge,this.int16[Ze+22]=nt,s}}le.prototype.bytesPerElement=48,Yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",le);class xe extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re,ze,Ge,nt,Ze,ot,st,xt,qt,cr,Gt,Bt,Dt,Jt){const Ft=this.length;return this.resize(Ft+1),this.emplace(Ft,s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re,ze,Ge,nt,Ze,ot,st,xt,qt,cr,Gt,Bt,Dt,Jt)}emplace(s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re,ze,Ge,nt,Ze,ot,st,xt,qt,cr,Gt,Bt,Dt,Jt,Ft){const At=32*s,br=16*s;return this.int16[At+0]=f,this.int16[At+1]=y,this.int16[At+2]=E,this.int16[At+3]=C,this.int16[At+4]=T,this.int16[At+5]=D,this.int16[At+6]=z,this.int16[At+7]=Z,this.uint16[At+8]=te,this.uint16[At+9]=oe,this.uint16[At+10]=de,this.uint16[At+11]=_e,this.uint16[At+12]=Ee,this.uint16[At+13]=Re,this.uint16[At+14]=ze,this.uint16[At+15]=Ge,this.uint16[At+16]=nt,this.uint16[At+17]=Ze,this.uint16[At+18]=ot,this.uint16[At+19]=st,this.uint16[At+20]=xt,this.uint16[At+21]=qt,this.uint16[At+22]=cr,this.uint32[br+12]=Gt,this.float32[br+13]=Bt,this.float32[br+14]=Dt,this.uint16[At+30]=Jt,this.uint16[At+31]=Ft,s}}xe.prototype.bytesPerElement=64,Yt("StructArrayLayout8i15ui1ul2f2ui64",xe);class x extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const f=this.length;return this.resize(f+1),this.emplace(f,s)}emplace(s,f){return this.float32[1*s+0]=f,s}}x.prototype.bytesPerElement=4,Yt("StructArrayLayout1f4",x);class a extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,f,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,f,y)}emplace(s,f,y,E){const C=3*s;return this.uint16[6*s+0]=f,this.float32[C+1]=y,this.float32[C+2]=E,s}}a.prototype.bytesPerElement=12,Yt("StructArrayLayout1ui2f12",a);class d extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,f,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,f,y)}emplace(s,f,y,E){const C=4*s;return this.uint32[2*s+0]=f,this.uint16[C+2]=y,this.uint16[C+3]=E,s}}d.prototype.bytesPerElement=8,Yt("StructArrayLayout1ul2ui8",d);class b extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,f){const y=this.length;return this.resize(y+1),this.emplace(y,s,f)}emplace(s,f,y){const E=2*s;return this.uint16[E+0]=f,this.uint16[E+1]=y,s}}b.prototype.bytesPerElement=4,Yt("StructArrayLayout2ui4",b);class w extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const f=this.length;return this.resize(f+1),this.emplace(f,s)}emplace(s,f){return this.uint16[1*s+0]=f,s}}w.prototype.bytesPerElement=2,Yt("StructArrayLayout1ui2",w);class I extends $n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,f,y,E){const C=this.length;return this.resize(C+1),this.emplace(C,s,f,y,E)}emplace(s,f,y,E,C){const T=4*s;return this.float32[T+0]=f,this.float32[T+1]=y,this.float32[T+2]=E,this.float32[T+3]=C,s}}I.prototype.bytesPerElement=16,Yt("StructArrayLayout4f16",I);class L extends Us{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new P(this.anchorPointX,this.anchorPointY)}}L.prototype.size=20;class F extends g{get(s){return new L(this,s)}}Yt("CollisionBoxArray",F);class j extends Us{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}j.prototype.size=48;class Y extends le{get(s){return new j(this,s)}}Yt("PlacedSymbolArray",Y);class K extends Us{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}K.prototype.size=64;class re extends xe{get(s){return new K(this,s)}}Yt("SymbolInstanceArray",re);class me extends x{getoffsetX(s){return this.float32[1*s+0]}}Yt("GlyphOffsetArray",me);class Me extends Qa{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}Yt("SymbolLineVertexArray",Me);class Te extends Us{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Te.prototype.size=12;class Fe extends a{get(s){return new Te(this,s)}}Yt("TextAnchorOffsetArray",Fe);class Ce extends Us{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ce.prototype.size=8;class Je extends d{get(s){return new Ce(this,s)}}Yt("FeatureIndexArray",Je);class at extends To{}class je extends To{}class tt extends To{}class ut extends Fl{}class lt extends co{}class bt extends ti{}class St extends Fu{}class wt extends bs{}class Mt extends o{}class lr extends c{}class Qr extends v{}class kt extends N{}class gr extends G{}class ar extends b{}const Ii=Kt([{name:"a_pos",components:2,type:"Int16"}],4),{members:en}=Ii;class _r{constructor(s=[]){this.segments=s}prepareSegment(s,f,y,E){let C=this.segments[this.segments.length-1];return s>_r.MAX_VERTEX_ARRAY_LENGTH&&W(`Max vertices per segment is ${_r.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!C||C.vertexLength+s>_r.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==E)&&(C={vertexOffset:f.length,primitiveOffset:y.length,vertexLength:0,primitiveLength:0},E!==void 0&&(C.sortKey=E),this.segments.push(C)),C}get(){return this.segments}destroy(){for(const s of this.segments)for(const f in s.vaos)s.vaos[f].destroy()}static simpleSegment(s,f,y,E){return new _r([{vertexOffset:s,primitiveOffset:f,vertexLength:y,primitiveLength:E,vaos:{},sortKey:0}])}}function tn(h,s){return 256*(h=X(Math.floor(h),0,255))+X(Math.floor(s),0,255)}_r.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Yt("SegmentVector",_r);const Bi=Kt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ri={exports:{}},xs={exports:{}};xs.exports=function(h,s){var f,y,E,C,T,D,z,Z;for(y=h.length-(f=3&h.length),E=s,T=3432918353,D=461845907,Z=0;Z<y;)z=255&h.charCodeAt(Z)|(255&h.charCodeAt(++Z))<<8|(255&h.charCodeAt(++Z))<<16|(255&h.charCodeAt(++Z))<<24,++Z,E=27492+(65535&(C=5*(65535&(E=(E^=z=(65535&(z=(z=(65535&z)*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*D+(((z>>>16)*D&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(z=0,f){case 3:z^=(255&h.charCodeAt(Z+2))<<16;case 2:z^=(255&h.charCodeAt(Z+1))<<8;case 1:E^=z=(65535&(z=(z=(65535&(z^=255&h.charCodeAt(Z)))*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*D+(((z>>>16)*D&65535)<<16)&4294967295}return E^=h.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0};var ia=xs.exports,ro={exports:{}};ro.exports=function(h,s){for(var f,y=h.length,E=s^y,C=0;y>=4;)f=1540483477*(65535&(f=255&h.charCodeAt(C)|(255&h.charCodeAt(++C))<<8|(255&h.charCodeAt(++C))<<16|(255&h.charCodeAt(++C))<<24))+((1540483477*(f>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),y-=4,++C;switch(y){case 3:E^=(255&h.charCodeAt(C+2))<<16;case 2:E^=(255&h.charCodeAt(C+1))<<8;case 1:E=1540483477*(65535&(E^=255&h.charCodeAt(C)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0};var es=ia,Ou=ro.exports;ri.exports=es,ri.exports.murmur3=es,ri.exports.murmur2=Ou;var su=_(ri.exports);class Cu{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,f,y,E){this.ids.push(ac(s)),this.positions.push(f,y,E)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const f=ac(s);let y=0,E=this.ids.length-1;for(;y<E;){const T=y+E>>1;this.ids[T]>=f?E=T:y=T+1}const C=[];for(;this.ids[y]===f;)C.push({index:this.positions[3*y],start:this.positions[3*y+1],end:this.positions[3*y+2]}),y++;return C}static serialize(s,f){const y=new Float64Array(s.ids),E=new Uint32Array(s.positions);return ul(y,E,0,y.length-1),f&&f.push(y.buffer,E.buffer),{ids:y,positions:E}}static deserialize(s){const f=new Cu;return f.ids=s.ids,f.positions=s.positions,f.indexed=!0,f}}function ac(h){const s=+h;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:su(String(h))}function ul(h,s,f,y){for(;f<y;){const E=h[f+y>>1];let C=f-1,T=y+1;for(;;){do C++;while(h[C]<E);do T--;while(h[T]>E);if(C>=T)break;ku(h,C,T),ku(s,3*C,3*T),ku(s,3*C+1,3*T+1),ku(s,3*C+2,3*T+2)}T-f<y-T?(ul(h,s,f,T),f=T+1):(ul(h,s,T+1,y),y=T)}}function ku(h,s,f){const y=h[s];h[s]=h[f],h[f]=y}Yt("FeaturePositionMap",Cu);class ho{constructor(s,f){this.gl=s.gl,this.location=f}}class Mo extends ho{constructor(s,f){super(s,f),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class va extends ho{constructor(s,f){super(s,f),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class sc extends ho{constructor(s,f){super(s,f),this.current=Ut.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const Lo=new Float32Array(16);function _o(h){return[tn(255*h.r,255*h.g),tn(255*h.b,255*h.a)]}class ya{constructor(s,f,y){this.value=s,this.uniformNames=f.map(E=>`u_${E}`),this.type=y}setUniform(s,f,y){s.set(y.constantOr(this.value))}getBinding(s,f,y){return this.type==="color"?new sc(s,f):new Mo(s,f)}}class zi{constructor(s,f){this.uniformNames=f.map(y=>`u_${y}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,f){this.pixelRatioFrom=f.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=f.tlbr,this.patternTo=s.tlbr}setUniform(s,f,y,E){const C=E==="u_pattern_to"?this.patternTo:E==="u_pattern_from"?this.patternFrom:E==="u_pixel_ratio_to"?this.pixelRatioTo:E==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&s.set(C)}getBinding(s,f,y){return y.substr(0,9)==="u_pattern"?new va(s,f):new Mo(s,f)}}class Bu{constructor(s,f,y,E){this.expression=s,this.type=y,this.maxValue=0,this.paintVertexAttributes=f.map(C=>({name:`a_${C}`,type:"Float32",components:y==="color"?2:1,offset:0})),this.paintVertexArray=new E}populatePaintArray(s,f,y,E,C){const T=this.paintVertexArray.length,D=this.expression.evaluate(new Kn(0),f,{},E,[],C);this.paintVertexArray.resize(s),this._setPaintValue(T,s,D)}updatePaintArray(s,f,y,E){const C=this.expression.evaluate({zoom:0},y,E);this._setPaintValue(s,f,C)}_setPaintValue(s,f,y){if(this.type==="color"){const E=_o(y);for(let C=s;C<f;C++)this.paintVertexArray.emplace(C,E[0],E[1])}else{for(let E=s;E<f;E++)this.paintVertexArray.emplace(E,y);this.maxValue=Math.max(this.maxValue,Math.abs(y))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class uu{constructor(s,f,y,E,C,T){this.expression=s,this.uniformNames=f.map(D=>`u_${D}_t`),this.type=y,this.useIntegerZoom=E,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=f.map(D=>({name:`a_${D}`,type:"Float32",components:y==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(s,f,y,E,C){const T=this.expression.evaluate(new Kn(this.zoom),f,{},E,[],C),D=this.expression.evaluate(new Kn(this.zoom+1),f,{},E,[],C),z=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(z,s,T,D)}updatePaintArray(s,f,y,E){const C=this.expression.evaluate({zoom:this.zoom},y,E),T=this.expression.evaluate({zoom:this.zoom+1},y,E);this._setPaintValue(s,f,C,T)}_setPaintValue(s,f,y,E){if(this.type==="color"){const C=_o(y),T=_o(E);for(let D=s;D<f;D++)this.paintVertexArray.emplace(D,C[0],C[1],T[0],T[1])}else{for(let C=s;C<f;C++)this.paintVertexArray.emplace(C,y,E);this.maxValue=Math.max(this.maxValue,Math.abs(y),Math.abs(E))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,f){const y=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,E=X(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);s.set(E)}getBinding(s,f,y){return new Mo(s,f)}}class ll{constructor(s,f,y,E,C,T){this.expression=s,this.type=f,this.useIntegerZoom=y,this.zoom=E,this.layerId=T,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(s,f,y){const E=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(E,s,f.patterns&&f.patterns[this.layerId],y)}updatePaintArray(s,f,y,E,C){this._setPaintValues(s,f,y.patterns&&y.patterns[this.layerId],C)}_setPaintValues(s,f,y,E){if(!E||!y)return;const{min:C,mid:T,max:D}=y,z=E[C],Z=E[T],te=E[D];if(z&&Z&&te)for(let oe=s;oe<f;oe++)this.zoomInPaintVertexArray.emplace(oe,Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],Z.pixelRatio,z.pixelRatio),this.zoomOutPaintVertexArray.emplace(oe,Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],te.tl[0],te.tl[1],te.br[0],te.br[1],Z.pixelRatio,te.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,Bi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,Bi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class xg{constructor(s,f,y){this.binders={},this._buffers=[];const E=[];for(const C in s.paint._values){if(!y(C))continue;const T=s.paint.get(C);if(!(T instanceof Ja&&Ga(T.property.specification)))continue;const D=f0(C,s.type),z=T.value,Z=T.property.specification.type,te=T.property.useIntegerZoom,oe=T.property.specification["property-type"],de=oe==="cross-faded"||oe==="cross-faded-data-driven";if(z.kind==="constant")this.binders[C]=de?new zi(z.value,D):new ya(z.value,D,Z),E.push(`/u_${C}`);else if(z.kind==="source"||de){const _e=Bl(C,Z,"source");this.binders[C]=de?new ll(z,Z,te,f,_e,s.id):new Bu(z,D,Z,_e),E.push(`/a_${C}`)}else{const _e=Bl(C,Z,"composite");this.binders[C]=new uu(z,D,Z,te,f,_e),E.push(`/z_${C}`)}}this.cacheKey=E.sort().join("")}getMaxValue(s){const f=this.binders[s];return f instanceof Bu||f instanceof uu?f.maxValue:0}populatePaintArrays(s,f,y,E,C){for(const T in this.binders){const D=this.binders[T];(D instanceof Bu||D instanceof uu||D instanceof ll)&&D.populatePaintArray(s,f,y,E,C)}}setConstantPatternPositions(s,f){for(const y in this.binders){const E=this.binders[y];E instanceof zi&&E.setConstantPatternPositions(s,f)}}updatePaintArrays(s,f,y,E,C){let T=!1;for(const D in s){const z=f.getPositions(D);for(const Z of z){const te=y.feature(Z.index);for(const oe in this.binders){const de=this.binders[oe];if((de instanceof Bu||de instanceof uu||de instanceof ll)&&de.expression.isStateDependent===!0){const _e=E.paint.get(oe);de.expression=_e.value,de.updatePaintArray(Z.start,Z.end,te,s[D],C),T=!0}}}}return T}defines(){const s=[];for(const f in this.binders){const y=this.binders[f];(y instanceof ya||y instanceof zi)&&s.push(...y.uniformNames.map(E=>`#define HAS_UNIFORM_${E}`))}return s}getBinderAttributes(){const s=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof Bu||y instanceof uu)for(let E=0;E<y.paintVertexAttributes.length;E++)s.push(y.paintVertexAttributes[E].name);else if(y instanceof ll)for(let E=0;E<Bi.members.length;E++)s.push(Bi.members[E].name)}return s}getBinderUniforms(){const s=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof ya||y instanceof zi||y instanceof uu)for(const E of y.uniformNames)s.push(E)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,f){const y=[];for(const E in this.binders){const C=this.binders[E];if(C instanceof ya||C instanceof zi||C instanceof uu){for(const T of C.uniformNames)if(f[T]){const D=C.getBinding(s,f[T],T);y.push({name:T,property:E,binding:D})}}}return y}setUniforms(s,f,y,E){for(const{name:C,property:T,binding:D}of f)this.binders[T].setUniform(D,E,y.get(T),C)}updatePaintBuffers(s){this._buffers=[];for(const f in this.binders){const y=this.binders[f];if(s&&y instanceof ll){const E=s.fromScale===2?y.zoomInPaintVertexBuffer:y.zoomOutPaintVertexBuffer;E&&this._buffers.push(E)}else(y instanceof Bu||y instanceof uu)&&y.paintVertexBuffer&&this._buffers.push(y.paintVertexBuffer)}}upload(s){for(const f in this.binders){const y=this.binders[f];(y instanceof Bu||y instanceof uu||y instanceof ll)&&y.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const f=this.binders[s];(f instanceof Bu||f instanceof uu||f instanceof ll)&&f.destroy()}}}class kl{constructor(s,f,y=()=>!0){this.programConfigurations={};for(const E of s)this.programConfigurations[E.id]=new xg(E,f,y);this.needsUpload=!1,this._featureMap=new Cu,this._bufferOffset=0}populatePaintArrays(s,f,y,E,C,T){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(s,f,E,C,T);f.id!==void 0&&this._featureMap.add(f.id,y,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,f,y,E){for(const C of y)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(s,this._featureMap,f,C,E)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const f in this.programConfigurations)this.programConfigurations[f].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function f0(h,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${s}-`,"").replace(/-/g,"_")]}function Bl(h,s,f){const y={color:{source:ti,composite:I},number:{source:x,composite:ti}},E=function(C){return{"line-pattern":{source:St,composite:St},"fill-pattern":{source:St,composite:St},"fill-extrusion-pattern":{source:St,composite:St}}[C]}(h);return E&&E[f]||y[s][f]}Yt("ConstantBinder",ya),Yt("CrossFadedConstantBinder",zi),Yt("SourceExpressionBinder",Bu),Yt("CrossFadedCompositeBinder",ll),Yt("CompositeExpressionBinder",uu),Yt("ProgramConfiguration",xg,{omit:["_buffers"]}),Yt("ProgramConfigurationSet",kl);const Yi=8192,Th=Math.pow(2,14)-1,Wf=-Th-1;function zu(h){const s=Yi/h.extent,f=h.loadGeometry();for(let y=0;y<f.length;y++){const E=f[y];for(let C=0;C<E.length;C++){const T=E[C],D=Math.round(T.x*s),z=Math.round(T.y*s);T.x=X(D,Wf,Th),T.y=X(z,Wf,Th),(D<T.x||D>T.x+1||z<T.y||z>T.y+1)&&W("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return f}function cl(h,s){return{type:h.type,id:h.id,properties:h.properties,geometry:s?zu(h):[]}}function uc(h,s,f,y,E){h.emplaceBack(2*s+(y+1)/2,2*f+(E+1)/2)}class p0{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(f=>f.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new je,this.indexArray=new gr,this.segments=new _r,this.programConfigurations=new kl(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(s,f,y){const E=this.layers[0],C=[];let T=null,D=!1;E.type==="circle"&&(T=E.layout.get("circle-sort-key"),D=!T.isConstant());for(const{feature:z,id:Z,index:te,sourceLayerIndex:oe}of s){const de=this.layers[0]._featureFilter.needGeometry,_e=cl(z,de);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),_e,y))continue;const Ee=D?T.evaluate(_e,{},y):void 0,Re={id:Z,properties:z.properties,type:z.type,sourceLayerIndex:oe,index:te,geometry:de?_e.geometry:zu(z),patterns:{},sortKey:Ee};C.push(Re)}D&&C.sort((z,Z)=>z.sortKey-Z.sortKey);for(const z of C){const{geometry:Z,index:te,sourceLayerIndex:oe}=z,de=s[te].feature;this.addFeature(z,Z,te,y),f.featureIndex.insert(de,Z,te,oe,this.index)}}update(s,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,f,this.stateDependentLayers,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,en),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,f,y,E){for(const C of f)for(const T of C){const D=T.x,z=T.y;if(D<0||D>=Yi||z<0||z>=Yi)continue;const Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),te=Z.vertexLength;uc(this.layoutVertexArray,D,z,-1,-1),uc(this.layoutVertexArray,D,z,1,-1),uc(this.layoutVertexArray,D,z,1,1),uc(this.layoutVertexArray,D,z,-1,1),this.indexArray.emplaceBack(te,te+1,te+2),this.indexArray.emplaceBack(te,te+3,te+2),Z.vertexLength+=4,Z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,y,{},E)}}function GS(h,s){for(let f=0;f<h.length;f++)if(Mh(s,h[f]))return!0;for(let f=0;f<s.length;f++)if(Mh(h,s[f]))return!0;return!!d0(h,s)}function $F(h,s,f){return!!Mh(h,s)||!!g0(s,h,f)}function qS(h,s){if(h.length===1)return XS(s,h[0]);for(let f=0;f<s.length;f++){const y=s[f];for(let E=0;E<y.length;E++)if(Mh(h,y[E]))return!0}for(let f=0;f<h.length;f++)if(XS(s,h[f]))return!0;for(let f=0;f<s.length;f++)if(d0(h,s[f]))return!0;return!1}function GF(h,s,f){if(h.length>1){if(d0(h,s))return!0;for(let y=0;y<s.length;y++)if(g0(s[y],h,f))return!0}for(let y=0;y<h.length;y++)if(g0(h[y],s,f))return!0;return!1}function d0(h,s){if(h.length===0||s.length===0)return!1;for(let f=0;f<h.length-1;f++){const y=h[f],E=h[f+1];for(let C=0;C<s.length-1;C++)if(qF(y,E,s[C],s[C+1]))return!0}return!1}function qF(h,s,f,y){return J(h,f,y)!==J(s,f,y)&&J(h,s,f)!==J(h,s,y)}function g0(h,s,f){const y=f*f;if(s.length===1)return h.distSqr(s[0])<y;for(let E=1;E<s.length;E++)if(VS(h,s[E-1],s[E])<y)return!0;return!1}function VS(h,s,f){const y=s.distSqr(f);if(y===0)return h.distSqr(s);const E=((h.x-s.x)*(f.x-s.x)+(h.y-s.y)*(f.y-s.y))/y;return h.distSqr(E<0?s:E>1?f:f.sub(s)._mult(E)._add(s))}function XS(h,s){let f,y,E,C=!1;for(let T=0;T<h.length;T++){f=h[T];for(let D=0,z=f.length-1;D<f.length;z=D++)y=f[D],E=f[z],y.y>s.y!=E.y>s.y&&s.x<(E.x-y.x)*(s.y-y.y)/(E.y-y.y)+y.x&&(C=!C)}return C}function Mh(h,s){let f=!1;for(let y=0,E=h.length-1;y<h.length;E=y++){const C=h[y],T=h[E];C.y>s.y!=T.y>s.y&&s.x<(T.x-C.x)*(s.y-C.y)/(T.y-C.y)+C.x&&(f=!f)}return f}function VF(h,s,f){const y=f[0],E=f[2];if(h.x<y.x&&s.x<y.x||h.x>E.x&&s.x>E.x||h.y<y.y&&s.y<y.y||h.y>E.y&&s.y>E.y)return!1;const C=J(h,s,f[0]);return C!==J(h,s,f[1])||C!==J(h,s,f[2])||C!==J(h,s,f[3])}function Zf(h,s,f){const y=s.paint.get(h).value;return y.kind==="constant"?y.value:f.programConfigurations.get(s.id).getMaxValue(h)}function wg(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function Eg(h,s,f,y,E){if(!s[0]&&!s[1])return h;const C=P.convert(s)._mult(E);f==="viewport"&&C._rotate(-y);const T=[];for(let D=0;D<h.length;D++)T.push(h[D].sub(C));return T}let YS,WS;Yt("CircleBucket",p0,{omit:["layers"]});var XF={get paint(){return WS=WS||new Uo({"circle-radius":new Er(Ye.paint_circle["circle-radius"]),"circle-color":new Er(Ye.paint_circle["circle-color"]),"circle-blur":new Er(Ye.paint_circle["circle-blur"]),"circle-opacity":new Er(Ye.paint_circle["circle-opacity"]),"circle-translate":new fr(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new fr(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fr(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fr(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Er(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Er(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Er(Ye.paint_circle["circle-stroke-opacity"])})},get layout(){return YS=YS||new Uo({"circle-sort-key":new Er(Ye.layout_circle["circle-sort-key"])})}},ts=1e-6,Lh=typeof Float32Array<"u"?Float32Array:Array;function m0(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function ZS(h,s,f){var y=s[0],E=s[1],C=s[2],T=s[3],D=s[4],z=s[5],Z=s[6],te=s[7],oe=s[8],de=s[9],_e=s[10],Ee=s[11],Re=s[12],ze=s[13],Ge=s[14],nt=s[15],Ze=f[0],ot=f[1],st=f[2],xt=f[3];return h[0]=Ze*y+ot*D+st*oe+xt*Re,h[1]=Ze*E+ot*z+st*de+xt*ze,h[2]=Ze*C+ot*Z+st*_e+xt*Ge,h[3]=Ze*T+ot*te+st*Ee+xt*nt,h[4]=(Ze=f[4])*y+(ot=f[5])*D+(st=f[6])*oe+(xt=f[7])*Re,h[5]=Ze*E+ot*z+st*de+xt*ze,h[6]=Ze*C+ot*Z+st*_e+xt*Ge,h[7]=Ze*T+ot*te+st*Ee+xt*nt,h[8]=(Ze=f[8])*y+(ot=f[9])*D+(st=f[10])*oe+(xt=f[11])*Re,h[9]=Ze*E+ot*z+st*de+xt*ze,h[10]=Ze*C+ot*Z+st*_e+xt*Ge,h[11]=Ze*T+ot*te+st*Ee+xt*nt,h[12]=(Ze=f[12])*y+(ot=f[13])*D+(st=f[14])*oe+(xt=f[15])*Re,h[13]=Ze*E+ot*z+st*de+xt*ze,h[14]=Ze*C+ot*Z+st*_e+xt*Ge,h[15]=Ze*T+ot*te+st*Ee+xt*nt,h}Math.hypot||(Math.hypot=function(){for(var h=0,s=arguments.length;s--;)h+=arguments[s]*arguments[s];return Math.sqrt(h)});var Hf,YF=ZS;function Sg(h,s,f){var y=s[0],E=s[1],C=s[2],T=s[3];return h[0]=f[0]*y+f[4]*E+f[8]*C+f[12]*T,h[1]=f[1]*y+f[5]*E+f[9]*C+f[13]*T,h[2]=f[2]*y+f[6]*E+f[10]*C+f[14]*T,h[3]=f[3]*y+f[7]*E+f[11]*C+f[15]*T,h}Hf=new Lh(4),Lh!=Float32Array&&(Hf[0]=0,Hf[1]=0,Hf[2]=0,Hf[3]=0);class WF extends Co{constructor(s){super(s,XF)}createBucket(s){return new p0(s)}queryRadius(s){const f=s;return Zf("circle-radius",this,f)+Zf("circle-stroke-width",this,f)+wg(this.paint.get("circle-translate"))}queryIntersectsFeature(s,f,y,E,C,T,D,z){const Z=Eg(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,D),te=this.paint.get("circle-radius").evaluate(f,y)+this.paint.get("circle-stroke-width").evaluate(f,y),oe=this.paint.get("circle-pitch-alignment")==="map",de=oe?Z:function(Ee,Re){return Ee.map(ze=>HS(ze,Re))}(Z,z),_e=oe?te*D:te;for(const Ee of E)for(const Re of Ee){const ze=oe?Re:HS(Re,z);let Ge=_e;const nt=Sg([],[Re.x,Re.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ge*=nt[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ge*=T.cameraToCenterDistance/nt[3]),$F(de,ze,Ge))return!0}return!1}}function HS(h,s){const f=Sg([],[h.x,h.y,0,1],s);return new P(f[0]/f[3],f[1]/f[3])}class JS extends p0{}let KS;Yt("HeatmapBucket",JS,{omit:["layers"]});var ZF={get paint(){return KS=KS||new Uo({"heatmap-radius":new Er(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Er(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fr(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Iu(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fr(Ye.paint_heatmap["heatmap-opacity"])})}};function v0(h,{width:s,height:f},y,E){if(E){if(E instanceof Uint8ClampedArray)E=new Uint8Array(E.buffer);else if(E.length!==s*f*y)throw new RangeError(`mismatched image size. expected: ${E.length} but got: ${s*f*y}`)}else E=new Uint8Array(s*f*y);return h.width=s,h.height=f,h.data=E,h}function QS(h,{width:s,height:f},y){if(s===h.width&&f===h.height)return;const E=v0({},{width:s,height:f},y);y0(h,E,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,s),height:Math.min(h.height,f)},y),h.width=s,h.height=f,h.data=E.data}function y0(h,s,f,y,E,C){if(E.width===0||E.height===0)return s;if(E.width>h.width||E.height>h.height||f.x>h.width-E.width||f.y>h.height-E.height)throw new RangeError("out of range source coordinates for image copy");if(E.width>s.width||E.height>s.height||y.x>s.width-E.width||y.y>s.height-E.height)throw new RangeError("out of range destination coordinates for image copy");const T=h.data,D=s.data;if(T===D)throw new Error("srcData equals dstData, so image is already copied");for(let z=0;z<E.height;z++){const Z=((f.y+z)*h.width+f.x)*C,te=((y.y+z)*s.width+y.x)*C;for(let oe=0;oe<E.width*C;oe++)D[te+oe]=T[Z+oe]}return s}class Jf{constructor(s,f){v0(this,s,1,f)}resize(s){QS(this,s,1)}clone(){return new Jf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,f,y,E,C){y0(s,f,y,E,C,1)}}class lu{constructor(s,f){v0(this,s,4,f)}resize(s){QS(this,s,4)}replace(s,f){f?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new lu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,f,y,E,C){y0(s,f,y,E,C,4)}}function eP(h){const s={},f=h.resolution||256,y=h.clips?h.clips.length:1,E=h.image||new lu({width:f,height:y});if(Math.log(f)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${f}`);const C=(T,D,z)=>{s[h.evaluationKey]=z;const Z=h.expression.evaluate(s);E.data[T+D+0]=Math.floor(255*Z.r/Z.a),E.data[T+D+1]=Math.floor(255*Z.g/Z.a),E.data[T+D+2]=Math.floor(255*Z.b/Z.a),E.data[T+D+3]=Math.floor(255*Z.a)};if(h.clips)for(let T=0,D=0;T<y;++T,D+=4*f)for(let z=0,Z=0;z<f;z++,Z+=4){const te=z/(f-1),{start:oe,end:de}=h.clips[T];C(D,Z,oe*(1-te)+de*te)}else for(let T=0,D=0;T<f;T++,D+=4)C(0,D,T/(f-1));return E}Yt("AlphaImage",Jf),Yt("RGBAImage",lu);class HF extends Co{createBucket(s){return new JS(s)}constructor(s){super(s,ZF),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=eP({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let tP;var JF={get paint(){return tP=tP||new Uo({"hillshade-illumination-direction":new fr(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fr(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fr(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fr(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fr(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fr(Ye.paint_hillshade["hillshade-accent-color"])})}};class KF extends Co{constructor(s){super(s,JF)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const QF=Kt([{name:"a_pos",components:2,type:"Int16"}],4),{members:ek}=QF;var _0={exports:{}};function Pg(h,s,f){f=f||2;var y,E,C,T,D,z,Z,te=s&&s.length,oe=te?s[0]*f:h.length,de=rP(h,0,oe,f,!0),_e=[];if(!de||de.next===de.prev)return _e;if(te&&(de=function(Re,ze,Ge,nt){var Ze,ot,st,xt=[];for(Ze=0,ot=ze.length;Ze<ot;Ze++)(st=rP(Re,ze[Ze]*nt,Ze<ot-1?ze[Ze+1]*nt:Re.length,nt,!1))===st.next&&(st.steiner=!0),xt.push(uk(st));for(xt.sort(ok),Ze=0;Ze<xt.length;Ze++)Ge=ak(xt[Ze],Ge);return Ge}(h,s,de,f)),h.length>80*f){y=C=h[0],E=T=h[1];for(var Ee=f;Ee<oe;Ee+=f)(D=h[Ee])<y&&(y=D),(z=h[Ee+1])<E&&(E=z),D>C&&(C=D),z>T&&(T=z);Z=(Z=Math.max(C-y,T-E))!==0?32767/Z:0}return Kf(de,_e,f,y,E,Z,0),_e}function rP(h,s,f,y,E){var C,T;if(E===w0(h,s,f,y)>0)for(C=s;C<f;C+=y)T=oP(C,h[C],h[C+1],T);else for(C=f-y;C>=s;C-=y)T=oP(C,h[C],h[C+1],T);return T&&Ag(T,T.next)&&(ep(T),T=T.next),T}function Fc(h,s){if(!h)return h;s||(s=h);var f,y=h;do if(f=!1,y.steiner||!Ag(y,y.next)&&fo(y.prev,y,y.next)!==0)y=y.next;else{if(ep(y),(y=s=y.prev)===y.next)break;f=!0}while(f||y!==s);return s}function Kf(h,s,f,y,E,C,T){if(h){!T&&C&&function(te,oe,de,_e){var Ee=te;do Ee.z===0&&(Ee.z=b0(Ee.x,Ee.y,oe,de,_e)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next;while(Ee!==te);Ee.prevZ.nextZ=null,Ee.prevZ=null,function(Re){var ze,Ge,nt,Ze,ot,st,xt,qt,cr=1;do{for(Ge=Re,Re=null,ot=null,st=0;Ge;){for(st++,nt=Ge,xt=0,ze=0;ze<cr&&(xt++,nt=nt.nextZ);ze++);for(qt=cr;xt>0||qt>0&&nt;)xt!==0&&(qt===0||!nt||Ge.z<=nt.z)?(Ze=Ge,Ge=Ge.nextZ,xt--):(Ze=nt,nt=nt.nextZ,qt--),ot?ot.nextZ=Ze:Re=Ze,Ze.prevZ=ot,ot=Ze;Ge=nt}ot.nextZ=null,cr*=2}while(st>1)}(Ee)}(h,y,E,C);for(var D,z,Z=h;h.prev!==h.next;)if(D=h.prev,z=h.next,C?rk(h,y,E,C):tk(h))s.push(D.i/f|0),s.push(h.i/f|0),s.push(z.i/f|0),ep(h),h=z.next,Z=z.next;else if((h=z)===Z){T?T===1?Kf(h=nk(Fc(h),s,f),s,f,y,E,C,2):T===2&&ik(h,s,f,y,E,C):Kf(Fc(h),s,f,y,E,C,1);break}}}function tk(h){var s=h.prev,f=h,y=h.next;if(fo(s,f,y)>=0)return!1;for(var E=s.x,C=f.x,T=y.x,D=s.y,z=f.y,Z=y.y,te=E<C?E<T?E:T:C<T?C:T,oe=D<z?D<Z?D:Z:z<Z?z:Z,de=E>C?E>T?E:T:C>T?C:T,_e=D>z?D>Z?D:Z:z>Z?z:Z,Ee=y.next;Ee!==s;){if(Ee.x>=te&&Ee.x<=de&&Ee.y>=oe&&Ee.y<=_e&&Rh(E,D,C,z,T,Z,Ee.x,Ee.y)&&fo(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.next}return!0}function rk(h,s,f,y){var E=h.prev,C=h,T=h.next;if(fo(E,C,T)>=0)return!1;for(var D=E.x,z=C.x,Z=T.x,te=E.y,oe=C.y,de=T.y,_e=D<z?D<Z?D:Z:z<Z?z:Z,Ee=te<oe?te<de?te:de:oe<de?oe:de,Re=D>z?D>Z?D:Z:z>Z?z:Z,ze=te>oe?te>de?te:de:oe>de?oe:de,Ge=b0(_e,Ee,s,f,y),nt=b0(Re,ze,s,f,y),Ze=h.prevZ,ot=h.nextZ;Ze&&Ze.z>=Ge&&ot&&ot.z<=nt;){if(Ze.x>=_e&&Ze.x<=Re&&Ze.y>=Ee&&Ze.y<=ze&&Ze!==E&&Ze!==T&&Rh(D,te,z,oe,Z,de,Ze.x,Ze.y)&&fo(Ze.prev,Ze,Ze.next)>=0||(Ze=Ze.prevZ,ot.x>=_e&&ot.x<=Re&&ot.y>=Ee&&ot.y<=ze&&ot!==E&&ot!==T&&Rh(D,te,z,oe,Z,de,ot.x,ot.y)&&fo(ot.prev,ot,ot.next)>=0))return!1;ot=ot.nextZ}for(;Ze&&Ze.z>=Ge;){if(Ze.x>=_e&&Ze.x<=Re&&Ze.y>=Ee&&Ze.y<=ze&&Ze!==E&&Ze!==T&&Rh(D,te,z,oe,Z,de,Ze.x,Ze.y)&&fo(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.prevZ}for(;ot&&ot.z<=nt;){if(ot.x>=_e&&ot.x<=Re&&ot.y>=Ee&&ot.y<=ze&&ot!==E&&ot!==T&&Rh(D,te,z,oe,Z,de,ot.x,ot.y)&&fo(ot.prev,ot,ot.next)>=0)return!1;ot=ot.nextZ}return!0}function nk(h,s,f){var y=h;do{var E=y.prev,C=y.next.next;!Ag(E,C)&&nP(E,y,y.next,C)&&Qf(E,C)&&Qf(C,E)&&(s.push(E.i/f|0),s.push(y.i/f|0),s.push(C.i/f|0),ep(y),ep(y.next),y=h=C),y=y.next}while(y!==h);return Fc(y)}function ik(h,s,f,y,E,C){var T=h;do{for(var D=T.next.next;D!==T.prev;){if(T.i!==D.i&&lk(T,D)){var z=iP(T,D);return T=Fc(T,T.next),z=Fc(z,z.next),Kf(T,s,f,y,E,C,0),void Kf(z,s,f,y,E,C,0)}D=D.next}T=T.next}while(T!==h)}function ok(h,s){return h.x-s.x}function ak(h,s){var f=function(E,C){var T,D=C,z=E.x,Z=E.y,te=-1/0;do{if(Z<=D.y&&Z>=D.next.y&&D.next.y!==D.y){var oe=D.x+(Z-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(oe<=z&&oe>te&&(te=oe,T=D.x<D.next.x?D:D.next,oe===z))return T}D=D.next}while(D!==C);if(!T)return null;var de,_e=T,Ee=T.x,Re=T.y,ze=1/0;D=T;do z>=D.x&&D.x>=Ee&&z!==D.x&&Rh(Z<Re?z:te,Z,Ee,Re,Z<Re?te:z,Z,D.x,D.y)&&(de=Math.abs(Z-D.y)/(z-D.x),Qf(D,E)&&(de<ze||de===ze&&(D.x>T.x||D.x===T.x&&sk(T,D)))&&(T=D,ze=de)),D=D.next;while(D!==_e);return T}(h,s);if(!f)return s;var y=iP(f,h);return Fc(y,y.next),Fc(f,f.next)}function sk(h,s){return fo(h.prev,h,s.prev)<0&&fo(s.next,h,h.next)<0}function b0(h,s,f,y,E){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-f)*E|0)|h<<8))|h<<4))|h<<2))|h<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-y)*E|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function uk(h){var s=h,f=h;do(s.x<f.x||s.x===f.x&&s.y<f.y)&&(f=s),s=s.next;while(s!==h);return f}function Rh(h,s,f,y,E,C,T,D){return(E-T)*(s-D)>=(h-T)*(C-D)&&(h-T)*(y-D)>=(f-T)*(s-D)&&(f-T)*(C-D)>=(E-T)*(y-D)}function lk(h,s){return h.next.i!==s.i&&h.prev.i!==s.i&&!function(f,y){var E=f;do{if(E.i!==f.i&&E.next.i!==f.i&&E.i!==y.i&&E.next.i!==y.i&&nP(E,E.next,f,y))return!0;E=E.next}while(E!==f);return!1}(h,s)&&(Qf(h,s)&&Qf(s,h)&&function(f,y){var E=f,C=!1,T=(f.x+y.x)/2,D=(f.y+y.y)/2;do E.y>D!=E.next.y>D&&E.next.y!==E.y&&T<(E.next.x-E.x)*(D-E.y)/(E.next.y-E.y)+E.x&&(C=!C),E=E.next;while(E!==f);return C}(h,s)&&(fo(h.prev,h,s.prev)||fo(h,s.prev,s))||Ag(h,s)&&fo(h.prev,h,h.next)>0&&fo(s.prev,s,s.next)>0)}function fo(h,s,f){return(s.y-h.y)*(f.x-s.x)-(s.x-h.x)*(f.y-s.y)}function Ag(h,s){return h.x===s.x&&h.y===s.y}function nP(h,s,f,y){var E=Og(fo(h,s,f)),C=Og(fo(h,s,y)),T=Og(fo(f,y,h)),D=Og(fo(f,y,s));return E!==C&&T!==D||!(E!==0||!Ig(h,f,s))||!(C!==0||!Ig(h,y,s))||!(T!==0||!Ig(f,h,y))||!(D!==0||!Ig(f,s,y))}function Ig(h,s,f){return s.x<=Math.max(h.x,f.x)&&s.x>=Math.min(h.x,f.x)&&s.y<=Math.max(h.y,f.y)&&s.y>=Math.min(h.y,f.y)}function Og(h){return h>0?1:h<0?-1:0}function Qf(h,s){return fo(h.prev,h,h.next)<0?fo(h,s,h.next)>=0&&fo(h,h.prev,s)>=0:fo(h,s,h.prev)<0||fo(h,h.next,s)<0}function iP(h,s){var f=new x0(h.i,h.x,h.y),y=new x0(s.i,s.x,s.y),E=h.next,C=s.prev;return h.next=s,s.prev=h,f.next=E,E.prev=f,y.next=f,f.prev=y,C.next=y,y.prev=C,y}function oP(h,s,f,y){var E=new x0(h,s,f);return y?(E.next=y.next,E.prev=y,y.next.prev=E,y.next=E):(E.prev=E,E.next=E),E}function ep(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function x0(h,s,f){this.i=h,this.x=s,this.y=f,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function w0(h,s,f,y){for(var E=0,C=s,T=f-y;C<f;C+=y)E+=(h[T]-h[C])*(h[C+1]+h[T+1]),T=C;return E}_0.exports=Pg,_0.exports.default=Pg,Pg.deviation=function(h,s,f,y){var E=s&&s.length,C=Math.abs(w0(h,0,E?s[0]*f:h.length,f));if(E)for(var T=0,D=s.length;T<D;T++)C-=Math.abs(w0(h,s[T]*f,T<D-1?s[T+1]*f:h.length,f));var z=0;for(T=0;T<y.length;T+=3){var Z=y[T]*f,te=y[T+1]*f,oe=y[T+2]*f;z+=Math.abs((h[Z]-h[oe])*(h[te+1]-h[Z+1])-(h[Z]-h[te])*(h[oe+1]-h[Z+1]))}return C===0&&z===0?0:Math.abs((z-C)/C)},Pg.flatten=function(h){for(var s=h[0][0].length,f={vertices:[],holes:[],dimensions:s},y=0,E=0;E<h.length;E++){for(var C=0;C<h[E].length;C++)for(var T=0;T<s;T++)f.vertices.push(h[E][C][T]);E>0&&f.holes.push(y+=h[E-1].length)}return f};var aP=_(_0.exports);function ck(h,s,f,y,E){sP(h,s,f||0,y||h.length-1,E||hk)}function sP(h,s,f,y,E){for(;y>f;){if(y-f>600){var C=y-f+1,T=s-f+1,D=Math.log(C),z=.5*Math.exp(2*D/3),Z=.5*Math.sqrt(D*z*(C-z)/C)*(T-C/2<0?-1:1);sP(h,s,Math.max(f,Math.floor(s-T*z/C+Z)),Math.min(y,Math.floor(s+(C-T)*z/C+Z)),E)}var te=h[s],oe=f,de=y;for(tp(h,f,s),E(h[y],te)>0&&tp(h,f,y);oe<de;){for(tp(h,oe,de),oe++,de--;E(h[oe],te)<0;)oe++;for(;E(h[de],te)>0;)de--}E(h[f],te)===0?tp(h,f,de):tp(h,++de,y),de<=s&&(f=de+1),s<=de&&(y=de-1)}}function tp(h,s,f){var y=h[s];h[s]=h[f],h[f]=y}function hk(h,s){return h<s?-1:h>s?1:0}function E0(h,s){const f=h.length;if(f<=1)return[h];const y=[];let E,C;for(let T=0;T<f;T++){const D=be(h[T]);D!==0&&(h[T].area=Math.abs(D),C===void 0&&(C=D<0),C===D<0?(E&&y.push(E),E=[h[T]]):E.push(h[T]))}if(E&&y.push(E),s>1)for(let T=0;T<y.length;T++)y[T].length<=s||(ck(y[T],s,1,y[T].length-1,fk),y[T]=y[T].slice(0,s));return y}function fk(h,s){return s.area-h.area}function S0(h,s,f){const y=f.patternDependencies;let E=!1;for(const C of s){const T=C.paint.get(`${h}-pattern`);T.isConstant()||(E=!0);const D=T.constantOr(null);D&&(E=!0,y[D.to]=!0,y[D.from]=!0)}return E}function P0(h,s,f,y,E){const C=E.patternDependencies;for(const T of s){const D=T.paint.get(`${h}-pattern`).value;if(D.kind!=="constant"){let z=D.evaluate({zoom:y-1},f,{},E.availableImages),Z=D.evaluate({zoom:y},f,{},E.availableImages),te=D.evaluate({zoom:y+1},f,{},E.availableImages);z=z&&z.name?z.name:z,Z=Z&&Z.name?Z.name:Z,te=te&&te.name?te.name:te,C[z]=!0,C[Z]=!0,C[te]=!0,f.patterns[T.id]={min:z,mid:Z,max:te}}}return f}class A0{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(f=>f.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new tt,this.indexArray=new gr,this.indexArray2=new ar,this.programConfigurations=new kl(s.layers,s.zoom),this.segments=new _r,this.segments2=new _r,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(s,f,y){this.hasPattern=S0("fill",this.layers,f);const E=this.layers[0].layout.get("fill-sort-key"),C=!E.isConstant(),T=[];for(const{feature:D,id:z,index:Z,sourceLayerIndex:te}of s){const oe=this.layers[0]._featureFilter.needGeometry,de=cl(D,oe);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),de,y))continue;const _e=C?E.evaluate(de,{},y,f.availableImages):void 0,Ee={id:z,properties:D.properties,type:D.type,sourceLayerIndex:te,index:Z,geometry:oe?de.geometry:zu(D),patterns:{},sortKey:_e};T.push(Ee)}C&&T.sort((D,z)=>D.sortKey-z.sortKey);for(const D of T){const{geometry:z,index:Z,sourceLayerIndex:te}=D;if(this.hasPattern){const oe=P0("fill",this.layers,D,this.zoom,f);this.patternFeatures.push(oe)}else this.addFeature(D,z,Z,y,{});f.featureIndex.insert(s[Z].feature,z,Z,te,this.index)}}update(s,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,f,this.stateDependentLayers,y)}addFeatures(s,f,y){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,f,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ek),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,f,y,E,C){for(const T of E0(f,500)){let D=0;for(const _e of T)D+=_e.length;const z=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),Z=z.vertexLength,te=[],oe=[];for(const _e of T){if(_e.length===0)continue;_e!==T[0]&&oe.push(te.length/2);const Ee=this.segments2.prepareSegment(_e.length,this.layoutVertexArray,this.indexArray2),Re=Ee.vertexLength;this.layoutVertexArray.emplaceBack(_e[0].x,_e[0].y),this.indexArray2.emplaceBack(Re+_e.length-1,Re),te.push(_e[0].x),te.push(_e[0].y);for(let ze=1;ze<_e.length;ze++)this.layoutVertexArray.emplaceBack(_e[ze].x,_e[ze].y),this.indexArray2.emplaceBack(Re+ze-1,Re+ze),te.push(_e[ze].x),te.push(_e[ze].y);Ee.vertexLength+=_e.length,Ee.primitiveLength+=_e.length}const de=aP(te,oe);for(let _e=0;_e<de.length;_e+=3)this.indexArray.emplaceBack(Z+de[_e],Z+de[_e+1],Z+de[_e+2]);z.vertexLength+=D,z.primitiveLength+=de.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,y,C,E)}}let uP,lP;Yt("FillBucket",A0,{omit:["layers","patternFeatures"]});var pk={get paint(){return lP=lP||new Uo({"fill-antialias":new fr(Ye.paint_fill["fill-antialias"]),"fill-opacity":new Er(Ye.paint_fill["fill-opacity"]),"fill-color":new Er(Ye.paint_fill["fill-color"]),"fill-outline-color":new Er(Ye.paint_fill["fill-outline-color"]),"fill-translate":new fr(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new fr(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new ma(Ye.paint_fill["fill-pattern"])})},get layout(){return uP=uP||new Uo({"fill-sort-key":new Er(Ye.layout_fill["fill-sort-key"])})}};class dk extends Co{constructor(s){super(s,pk)}recalculate(s,f){super.recalculate(s,f);const y=this.paint._values["fill-outline-color"];y.value.kind==="constant"&&y.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new A0(s)}queryRadius(){return wg(this.paint.get("fill-translate"))}queryIntersectsFeature(s,f,y,E,C,T,D){return qS(Eg(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,D),E)}isTileClipped(){return!0}}const gk=Kt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),mk=Kt([{name:"a_centroid",components:2,type:"Int16"}],4),{members:vk}=gk;var lc={},yk=m,cP=Dh;function Dh(h,s,f,y,E){this.properties={},this.extent=f,this.type=0,this._pbf=h,this._geometry=-1,this._keys=y,this._values=E,h.readFields(_k,this,s)}function _k(h,s,f){h==1?s.id=f.readVarint():h==2?function(y,E){for(var C=y.readVarint()+y.pos;y.pos<C;){var T=E._keys[y.readVarint()],D=E._values[y.readVarint()];E.properties[T]=D}}(f,s):h==3?s.type=f.readVarint():h==4&&(s._geometry=f.pos)}function bk(h){for(var s,f,y=0,E=0,C=h.length,T=C-1;E<C;T=E++)y+=((f=h[T]).x-(s=h[E]).x)*(s.y+f.y);return y}Dh.types=["Unknown","Point","LineString","Polygon"],Dh.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var s,f=h.readVarint()+h.pos,y=1,E=0,C=0,T=0,D=[];h.pos<f;){if(E<=0){var z=h.readVarint();y=7&z,E=z>>3}if(E--,y===1||y===2)C+=h.readSVarint(),T+=h.readSVarint(),y===1&&(s&&D.push(s),s=[]),s.push(new yk(C,T));else{if(y!==7)throw new Error("unknown command "+y);s&&s.push(s[0].clone())}}return s&&D.push(s),D},Dh.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var s=h.readVarint()+h.pos,f=1,y=0,E=0,C=0,T=1/0,D=-1/0,z=1/0,Z=-1/0;h.pos<s;){if(y<=0){var te=h.readVarint();f=7&te,y=te>>3}if(y--,f===1||f===2)(E+=h.readSVarint())<T&&(T=E),E>D&&(D=E),(C+=h.readSVarint())<z&&(z=C),C>Z&&(Z=C);else if(f!==7)throw new Error("unknown command "+f)}return[T,z,D,Z]},Dh.prototype.toGeoJSON=function(h,s,f){var y,E,C=this.extent*Math.pow(2,f),T=this.extent*h,D=this.extent*s,z=this.loadGeometry(),Z=Dh.types[this.type];function te(_e){for(var Ee=0;Ee<_e.length;Ee++){var Re=_e[Ee];_e[Ee]=[360*(Re.x+T)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(Re.y+D)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var oe=[];for(y=0;y<z.length;y++)oe[y]=z[y][0];te(z=oe);break;case 2:for(y=0;y<z.length;y++)te(z[y]);break;case 3:for(z=function(_e){var Ee=_e.length;if(Ee<=1)return[_e];for(var Re,ze,Ge=[],nt=0;nt<Ee;nt++){var Ze=bk(_e[nt]);Ze!==0&&(ze===void 0&&(ze=Ze<0),ze===Ze<0?(Re&&Ge.push(Re),Re=[_e[nt]]):Re.push(_e[nt]))}return Re&&Ge.push(Re),Ge}(z),y=0;y<z.length;y++)for(E=0;E<z[y].length;E++)te(z[y][E])}z.length===1?z=z[0]:Z="Multi"+Z;var de={type:"Feature",geometry:{type:Z,coordinates:z},properties:this.properties};return"id"in this&&(de.id=this.id),de};var xk=cP,hP=fP;function fP(h,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(wk,this,s),this.length=this._features.length}function wk(h,s,f){h===15?s.version=f.readVarint():h===1?s.name=f.readString():h===5?s.extent=f.readVarint():h===2?s._features.push(f.pos):h===3?s._keys.push(f.readString()):h===4&&s._values.push(function(y){for(var E=null,C=y.readVarint()+y.pos;y.pos<C;){var T=y.readVarint()>>3;E=T===1?y.readString():T===2?y.readFloat():T===3?y.readDouble():T===4?y.readVarint64():T===5?y.readVarint():T===6?y.readSVarint():T===7?y.readBoolean():null}return E}(f))}fP.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var s=this._pbf.readVarint()+this._pbf.pos;return new xk(this._pbf,s,this.extent,this._keys,this._values)};var Ek=hP;function Sk(h,s,f){if(h===3){var y=new Ek(f,f.readVarint()+f.pos);y.length&&(s[y.name]=y)}}lc.VectorTile=function(h,s){this.layers=h.readFields(Sk,{},s)},lc.VectorTileFeature=cP,lc.VectorTileLayer=hP;const Pk=lc.VectorTileFeature.types,I0=Math.pow(2,13);function rp(h,s,f,y,E,C,T,D){h.emplaceBack(s,f,2*Math.floor(y*I0)+T,E*I0*2,C*I0*2,Math.round(D))}class O0{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(f=>f.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new ut,this.centroidVertexArray=new at,this.indexArray=new gr,this.programConfigurations=new kl(s.layers,s.zoom),this.segments=new _r,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(s,f,y){this.features=[],this.hasPattern=S0("fill-extrusion",this.layers,f);for(const{feature:E,id:C,index:T,sourceLayerIndex:D}of s){const z=this.layers[0]._featureFilter.needGeometry,Z=cl(E,z);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),Z,y))continue;const te={id:C,sourceLayerIndex:D,index:T,geometry:z?Z.geometry:zu(E),properties:E.properties,type:E.type,patterns:{}};this.hasPattern?this.features.push(P0("fill-extrusion",this.layers,te,this.zoom,f)):this.addFeature(te,te.geometry,T,y,{}),f.featureIndex.insert(E,te.geometry,T,D,this.index,!0)}}addFeatures(s,f,y){for(const E of this.features){const{geometry:C}=E;this.addFeature(E,C,E.index,f,y)}}update(s,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,f,this.stateDependentLayers,y)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,vk),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,mk.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,f,y,E,C){const T={x:0,y:0,vertexCount:0};for(const D of E0(f,500)){let z=0;for(const Ee of D)z+=Ee.length;let Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Ee of D){if(Ee.length===0||Ik(Ee))continue;let Re=0;for(let ze=0;ze<Ee.length;ze++){const Ge=Ee[ze];if(ze>=1){const nt=Ee[ze-1];if(!Ak(Ge,nt)){Z.vertexLength+4>_r.MAX_VERTEX_ARRAY_LENGTH&&(Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ze=Ge.sub(nt)._perp()._unit(),ot=nt.dist(Ge);Re+ot>32768&&(Re=0),rp(this.layoutVertexArray,Ge.x,Ge.y,Ze.x,Ze.y,0,0,Re),rp(this.layoutVertexArray,Ge.x,Ge.y,Ze.x,Ze.y,0,1,Re),T.x+=2*Ge.x,T.y+=2*Ge.y,T.vertexCount+=2,Re+=ot,rp(this.layoutVertexArray,nt.x,nt.y,Ze.x,Ze.y,0,0,Re),rp(this.layoutVertexArray,nt.x,nt.y,Ze.x,Ze.y,0,1,Re),T.x+=2*nt.x,T.y+=2*nt.y,T.vertexCount+=2;const st=Z.vertexLength;this.indexArray.emplaceBack(st,st+2,st+1),this.indexArray.emplaceBack(st+1,st+2,st+3),Z.vertexLength+=4,Z.primitiveLength+=2}}}}if(Z.vertexLength+z>_r.MAX_VERTEX_ARRAY_LENGTH&&(Z=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),Pk[s.type]!=="Polygon")continue;const te=[],oe=[],de=Z.vertexLength;for(const Ee of D)if(Ee.length!==0){Ee!==D[0]&&oe.push(te.length/2);for(let Re=0;Re<Ee.length;Re++){const ze=Ee[Re];rp(this.layoutVertexArray,ze.x,ze.y,0,0,1,1,0),T.x+=ze.x,T.y+=ze.y,T.vertexCount+=1,te.push(ze.x),te.push(ze.y)}}const _e=aP(te,oe);for(let Ee=0;Ee<_e.length;Ee+=3)this.indexArray.emplaceBack(de+_e[Ee],de+_e[Ee+2],de+_e[Ee+1]);Z.primitiveLength+=_e.length/3,Z.vertexLength+=z}for(let D=0;D<T.vertexCount;D++)this.centroidVertexArray.emplaceBack(Math.floor(T.x/T.vertexCount),Math.floor(T.y/T.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,y,C,E)}}function Ak(h,s){return h.x===s.x&&(h.x<0||h.x>Yi)||h.y===s.y&&(h.y<0||h.y>Yi)}function Ik(h){return h.every(s=>s.x<0)||h.every(s=>s.x>Yi)||h.every(s=>s.y<0)||h.every(s=>s.y>Yi)}let pP;Yt("FillExtrusionBucket",O0,{omit:["layers","features"]});var Ok={get paint(){return pP=pP||new Uo({"fill-extrusion-opacity":new fr(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Er(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fr(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fr(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ma(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Er(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Er(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fr(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Ck extends Co{constructor(s){super(s,Ok)}createBucket(s){return new O0(s)}queryRadius(){return wg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,f,y,E,C,T,D,z){const Z=Eg(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,D),te=this.paint.get("fill-extrusion-height").evaluate(f,y),oe=this.paint.get("fill-extrusion-base").evaluate(f,y),de=function(Ee,Re,ze,Ge){const nt=[];for(const Ze of Ee){const ot=[Ze.x,Ze.y,0,1];Sg(ot,ot,Re),nt.push(new P(ot[0]/ot[3],ot[1]/ot[3]))}return nt}(Z,z),_e=function(Ee,Re,ze,Ge){const nt=[],Ze=[],ot=Ge[8]*Re,st=Ge[9]*Re,xt=Ge[10]*Re,qt=Ge[11]*Re,cr=Ge[8]*ze,Gt=Ge[9]*ze,Bt=Ge[10]*ze,Dt=Ge[11]*ze;for(const Jt of Ee){const Ft=[],At=[];for(const br of Jt){const pr=br.x,Jr=br.y,bi=Ge[0]*pr+Ge[4]*Jr+Ge[12],Oi=Ge[1]*pr+Ge[5]*Jr+Ge[13],Do=Ge[2]*pr+Ge[6]*Jr+Ge[14],Gs=Ge[3]*pr+Ge[7]*Jr+Ge[15],rs=Do+xt,bo=Gs+qt,$o=bi+cr,ba=Oi+Gt,Es=Do+Bt,ns=Gs+Dt,xo=new P((bi+ot)/bo,(Oi+st)/bo);xo.z=rs/bo,Ft.push(xo);const No=new P($o/ns,ba/ns);No.z=Es/ns,At.push(No)}nt.push(Ft),Ze.push(At)}return[nt,Ze]}(E,oe,te,z);return function(Ee,Re,ze){let Ge=1/0;qS(ze,Re)&&(Ge=dP(ze,Re[0]));for(let nt=0;nt<Re.length;nt++){const Ze=Re[nt],ot=Ee[nt];for(let st=0;st<Ze.length-1;st++){const xt=Ze[st],qt=[xt,Ze[st+1],ot[st+1],ot[st],xt];GS(ze,qt)&&(Ge=Math.min(Ge,dP(ze,qt)))}}return Ge!==1/0&&Ge}(_e[0],_e[1],de)}}function np(h,s){return h.x*s.x+h.y*s.y}function dP(h,s){if(h.length===1){let f=0;const y=s[f++];let E;for(;!E||y.equals(E);)if(E=s[f++],!E)return 1/0;for(;f<s.length;f++){const C=s[f],T=h[0],D=E.sub(y),z=C.sub(y),Z=T.sub(y),te=np(D,D),oe=np(D,z),de=np(z,z),_e=np(Z,D),Ee=np(Z,z),Re=te*de-oe*oe,ze=(de*_e-oe*Ee)/Re,Ge=(te*Ee-oe*_e)/Re,nt=y.z*(1-ze-Ge)+E.z*ze+C.z*Ge;if(isFinite(nt))return nt}return 1/0}{let f=1/0;for(const y of s)f=Math.min(f,y.z);return f}}const Tk=Kt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Mk}=Tk,Lk=Kt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Rk}=Lk,Dk=lc.VectorTileFeature.types,Nk=Math.cos(Math.PI/180*37.5),gP=Math.pow(2,14)/.5;class C0{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(f=>f.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(f=>{this.gradients[f.id]={}}),this.layoutVertexArray=new lt,this.layoutVertexArray2=new bt,this.indexArray=new gr,this.programConfigurations=new kl(s.layers,s.zoom),this.segments=new _r,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(s,f,y){this.hasPattern=S0("line",this.layers,f);const E=this.layers[0].layout.get("line-sort-key"),C=!E.isConstant(),T=[];for(const{feature:D,id:z,index:Z,sourceLayerIndex:te}of s){const oe=this.layers[0]._featureFilter.needGeometry,de=cl(D,oe);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),de,y))continue;const _e=C?E.evaluate(de,{},y):void 0,Ee={id:z,properties:D.properties,type:D.type,sourceLayerIndex:te,index:Z,geometry:oe?de.geometry:zu(D),patterns:{},sortKey:_e};T.push(Ee)}C&&T.sort((D,z)=>D.sortKey-z.sortKey);for(const D of T){const{geometry:z,index:Z,sourceLayerIndex:te}=D;if(this.hasPattern){const oe=P0("line",this.layers,D,this.zoom,f);this.patternFeatures.push(oe)}else this.addFeature(D,z,Z,y,{});f.featureIndex.insert(s[Z].feature,z,Z,te,this.index)}}update(s,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,f,this.stateDependentLayers,y)}addFeatures(s,f,y){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,f,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Rk)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Mk),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,f,y,E,C){const T=this.layers[0].layout,D=T.get("line-join").evaluate(s,{}),z=T.get("line-cap"),Z=T.get("line-miter-limit"),te=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const oe of f)this.addLine(oe,s,D,z,Z,te);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,y,C,E)}addLine(s,f,y,E,C,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ge=0;Ge<s.length-1;Ge++)this.totalDistance+=s[Ge].dist(s[Ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const D=Dk[f.type]==="Polygon";let z=s.length;for(;z>=2&&s[z-1].equals(s[z-2]);)z--;let Z=0;for(;Z<z-1&&s[Z].equals(s[Z+1]);)Z++;if(z<(D?3:2))return;y==="bevel"&&(C=1.05);const te=this.overscaling<=16?15*Yi/(512*this.overscaling):0,oe=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let de,_e,Ee,Re,ze;this.e1=this.e2=-1,D&&(de=s[z-2],ze=s[Z].sub(de)._unit()._perp());for(let Ge=Z;Ge<z;Ge++){if(Ee=Ge===z-1?D?s[Z+1]:void 0:s[Ge+1],Ee&&s[Ge].equals(Ee))continue;ze&&(Re=ze),de&&(_e=de),de=s[Ge],ze=Ee?Ee.sub(de)._unit()._perp():Re,Re=Re||ze;let nt=Re.add(ze);nt.x===0&&nt.y===0||nt._unit();const Ze=Re.x*ze.x+Re.y*ze.y,ot=nt.x*ze.x+nt.y*ze.y,st=ot!==0?1/ot:1/0,xt=2*Math.sqrt(2-2*ot),qt=ot<Nk&&_e&&Ee,cr=Re.x*ze.y-Re.y*ze.x>0;if(qt&&Ge>Z){const Dt=de.dist(_e);if(Dt>2*te){const Jt=de.sub(de.sub(_e)._mult(te/Dt)._round());this.updateDistance(_e,Jt),this.addCurrentVertex(Jt,Re,0,0,oe),_e=Jt}}const Gt=_e&&Ee;let Bt=Gt?y:D?"butt":E;if(Gt&&Bt==="round"&&(st<T?Bt="miter":st<=2&&(Bt="fakeround")),Bt==="miter"&&st>C&&(Bt="bevel"),Bt==="bevel"&&(st>2&&(Bt="flipbevel"),st<C&&(Bt="miter")),_e&&this.updateDistance(_e,de),Bt==="miter")nt._mult(st),this.addCurrentVertex(de,nt,0,0,oe);else if(Bt==="flipbevel"){if(st>100)nt=ze.mult(-1);else{const Dt=st*Re.add(ze).mag()/Re.sub(ze).mag();nt._perp()._mult(Dt*(cr?-1:1))}this.addCurrentVertex(de,nt,0,0,oe),this.addCurrentVertex(de,nt.mult(-1),0,0,oe)}else if(Bt==="bevel"||Bt==="fakeround"){const Dt=-Math.sqrt(st*st-1),Jt=cr?Dt:0,Ft=cr?0:Dt;if(_e&&this.addCurrentVertex(de,Re,Jt,Ft,oe),Bt==="fakeround"){const At=Math.round(180*xt/Math.PI/20);for(let br=1;br<At;br++){let pr=br/At;if(pr!==.5){const bi=pr-.5;pr+=pr*bi*(pr-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*bi*bi+(.848013+Ze*(.215638*Ze-1.06021)))}const Jr=ze.sub(Re)._mult(pr)._add(Re)._unit()._mult(cr?-1:1);this.addHalfVertex(de,Jr.x,Jr.y,!1,cr,0,oe)}}Ee&&this.addCurrentVertex(de,ze,-Jt,-Ft,oe)}else if(Bt==="butt")this.addCurrentVertex(de,nt,0,0,oe);else if(Bt==="square"){const Dt=_e?1:-1;this.addCurrentVertex(de,nt,Dt,Dt,oe)}else Bt==="round"&&(_e&&(this.addCurrentVertex(de,Re,0,0,oe),this.addCurrentVertex(de,Re,1,1,oe,!0)),Ee&&(this.addCurrentVertex(de,ze,-1,-1,oe,!0),this.addCurrentVertex(de,ze,0,0,oe)));if(qt&&Ge<z-1){const Dt=de.dist(Ee);if(Dt>2*te){const Jt=de.add(Ee.sub(de)._mult(te/Dt)._round());this.updateDistance(de,Jt),this.addCurrentVertex(Jt,ze,0,0,oe),de=Jt}}}}addCurrentVertex(s,f,y,E,C,T=!1){const D=f.y*E-f.x,z=-f.y-f.x*E;this.addHalfVertex(s,f.x+f.y*y,f.y-f.x*y,T,!1,y,C),this.addHalfVertex(s,D,z,T,!0,-E,C),this.distance>gP/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,f,y,E,C,T))}addHalfVertex({x:s,y:f},y,E,C,T,D,z){const Z=.5*(this.lineClips?this.scaledDistance*(gP-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(C?1:0),(f<<1)+(T?1:0),Math.round(63*y)+128,Math.round(63*E)+128,1+(D===0?0:D<0?-1:1)|(63&Z)<<2,Z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const te=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,te),z.primitiveLength++),T?this.e2=te:this.e1=te}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,f){this.distance+=s.dist(f),this.updateScaledDistance()}}let mP,vP;Yt("LineBucket",C0,{omit:["layers","patternFeatures"]});var yP={get paint(){return vP=vP||new Uo({"line-opacity":new Er(Ye.paint_line["line-opacity"]),"line-color":new Er(Ye.paint_line["line-color"]),"line-translate":new fr(Ye.paint_line["line-translate"]),"line-translate-anchor":new fr(Ye.paint_line["line-translate-anchor"]),"line-width":new Er(Ye.paint_line["line-width"]),"line-gap-width":new Er(Ye.paint_line["line-gap-width"]),"line-offset":new Er(Ye.paint_line["line-offset"]),"line-blur":new Er(Ye.paint_line["line-blur"]),"line-dasharray":new Au(Ye.paint_line["line-dasharray"]),"line-pattern":new ma(Ye.paint_line["line-pattern"]),"line-gradient":new Iu(Ye.paint_line["line-gradient"])})},get layout(){return mP=mP||new Uo({"line-cap":new fr(Ye.layout_line["line-cap"]),"line-join":new Er(Ye.layout_line["line-join"]),"line-miter-limit":new fr(Ye.layout_line["line-miter-limit"]),"line-round-limit":new fr(Ye.layout_line["line-round-limit"]),"line-sort-key":new Er(Ye.layout_line["line-sort-key"])})}};class Fk extends Er{possiblyEvaluate(s,f){return f=new Kn(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),super.possiblyEvaluate(s,f)}evaluate(s,f,y,E){return f=k({},f,{zoom:Math.floor(f.zoom)}),super.evaluate(s,f,y,E)}}let Cg;class kk extends Co{constructor(s){super(s,yP),this.gradientVersion=0,Cg||(Cg=new Fk(yP.paint.properties["line-width"].specification),Cg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){s==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Oa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,f){super.recalculate(s,f),this.paint._values["line-floorwidth"]=Cg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new C0(s)}queryRadius(s){const f=s,y=_P(Zf("line-width",this,f),Zf("line-gap-width",this,f)),E=Zf("line-offset",this,f);return y/2+Math.abs(E)+wg(this.paint.get("line-translate"))}queryIntersectsFeature(s,f,y,E,C,T,D){const z=Eg(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,D),Z=D/2*_P(this.paint.get("line-width").evaluate(f,y),this.paint.get("line-gap-width").evaluate(f,y)),te=this.paint.get("line-offset").evaluate(f,y);return te&&(E=function(oe,de){const _e=[];for(let Ee=0;Ee<oe.length;Ee++){const Re=oe[Ee],ze=[];for(let Ge=0;Ge<Re.length;Ge++){const nt=Re[Ge-1],Ze=Re[Ge],ot=Re[Ge+1],st=Ge===0?new P(0,0):Ze.sub(nt)._unit()._perp(),xt=Ge===Re.length-1?new P(0,0):ot.sub(Ze)._unit()._perp(),qt=st._add(xt)._unit(),cr=qt.x*xt.x+qt.y*xt.y;cr!==0&&qt._mult(1/cr),ze.push(qt._mult(de)._add(Ze))}_e.push(ze)}return _e}(E,te*D)),function(oe,de,_e){for(let Ee=0;Ee<de.length;Ee++){const Re=de[Ee];if(oe.length>=3){for(let ze=0;ze<Re.length;ze++)if(Mh(oe,Re[ze]))return!0}if(GF(oe,Re,_e))return!0}return!1}(z,E,Z)}isTileClipped(){return!0}}function _P(h,s){return s>0?s+2*h:h}const Bk=Kt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),zk=Kt([{name:"a_projected_pos",components:3,type:"Float32"}],4);Kt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const jk=Kt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Kt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const bP=Kt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Uk=Kt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function $k(h,s,f){return h.sections.forEach(y=>{y.text=function(E,C,T){const D=C.layout.get("text-transform").evaluate(T,{});return D==="uppercase"?E=E.toLocaleUpperCase():D==="lowercase"&&(E=E.toLocaleLowerCase()),Jn.applyArabicShaping&&(E=Jn.applyArabicShaping(E)),E}(y.text,s,f)}),h}Kt([{name:"triangle",components:3,type:"Uint16"}]),Kt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Kt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Kt([{type:"Float32",name:"offsetX"}]),Kt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Kt([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ip={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Ro=24,xP=ai,wP=function(h,s,f,y,E){var C,T,D=8*E-y-1,z=(1<<D)-1,Z=z>>1,te=-7,oe=f?E-1:0,de=f?-1:1,_e=h[s+oe];for(oe+=de,C=_e&(1<<-te)-1,_e>>=-te,te+=D;te>0;C=256*C+h[s+oe],oe+=de,te-=8);for(T=C&(1<<-te)-1,C>>=-te,te+=y;te>0;T=256*T+h[s+oe],oe+=de,te-=8);if(C===0)C=1-Z;else{if(C===z)return T?NaN:1/0*(_e?-1:1);T+=Math.pow(2,y),C-=Z}return(_e?-1:1)*T*Math.pow(2,C-y)},EP=function(h,s,f,y,E,C){var T,D,z,Z=8*C-E-1,te=(1<<Z)-1,oe=te>>1,de=E===23?Math.pow(2,-24)-Math.pow(2,-77):0,_e=y?0:C-1,Ee=y?1:-1,Re=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(D=isNaN(s)?1:0,T=te):(T=Math.floor(Math.log(s)/Math.LN2),s*(z=Math.pow(2,-T))<1&&(T--,z*=2),(s+=T+oe>=1?de/z:de*Math.pow(2,1-oe))*z>=2&&(T++,z/=2),T+oe>=te?(D=0,T=te):T+oe>=1?(D=(s*z-1)*Math.pow(2,E),T+=oe):(D=s*Math.pow(2,oe-1)*Math.pow(2,E),T=0));E>=8;h[f+_e]=255&D,_e+=Ee,D/=256,E-=8);for(T=T<<E|D,Z+=E;Z>0;h[f+_e]=255&T,_e+=Ee,T/=256,Z-=8);h[f+_e-Ee]|=128*Re};function ai(h){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(h)?h:new Uint8Array(h||0),this.pos=0,this.type=0,this.length=this.buf.length}ai.Varint=0,ai.Fixed64=1,ai.Bytes=2,ai.Fixed32=5;var T0=4294967296,SP=1/T0,PP=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function zl(h){return h.type===ai.Bytes?h.readVarint()+h.pos:h.pos+1}function Nh(h,s,f){return f?4294967296*s+(h>>>0):4294967296*(s>>>0)+(h>>>0)}function AP(h,s,f){var y=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));f.realloc(y);for(var E=f.pos-1;E>=h;E--)f.buf[E+y]=f.buf[E]}function Gk(h,s){for(var f=0;f<h.length;f++)s.writeVarint(h[f])}function qk(h,s){for(var f=0;f<h.length;f++)s.writeSVarint(h[f])}function Vk(h,s){for(var f=0;f<h.length;f++)s.writeFloat(h[f])}function Xk(h,s){for(var f=0;f<h.length;f++)s.writeDouble(h[f])}function Yk(h,s){for(var f=0;f<h.length;f++)s.writeBoolean(h[f])}function Wk(h,s){for(var f=0;f<h.length;f++)s.writeFixed32(h[f])}function Zk(h,s){for(var f=0;f<h.length;f++)s.writeSFixed32(h[f])}function Hk(h,s){for(var f=0;f<h.length;f++)s.writeFixed64(h[f])}function Jk(h,s){for(var f=0;f<h.length;f++)s.writeSFixed64(h[f])}function Tg(h,s){return(h[s]|h[s+1]<<8|h[s+2]<<16)+16777216*h[s+3]}function Fh(h,s,f){h[f]=s,h[f+1]=s>>>8,h[f+2]=s>>>16,h[f+3]=s>>>24}function IP(h,s){return(h[s]|h[s+1]<<8|h[s+2]<<16)+(h[s+3]<<24)}ai.prototype={destroy:function(){this.buf=null},readFields:function(h,s,f){for(f=f||this.length;this.pos<f;){var y=this.readVarint(),E=y>>3,C=this.pos;this.type=7&y,h(E,s,this),this.pos===C&&this.skip(y)}return s},readMessage:function(h,s){return this.readFields(h,s,this.readVarint()+this.pos)},readFixed32:function(){var h=Tg(this.buf,this.pos);return this.pos+=4,h},readSFixed32:function(){var h=IP(this.buf,this.pos);return this.pos+=4,h},readFixed64:function(){var h=Tg(this.buf,this.pos)+Tg(this.buf,this.pos+4)*T0;return this.pos+=8,h},readSFixed64:function(){var h=Tg(this.buf,this.pos)+IP(this.buf,this.pos+4)*T0;return this.pos+=8,h},readFloat:function(){var h=wP(this.buf,this.pos,!0,23,4);return this.pos+=4,h},readDouble:function(){var h=wP(this.buf,this.pos,!0,52,8);return this.pos+=8,h},readVarint:function(h){var s,f,y=this.buf;return s=127&(f=y[this.pos++]),f<128?s:(s|=(127&(f=y[this.pos++]))<<7,f<128?s:(s|=(127&(f=y[this.pos++]))<<14,f<128?s:(s|=(127&(f=y[this.pos++]))<<21,f<128?s:function(E,C,T){var D,z,Z=T.buf;if(D=(112&(z=Z[T.pos++]))>>4,z<128||(D|=(127&(z=Z[T.pos++]))<<3,z<128)||(D|=(127&(z=Z[T.pos++]))<<10,z<128)||(D|=(127&(z=Z[T.pos++]))<<17,z<128)||(D|=(127&(z=Z[T.pos++]))<<24,z<128)||(D|=(1&(z=Z[T.pos++]))<<31,z<128))return Nh(E,D,C);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(f=y[this.pos]))<<28,h,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var h=this.readVarint();return h%2==1?(h+1)/-2:h/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var h=this.readVarint()+this.pos,s=this.pos;return this.pos=h,h-s>=12&&PP?function(f,y,E){return PP.decode(f.subarray(y,E))}(this.buf,s,h):function(f,y,E){for(var C="",T=y;T<E;){var D,z,Z,te=f[T],oe=null,de=te>239?4:te>223?3:te>191?2:1;if(T+de>E)break;de===1?te<128&&(oe=te):de===2?(192&(D=f[T+1]))==128&&(oe=(31&te)<<6|63&D)<=127&&(oe=null):de===3?(z=f[T+2],(192&(D=f[T+1]))==128&&(192&z)==128&&((oe=(15&te)<<12|(63&D)<<6|63&z)<=2047||oe>=55296&&oe<=57343)&&(oe=null)):de===4&&(z=f[T+2],Z=f[T+3],(192&(D=f[T+1]))==128&&(192&z)==128&&(192&Z)==128&&((oe=(15&te)<<18|(63&D)<<12|(63&z)<<6|63&Z)<=65535||oe>=1114112)&&(oe=null)),oe===null?(oe=65533,de=1):oe>65535&&(oe-=65536,C+=String.fromCharCode(oe>>>10&1023|55296),oe=56320|1023&oe),C+=String.fromCharCode(oe),T+=de}return C}(this.buf,s,h)},readBytes:function(){var h=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,h);return this.pos=h,s},readPackedVarint:function(h,s){if(this.type!==ai.Bytes)return h.push(this.readVarint(s));var f=zl(this);for(h=h||[];this.pos<f;)h.push(this.readVarint(s));return h},readPackedSVarint:function(h){if(this.type!==ai.Bytes)return h.push(this.readSVarint());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readSVarint());return h},readPackedBoolean:function(h){if(this.type!==ai.Bytes)return h.push(this.readBoolean());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readBoolean());return h},readPackedFloat:function(h){if(this.type!==ai.Bytes)return h.push(this.readFloat());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readFloat());return h},readPackedDouble:function(h){if(this.type!==ai.Bytes)return h.push(this.readDouble());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readDouble());return h},readPackedFixed32:function(h){if(this.type!==ai.Bytes)return h.push(this.readFixed32());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readFixed32());return h},readPackedSFixed32:function(h){if(this.type!==ai.Bytes)return h.push(this.readSFixed32());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readSFixed32());return h},readPackedFixed64:function(h){if(this.type!==ai.Bytes)return h.push(this.readFixed64());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readFixed64());return h},readPackedSFixed64:function(h){if(this.type!==ai.Bytes)return h.push(this.readSFixed64());var s=zl(this);for(h=h||[];this.pos<s;)h.push(this.readSFixed64());return h},skip:function(h){var s=7&h;if(s===ai.Varint)for(;this.buf[this.pos++]>127;);else if(s===ai.Bytes)this.pos=this.readVarint()+this.pos;else if(s===ai.Fixed32)this.pos+=4;else{if(s!==ai.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(h,s){this.writeVarint(h<<3|s)},realloc:function(h){for(var s=this.length||16;s<this.pos+h;)s*=2;if(s!==this.length){var f=new Uint8Array(s);f.set(this.buf),this.buf=f,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(h){this.realloc(4),Fh(this.buf,h,this.pos),this.pos+=4},writeSFixed32:function(h){this.realloc(4),Fh(this.buf,h,this.pos),this.pos+=4},writeFixed64:function(h){this.realloc(8),Fh(this.buf,-1&h,this.pos),Fh(this.buf,Math.floor(h*SP),this.pos+4),this.pos+=8},writeSFixed64:function(h){this.realloc(8),Fh(this.buf,-1&h,this.pos),Fh(this.buf,Math.floor(h*SP),this.pos+4),this.pos+=8},writeVarint:function(h){(h=+h||0)>268435455||h<0?function(s,f){var y,E;if(s>=0?(y=s%4294967296|0,E=s/4294967296|0):(E=~(-s/4294967296),4294967295^(y=~(-s%4294967296))?y=y+1|0:(y=0,E=E+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(C,T,D){D.buf[D.pos++]=127&C|128,C>>>=7,D.buf[D.pos++]=127&C|128,C>>>=7,D.buf[D.pos++]=127&C|128,C>>>=7,D.buf[D.pos++]=127&C|128,D.buf[D.pos]=127&(C>>>=7)}(y,0,f),function(C,T){var D=(7&C)<<4;T.buf[T.pos++]|=D|((C>>>=3)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C)))))}(E,f)}(h,this):(this.realloc(4),this.buf[this.pos++]=127&h|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=h>>>7&127))))},writeSVarint:function(h){this.writeVarint(h<0?2*-h-1:2*h)},writeBoolean:function(h){this.writeVarint(!!h)},writeString:function(h){h=String(h),this.realloc(4*h.length),this.pos++;var s=this.pos;this.pos=function(y,E,C){for(var T,D,z=0;z<E.length;z++){if((T=E.charCodeAt(z))>55295&&T<57344){if(!D){T>56319||z+1===E.length?(y[C++]=239,y[C++]=191,y[C++]=189):D=T;continue}if(T<56320){y[C++]=239,y[C++]=191,y[C++]=189,D=T;continue}T=D-55296<<10|T-56320|65536,D=null}else D&&(y[C++]=239,y[C++]=191,y[C++]=189,D=null);T<128?y[C++]=T:(T<2048?y[C++]=T>>6|192:(T<65536?y[C++]=T>>12|224:(y[C++]=T>>18|240,y[C++]=T>>12&63|128),y[C++]=T>>6&63|128),y[C++]=63&T|128)}return C}(this.buf,h,this.pos);var f=this.pos-s;f>=128&&AP(s,f,this),this.pos=s-1,this.writeVarint(f),this.pos+=f},writeFloat:function(h){this.realloc(4),EP(this.buf,h,this.pos,!0,23,4),this.pos+=4},writeDouble:function(h){this.realloc(8),EP(this.buf,h,this.pos,!0,52,8),this.pos+=8},writeBytes:function(h){var s=h.length;this.writeVarint(s),this.realloc(s);for(var f=0;f<s;f++)this.buf[this.pos++]=h[f]},writeRawMessage:function(h,s){this.pos++;var f=this.pos;h(s,this);var y=this.pos-f;y>=128&&AP(f,y,this),this.pos=f-1,this.writeVarint(y),this.pos+=y},writeMessage:function(h,s,f){this.writeTag(h,ai.Bytes),this.writeRawMessage(s,f)},writePackedVarint:function(h,s){s.length&&this.writeMessage(h,Gk,s)},writePackedSVarint:function(h,s){s.length&&this.writeMessage(h,qk,s)},writePackedBoolean:function(h,s){s.length&&this.writeMessage(h,Yk,s)},writePackedFloat:function(h,s){s.length&&this.writeMessage(h,Vk,s)},writePackedDouble:function(h,s){s.length&&this.writeMessage(h,Xk,s)},writePackedFixed32:function(h,s){s.length&&this.writeMessage(h,Wk,s)},writePackedSFixed32:function(h,s){s.length&&this.writeMessage(h,Zk,s)},writePackedFixed64:function(h,s){s.length&&this.writeMessage(h,Hk,s)},writePackedSFixed64:function(h,s){s.length&&this.writeMessage(h,Jk,s)},writeBytesField:function(h,s){this.writeTag(h,ai.Bytes),this.writeBytes(s)},writeFixed32Field:function(h,s){this.writeTag(h,ai.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(h,s){this.writeTag(h,ai.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(h,s){this.writeTag(h,ai.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(h,s){this.writeTag(h,ai.Fixed64),this.writeSFixed64(s)},writeVarintField:function(h,s){this.writeTag(h,ai.Varint),this.writeVarint(s)},writeSVarintField:function(h,s){this.writeTag(h,ai.Varint),this.writeSVarint(s)},writeStringField:function(h,s){this.writeTag(h,ai.Bytes),this.writeString(s)},writeFloatField:function(h,s){this.writeTag(h,ai.Fixed32),this.writeFloat(s)},writeDoubleField:function(h,s){this.writeTag(h,ai.Fixed64),this.writeDouble(s)},writeBooleanField:function(h,s){this.writeVarintField(h,!!s)}};var M0=_(xP);const L0=3;function Kk(h,s,f){h===1&&f.readMessage(Qk,s)}function Qk(h,s,f){if(h===3){const{id:y,bitmap:E,width:C,height:T,left:D,top:z,advance:Z}=f.readMessage(e3,{});s.push({id:y,bitmap:new Jf({width:C+2*L0,height:T+2*L0},E),metrics:{width:C,height:T,left:D,top:z,advance:Z}})}}function e3(h,s,f){h===1?s.id=f.readVarint():h===2?s.bitmap=f.readBytes():h===3?s.width=f.readVarint():h===4?s.height=f.readVarint():h===5?s.left=f.readSVarint():h===6?s.top=f.readSVarint():h===7&&(s.advance=f.readVarint())}const OP=L0;function CP(h){let s=0,f=0;for(const T of h)s+=T.w*T.h,f=Math.max(f,T.w);h.sort((T,D)=>D.h-T.h);const y=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),f),h:1/0}];let E=0,C=0;for(const T of h)for(let D=y.length-1;D>=0;D--){const z=y[D];if(!(T.w>z.w||T.h>z.h)){if(T.x=z.x,T.y=z.y,C=Math.max(C,T.y+T.h),E=Math.max(E,T.x+T.w),T.w===z.w&&T.h===z.h){const Z=y.pop();D<y.length&&(y[D]=Z)}else T.h===z.h?(z.x+=T.w,z.w-=T.w):T.w===z.w?(z.y+=T.h,z.h-=T.h):(y.push({x:z.x+T.w,y:z.y,w:z.w-T.w,h:T.h}),z.y+=T.h,z.h-=T.h);break}}return{w:E,h:C,fill:s/(E*C)||0}}const ws=1;class R0{constructor(s,{pixelRatio:f,version:y,stretchX:E,stretchY:C,content:T}){this.paddedRect=s,this.pixelRatio=f,this.stretchX=E,this.stretchY=C,this.content=T,this.version=y}get tl(){return[this.paddedRect.x+ws,this.paddedRect.y+ws]}get br(){return[this.paddedRect.x+this.paddedRect.w-ws,this.paddedRect.y+this.paddedRect.h-ws]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ws)/this.pixelRatio,(this.paddedRect.h-2*ws)/this.pixelRatio]}}class TP{constructor(s,f){const y={},E={};this.haveRenderCallbacks=[];const C=[];this.addImages(s,y,C),this.addImages(f,E,C);const{w:T,h:D}=CP(C),z=new lu({width:T||1,height:D||1});for(const Z in s){const te=s[Z],oe=y[Z].paddedRect;lu.copy(te.data,z,{x:0,y:0},{x:oe.x+ws,y:oe.y+ws},te.data)}for(const Z in f){const te=f[Z],oe=E[Z].paddedRect,de=oe.x+ws,_e=oe.y+ws,Ee=te.data.width,Re=te.data.height;lu.copy(te.data,z,{x:0,y:0},{x:de,y:_e},te.data),lu.copy(te.data,z,{x:0,y:Re-1},{x:de,y:_e-1},{width:Ee,height:1}),lu.copy(te.data,z,{x:0,y:0},{x:de,y:_e+Re},{width:Ee,height:1}),lu.copy(te.data,z,{x:Ee-1,y:0},{x:de-1,y:_e},{width:1,height:Re}),lu.copy(te.data,z,{x:0,y:0},{x:de+Ee,y:_e},{width:1,height:Re})}this.image=z,this.iconPositions=y,this.patternPositions=E}addImages(s,f,y){for(const E in s){const C=s[E],T={x:0,y:0,w:C.data.width+2*ws,h:C.data.height+2*ws};y.push(T),f[E]=new R0(T,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(E)}}patchUpdatedImages(s,f){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const y in s.updatedImages)this.patchUpdatedImage(this.iconPositions[y],s.getImage(y),f),this.patchUpdatedImage(this.patternPositions[y],s.getImage(y),f)}patchUpdatedImage(s,f,y){if(!s||!f||s.version===f.version)return;s.version=f.version;const[E,C]=s.tl;y.update(f.data,void 0,{x:E,y:C})}}var cc;Yt("ImagePosition",R0),Yt("ImageAtlas",TP),u.WritingMode=void 0,(cc=u.WritingMode||(u.WritingMode={}))[cc.none=0]="none",cc[cc.horizontal=1]="horizontal",cc[cc.vertical=2]="vertical",cc[cc.horizontalOnly=3]="horizontalOnly";const op=-17;class ap{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,f){const y=new ap;return y.scale=s||1,y.fontStack=f,y}static forImage(s){const f=new ap;return f.imageName=s,f}}class kh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,f){const y=new kh;for(let E=0;E<s.sections.length;E++){const C=s.sections[E];C.image?y.addImageSection(C):y.addTextSection(C,f)}return y}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let f="";for(let y=0;y<s.length;y++){const E=s.charCodeAt(y+1)||null,C=s.charCodeAt(y-1)||null;f+=E&&Za(E)&&!ip[s[y+1]]||C&&Za(C)&&!ip[s[y-1]]||!ip[s[y]]?s[y]:ip[s[y]]}return f}(this.text)}trim(){let s=0;for(let y=0;y<this.text.length&&Lg[this.text.charCodeAt(y)];y++)s++;let f=this.text.length;for(let y=this.text.length-1;y>=0&&y>=s&&Lg[this.text.charCodeAt(y)];y--)f--;this.text=this.text.substring(s,f),this.sectionIndex=this.sectionIndex.slice(s,f)}substring(s,f){const y=new kh;return y.text=this.text.substring(s,f),y.sectionIndex=this.sectionIndex.slice(s,f),y.sections=this.sections,y}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,f)=>Math.max(s,this.sections[f].scale),0)}addTextSection(s,f){this.text+=s.text,this.sections.push(ap.forText(s.scale,s.fontStack||f));const y=this.sections.length-1;for(let E=0;E<s.text.length;++E)this.sectionIndex.push(y)}addImageSection(s){const f=s.image?s.image.name:"";if(f.length===0)return void W("Can't add FormattedSection with an empty image.");const y=this.getNextImageSectionCharCode();y?(this.text+=String.fromCharCode(y),this.sections.push(ap.forImage(f)),this.sectionIndex.push(this.sections.length-1)):W("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Mg(h,s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re){const ze=kh.fromFeature(h,E);let Ge;oe===u.WritingMode.vertical&&ze.verticalizePunctuation();const{processBidirectionalText:nt,processStyledBidirectionalText:Ze}=Jn;if(nt&&ze.sections.length===1){Ge=[];const xt=nt(ze.toString(),D0(ze,Z,C,s,y,_e,Ee));for(const qt of xt){const cr=new kh;cr.text=qt,cr.sections=ze.sections;for(let Gt=0;Gt<qt.length;Gt++)cr.sectionIndex.push(0);Ge.push(cr)}}else if(Ze){Ge=[];const xt=Ze(ze.text,ze.sectionIndex,D0(ze,Z,C,s,y,_e,Ee));for(const qt of xt){const cr=new kh;cr.text=qt[0],cr.sectionIndex=qt[1],cr.sections=ze.sections,Ge.push(cr)}}else Ge=function(xt,qt){const cr=[],Gt=xt.text;let Bt=0;for(const Dt of qt)cr.push(xt.substring(Bt,Dt)),Bt=Dt;return Bt<Gt.length&&cr.push(xt.substring(Bt,Gt.length)),cr}(ze,D0(ze,Z,C,s,y,_e,Ee));const ot=[],st={positionedLines:ot,text:ze.toString(),top:te[1],bottom:te[1],left:te[0],right:te[0],writingMode:oe,iconsInText:!1,verticalizable:!1};return function(xt,qt,cr,Gt,Bt,Dt,Jt,Ft,At,br,pr,Jr){let bi=0,Oi=op,Do=0,Gs=0;const rs=Ft==="right"?1:Ft==="left"?0:.5;let bo=0;for(const xo of Bt){xo.trim();const No=xo.getMaxScale(),Da=(No-1)*Ro,is={positionedGlyphs:[],lineOffset:0};xt.positionedLines[bo]=is;const Ss=is.positionedGlyphs;let Ps=0;if(!xo.length()){Oi+=Dt,++bo;continue}for(let xa=0;xa<xo.length();xa++){const on=xo.getSection(xa),qs=xo.getSectionIndex(xa),wa=xo.getCharCode(xa);let os=0,Tu=null,ju=null,Uu=null,jl=Ro;const Mu=!(At===u.WritingMode.horizontal||!pr&&!Oo(wa)||pr&&(Lg[wa]||($o=wa,It.Arabic($o)||It["Arabic Supplement"]($o)||It["Arabic Extended-A"]($o)||It["Arabic Presentation Forms-A"]($o)||It["Arabic Presentation Forms-B"]($o))));if(on.imageName){const hu=Gt[on.imageName];if(!hu)continue;Uu=on.imageName,xt.iconsInText=xt.iconsInText||!0,ju=hu.paddedRect;const As=hu.displaySize;on.scale=on.scale*Ro/Jr,Tu={width:As[0],height:As[1],left:ws,top:-OP,advance:Mu?As[1]:As[0]},os=Da+(Ro-As[1]*on.scale),jl=Tu.advance;const Ul=Mu?As[0]*on.scale-Ro*No:As[1]*on.scale-Ro*No;Ul>0&&Ul>Ps&&(Ps=Ul)}else{const hu=cr[on.fontStack],As=hu&&hu[wa];if(As&&As.rect)ju=As.rect,Tu=As.metrics;else{const Ul=qt[on.fontStack],hp=Ul&&Ul[wa];if(!hp)continue;Tu=hp.metrics}os=(No-on.scale)*Ro}Mu?(xt.verticalizable=!0,Ss.push({glyph:wa,imageName:Uu,x:bi,y:Oi+os,vertical:Mu,scale:on.scale,fontStack:on.fontStack,sectionIndex:qs,metrics:Tu,rect:ju}),bi+=jl*on.scale+br):(Ss.push({glyph:wa,imageName:Uu,x:bi,y:Oi+os,vertical:Mu,scale:on.scale,fontStack:on.fontStack,sectionIndex:qs,metrics:Tu,rect:ju}),bi+=Tu.advance*on.scale+br)}Ss.length!==0&&(Do=Math.max(bi-br,Do),n3(Ss,0,Ss.length-1,rs,Ps)),bi=0;const no=Dt*No+Ps;is.lineOffset=Math.max(Ps,Da),Oi+=no,Gs=Math.max(no,Gs),++bo}var $o;const ba=Oi-op,{horizontalAlign:Es,verticalAlign:ns}=N0(Jt);(function(xo,No,Da,is,Ss,Ps,no,xa,on){const qs=(No-Da)*Ss;let wa=0;wa=Ps!==no?-xa*is-op:(-is*on+.5)*no;for(const os of xo)for(const Tu of os.positionedGlyphs)Tu.x+=qs,Tu.y+=wa})(xt.positionedLines,rs,Es,ns,Do,Gs,Dt,ba,Bt.length),xt.top+=-ns*ba,xt.bottom=xt.top+ba,xt.left+=-Es*Do,xt.right=xt.left+Do}(st,s,f,y,Ge,T,D,z,oe,Z,de,Re),!function(xt){for(const qt of xt)if(qt.positionedGlyphs.length!==0)return!1;return!0}(ot)&&st}const Lg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},t3={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function MP(h,s,f,y,E,C){if(s.imageName){const T=y[s.imageName];return T?T.displaySize[0]*s.scale*Ro/C+E:0}{const T=f[s.fontStack],D=T&&T[h];return D?D.metrics.advance*s.scale+E:0}}function LP(h,s,f,y){const E=Math.pow(h-s,2);return y?h<s?E/2:2*E:E+Math.abs(f)*f}function r3(h,s,f){let y=0;return h===10&&(y-=1e4),f&&(y+=150),h!==40&&h!==65288||(y+=50),s!==41&&s!==65289||(y+=50),y}function RP(h,s,f,y,E,C){let T=null,D=LP(s,f,E,C);for(const z of y){const Z=LP(s-z.x,f,E,C)+z.badness;Z<=D&&(T=z,D=Z)}return{index:h,x:s,priorBreak:T,badness:D}}function DP(h){return h?DP(h.priorBreak).concat(h.index):[]}function D0(h,s,f,y,E,C,T){if(C!=="point")return[];if(!h)return[];const D=[],z=function(de,_e,Ee,Re,ze,Ge){let nt=0;for(let Ze=0;Ze<de.length();Ze++){const ot=de.getSection(Ze);nt+=MP(de.getCharCode(Ze),ot,Re,ze,_e,Ge)}return nt/Math.max(1,Math.ceil(nt/Ee))}(h,s,f,y,E,T),Z=h.text.indexOf("​")>=0;let te=0;for(let de=0;de<h.length();de++){const _e=h.getSection(de),Ee=h.getCharCode(de);if(Lg[Ee]||(te+=MP(Ee,_e,y,E,s,T)),de<h.length()-1){const Re=!((oe=Ee)<11904||!(It["Bopomofo Extended"](oe)||It.Bopomofo(oe)||It["CJK Compatibility Forms"](oe)||It["CJK Compatibility Ideographs"](oe)||It["CJK Compatibility"](oe)||It["CJK Radicals Supplement"](oe)||It["CJK Strokes"](oe)||It["CJK Symbols and Punctuation"](oe)||It["CJK Unified Ideographs Extension A"](oe)||It["CJK Unified Ideographs"](oe)||It["Enclosed CJK Letters and Months"](oe)||It["Halfwidth and Fullwidth Forms"](oe)||It.Hiragana(oe)||It["Ideographic Description Characters"](oe)||It["Kangxi Radicals"](oe)||It["Katakana Phonetic Extensions"](oe)||It.Katakana(oe)||It["Vertical Forms"](oe)||It["Yi Radicals"](oe)||It["Yi Syllables"](oe)));(t3[Ee]||Re||_e.imageName)&&D.push(RP(de+1,te,z,D,r3(Ee,h.getCharCode(de+1),Re&&Z),!1))}}var oe;return DP(RP(h.length(),te,z,D,0,!0))}function N0(h){let s=.5,f=.5;switch(h){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}return{horizontalAlign:s,verticalAlign:f}}function n3(h,s,f,y,E){if(!y&&!E)return;const C=h[f],T=(h[f].x+C.metrics.advance*C.scale)*y;for(let D=s;D<=f;D++)h[D].x-=T,h[D].y+=E}function i3(h,s,f){const{horizontalAlign:y,verticalAlign:E}=N0(f),C=s[0]-h.displaySize[0]*y,T=s[1]-h.displaySize[1]*E;return{image:h,top:T,bottom:T+h.displaySize[1],left:C,right:C+h.displaySize[0]}}function NP(h,s,f,y,E,C){const T=h.image;let D;if(T.content){const ze=T.content,Ge=T.pixelRatio||1;D=[ze[0]/Ge,ze[1]/Ge,T.displaySize[0]-ze[2]/Ge,T.displaySize[1]-ze[3]/Ge]}const z=s.left*C,Z=s.right*C;let te,oe,de,_e;f==="width"||f==="both"?(_e=E[0]+z-y[3],oe=E[0]+Z+y[1]):(_e=E[0]+(z+Z-T.displaySize[0])/2,oe=_e+T.displaySize[0]);const Ee=s.top*C,Re=s.bottom*C;return f==="height"||f==="both"?(te=E[1]+Ee-y[0],de=E[1]+Re+y[2]):(te=E[1]+(Ee+Re-T.displaySize[1])/2,de=te+T.displaySize[1]),{image:T,top:te,right:oe,bottom:de,left:_e,collisionPadding:D}}const sp=255,hl=128,hc=sp*hl;function FP(h,s){const{expression:f}=s;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new Kn(h+1))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:y,interpolationType:E}=f;let C=0;for(;C<y.length&&y[C]<=h;)C++;C=Math.max(0,C-1);let T=C;for(;T<y.length&&y[T]<h+1;)T++;T=Math.min(y.length-1,T);const D=y[C],z=y[T];return f.kind==="composite"?{kind:"composite",minZoom:D,maxZoom:z,interpolationType:E}:{kind:"camera",minZoom:D,maxZoom:z,minSize:f.evaluate(new Kn(D)),maxSize:f.evaluate(new Kn(z)),interpolationType:E}}}function F0(h,s,f){let y="never";const E=h.get(s);return E?y=E:h.get(f)&&(y="always"),y}const o3=lc.VectorTileFeature.types,a3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Rg(h,s,f,y,E,C,T,D,z,Z,te,oe,de){const _e=D?Math.min(hc,Math.round(D[0])):0,Ee=D?Math.min(hc,Math.round(D[1])):0;h.emplaceBack(s,f,Math.round(32*y),Math.round(32*E),C,T,(_e<<1)+(z?1:0),Ee,16*Z,16*te,256*oe,256*de)}function k0(h,s,f){h.emplaceBack(s.x,s.y,f),h.emplaceBack(s.x,s.y,f),h.emplaceBack(s.x,s.y,f),h.emplaceBack(s.x,s.y,f)}function s3(h){for(const s of h.sections)if(Su(s.text))return!0;return!1}class B0{constructor(s){this.layoutVertexArray=new wt,this.indexArray=new gr,this.programConfigurations=s,this.segments=new _r,this.dynamicLayoutVertexArray=new Mt,this.opacityVertexArray=new lr,this.hasVisibleVertices=!1,this.placedSymbolArray=new Y}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,f,y,E){this.isEmpty()||(y&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Bk.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,zk.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,a3,!0),this.opacityVertexBuffer.itemSize=1),(y||E)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Yt("SymbolBuffers",B0);class z0{constructor(s,f,y){this.layoutVertexArray=new s,this.layoutAttributes=f,this.indexArray=new y,this.segments=new _r,this.collisionVertexArray=new kt}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,jk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Yt("CollisionBuffers",z0);class Bh{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(T=>T.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=m0([]),this.placementViewportMatrix=m0([]);const f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=FP(this.zoom,f["text-size"]),this.iconSizeData=FP(this.zoom,f["icon-size"]);const y=this.layers[0].layout,E=y.get("symbol-sort-key"),C=y.get("symbol-z-order");this.canOverlap=F0(y,"text-overlap","text-allow-overlap")!=="never"||F0(y,"icon-overlap","icon-allow-overlap")!=="never"||y.get("text-ignore-placement")||y.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!E.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,y.get("symbol-placement")==="point"&&(this.writingModes=y.get("text-writing-mode").map(T=>u.WritingMode[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=s.sourceID}createArrays(){this.text=new B0(new kl(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new B0(new kl(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new me,this.lineVertexArray=new Me,this.symbolInstances=new re,this.textAnchorOffsets=new Fe}calculateGlyphDependencies(s,f,y,E,C){for(let T=0;T<s.length;T++)if(f[s.charCodeAt(T)]=!0,(y||E)&&C){const D=ip[s.charAt(T)];D&&(f[D.charCodeAt(0)]=!0)}}populate(s,f,y){const E=this.layers[0],C=E.layout,T=C.get("text-font"),D=C.get("text-field"),z=C.get("icon-image"),Z=(D.value.kind!=="constant"||D.value.value instanceof Vr&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),te=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,oe=C.get("symbol-sort-key");if(this.features=[],!Z&&!te)return;const de=f.iconDependencies,_e=f.glyphDependencies,Ee=f.availableImages,Re=new Kn(this.zoom);for(const{feature:ze,id:Ge,index:nt,sourceLayerIndex:Ze}of s){const ot=E._featureFilter.needGeometry,st=cl(ze,ot);if(!E._featureFilter.filter(Re,st,y))continue;let xt,qt;if(ot||(st.geometry=zu(ze)),Z){const Gt=E.getValueAndResolveTokens("text-field",st,y,Ee),Bt=Vr.factory(Gt);s3(Bt)&&(this.hasRTLText=!0),(!this.hasRTLText||ys()==="unavailable"||this.hasRTLText&&Jn.isParsed())&&(xt=$k(Bt,E,st))}if(te){const Gt=E.getValueAndResolveTokens("icon-image",st,y,Ee);qt=Gt instanceof hi?Gt:hi.fromString(Gt)}if(!xt&&!qt)continue;const cr=this.sortFeaturesByKey?oe.evaluate(st,{},y):void 0;if(this.features.push({id:Ge,text:xt,icon:qt,index:nt,sourceLayerIndex:Ze,geometry:st.geometry,properties:ze.properties,type:o3[ze.type],sortKey:cr}),qt&&(de[qt.name]=!0),xt){const Gt=T.evaluate(st,{},y).join(","),Bt=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.WritingMode.vertical)>=0;for(const Dt of xt.sections)if(Dt.image)de[Dt.image.name]=!0;else{const Jt=sl(xt.toString()),Ft=Dt.fontStack||Gt,At=_e[Ft]=_e[Ft]||{};this.calculateGlyphDependencies(Dt.text,At,Bt,this.allowVerticalPlacement,Jt)}}}C.get("symbol-placement")==="line"&&(this.features=function(ze){const Ge={},nt={},Ze=[];let ot=0;function st(Gt){Ze.push(ze[Gt]),ot++}function xt(Gt,Bt,Dt){const Jt=nt[Gt];return delete nt[Gt],nt[Bt]=Jt,Ze[Jt].geometry[0].pop(),Ze[Jt].geometry[0]=Ze[Jt].geometry[0].concat(Dt[0]),Jt}function qt(Gt,Bt,Dt){const Jt=Ge[Bt];return delete Ge[Bt],Ge[Gt]=Jt,Ze[Jt].geometry[0].shift(),Ze[Jt].geometry[0]=Dt[0].concat(Ze[Jt].geometry[0]),Jt}function cr(Gt,Bt,Dt){const Jt=Dt?Bt[0][Bt[0].length-1]:Bt[0][0];return`${Gt}:${Jt.x}:${Jt.y}`}for(let Gt=0;Gt<ze.length;Gt++){const Bt=ze[Gt],Dt=Bt.geometry,Jt=Bt.text?Bt.text.toString():null;if(!Jt){st(Gt);continue}const Ft=cr(Jt,Dt),At=cr(Jt,Dt,!0);if(Ft in nt&&At in Ge&&nt[Ft]!==Ge[At]){const br=qt(Ft,At,Dt),pr=xt(Ft,At,Ze[br].geometry);delete Ge[Ft],delete nt[At],nt[cr(Jt,Ze[pr].geometry,!0)]=pr,Ze[br].geometry=null}else Ft in nt?xt(Ft,At,Dt):At in Ge?qt(Ft,At,Dt):(st(Gt),Ge[Ft]=ot-1,nt[At]=ot-1)}return Ze.filter(Gt=>Gt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ze,Ge)=>ze.sortKey-Ge.sortKey)}update(s,f,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,f,this.layers,y),this.icon.programConfigurations.updatePaintArrays(s,f,this.layers,y))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,f){const y=this.lineVertexArray.length;if(s.segment!==void 0){let E=s.dist(f[s.segment+1]),C=s.dist(f[s.segment]);const T={};for(let D=s.segment+1;D<f.length;D++)T[D]={x:f[D].x,y:f[D].y,tileUnitDistanceFromAnchor:E},D<f.length-1&&(E+=f[D+1].dist(f[D]));for(let D=s.segment||0;D>=0;D--)T[D]={x:f[D].x,y:f[D].y,tileUnitDistanceFromAnchor:C},D>0&&(C+=f[D-1].dist(f[D]));for(let D=0;D<f.length;D++){const z=T[D];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:y,lineLength:this.lineVertexArray.length-y}}addSymbols(s,f,y,E,C,T,D,z,Z,te,oe,de){const _e=s.indexArray,Ee=s.layoutVertexArray,Re=s.segments.prepareSegment(4*f.length,Ee,_e,this.canOverlap?T.sortKey:void 0),ze=this.glyphOffsetArray.length,Ge=Re.vertexLength,nt=this.allowVerticalPlacement&&D===u.WritingMode.vertical?Math.PI/2:0,Ze=T.text&&T.text.sections;for(let ot=0;ot<f.length;ot++){const{tl:st,tr:xt,bl:qt,br:cr,tex:Gt,pixelOffsetTL:Bt,pixelOffsetBR:Dt,minFontScaleX:Jt,minFontScaleY:Ft,glyphOffset:At,isSDF:br,sectionIndex:pr}=f[ot],Jr=Re.vertexLength,bi=At[1];Rg(Ee,z.x,z.y,st.x,bi+st.y,Gt.x,Gt.y,y,br,Bt.x,Bt.y,Jt,Ft),Rg(Ee,z.x,z.y,xt.x,bi+xt.y,Gt.x+Gt.w,Gt.y,y,br,Dt.x,Bt.y,Jt,Ft),Rg(Ee,z.x,z.y,qt.x,bi+qt.y,Gt.x,Gt.y+Gt.h,y,br,Bt.x,Dt.y,Jt,Ft),Rg(Ee,z.x,z.y,cr.x,bi+cr.y,Gt.x+Gt.w,Gt.y+Gt.h,y,br,Dt.x,Dt.y,Jt,Ft),k0(s.dynamicLayoutVertexArray,z,nt),_e.emplaceBack(Jr,Jr+1,Jr+2),_e.emplaceBack(Jr+1,Jr+2,Jr+3),Re.vertexLength+=4,Re.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),ot!==f.length-1&&pr===f[ot+1].sectionIndex||s.programConfigurations.populatePaintArrays(Ee.length,T,T.index,{},de,Ze&&Ze[pr])}s.placedSymbolArray.emplaceBack(z.x,z.y,ze,this.glyphOffsetArray.length-ze,Ge,Z,te,z.segment,y?y[0]:0,y?y[1]:0,E[0],E[1],D,0,!1,0,oe)}_addCollisionDebugVertex(s,f,y,E,C,T){return f.emplaceBack(0,0),s.emplaceBack(y.x,y.y,E,C,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(s,f,y,E,C,T,D){const z=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),Z=z.vertexLength,te=C.layoutVertexArray,oe=C.collisionVertexArray,de=D.anchorX,_e=D.anchorY;this._addCollisionDebugVertex(te,oe,T,de,_e,new P(s,f)),this._addCollisionDebugVertex(te,oe,T,de,_e,new P(y,f)),this._addCollisionDebugVertex(te,oe,T,de,_e,new P(y,E)),this._addCollisionDebugVertex(te,oe,T,de,_e,new P(s,E)),z.vertexLength+=4;const Ee=C.indexArray;Ee.emplaceBack(Z,Z+1),Ee.emplaceBack(Z+1,Z+2),Ee.emplaceBack(Z+2,Z+3),Ee.emplaceBack(Z+3,Z),z.primitiveLength+=4}addDebugCollisionBoxes(s,f,y,E){for(let C=s;C<f;C++){const T=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,E?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,y)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new z0(Qr,bP.members,ar),this.iconCollisionBox=new z0(Qr,bP.members,ar);for(let s=0;s<this.symbolInstances.length;s++){const f=this.symbolInstances.get(s);this.addDebugCollisionBoxes(f.textBoxStartIndex,f.textBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.iconBoxStartIndex,f.iconBoxEndIndex,f,!1),this.addDebugCollisionBoxes(f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f,!1)}}_deserializeCollisionBoxesForSymbol(s,f,y,E,C,T,D,z,Z){const te={};for(let oe=f;oe<y;oe++){const de=s.get(oe);te.textBox={x1:de.x1,y1:de.y1,x2:de.x2,y2:de.y2,anchorPointX:de.anchorPointX,anchorPointY:de.anchorPointY},te.textFeatureIndex=de.featureIndex;break}for(let oe=E;oe<C;oe++){const de=s.get(oe);te.verticalTextBox={x1:de.x1,y1:de.y1,x2:de.x2,y2:de.y2,anchorPointX:de.anchorPointX,anchorPointY:de.anchorPointY},te.verticalTextFeatureIndex=de.featureIndex;break}for(let oe=T;oe<D;oe++){const de=s.get(oe);te.iconBox={x1:de.x1,y1:de.y1,x2:de.x2,y2:de.y2,anchorPointX:de.anchorPointX,anchorPointY:de.anchorPointY},te.iconFeatureIndex=de.featureIndex;break}for(let oe=z;oe<Z;oe++){const de=s.get(oe);te.verticalIconBox={x1:de.x1,y1:de.y1,x2:de.x2,y2:de.y2,anchorPointX:de.anchorPointX,anchorPointY:de.anchorPointY},te.verticalIconFeatureIndex=de.featureIndex;break}return te}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){const y=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,y.textBoxStartIndex,y.textBoxEndIndex,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y.iconBoxStartIndex,y.iconBoxEndIndex,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,f){const y=s.placedSymbolArray.get(f),E=y.vertexStartIndex+4*y.numGlyphs;for(let C=y.vertexStartIndex;C<E;C+=4)s.indexArray.emplaceBack(C,C+1,C+2),s.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const f=Math.sin(s),y=Math.cos(s),E=[],C=[],T=[];for(let D=0;D<this.symbolInstances.length;++D){T.push(D);const z=this.symbolInstances.get(D);E.push(0|Math.round(f*z.anchorX+y*z.anchorY)),C.push(z.featureIndex)}return T.sort((D,z)=>E[D]-E[z]||C[z]-C[D]),T}addToSortKeyRanges(s,f){const y=this.sortKeyRanges[this.sortKeyRanges.length-1];y&&y.sortKey===f?y.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const f of this.symbolInstanceIndexes){const y=this.symbolInstances.get(f);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach((E,C,T)=>{E>=0&&T.indexOf(E)===C&&this.addIndicesForPlacedSymbol(this.text,E)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let kP,BP;Yt("SymbolBucket",Bh,{omit:["layers","collisionBoxArray","features","compareText"]}),Bh.MAX_GLYPHS=65535,Bh.addDynamicAttributes=k0;var j0={get paint(){return BP=BP||new Uo({"icon-opacity":new Er(Ye.paint_symbol["icon-opacity"]),"icon-color":new Er(Ye.paint_symbol["icon-color"]),"icon-halo-color":new Er(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Er(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Er(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new fr(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new fr(Ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new Er(Ye.paint_symbol["text-opacity"]),"text-color":new Er(Ye.paint_symbol["text-color"],{runtimeType:Ar,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new Er(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new Er(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Er(Ye.paint_symbol["text-halo-blur"]),"text-translate":new fr(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new fr(Ye.paint_symbol["text-translate-anchor"])})},get layout(){return kP=kP||new Uo({"symbol-placement":new fr(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new fr(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fr(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Er(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fr(Ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fr(Ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new fr(Ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new fr(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new fr(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fr(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Er(Ye.layout_symbol["icon-size"]),"icon-text-fit":new fr(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fr(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Er(Ye.layout_symbol["icon-image"]),"icon-rotate":new Er(Ye.layout_symbol["icon-rotate"]),"icon-padding":new Er(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new fr(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Er(Ye.layout_symbol["icon-offset"]),"icon-anchor":new Er(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fr(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fr(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fr(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new Er(Ye.layout_symbol["text-field"]),"text-font":new Er(Ye.layout_symbol["text-font"]),"text-size":new Er(Ye.layout_symbol["text-size"]),"text-max-width":new Er(Ye.layout_symbol["text-max-width"]),"text-line-height":new fr(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Er(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new Er(Ye.layout_symbol["text-justify"]),"text-radial-offset":new Er(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fr(Ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Er(Ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Er(Ye.layout_symbol["text-anchor"]),"text-max-angle":new fr(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new fr(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new Er(Ye.layout_symbol["text-rotate"]),"text-padding":new fr(Ye.layout_symbol["text-padding"]),"text-keep-upright":new fr(Ye.layout_symbol["text-keep-upright"]),"text-transform":new Er(Ye.layout_symbol["text-transform"]),"text-offset":new Er(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new fr(Ye.layout_symbol["text-allow-overlap"]),"text-overlap":new fr(Ye.layout_symbol["text-overlap"]),"text-ignore-placement":new fr(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new fr(Ye.layout_symbol["text-optional"])})}};class zP{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:ir,this.defaultValue=s}evaluate(s){if(s.formattedSection){const f=this.defaultValue.property.overrides;if(f&&f.hasOverride(s.formattedSection))return f.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Yt("FormatSectionOverride",zP,{omit:["defaultValue"]});class Dg extends Co{constructor(s){super(s,j0)}recalculate(s,f){if(super.recalculate(s,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const y=this.layout.get("text-writing-mode");if(y){const E=[];for(const C of y)E.indexOf(C)<0&&E.push(C);this.layout._values["text-writing-mode"]=E}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,f,y,E){const C=this.layout.get(s).evaluate(f,{},y,E),T=this._unevaluatedLayout._values[s];return T.isDataDriven()||Li(T.value)||!C?C:function(D,z){return z.replace(/{([^{}]+)}/g,(Z,te)=>te in D?String(D[te]):"")}(f.properties,C)}createBucket(s){return new Bh(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of j0.paint.overridableProperties){if(!Dg.hasPaintOverride(this.layout,s))continue;const f=this.paint.get(s),y=new zP(f),E=new Hn(y,f.property.specification);let C=null;C=f.value.kind==="constant"||f.value.kind==="source"?new wu("source",E):new ln("composite",E,f.value.zoomStops),this.paint._values[s]=new Ja(f.property,C,f.parameters)}}_handleOverridablePaintPropertyUpdate(s,f,y){return!(!this.layout||f.isDataDriven()||y.isDataDriven())&&Dg.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,f){const y=s.get("text-field"),E=j0.paint.properties[f];let C=!1;const T=D=>{for(const z of D)if(E.overrides&&E.overrides.hasOverride(z))return void(C=!0)};if(y.value.kind==="constant"&&y.value.value instanceof Vr)T(y.value.value.sections);else if(y.value.kind==="source"){const D=Z=>{C||(Z instanceof Xo&&Qn(Z.value)===un?T(Z.value.sections):Z instanceof $a?T(Z.sections):Z.eachChild(D))},z=y.value;z._styleExpression&&D(z._styleExpression.expression)}return C}}let jP;var u3={get paint(){return jP=jP||new Uo({"background-color":new fr(Ye.paint_background["background-color"]),"background-pattern":new Au(Ye.paint_background["background-pattern"]),"background-opacity":new fr(Ye.paint_background["background-opacity"])})}};class l3 extends Co{constructor(s){super(s,u3)}}let UP;var c3={get paint(){return UP=UP||new Uo({"raster-opacity":new fr(Ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new fr(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fr(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fr(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new fr(Ye.paint_raster["raster-saturation"]),"raster-contrast":new fr(Ye.paint_raster["raster-contrast"]),"raster-resampling":new fr(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new fr(Ye.paint_raster["raster-fade-duration"])})}};class h3 extends Co{constructor(s){super(s,c3)}}class f3 extends Co{constructor(s){super(s,{}),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class p3{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const U0=63710088e-1;class fc{constructor(s,f){if(isNaN(s)||isNaN(f))throw new Error(`Invalid LngLat object: (${s}, ${f})`);if(this.lng=+s,this.lat=+f,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fc(R(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const f=Math.PI/180,y=this.lat*f,E=s.lat*f,C=Math.sin(y)*Math.sin(E)+Math.cos(y)*Math.cos(E)*Math.cos((s.lng-this.lng)*f);return U0*Math.acos(Math.min(C,1))}static convert(s){if(s instanceof fc)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new fc(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new fc(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const $P=2*Math.PI*U0;function GP(h){return $P*Math.cos(h*Math.PI/180)}function qP(h){return(180+h)/360}function VP(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function XP(h,s){return h/GP(s)}function $0(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}class Ng{constructor(s,f,y=0){this.x=+s,this.y=+f,this.z=+y}static fromLngLat(s,f=0){const y=fc.convert(s);return new Ng(qP(y.lng),VP(y.lat),XP(f,y.lat))}toLngLat(){return new fc(360*this.x-180,$0(this.y))}toAltitude(){return this.z*GP($0(this.y))}meterInMercatorCoordinateUnits(){return 1/$P*(s=$0(this.y),1/Math.cos(s*Math.PI/180));var s}}function YP(h,s,f){var y=2*Math.PI*6378137/256/Math.pow(2,f);return[h*y-2*Math.PI*6378137/2,s*y-2*Math.PI*6378137/2]}class G0{constructor(s,f,y){if(s<0||s>25||y<0||y>=Math.pow(2,s)||f<0||f>=Math.pow(2,s))throw new Error(`x=${f}, y=${y}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=f,this.y=y,this.key=up(0,s,s,f,y)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,f,y){const E=(T=this.y,D=this.z,z=YP(256*(C=this.x),256*(T=Math.pow(2,D)-T-1),D),Z=YP(256*(C+1),256*(T+1),D),z[0]+","+z[1]+","+Z[0]+","+Z[1]);var C,T,D,z,Z;const te=function(oe,de,_e){let Ee,Re="";for(let ze=oe;ze>0;ze--)Ee=1<<ze-1,Re+=(de&Ee?1:0)+(_e&Ee?2:0);return Re}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(y==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,f>1?"@2x":"").replace(/{quadkey}/g,te).replace(/{bbox-epsg-3857}/g,E)}isChildOf(s){const f=this.z-s.z;return f>0&&s.x===this.x>>f&&s.y===this.y>>f}getTilePoint(s){const f=Math.pow(2,this.z);return new P((s.x*f-this.x)*Yi,(s.y*f-this.y)*Yi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class WP{constructor(s,f){this.wrap=s,this.canonical=f,this.key=up(s,f.z,f.z,f.x,f.y)}}class cu{constructor(s,f,y,E,C){if(s<y)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${y}`);this.overscaledZ=s,this.wrap=f,this.canonical=new G0(y,+E,+C),this.key=up(f,s,y,E,C)}clone(){return new cu(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-s;return s>this.canonical.z?new cu(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new cu(s,this.wrap,s,this.canonical.x>>f,this.canonical.y>>f)}calculateScaledKey(s,f){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const y=this.canonical.z-s;return s>this.canonical.z?up(this.wrap*+f,s,this.canonical.z,this.canonical.x,this.canonical.y):up(this.wrap*+f,s,s,this.canonical.x>>y,this.canonical.y>>y)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const f=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>f&&s.canonical.y===this.canonical.y>>f}children(s){if(this.overscaledZ>=s)return[new cu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const f=this.canonical.z+1,y=2*this.canonical.x,E=2*this.canonical.y;return[new cu(f,this.wrap,f,y,E),new cu(f,this.wrap,f,y+1,E),new cu(f,this.wrap,f,y,E+1),new cu(f,this.wrap,f,y+1,E+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new cu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new cu(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new WP(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new Ng(s.x-this.wrap,s.y))}}function up(h,s,f,y,E){(h*=2)<0&&(h=-1*h-1);const C=1<<f;return(C*C*h+C*E+y).toString(36)+f.toString(36)+s.toString(36)}Yt("CanonicalTileID",G0),Yt("OverscaledTileID",cu,{omit:["posMatrix"]});class ZP{constructor(s,f,y){if(this.uid=s,f.height!==f.width)throw new RangeError("DEM tiles must be square");if(y&&y!=="mapbox"&&y!=="terrarium")return void W(`"${y}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=f.height;const E=this.dim=f.height-2;this.data=new Uint32Array(f.data.buffer),this.encoding=y||"mapbox";for(let C=0;C<E;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(E,C)]=this.data[this._idx(E-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,E)]=this.data[this._idx(C,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<E;C++)for(let T=0;T<E;T++){const D=this.get(C,T);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(s,f){const y=new Uint8Array(this.data.buffer),E=4*this._idx(s,f);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(y[E],y[E+1],y[E+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(s,f){if(s<-1||s>=this.dim+1||f<-1||f>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(f+1)*this.stride+(s+1)}_unpackMapbox(s,f,y){return(256*s*256+256*f+y)/10-1e4}_unpackTerrarium(s,f,y){return 256*s+f+y/256-32768}getPixels(){return new lu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,f,y){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let E=f*this.dim,C=f*this.dim+this.dim,T=y*this.dim,D=y*this.dim+this.dim;switch(f){case-1:E=C-1;break;case 1:C=E+1}switch(y){case-1:T=D-1;break;case 1:D=T+1}const z=-f*this.dim,Z=-y*this.dim;for(let te=T;te<D;te++)for(let oe=E;oe<C;oe++)this.data[this._idx(oe,te)]=s.data[this._idx(oe+z,te+Z)]}}Yt("DEMData",ZP);class HP{constructor(s){this._stringToNumber={},this._numberToString=[];for(let f=0;f<s.length;f++){const y=s[f];this._stringToNumber[y]=f,this._numberToString[f]=y}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class JP{constructor(s,f,y,E,C){this.type="Feature",this._vectorTileFeature=s,s._z=f,s._x=y,s._y=E,this.properties=s.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const f in this)f!=="_geometry"&&f!=="_vectorTileFeature"&&(s[f]=this[f]);return s}}class KP{constructor(s,f){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new jo(Yi,16,0),this.grid3D=new jo(Yi,16,0),this.featureIndexArray=new Je,this.promoteId=f}insert(s,f,y,E,C,T){const D=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(y,E,C);const z=T?this.grid3D:this.grid;for(let Z=0;Z<f.length;Z++){const te=f[Z],oe=[1/0,1/0,-1/0,-1/0];for(let de=0;de<te.length;de++){const _e=te[de];oe[0]=Math.min(oe[0],_e.x),oe[1]=Math.min(oe[1],_e.y),oe[2]=Math.max(oe[2],_e.x),oe[3]=Math.max(oe[3],_e.y)}oe[0]<Yi&&oe[1]<Yi&&oe[2]>=0&&oe[3]>=0&&z.insert(D,oe[0],oe[1],oe[2],oe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new lc.VectorTile(new M0(this.rawTileData)).layers,this.sourceLayerCoder=new HP(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,f,y,E){this.loadVTLayers();const C=s.params||{},T=Yi/s.tileSize/s.scale,D=Si(C.filter),z=s.queryGeometry,Z=s.queryPadding*T,te=eA(z),oe=this.grid.query(te.minX-Z,te.minY-Z,te.maxX+Z,te.maxY+Z),de=eA(s.cameraQueryGeometry),_e=this.grid3D.query(de.minX-Z,de.minY-Z,de.maxX+Z,de.maxY+Z,(ze,Ge,nt,Ze)=>function(ot,st,xt,qt,cr){for(const Bt of ot)if(st<=Bt.x&&xt<=Bt.y&&qt>=Bt.x&&cr>=Bt.y)return!0;const Gt=[new P(st,xt),new P(st,cr),new P(qt,cr),new P(qt,xt)];if(ot.length>2){for(const Bt of Gt)if(Mh(ot,Bt))return!0}for(let Bt=0;Bt<ot.length-1;Bt++)if(VF(ot[Bt],ot[Bt+1],Gt))return!0;return!1}(s.cameraQueryGeometry,ze-Z,Ge-Z,nt+Z,Ze+Z));for(const ze of _e)oe.push(ze);oe.sort(d3);const Ee={};let Re;for(let ze=0;ze<oe.length;ze++){const Ge=oe[ze];if(Ge===Re)continue;Re=Ge;const nt=this.featureIndexArray.get(Ge);let Ze=null;this.loadMatchingFeature(Ee,nt.bucketIndex,nt.sourceLayerIndex,nt.featureIndex,D,C.layers,C.availableImages,f,y,E,(ot,st,xt)=>(Ze||(Ze=zu(ot)),st.queryIntersectsFeature(z,ot,xt,Ze,this.z,s.transform,T,s.pixelPosMatrix)))}return Ee}loadMatchingFeature(s,f,y,E,C,T,D,z,Z,te,oe){const de=this.bucketLayerIDs[f];if(T&&!function(ze,Ge){for(let nt=0;nt<ze.length;nt++)if(Ge.indexOf(ze[nt])>=0)return!0;return!1}(T,de))return;const _e=this.sourceLayerCoder.decode(y),Ee=this.vtLayers[_e].feature(E);if(C.needGeometry){const ze=cl(Ee,!0);if(!C.filter(new Kn(this.tileID.overscaledZ),ze,this.tileID.canonical))return}else if(!C.filter(new Kn(this.tileID.overscaledZ),Ee))return;const Re=this.getId(Ee,_e);for(let ze=0;ze<de.length;ze++){const Ge=de[ze];if(T&&T.indexOf(Ge)<0)continue;const nt=z[Ge];if(!nt)continue;let Ze={};Re&&te&&(Ze=te.getState(nt.sourceLayer||"_geojsonTileLayer",Re));const ot=k({},Z[Ge]);ot.paint=QP(ot.paint,nt.paint,Ee,Ze,D),ot.layout=QP(ot.layout,nt.layout,Ee,Ze,D);const st=!oe||oe(Ee,nt,Ze);if(!st)continue;const xt=new JP(Ee,this.z,this.x,this.y,Re);xt.layer=ot;let qt=s[Ge];qt===void 0&&(qt=s[Ge]=[]),qt.push({featureIndex:E,feature:xt,intersectionZ:st})}}lookupSymbolFeatures(s,f,y,E,C,T,D,z){const Z={};this.loadVTLayers();const te=Si(C);for(const oe of s)this.loadMatchingFeature(Z,y,E,oe,te,T,D,z,f);return Z}hasLayer(s){for(const f of this.bucketLayerIDs)for(const y of f)if(s===y)return!0;return!1}getId(s,f){let y=s.id;return this.promoteId&&(y=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[f]],typeof y=="boolean"&&(y=Number(y))),y}}function QP(h,s,f,y,E){return H(h,(C,T)=>{const D=s instanceof au?s.get(T):null;return D&&D.evaluate?D.evaluate(f,y,E):D})}function eA(h){let s=1/0,f=1/0,y=-1/0,E=-1/0;for(const C of h)s=Math.min(s,C.x),f=Math.min(f,C.y),y=Math.max(y,C.x),E=Math.max(E,C.y);return{minX:s,minY:f,maxX:y,maxY:E}}function d3(h,s){return s-h}function tA(h,s,f,y,E){const C=[];for(let T=0;T<h.length;T++){const D=h[T];let z;for(let Z=0;Z<D.length-1;Z++){let te=D[Z],oe=D[Z+1];te.x<s&&oe.x<s||(te.x<s?te=new P(s,te.y+(s-te.x)/(oe.x-te.x)*(oe.y-te.y))._round():oe.x<s&&(oe=new P(s,te.y+(s-te.x)/(oe.x-te.x)*(oe.y-te.y))._round()),te.y<f&&oe.y<f||(te.y<f?te=new P(te.x+(f-te.y)/(oe.y-te.y)*(oe.x-te.x),f)._round():oe.y<f&&(oe=new P(te.x+(f-te.y)/(oe.y-te.y)*(oe.x-te.x),f)._round()),te.x>=y&&oe.x>=y||(te.x>=y?te=new P(y,te.y+(y-te.x)/(oe.x-te.x)*(oe.y-te.y))._round():oe.x>=y&&(oe=new P(y,te.y+(y-te.x)/(oe.x-te.x)*(oe.y-te.y))._round()),te.y>=E&&oe.y>=E||(te.y>=E?te=new P(te.x+(E-te.y)/(oe.y-te.y)*(oe.x-te.x),E)._round():oe.y>=E&&(oe=new P(te.x+(E-te.y)/(oe.y-te.y)*(oe.x-te.x),E)._round()),z&&te.equals(z[z.length-1])||(z=[te],C.push(z)),z.push(oe)))))}}return C}Yt("FeatureIndex",KP,{omit:["rawTileData","sourceLayerCoder"]});class pc extends P{constructor(s,f,y,E){super(s,f),this.angle=y,E!==void 0&&(this.segment=E)}clone(){return new pc(this.x,this.y,this.angle,this.segment)}}function rA(h,s,f,y,E){if(s.segment===void 0||f===0)return!0;let C=s,T=s.segment+1,D=0;for(;D>-f/2;){if(T--,T<0)return!1;D-=h[T].dist(C),C=h[T]}D+=h[T].dist(h[T+1]),T++;const z=[];let Z=0;for(;D<f/2;){const te=h[T],oe=h[T+1];if(!oe)return!1;let de=h[T-1].angleTo(te)-te.angleTo(oe);for(de=Math.abs((de+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:D,angleDelta:de}),Z+=de;D-z[0].distance>y;)Z-=z.shift().angleDelta;if(Z>E)return!1;T++,D+=te.dist(oe)}return!0}function nA(h){let s=0;for(let f=0;f<h.length-1;f++)s+=h[f].dist(h[f+1]);return s}function iA(h,s,f){return h?.6*s*f:0}function oA(h,s){return Math.max(h?h.right-h.left:0,s?s.right-s.left:0)}function g3(h,s,f,y,E,C){const T=iA(f,E,C),D=oA(f,y)*C;let z=0;const Z=nA(h)/2;for(let te=0;te<h.length-1;te++){const oe=h[te],de=h[te+1],_e=oe.dist(de);if(z+_e>Z){const Ee=(Z-z)/_e,Re=Ti.number(oe.x,de.x,Ee),ze=Ti.number(oe.y,de.y,Ee),Ge=new pc(Re,ze,de.angleTo(oe),te);return Ge._round(),!T||rA(h,Ge,D,T,s)?Ge:void 0}z+=_e}}function m3(h,s,f,y,E,C,T,D,z){const Z=iA(y,C,T),te=oA(y,E),oe=te*T,de=h[0].x===0||h[0].x===z||h[0].y===0||h[0].y===z;return s-oe<s/4&&(s=oe+s/4),aA(h,de?s/2*D%s:(te/2+2*C)*T*D%s,s,Z,f,oe,de,!1,z)}function aA(h,s,f,y,E,C,T,D,z){const Z=C/2,te=nA(h);let oe=0,de=s-f,_e=[];for(let Ee=0;Ee<h.length-1;Ee++){const Re=h[Ee],ze=h[Ee+1],Ge=Re.dist(ze),nt=ze.angleTo(Re);for(;de+f<oe+Ge;){de+=f;const Ze=(de-oe)/Ge,ot=Ti.number(Re.x,ze.x,Ze),st=Ti.number(Re.y,ze.y,Ze);if(ot>=0&&ot<z&&st>=0&&st<z&&de-Z>=0&&de+Z<=te){const xt=new pc(ot,st,nt,Ee);xt._round(),y&&!rA(h,xt,C,y,E)||_e.push(xt)}}oe+=Ge}return D||_e.length||T||(_e=aA(h,oe/2,f,y,E,C,T,!0,z)),_e}Yt("Anchor",pc);const zh=ws;function sA(h,s,f,y){const E=[],C=h.image,T=C.pixelRatio,D=C.paddedRect.w-2*zh,z=C.paddedRect.h-2*zh,Z=h.right-h.left,te=h.bottom-h.top,oe=C.stretchX||[[0,D]],de=C.stretchY||[[0,z]],_e=(Dt,Jt)=>Dt+Jt[1]-Jt[0],Ee=oe.reduce(_e,0),Re=de.reduce(_e,0),ze=D-Ee,Ge=z-Re;let nt=0,Ze=Ee,ot=0,st=Re,xt=0,qt=ze,cr=0,Gt=Ge;if(C.content&&y){const Dt=C.content;nt=Fg(oe,0,Dt[0]),ot=Fg(de,0,Dt[1]),Ze=Fg(oe,Dt[0],Dt[2]),st=Fg(de,Dt[1],Dt[3]),xt=Dt[0]-nt,cr=Dt[1]-ot,qt=Dt[2]-Dt[0]-Ze,Gt=Dt[3]-Dt[1]-st}const Bt=(Dt,Jt,Ft,At)=>{const br=kg(Dt.stretch-nt,Ze,Z,h.left),pr=Bg(Dt.fixed-xt,qt,Dt.stretch,Ee),Jr=kg(Jt.stretch-ot,st,te,h.top),bi=Bg(Jt.fixed-cr,Gt,Jt.stretch,Re),Oi=kg(Ft.stretch-nt,Ze,Z,h.left),Do=Bg(Ft.fixed-xt,qt,Ft.stretch,Ee),Gs=kg(At.stretch-ot,st,te,h.top),rs=Bg(At.fixed-cr,Gt,At.stretch,Re),bo=new P(br,Jr),$o=new P(Oi,Jr),ba=new P(Oi,Gs),Es=new P(br,Gs),ns=new P(pr/T,bi/T),xo=new P(Do/T,rs/T),No=s*Math.PI/180;if(No){const Ss=Math.sin(No),Ps=Math.cos(No),no=[Ps,-Ss,Ss,Ps];bo._matMult(no),$o._matMult(no),Es._matMult(no),ba._matMult(no)}const Da=Dt.stretch+Dt.fixed,is=Jt.stretch+Jt.fixed;return{tl:bo,tr:$o,bl:Es,br:ba,tex:{x:C.paddedRect.x+zh+Da,y:C.paddedRect.y+zh+is,w:Ft.stretch+Ft.fixed-Da,h:At.stretch+At.fixed-is},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ns,pixelOffsetBR:xo,minFontScaleX:qt/T/Z,minFontScaleY:Gt/T/te,isSDF:f}};if(y&&(C.stretchX||C.stretchY)){const Dt=uA(oe,ze,Ee),Jt=uA(de,Ge,Re);for(let Ft=0;Ft<Dt.length-1;Ft++){const At=Dt[Ft],br=Dt[Ft+1];for(let pr=0;pr<Jt.length-1;pr++)E.push(Bt(At,Jt[pr],br,Jt[pr+1]))}}else E.push(Bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:D+1},{fixed:0,stretch:z+1}));return E}function Fg(h,s,f){let y=0;for(const E of h)y+=Math.max(s,Math.min(f,E[1]))-Math.max(s,Math.min(f,E[0]));return y}function uA(h,s,f){const y=[{fixed:-zh,stretch:0}];for(const[E,C]of h){const T=y[y.length-1];y.push({fixed:E-T.stretch,stretch:T.stretch}),y.push({fixed:E-T.stretch,stretch:T.stretch+(C-E)})}return y.push({fixed:s+zh,stretch:f}),y}function kg(h,s,f,y){return h/s*f+y}function Bg(h,s,f,y){return h-s*f/y}class zg{constructor(s,f,y,E,C,T,D,z,Z,te){if(this.boxStartIndex=s.length,Z){let oe=T.top,de=T.bottom;const _e=T.collisionPadding;_e&&(oe-=_e[1],de+=_e[3]);let Ee=de-oe;Ee>0&&(Ee=Math.max(10,Ee),this.circleDiameter=Ee)}else{let oe=T.top*D-z[0],de=T.bottom*D+z[2],_e=T.left*D-z[3],Ee=T.right*D+z[1];const Re=T.collisionPadding;if(Re&&(_e-=Re[0]*D,oe-=Re[1]*D,Ee+=Re[2]*D,de+=Re[3]*D),te){const ze=new P(_e,oe),Ge=new P(Ee,oe),nt=new P(_e,de),Ze=new P(Ee,de),ot=te*Math.PI/180;ze._rotate(ot),Ge._rotate(ot),nt._rotate(ot),Ze._rotate(ot),_e=Math.min(ze.x,Ge.x,nt.x,Ze.x),Ee=Math.max(ze.x,Ge.x,nt.x,Ze.x),oe=Math.min(ze.y,Ge.y,nt.y,Ze.y),de=Math.max(ze.y,Ge.y,nt.y,Ze.y)}s.emplaceBack(f.x,f.y,_e,oe,Ee,de,y,E,C)}this.boxEndIndex=s.length}}class v3{constructor(s=[],f=y3){if(this.data=s,this.length=this.data.length,this.compare=f,this.length>0)for(let y=(this.length>>1)-1;y>=0;y--)this._down(y)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],f=this.data.pop();return this.length--,this.length>0&&(this.data[0]=f,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:f,compare:y}=this,E=f[s];for(;s>0;){const C=s-1>>1,T=f[C];if(y(E,T)>=0)break;f[s]=T,s=C}f[s]=E}_down(s){const{data:f,compare:y}=this,E=this.length>>1,C=f[s];for(;s<E;){let T=1+(s<<1),D=f[T];const z=T+1;if(z<this.length&&y(f[z],D)<0&&(T=z,D=f[z]),y(D,C)>=0)break;f[s]=D,s=T}f[s]=C}}function y3(h,s){return h<s?-1:h>s?1:0}function _3(h,s=1,f=!1){let y=1/0,E=1/0,C=-1/0,T=-1/0;const D=h[0];for(let _e=0;_e<D.length;_e++){const Ee=D[_e];(!_e||Ee.x<y)&&(y=Ee.x),(!_e||Ee.y<E)&&(E=Ee.y),(!_e||Ee.x>C)&&(C=Ee.x),(!_e||Ee.y>T)&&(T=Ee.y)}const z=Math.min(C-y,T-E);let Z=z/2;const te=new v3([],b3);if(z===0)return new P(y,E);for(let _e=y;_e<C;_e+=z)for(let Ee=E;Ee<T;Ee+=z)te.push(new jh(_e+Z,Ee+Z,Z,h));let oe=function(_e){let Ee=0,Re=0,ze=0;const Ge=_e[0];for(let nt=0,Ze=Ge.length,ot=Ze-1;nt<Ze;ot=nt++){const st=Ge[nt],xt=Ge[ot],qt=st.x*xt.y-xt.x*st.y;Re+=(st.x+xt.x)*qt,ze+=(st.y+xt.y)*qt,Ee+=3*qt}return new jh(Re/Ee,ze/Ee,0,_e)}(h),de=te.length;for(;te.length;){const _e=te.pop();(_e.d>oe.d||!oe.d)&&(oe=_e),_e.max-oe.d<=s||(Z=_e.h/2,te.push(new jh(_e.p.x-Z,_e.p.y-Z,Z,h)),te.push(new jh(_e.p.x+Z,_e.p.y-Z,Z,h)),te.push(new jh(_e.p.x-Z,_e.p.y+Z,Z,h)),te.push(new jh(_e.p.x+Z,_e.p.y+Z,Z,h)),de+=4)}return oe.p}function b3(h,s){return s.max-h.max}function jh(h,s,f,y){this.p=new P(h,s),this.h=f,this.d=function(E,C){let T=!1,D=1/0;for(let z=0;z<C.length;z++){const Z=C[z];for(let te=0,oe=Z.length,de=oe-1;te<oe;de=te++){const _e=Z[te],Ee=Z[de];_e.y>E.y!=Ee.y>E.y&&E.x<(Ee.x-_e.x)*(E.y-_e.y)/(Ee.y-_e.y)+_e.x&&(T=!T),D=Math.min(D,VS(E,_e,Ee))}}return(T?1:-1)*Math.sqrt(D)}(this.p,y),this.max=this.d+this.h*Math.SQRT2}var _a;u.TextAnchorEnum=void 0,(_a=u.TextAnchorEnum||(u.TextAnchorEnum={}))[_a.center=1]="center",_a[_a.left=2]="left",_a[_a.right=3]="right",_a[_a.top=4]="top",_a[_a.bottom=5]="bottom",_a[_a["top-left"]=6]="top-left",_a[_a["top-right"]=7]="top-right",_a[_a["bottom-left"]=8]="bottom-left",_a[_a["bottom-right"]=9]="bottom-right";const dc=7,q0=Number.POSITIVE_INFINITY;function lA(h,s){return s[1]!==q0?function(f,y,E){let C=0,T=0;switch(y=Math.abs(y),E=Math.abs(E),f){case"top-right":case"top-left":case"top":T=E-dc;break;case"bottom-right":case"bottom-left":case"bottom":T=-E+dc}switch(f){case"top-right":case"bottom-right":case"right":C=-y;break;case"top-left":case"bottom-left":case"left":C=y}return[C,T]}(h,s[0],s[1]):function(f,y){let E=0,C=0;y<0&&(y=0);const T=y/Math.SQRT2;switch(f){case"top-right":case"top-left":C=T-dc;break;case"bottom-right":case"bottom-left":C=-T+dc;break;case"bottom":C=-y+dc;break;case"top":C=y-dc}switch(f){case"top-right":case"bottom-right":E=-T;break;case"top-left":case"bottom-left":E=T;break;case"left":E=y;break;case"right":E=-y}return[E,C]}(h,s[0])}function cA(h,s,f){var y;const E=h.layout,C=(y=E.get("text-variable-anchor-offset"))===null||y===void 0?void 0:y.evaluate(s,{},f);if(C){const D=C.values,z=[];for(let Z=0;Z<D.length;Z+=2){const te=z[Z]=D[Z],oe=D[Z+1].map(de=>de*Ro);te.startsWith("top")?oe[1]-=dc:te.startsWith("bottom")&&(oe[1]+=dc),z[Z+1]=oe}return new ci(z)}const T=E.get("text-variable-anchor");if(T){let D;D=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[E.get("text-radial-offset").evaluate(s,{},f)*Ro,q0]:E.get("text-offset").evaluate(s,{},f).map(Z=>Z*Ro);const z=[];for(const Z of T)z.push(Z,lA(Z,D));return new ci(z)}return null}function V0(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function x3(h,s,f,y,E,C,T,D,z,Z,te){let oe=C.textMaxSize.evaluate(s,{});oe===void 0&&(oe=T);const de=h.layers[0].layout,_e=de.get("icon-offset").evaluate(s,{},te),Ee=fA(f.horizontal),Re=T/24,ze=h.tilePixelRatio*Re,Ge=h.tilePixelRatio*oe/24,nt=h.tilePixelRatio*D,Ze=h.tilePixelRatio*de.get("symbol-spacing"),ot=de.get("text-padding")*h.tilePixelRatio,st=function(At,br,pr,Jr=1){const bi=At.get("icon-padding").evaluate(br,{},pr),Oi=bi&&bi.values;return[Oi[0]*Jr,Oi[1]*Jr,Oi[2]*Jr,Oi[3]*Jr]}(de,s,te,h.tilePixelRatio),xt=de.get("text-max-angle")/180*Math.PI,qt=de.get("text-rotation-alignment")!=="viewport"&&de.get("symbol-placement")!=="point",cr=de.get("icon-rotation-alignment")==="map"&&de.get("symbol-placement")!=="point",Gt=de.get("symbol-placement"),Bt=Ze/2,Dt=de.get("icon-text-fit");let Jt;y&&Dt!=="none"&&(h.allowVerticalPlacement&&f.vertical&&(Jt=NP(y,f.vertical,Dt,de.get("icon-text-fit-padding"),_e,Re)),Ee&&(y=NP(y,Ee,Dt,de.get("icon-text-fit-padding"),_e,Re)));const Ft=(At,br)=>{br.x<0||br.x>=Yi||br.y<0||br.y>=Yi||function(pr,Jr,bi,Oi,Do,Gs,rs,bo,$o,ba,Es,ns,xo,No,Da,is,Ss,Ps,no,xa,on,qs,wa,os,Tu){const ju=pr.addToLineVertexArray(Jr,bi);let Uu,jl,Mu,hu,As=0,Ul=0,hp=0,mA=0,Q0=-1,e1=-1;const $l={};let vA=su("");if(pr.allowVerticalPlacement&&Oi.vertical){const Na=bo.layout.get("text-rotate").evaluate(on,{},os)+90;Mu=new zg($o,Jr,ba,Es,ns,Oi.vertical,xo,No,Da,Na),rs&&(hu=new zg($o,Jr,ba,Es,ns,rs,Ss,Ps,Da,Na))}if(Do){const Na=bo.layout.get("icon-rotate").evaluate(on,{}),fu=bo.layout.get("icon-text-fit")!=="none",kc=sA(Do,Na,wa,fu),Gu=rs?sA(rs,Na,wa,fu):void 0;jl=new zg($o,Jr,ba,Es,ns,Do,Ss,Ps,!1,Na),As=4*kc.length;const Bc=pr.iconSizeData;let fl=null;Bc.kind==="source"?(fl=[hl*bo.layout.get("icon-size").evaluate(on,{})],fl[0]>hc&&W(`${pr.layerIds[0]}: Value for "icon-size" is >= ${sp}. Reduce your "icon-size".`)):Bc.kind==="composite"&&(fl=[hl*qs.compositeIconSizes[0].evaluate(on,{},os),hl*qs.compositeIconSizes[1].evaluate(on,{},os)],(fl[0]>hc||fl[1]>hc)&&W(`${pr.layerIds[0]}: Value for "icon-size" is >= ${sp}. Reduce your "icon-size".`)),pr.addSymbols(pr.icon,kc,fl,xa,no,on,u.WritingMode.none,Jr,ju.lineStartIndex,ju.lineLength,-1,os),Q0=pr.icon.placedSymbolArray.length-1,Gu&&(Ul=4*Gu.length,pr.addSymbols(pr.icon,Gu,fl,xa,no,on,u.WritingMode.vertical,Jr,ju.lineStartIndex,ju.lineLength,-1,os),e1=pr.icon.placedSymbolArray.length-1)}const yA=Object.keys(Oi.horizontal);for(const Na of yA){const fu=Oi.horizontal[Na];if(!Uu){vA=su(fu.text);const Gu=bo.layout.get("text-rotate").evaluate(on,{},os);Uu=new zg($o,Jr,ba,Es,ns,fu,xo,No,Da,Gu)}const kc=fu.positionedLines.length===1;if(hp+=hA(pr,Jr,fu,Gs,bo,Da,on,is,ju,Oi.vertical?u.WritingMode.horizontal:u.WritingMode.horizontalOnly,kc?yA:[Na],$l,Q0,qs,os),kc)break}Oi.vertical&&(mA+=hA(pr,Jr,Oi.vertical,Gs,bo,Da,on,is,ju,u.WritingMode.vertical,["vertical"],$l,e1,qs,os));const S3=Uu?Uu.boxStartIndex:pr.collisionBoxArray.length,P3=Uu?Uu.boxEndIndex:pr.collisionBoxArray.length,A3=Mu?Mu.boxStartIndex:pr.collisionBoxArray.length,I3=Mu?Mu.boxEndIndex:pr.collisionBoxArray.length,O3=jl?jl.boxStartIndex:pr.collisionBoxArray.length,C3=jl?jl.boxEndIndex:pr.collisionBoxArray.length,T3=hu?hu.boxStartIndex:pr.collisionBoxArray.length,M3=hu?hu.boxEndIndex:pr.collisionBoxArray.length;let $u=-1;const Ug=(Na,fu)=>Na&&Na.circleDiameter?Math.max(Na.circleDiameter,fu):fu;$u=Ug(Uu,$u),$u=Ug(Mu,$u),$u=Ug(jl,$u),$u=Ug(hu,$u);const _A=$u>-1?1:0;_A&&($u*=Tu/Ro),pr.glyphOffsetArray.length>=Bh.MAX_GLYPHS&&W("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),on.sortKey!==void 0&&pr.addToSortKeyRanges(pr.symbolInstances.length,on.sortKey);const L3=cA(bo,on,os),[R3,D3]=function(Na,fu){const kc=Na.length,Gu=fu==null?void 0:fu.values;if((Gu==null?void 0:Gu.length)>0)for(let Bc=0;Bc<Gu.length;Bc+=2){const fl=Gu[Bc+1];Na.emplaceBack(u.TextAnchorEnum[Gu[Bc]],fl[0],fl[1])}return[kc,Na.length]}(pr.textAnchorOffsets,L3);pr.symbolInstances.emplaceBack(Jr.x,Jr.y,$l.right>=0?$l.right:-1,$l.center>=0?$l.center:-1,$l.left>=0?$l.left:-1,$l.vertical||-1,Q0,e1,vA,S3,P3,A3,I3,O3,C3,T3,M3,ba,hp,mA,As,Ul,_A,0,xo,$u,R3,D3)}(h,br,At,f,y,E,Jt,h.layers[0],h.collisionBoxArray,s.index,s.sourceLayerIndex,h.index,ze,[ot,ot,ot,ot],qt,z,nt,st,cr,_e,s,C,Z,te,T)};if(Gt==="line")for(const At of tA(s.geometry,0,0,Yi,Yi)){const br=m3(At,Ze,xt,f.vertical||Ee,y,24,Ge,h.overscaling,Yi);for(const pr of br)Ee&&w3(h,Ee.text,Bt,pr)||Ft(At,pr)}else if(Gt==="line-center"){for(const At of s.geometry)if(At.length>1){const br=g3(At,xt,f.vertical||Ee,y,24,Ge);br&&Ft(At,br)}}else if(s.type==="Polygon")for(const At of E0(s.geometry,0)){const br=_3(At,16);Ft(At[0],new pc(br.x,br.y,0))}else if(s.type==="LineString")for(const At of s.geometry)Ft(At,new pc(At[0].x,At[0].y,0));else if(s.type==="Point")for(const At of s.geometry)for(const br of At)Ft([br],new pc(br.x,br.y,0))}function hA(h,s,f,y,E,C,T,D,z,Z,te,oe,de,_e,Ee){const Re=function(nt,Ze,ot,st,xt,qt,cr,Gt){const Bt=st.layout.get("text-rotate").evaluate(qt,{})*Math.PI/180,Dt=[];for(const Jt of Ze.positionedLines)for(const Ft of Jt.positionedGlyphs){if(!Ft.rect)continue;const At=Ft.rect||{};let br=OP+1,pr=!0,Jr=1,bi=0;const Oi=(xt||Gt)&&Ft.vertical,Do=Ft.metrics.advance*Ft.scale/2;if(Gt&&Ze.verticalizable&&(bi=Jt.lineOffset/2-(Ft.imageName?-(Ro-Ft.metrics.width*Ft.scale)/2:(Ft.scale-1)*Ro)),Ft.imageName){const no=cr[Ft.imageName];pr=no.sdf,Jr=no.pixelRatio,br=ws/Jr}const Gs=xt?[Ft.x+Do,Ft.y]:[0,0];let rs=xt?[0,0]:[Ft.x+Do+ot[0],Ft.y+ot[1]-bi],bo=[0,0];Oi&&(bo=rs,rs=[0,0]);const $o=(Ft.metrics.left-br)*Ft.scale-Do+rs[0],ba=(-Ft.metrics.top-br)*Ft.scale+rs[1],Es=$o+At.w*Ft.scale/Jr,ns=ba+At.h*Ft.scale/Jr,xo=new P($o,ba),No=new P(Es,ba),Da=new P($o,ns),is=new P(Es,ns);if(Oi){const no=new P(-Do,Do-op),xa=-Math.PI/2,on=Ro/2-Do,qs=new P(5-op-on,-(Ft.imageName?on:0)),wa=new P(...bo);xo._rotateAround(xa,no)._add(qs)._add(wa),No._rotateAround(xa,no)._add(qs)._add(wa),Da._rotateAround(xa,no)._add(qs)._add(wa),is._rotateAround(xa,no)._add(qs)._add(wa)}if(Bt){const no=Math.sin(Bt),xa=Math.cos(Bt),on=[xa,-no,no,xa];xo._matMult(on),No._matMult(on),Da._matMult(on),is._matMult(on)}const Ss=new P(0,0),Ps=new P(0,0);Dt.push({tl:xo,tr:No,bl:Da,br:is,tex:At,writingMode:Ze.writingMode,glyphOffset:Gs,sectionIndex:Ft.sectionIndex,isSDF:pr,pixelOffsetTL:Ss,pixelOffsetBR:Ps,minFontScaleX:0,minFontScaleY:0})}return Dt}(0,f,D,E,C,T,y,h.allowVerticalPlacement),ze=h.textSizeData;let Ge=null;ze.kind==="source"?(Ge=[hl*E.layout.get("text-size").evaluate(T,{})],Ge[0]>hc&&W(`${h.layerIds[0]}: Value for "text-size" is >= ${sp}. Reduce your "text-size".`)):ze.kind==="composite"&&(Ge=[hl*_e.compositeTextSizes[0].evaluate(T,{},Ee),hl*_e.compositeTextSizes[1].evaluate(T,{},Ee)],(Ge[0]>hc||Ge[1]>hc)&&W(`${h.layerIds[0]}: Value for "text-size" is >= ${sp}. Reduce your "text-size".`)),h.addSymbols(h.text,Re,Ge,D,C,T,Z,s,z.lineStartIndex,z.lineLength,de,Ee);for(const nt of te)oe[nt]=h.text.placedSymbolArray.length-1;return 4*Re.length}function fA(h){for(const s in h)return h[s];return null}function w3(h,s,f,y){const E=h.compareText;if(s in E){const C=E[s];for(let T=C.length-1;T>=0;T--)if(y.dist(C[T])<f)return!0}else E[s]=[];return E[s].push(y),!1}const pA=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class X0{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[f,y]=new Uint8Array(s,0,2);if(f!==219)throw new Error("Data does not appear to be in a KDBush format.");const E=y>>4;if(E!==1)throw new Error(`Got v${E} data when expected v1.`);const C=pA[15&y];if(!C)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(s,2,1),[D]=new Uint32Array(s,4,1);return new X0(D,T,C,s)}constructor(s,f=64,y=Float64Array,E){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+f,2),65535),this.ArrayType=y,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const C=pA.indexOf(this.ArrayType),T=2*s*this.ArrayType.BYTES_PER_ELEMENT,D=s*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-D%8)%8;if(C<0)throw new Error(`Unexpected typed array class: ${y}.`);E&&E instanceof ArrayBuffer?(this.data=E,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+D+z,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+T+D+z),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+D+z,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+C]),new Uint16Array(this.data,2,1)[0]=f,new Uint32Array(this.data,4,1)[0]=s)}add(s,f){const y=this._pos>>1;return this.ids[y]=y,this.coords[this._pos++]=s,this.coords[this._pos++]=f,y}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Y0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,f,y,E){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:T,nodeSize:D}=this,z=[0,C.length-1,0],Z=[];for(;z.length;){const te=z.pop()||0,oe=z.pop()||0,de=z.pop()||0;if(oe-de<=D){for(let ze=de;ze<=oe;ze++){const Ge=T[2*ze],nt=T[2*ze+1];Ge>=s&&Ge<=y&&nt>=f&&nt<=E&&Z.push(C[ze])}continue}const _e=de+oe>>1,Ee=T[2*_e],Re=T[2*_e+1];Ee>=s&&Ee<=y&&Re>=f&&Re<=E&&Z.push(C[_e]),(te===0?s<=Ee:f<=Re)&&(z.push(de),z.push(_e-1),z.push(1-te)),(te===0?y>=Ee:E>=Re)&&(z.push(_e+1),z.push(oe),z.push(1-te))}return Z}within(s,f,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:E,coords:C,nodeSize:T}=this,D=[0,E.length-1,0],z=[],Z=y*y;for(;D.length;){const te=D.pop()||0,oe=D.pop()||0,de=D.pop()||0;if(oe-de<=T){for(let ze=de;ze<=oe;ze++)gA(C[2*ze],C[2*ze+1],s,f)<=Z&&z.push(E[ze]);continue}const _e=de+oe>>1,Ee=C[2*_e],Re=C[2*_e+1];gA(Ee,Re,s,f)<=Z&&z.push(E[_e]),(te===0?s-y<=Ee:f-y<=Re)&&(D.push(de),D.push(_e-1),D.push(1-te)),(te===0?s+y>=Ee:f+y>=Re)&&(D.push(_e+1),D.push(oe),D.push(1-te))}return z}}function Y0(h,s,f,y,E,C){if(E-y<=f)return;const T=y+E>>1;dA(h,s,T,y,E,C),Y0(h,s,f,y,T-1,1-C),Y0(h,s,f,T+1,E,1-C)}function dA(h,s,f,y,E,C){for(;E>y;){if(E-y>600){const Z=E-y+1,te=f-y+1,oe=Math.log(Z),de=.5*Math.exp(2*oe/3),_e=.5*Math.sqrt(oe*de*(Z-de)/Z)*(te-Z/2<0?-1:1);dA(h,s,f,Math.max(y,Math.floor(f-te*de/Z+_e)),Math.min(E,Math.floor(f+(Z-te)*de/Z+_e)),C)}const T=s[2*f+C];let D=y,z=E;for(lp(h,s,y,f),s[2*E+C]>T&&lp(h,s,y,E);D<z;){for(lp(h,s,D,z),D++,z--;s[2*D+C]<T;)D++;for(;s[2*z+C]>T;)z--}s[2*y+C]===T?lp(h,s,y,z):(z++,lp(h,s,z,E)),z<=f&&(y=z+1),f<=z&&(E=z-1)}}function lp(h,s,f,y){W0(h,f,y),W0(s,2*f,2*y),W0(s,2*f+1,2*y+1)}function W0(h,s,f){const y=h[s];h[s]=h[f],h[f]=y}function gA(h,s,f,y){const E=h-f,C=s-y;return E*E+C*C}var Z0;u.PerformanceMarkers=void 0,(Z0=u.PerformanceMarkers||(u.PerformanceMarkers={})).create="create",Z0.load="load",Z0.fullLoad="fullLoad";let jg=null,cp=[];const H0=1e3/60,J0="loadTime",K0="fullLoadTime",E3={mark(h){performance.mark(h)},frame(h){const s=h;jg!=null&&cp.push(s-jg),jg=s},clearMetrics(){jg=null,cp=[],performance.clearMeasures(J0),performance.clearMeasures(K0);for(const h in u.PerformanceMarkers)performance.clearMarks(u.PerformanceMarkers[h])},getPerformanceMetrics(){performance.measure(J0,u.PerformanceMarkers.create,u.PerformanceMarkers.load),performance.measure(K0,u.PerformanceMarkers.create,u.PerformanceMarkers.fullLoad);const h=performance.getEntriesByName(J0)[0].duration,s=performance.getEntriesByName(K0)[0].duration,f=cp.length,y=1/(cp.reduce((C,T)=>C+T,0)/f/1e3),E=cp.filter(C=>C>H0).reduce((C,T)=>C+(T-H0)/H0,0);return{loadTime:h,fullLoadTime:s,fps:y,percentDroppedFrames:E/(f+E)*100,totalFrames:f}}};u.AJAXError=ye,u.ARRAY_TYPE=Lh,u.Actor=class{constructor(h,s,f){this.receive=y=>{const E=y.data,C=E.id;if(C&&(!E.targetMapId||this.mapId===E.targetMapId))if(E.type==="<cancel>"){delete this.tasks[C];const T=this.cancelCallbacks[C];delete this.cancelCallbacks[C],T&&T()}else Oe()||E.mustQueue?(this.tasks[C]=E,this.taskQueue.push(C),this.invoker.trigger()):this.processTask(C,E)},this.process=()=>{if(!this.taskQueue.length)return;const y=this.taskQueue.shift(),E=this.tasks[y];delete this.tasks[y],this.taskQueue.length&&this.invoker.trigger(),E&&this.processTask(y,E)},this.target=h,this.parent=s,this.mapId=f,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new p3(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Oe()?h:window}send(h,s,f,y,E=!1){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(this.callbacks[C]=f);const T=ae(this.globalScope)?void 0:[];return this.target.postMessage({id:C,type:h,hasCallback:!!f,targetMapId:y,mustQueue:E,sourceMapId:this.mapId,data:La(s,T)},T),{cancel:()=>{f&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:y,sourceMapId:this.mapId})}}}processTask(h,s){if(s.type==="<response>"){const f=this.callbacks[h];delete this.callbacks[h],f&&(s.error?f(Fi(s.error)):f(null,Fi(s.data)))}else{let f=!1;const y=ae(this.globalScope)?void 0:[],E=s.hasCallback?(D,z)=>{f=!0,delete this.cancelCallbacks[h],this.target.postMessage({id:h,type:"<response>",sourceMapId:this.mapId,error:D?La(D):null,data:La(z,y)},y)}:D=>{f=!0};let C=null;const T=Fi(s.data);if(this.parent[s.type])C=this.parent[s.type](s.sourceMapId,T,E);else if(this.parent.getWorkerSource){const D=s.type.split(".");C=this.parent.getWorkerSource(s.sourceMapId,D[0],T.source)[D[1]](T,E)}else E(new Error(`Could not find function ${s.type}`));!f&&C&&C.cancel&&(this.cancelCallbacks[h]=C.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.AlphaImage=Jf,u.CanonicalTileID=G0,u.CollisionBoxArray=F,u.CollisionCircleLayoutArray=class extends A{},u.Color=Ut,u.DEMData=ZP,u.DataConstantProperty=fr,u.DictionaryCoder=HP,u.EXTENT=Yi,u.ErrorEvent=Ct,u.EvaluationParameters=Kn,u.Event=pt,u.Evented=mt,u.FeatureIndex=KP,u.FillBucket=A0,u.FillExtrusionBucket=O0,u.GeoJSONFeature=JP,u.ImageAtlas=TP,u.ImagePosition=R0,u.KDBush=X0,u.LineBucket=C0,u.LineStripIndexArray=class extends w{},u.LngLat=fc,u.MercatorCoordinate=Ng,u.ONE_EM=Ro,u.OverscaledTileID=cu,u.PerformanceUtils=E3,u.Point=P,u.Pos3dArray=class extends Qa{},u.PosArray=at,u.Properties=Uo,u.Protobuf=M0,u.QuadTriangleArray=class extends G{},u.RGBAImage=lu,u.RasterBoundsArray=class extends lo{},u.RequestPerformance=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},u.SegmentVector=_r,u.SymbolBucket=Bh,u.Transitionable=Dl,u.TriangleIndexArray=gr,u.Uniform1f=Mo,u.Uniform1i=class extends ho{constructor(h,s){super(h,s),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},u.Uniform2f=class extends ho{constructor(h,s){super(h,s),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},u.Uniform3f=class extends ho{constructor(h,s){super(h,s),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},u.Uniform4f=va,u.UniformColor=sc,u.UniformMatrix4f=class extends ho{constructor(h,s){super(h,s),this.current=Lo}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let s=1;s<16;s++)if(h[s]!==this.current[s]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},u.UnwrappedTileID=WP,u.ValidationError=$e,u.ZoomHistory=Ll,u.addDynamicAttributes=k0,u.arrayBufferToImage=function(h,s){const f=new Image;f.onload=()=>{s(null,f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Pe})},f.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const y=new Blob([new Uint8Array(h)],{type:"image/png"});f.src=h.byteLength?URL.createObjectURL(y):Pe},u.arrayBufferToImageBitmap=function(h,s){const f=new Blob([new Uint8Array(h)],{type:"image/png"});createImageBitmap(f).then(y=>{s(null,y)}).catch(y=>{s(new Error(`Could not load image because of ${y.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},u.asyncAll=function(h,s,f){if(!h.length)return f(null,[]);let y=h.length;const E=new Array(h.length);let C=null;h.forEach((T,D)=>{s(T,(z,Z)=>{z&&(C=z),E[D]=Z,--y==0&&f(C,E)})})},u.bezier=$,u.browser=he,u.clamp=X,u.clipLine=tA,u.clone=function(h){var s=new Lh(16);return s[0]=h[0],s[1]=h[1],s[2]=h[2],s[3]=h[3],s[4]=h[4],s[5]=h[5],s[6]=h[6],s[7]=h[7],s[8]=h[8],s[9]=h[9],s[10]=h[10],s[11]=h[11],s[12]=h[12],s[13]=h[13],s[14]=h[14],s[15]=h[15],s},u.clone$1=ie,u.collisionCircleLayout=Uk,u.config=fe,u.copy=function(h,s){return h[0]=s[0],h[1]=s[1],h[2]=s[2],h[3]=s[3],h[4]=s[4],h[5]=s[5],h[6]=s[6],h[7]=s[7],h[8]=s[8],h[9]=s[9],h[10]=s[10],h[11]=s[11],h[12]=s[12],h[13]=s[13],h[14]=s[14],h[15]=s[15],h},u.create=function(){var h=new Lh(16);return Lh!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},u.createExpression=Br,u.createFilter=Si,u.createLayout=Kt,u.createStyleLayer=function(h){if(h.type==="custom")return new f3(h);switch(h.type){case"background":return new l3(h);case"circle":return new WF(h);case"fill":return new dk(h);case"fill-extrusion":return new Ck(h);case"heatmap":return new HF(h);case"hillshade":return new KF(h);case"line":return new kk(h);case"raster":return new h3(h);case"symbol":return new Dg(h)}},u.deepEqual=function h(s,f){if(Array.isArray(s)){if(!Array.isArray(f)||s.length!==f.length)return!1;for(let y=0;y<s.length;y++)if(!h(s[y],f[y]))return!1;return!0}if(typeof s=="object"&&s!==null&&f!==null){if(typeof f!="object"||Object.keys(s).length!==Object.keys(f).length)return!1;for(const y in s)if(!h(s[y],f[y]))return!1;return!0}return s===f},u.defaultEasing=q,u.derefLayers=function(h){h=h.slice();const s=Object.create(null);for(let f=0;f<h.length;f++)s[h[f].id]=h[f];for(let f=0;f<h.length;f++)"ref"in h[f]&&(h[f]=hr(h[f],s[h[f].ref]));return h},u.diffStyles=function(h,s){if(!h)return[{command:yr.setStyle,args:[s]}];let f=[];try{if(!$t(h.version,s.version))return[{command:yr.setStyle,args:[s]}];$t(h.center,s.center)||f.push({command:yr.setCenter,args:[s.center]}),$t(h.zoom,s.zoom)||f.push({command:yr.setZoom,args:[s.zoom]}),$t(h.bearing,s.bearing)||f.push({command:yr.setBearing,args:[s.bearing]}),$t(h.pitch,s.pitch)||f.push({command:yr.setPitch,args:[s.pitch]}),$t(h.sprite,s.sprite)||f.push({command:yr.setSprite,args:[s.sprite]}),$t(h.glyphs,s.glyphs)||f.push({command:yr.setGlyphs,args:[s.glyphs]}),$t(h.transition,s.transition)||f.push({command:yr.setTransition,args:[s.transition]}),$t(h.light,s.light)||f.push({command:yr.setLight,args:[s.light]});const y={},E=[];(function(T,D,z,Z){let te;for(te in D=D||{},T=T||{})Object.prototype.hasOwnProperty.call(T,te)&&(Object.prototype.hasOwnProperty.call(D,te)||rt(te,z,Z));for(te in D)Object.prototype.hasOwnProperty.call(D,te)&&(Object.prototype.hasOwnProperty.call(T,te)?$t(T[te],D[te])||(T[te].type==="geojson"&&D[te].type==="geojson"&&ce(T,D,te)?z.push({command:yr.setGeoJSONSourceData,args:[te,D[te].data]}):Se(te,D,z,Z)):nn(te,D,z))})(h.sources,s.sources,E,y);const C=[];h.layers&&h.layers.forEach(T=>{y[T.source]?f.push({command:yr.removeLayer,args:[T.id]}):C.push(T)}),f=f.concat(E),function(T,D,z){D=D||[];const Z=(T=T||[]).map(Be),te=D.map(Be),oe=T.reduce(Xe,{}),de=D.reduce(Xe,{}),_e=Z.slice(),Ee=Object.create(null);let Re,ze,Ge,nt,Ze,ot,st;for(Re=0,ze=0;Re<Z.length;Re++)Ge=Z[Re],Object.prototype.hasOwnProperty.call(de,Ge)?ze++:(z.push({command:yr.removeLayer,args:[Ge]}),_e.splice(_e.indexOf(Ge,ze),1));for(Re=0,ze=0;Re<te.length;Re++)Ge=te[te.length-1-Re],_e[_e.length-1-Re]!==Ge&&(Object.prototype.hasOwnProperty.call(oe,Ge)?(z.push({command:yr.removeLayer,args:[Ge]}),_e.splice(_e.lastIndexOf(Ge,_e.length-ze),1)):ze++,ot=_e[_e.length-Re],z.push({command:yr.addLayer,args:[de[Ge],ot]}),_e.splice(_e.length-Re,0,Ge),Ee[Ge]=!0);for(Re=0;Re<te.length;Re++)if(Ge=te[Re],nt=oe[Ge],Ze=de[Ge],!Ee[Ge]&&!$t(nt,Ze))if($t(nt.source,Ze.source)&&$t(nt["source-layer"],Ze["source-layer"])&&$t(nt.type,Ze.type)){for(st in ge(nt.layout,Ze.layout,z,Ge,null,yr.setLayoutProperty),ge(nt.paint,Ze.paint,z,Ge,null,yr.setPaintProperty),$t(nt.filter,Ze.filter)||z.push({command:yr.setFilter,args:[Ge,Ze.filter]}),$t(nt.minzoom,Ze.minzoom)&&$t(nt.maxzoom,Ze.maxzoom)||z.push({command:yr.setLayerZoomRange,args:[Ge,Ze.minzoom,Ze.maxzoom]}),nt)Object.prototype.hasOwnProperty.call(nt,st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&(st.indexOf("paint.")===0?ge(nt[st],Ze[st],z,Ge,st.slice(6),yr.setPaintProperty):$t(nt[st],Ze[st])||z.push({command:yr.setLayerProperty,args:[Ge,st,Ze[st]]}));for(st in Ze)Object.prototype.hasOwnProperty.call(Ze,st)&&!Object.prototype.hasOwnProperty.call(nt,st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&(st.indexOf("paint.")===0?ge(nt[st],Ze[st],z,Ge,st.slice(6),yr.setPaintProperty):$t(nt[st],Ze[st])||z.push({command:yr.setLayerProperty,args:[Ge,st,Ze[st]]}))}else z.push({command:yr.removeLayer,args:[Ge]}),ot=_e[_e.lastIndexOf(Ge)+1],z.push({command:yr.addLayer,args:[Ze,ot]})}(C,s.layers,f)}catch{f=[{command:yr.setStyle,args:[s]}]}return f},u.dot=function(h,s){return h[0]*s[0]+h[1]*s[1]+h[2]*s[2]+h[3]*s[3]},u.earthRadius=U0,u.emitValidationErrors=Ni,u.emptyStyle=function(){const h={},s=Ye.$version;for(const f in Ye.$root){const y=Ye.$root[f];if(y.required){let E=null;E=f==="version"?s:y.type==="array"?[]:{},E!=null&&(h[f]=E)}}return h},u.equals=function(h,s){var f=h[0],y=h[1],E=h[2],C=h[3],T=h[4],D=h[5],z=h[6],Z=h[7],te=h[8],oe=h[9],de=h[10],_e=h[11],Ee=h[12],Re=h[13],ze=h[14],Ge=h[15],nt=s[0],Ze=s[1],ot=s[2],st=s[3],xt=s[4],qt=s[5],cr=s[6],Gt=s[7],Bt=s[8],Dt=s[9],Jt=s[10],Ft=s[11],At=s[12],br=s[13],pr=s[14],Jr=s[15];return Math.abs(f-nt)<=ts*Math.max(1,Math.abs(f),Math.abs(nt))&&Math.abs(y-Ze)<=ts*Math.max(1,Math.abs(y),Math.abs(Ze))&&Math.abs(E-ot)<=ts*Math.max(1,Math.abs(E),Math.abs(ot))&&Math.abs(C-st)<=ts*Math.max(1,Math.abs(C),Math.abs(st))&&Math.abs(T-xt)<=ts*Math.max(1,Math.abs(T),Math.abs(xt))&&Math.abs(D-qt)<=ts*Math.max(1,Math.abs(D),Math.abs(qt))&&Math.abs(z-cr)<=ts*Math.max(1,Math.abs(z),Math.abs(cr))&&Math.abs(Z-Gt)<=ts*Math.max(1,Math.abs(Z),Math.abs(Gt))&&Math.abs(te-Bt)<=ts*Math.max(1,Math.abs(te),Math.abs(Bt))&&Math.abs(oe-Dt)<=ts*Math.max(1,Math.abs(oe),Math.abs(Dt))&&Math.abs(de-Jt)<=ts*Math.max(1,Math.abs(de),Math.abs(Jt))&&Math.abs(_e-Ft)<=ts*Math.max(1,Math.abs(_e),Math.abs(Ft))&&Math.abs(Ee-At)<=ts*Math.max(1,Math.abs(Ee),Math.abs(At))&&Math.abs(Re-br)<=ts*Math.max(1,Math.abs(Re),Math.abs(br))&&Math.abs(ze-pr)<=ts*Math.max(1,Math.abs(ze),Math.abs(pr))&&Math.abs(Ge-Jr)<=ts*Math.max(1,Math.abs(Ge),Math.abs(Jr))},u.evaluateSizeForFeature=function(h,{uSize:s,uSizeT:f},{lowerSize:y,upperSize:E}){return h.kind==="source"?y/hl:h.kind==="composite"?Ti.number(y/hl,E/hl,f):s},u.evaluateSizeForZoom=function(h,s){let f=0,y=0;if(h.kind==="constant")y=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:E,minZoom:C,maxZoom:T}=h,D=E?X(Yr.interpolationFactor(E,s,C,T),0,1):0;h.kind==="camera"?y=Ti.number(h.minSize,h.maxSize,D):f=D}return{uSizeT:f,uSize:y}},u.evented=ou,u.extend=k,u.filterObject=ue,u.findLineIntersection=function(h,s,f,y){const E=s.y-h.y,C=s.x-h.x,T=y.y-f.y,D=y.x-f.x,z=T*C-D*E;if(z===0)return null;const Z=(D*(h.y-f.y)-T*(h.x-f.x))/z;return new P(h.x+Z*C,h.y+Z*E)},u.fromScaling=function(h,s){return h[0]=s[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=s[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=s[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},u.getAnchorAlignment=N0,u.getAnchorJustification=V0,u.getArrayBuffer=He,u.getDefaultExportFromCjs=_,u.getJSON=function(h,s){return We(k(h,{type:"json"}),s)},u.getOverlapMode=F0,u.getProtocolAction=De,u.getRTLTextPluginStatus=ys,u.getReferrer=se,u.getVideo=function(h,s){const f=window.document.createElement("video");f.muted=!0,f.onloadstart=function(){s(null,f)};for(let y=0;y<h.length;y++){const E=window.document.createElement("source");dt(h[y])||(f.crossOrigin="Anonymous"),E.src=h[y],f.appendChild(E)}return{cancel:()=>{}}},u.groupByLayout=function(h,s){const f={};for(let E=0;E<h.length;E++){const C=s&&s[h[E].id]||Ta(h[E]);s&&(s[h[E].id]=C);let T=f[C];T||(T=f[C]=[]),T.push(h[E])}const y=[];for(const E in f)y.push(f[E]);return y},u.identity=m0,u.interpolate=Ti,u.invert=function(h,s){var f=s[0],y=s[1],E=s[2],C=s[3],T=s[4],D=s[5],z=s[6],Z=s[7],te=s[8],oe=s[9],de=s[10],_e=s[11],Ee=s[12],Re=s[13],ze=s[14],Ge=s[15],nt=f*D-y*T,Ze=f*z-E*T,ot=f*Z-C*T,st=y*z-E*D,xt=y*Z-C*D,qt=E*Z-C*z,cr=te*Re-oe*Ee,Gt=te*ze-de*Ee,Bt=te*Ge-_e*Ee,Dt=oe*ze-de*Re,Jt=oe*Ge-_e*Re,Ft=de*Ge-_e*ze,At=nt*Ft-Ze*Jt+ot*Dt+st*Bt-xt*Gt+qt*cr;return At?(h[0]=(D*Ft-z*Jt+Z*Dt)*(At=1/At),h[1]=(E*Jt-y*Ft-C*Dt)*At,h[2]=(Re*qt-ze*xt+Ge*st)*At,h[3]=(de*xt-oe*qt-_e*st)*At,h[4]=(z*Bt-T*Ft-Z*Gt)*At,h[5]=(f*Ft-E*Bt+C*Gt)*At,h[6]=(ze*ot-Ee*qt-Ge*Ze)*At,h[7]=(te*qt-de*ot+_e*Ze)*At,h[8]=(T*Jt-D*Bt+Z*cr)*At,h[9]=(y*Bt-f*Jt-C*cr)*At,h[10]=(Ee*xt-Re*ot+Ge*nt)*At,h[11]=(oe*ot-te*xt-_e*nt)*At,h[12]=(D*Gt-T*Dt-z*cr)*At,h[13]=(f*Dt-y*Gt+E*cr)*At,h[14]=(Re*Ze-Ee*st-ze*nt)*At,h[15]=(te*st-oe*Ze+de*nt)*At,h):null},u.isImageBitmap=ct,u.isSafari=ae,u.isWorker=Oe,u.keysDifference=function(h,s){const f=[];for(const y in h)y in s||f.push(y);return f},u.lazyLoadRTLTextPlugin=function(){Jn.isLoading()||Jn.isLoaded()||ys()!=="deferred"||ki()},u.makeRequest=We,u.mapObject=H,u.mercatorXfromLng=qP,u.mercatorYfromLat=VP,u.mercatorZfromAltitude=XP,u.mul=YF,u.mul$1=function(h,s,f){return h[0]=s[0]*f[0],h[1]=s[1]*f[1],h[2]=s[2]*f[2],h[3]=s[3]*f[3],h},u.multiply=ZS,u.nextPowerOfTwo=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},u.operations=yr,u.ortho=function(h,s,f,y,E,C,T){var D=1/(s-f),z=1/(y-E),Z=1/(C-T);return h[0]=-2*D,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*z,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*Z,h[11]=0,h[12]=(s+f)*D,h[13]=(E+y)*z,h[14]=(T+C)*Z,h[15]=1,h},u.parseCacheControl=function(h){const s={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(f,y,E,C)=>{const T=E||C;return s[y]=!T||T.toLowerCase(),""}),s["max-age"]){const f=parseInt(s["max-age"],10);isNaN(f)?delete s["max-age"]:s["max-age"]=f}return s},u.parseGlyphPbf=function(h){return new M0(h).readFields(Kk,[])},u.pbf=xP,u.performSymbolLayout=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=Yi/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const s=h.bucket.layers[0],f=s.layout,y=s._unevaluatedLayout._values,E={layoutIconSize:y["icon-size"].possiblyEvaluate(new Kn(h.bucket.zoom+1),h.canonical),layoutTextSize:y["text-size"].possiblyEvaluate(new Kn(h.bucket.zoom+1),h.canonical),textMaxSize:y["text-size"].possiblyEvaluate(new Kn(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:te}=h.bucket.textSizeData;E.compositeTextSizes=[y["text-size"].possiblyEvaluate(new Kn(Z),h.canonical),y["text-size"].possiblyEvaluate(new Kn(te),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:te}=h.bucket.iconSizeData;E.compositeIconSizes=[y["icon-size"].possiblyEvaluate(new Kn(Z),h.canonical),y["icon-size"].possiblyEvaluate(new Kn(te),h.canonical)]}const C=f.get("text-line-height")*Ro,T=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",D=f.get("text-keep-upright"),z=f.get("text-size");for(const Z of h.bucket.features){const te=f.get("text-font").evaluate(Z,{},h.canonical).join(","),oe=z.evaluate(Z,{},h.canonical),de=E.layoutTextSize.evaluate(Z,{},h.canonical),_e=E.layoutIconSize.evaluate(Z,{},h.canonical),Ee={horizontal:{},vertical:void 0},Re=Z.text;let ze,Ge=[0,0];if(Re){const ot=Re.toString(),st=f.get("text-letter-spacing").evaluate(Z,{},h.canonical)*Ro,xt=Ra(ot)?st:0,qt=f.get("text-anchor").evaluate(Z,{},h.canonical),cr=cA(s,Z,h.canonical);if(!cr){const Ft=f.get("text-radial-offset").evaluate(Z,{},h.canonical);Ge=Ft?lA(qt,[Ft*Ro,q0]):f.get("text-offset").evaluate(Z,{},h.canonical).map(At=>At*Ro)}let Gt=T?"center":f.get("text-justify").evaluate(Z,{},h.canonical);const Bt=f.get("symbol-placement"),Dt=Bt==="point"?f.get("text-max-width").evaluate(Z,{},h.canonical)*Ro:0,Jt=()=>{h.bucket.allowVerticalPlacement&&sl(ot)&&(Ee.vertical=Mg(Re,h.glyphMap,h.glyphPositions,h.imagePositions,te,Dt,C,qt,"left",xt,Ge,u.WritingMode.vertical,!0,Bt,de,oe))};if(!T&&cr){const Ft=new Set;if(Gt==="auto")for(let br=0;br<cr.values.length;br+=2)Ft.add(V0(cr.values[br]));else Ft.add(Gt);let At=!1;for(const br of Ft)if(!Ee.horizontal[br])if(At)Ee.horizontal[br]=Ee.horizontal[0];else{const pr=Mg(Re,h.glyphMap,h.glyphPositions,h.imagePositions,te,Dt,C,"center",br,xt,Ge,u.WritingMode.horizontal,!1,Bt,de,oe);pr&&(Ee.horizontal[br]=pr,At=pr.positionedLines.length===1)}Jt()}else{Gt==="auto"&&(Gt=V0(qt));const Ft=Mg(Re,h.glyphMap,h.glyphPositions,h.imagePositions,te,Dt,C,qt,Gt,xt,Ge,u.WritingMode.horizontal,!1,Bt,de,oe);Ft&&(Ee.horizontal[Gt]=Ft),Jt(),sl(ot)&&T&&D&&(Ee.vertical=Mg(Re,h.glyphMap,h.glyphPositions,h.imagePositions,te,Dt,C,qt,Gt,xt,Ge,u.WritingMode.vertical,!1,Bt,de,oe))}}let nt=!1;if(Z.icon&&Z.icon.name){const ot=h.imageMap[Z.icon.name];ot&&(ze=i3(h.imagePositions[Z.icon.name],f.get("icon-offset").evaluate(Z,{},h.canonical),f.get("icon-anchor").evaluate(Z,{},h.canonical)),nt=!!ot.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=nt:h.bucket.sdfIcons!==nt&&W("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ot.pixelRatio!==h.bucket.pixelRatio||f.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const Ze=fA(Ee.horizontal)||Ee.vertical;h.bucket.iconsInText=!!Ze&&Ze.iconsInText,(Ze||ze)&&x3(h.bucket,Z,Ee,ze,h.imageMap,E,de,_e,Ge,nt,h.canonical)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},u.perspective=function(h,s,f,y,E){var C,T=1/Math.tan(s/2);return h[0]=T/f,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=T,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,E!=null&&E!==1/0?(h[10]=(E+y)*(C=1/(y-E)),h[14]=2*E*y*C):(h[10]=-1,h[14]=-2*y),h},u.pick=function(h,s){const f={};for(let y=0;y<s.length;y++){const E=s[y];E in h&&(f[E]=h[E])}return f},u.plugin=Jn,u.pointGeometry=m,u.polygonIntersectsPolygon=GS,u.potpack=CP,u.register=Yt,u.registerForPluginStateChange=function(h){return h({pluginStatus:na,pluginURL:yi}),ou.on("pluginStateChange",h),h},u.renderColorRamp=eP,u.rotateX=function(h,s,f){var y=Math.sin(f),E=Math.cos(f),C=s[4],T=s[5],D=s[6],z=s[7],Z=s[8],te=s[9],oe=s[10],de=s[11];return s!==h&&(h[0]=s[0],h[1]=s[1],h[2]=s[2],h[3]=s[3],h[12]=s[12],h[13]=s[13],h[14]=s[14],h[15]=s[15]),h[4]=C*E+Z*y,h[5]=T*E+te*y,h[6]=D*E+oe*y,h[7]=z*E+de*y,h[8]=Z*E-C*y,h[9]=te*E-T*y,h[10]=oe*E-D*y,h[11]=de*E-z*y,h},u.rotateZ=function(h,s,f){var y=Math.sin(f),E=Math.cos(f),C=s[0],T=s[1],D=s[2],z=s[3],Z=s[4],te=s[5],oe=s[6],de=s[7];return s!==h&&(h[8]=s[8],h[9]=s[9],h[10]=s[10],h[11]=s[11],h[12]=s[12],h[13]=s[13],h[14]=s[14],h[15]=s[15]),h[0]=C*E+Z*y,h[1]=T*E+te*y,h[2]=D*E+oe*y,h[3]=z*E+de*y,h[4]=Z*E-C*y,h[5]=te*E-T*y,h[6]=oe*E-D*y,h[7]=de*E-z*y,h},u.sameOrigin=dt,u.scale=function(h,s,f){var y=f[0],E=f[1],C=f[2];return h[0]=s[0]*y,h[1]=s[1]*y,h[2]=s[2]*y,h[3]=s[3]*y,h[4]=s[4]*E,h[5]=s[5]*E,h[6]=s[6]*E,h[7]=s[7]*E,h[8]=s[8]*C,h[9]=s[9]*C,h[10]=s[10]*C,h[11]=s[11]*C,h[12]=s[12],h[13]=s[13],h[14]=s[14],h[15]=s[15],h},u.setRTLTextPlugin=function(h,s,f=!1){if(na===so||na===ra||na===oi)throw new Error("setRTLTextPlugin cannot be called multiple times.");yi=he.resolveURL(h),na=so,oc=s,Rl(),f||ki()},u.sphericalToCartesian=function([h,s,f]){return s+=90,s*=Math.PI/180,f*=Math.PI/180,{x:h*Math.cos(s)*Math.sin(f),y:h*Math.sin(s)*Math.sin(f),z:h*Math.cos(f)}},u.toEvaluationFeature=cl,u.transformMat4=Sg,u.translate=function(h,s,f){var y,E,C,T,D,z,Z,te,oe,de,_e,Ee,Re=f[0],ze=f[1],Ge=f[2];return s===h?(h[12]=s[0]*Re+s[4]*ze+s[8]*Ge+s[12],h[13]=s[1]*Re+s[5]*ze+s[9]*Ge+s[13],h[14]=s[2]*Re+s[6]*ze+s[10]*Ge+s[14],h[15]=s[3]*Re+s[7]*ze+s[11]*Ge+s[15]):(E=s[1],C=s[2],T=s[3],D=s[4],z=s[5],Z=s[6],te=s[7],oe=s[8],de=s[9],_e=s[10],Ee=s[11],h[0]=y=s[0],h[1]=E,h[2]=C,h[3]=T,h[4]=D,h[5]=z,h[6]=Z,h[7]=te,h[8]=oe,h[9]=de,h[10]=_e,h[11]=Ee,h[12]=y*Re+D*ze+oe*Ge+s[12],h[13]=E*Re+z*ze+de*Ge+s[13],h[14]=C*Re+Z*ze+_e*Ge+s[14],h[15]=T*Re+te*ze+Ee*Ge+s[15]),h},u.triggerPluginCompletionEvent=vs,u.unicodeBlockLookup=It,u.uniqueId=function(){return U++},u.v8Spec=Ye,u.validateCustomStyleLayer=function(h){const s=[],f=h.id;return f===void 0&&s.push({message:`layers.${f}: missing required property "id"`}),h.render===void 0&&s.push({message:`layers.${f}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&s.push({message:`layers.${f}: property "renderingMode" must be either "2d" or "3d"`}),s},u.validateLight=nu,u.validateStyle=al,u.vectorTile=lc,u.warnOnce=W,u.wrap=R}),l(["./shared"],function(u){class _{constructor(ne){this.keyCache={},ne&&this.replace(ne)}replace(ne){this._layerConfigs={},this._layers={},this.update(ne,[])}update(ne,pe){for(const Ne of ne){this._layerConfigs[Ne.id]=Ne;const Ue=this._layers[Ne.id]=u.createStyleLayer(Ne);Ue._featureFilter=u.createFilter(Ue.filter),this.keyCache[Ne.id]&&delete this.keyCache[Ne.id]}for(const Ne of pe)delete this.keyCache[Ne],delete this._layerConfigs[Ne],delete this._layers[Ne];this.familiesBySource={};const Ie=u.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const Ne of Ie){const Ue=Ne.map(vt=>this._layers[vt.id]),et=Ue[0];if(et.visibility==="none")continue;const Ve=et.source||"";let qe=this.familiesBySource[Ve];qe||(qe=this.familiesBySource[Ve]={});const Ke=et.sourceLayer||"_geojsonTileLayer";let gt=qe[Ke];gt||(gt=qe[Ke]=[]),gt.push(Ue)}}}class m{constructor(ne){const pe={},Ie=[];for(const Ve in ne){const qe=ne[Ve],Ke=pe[Ve]={};for(const gt in qe){const vt=qe[+gt];if(!vt||vt.bitmap.width===0||vt.bitmap.height===0)continue;const ft={x:0,y:0,w:vt.bitmap.width+2,h:vt.bitmap.height+2};Ie.push(ft),Ke[gt]={rect:ft,metrics:vt.metrics}}}const{w:Ne,h:Ue}=u.potpack(Ie),et=new u.AlphaImage({width:Ne||1,height:Ue||1});for(const Ve in ne){const qe=ne[Ve];for(const Ke in qe){const gt=qe[+Ke];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;const vt=pe[Ve][Ke].rect;u.AlphaImage.copy(gt.bitmap,et,{x:0,y:0},{x:vt.x+1,y:vt.y+1},gt.bitmap)}}this.image=et,this.positions=pe}}u.register("GlyphAtlas",m);class S{constructor(ne){this.tileID=new u.OverscaledTileID(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.uid=ne.uid,this.zoom=ne.zoom,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.returnDependencies=!!ne.returnDependencies,this.promoteId=ne.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(ne,pe,Ie,Ne,Ue){this.status="parsing",this.data=ne,this.collisionBoxArray=new u.CollisionBoxArray;const et=new u.DictionaryCoder(Object.keys(ne.layers).sort()),Ve=new u.FeatureIndex(this.tileID,this.promoteId);Ve.bucketLayerIDs=[];const qe={},Ke={featureIndex:Ve,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ie},gt=pe.familiesBySource[this.source];for(const zr in gt){const Cr=ne.layers[zr];if(!Cr)continue;Cr.version===1&&u.warnOnce(`Vector tile source "${this.source}" layer "${zr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Zi=et.encode(zr),Ut=[];for(let Fr=0;Fr<Cr.length;Fr++){const _t=Cr.feature(Fr),Vr=Ve.getId(_t,zr);Ut.push({feature:_t,id:Vr,index:Fr,sourceLayerIndex:Zi})}for(const Fr of gt[zr]){const _t=Fr[0];_t.source!==this.source&&u.warnOnce(`layer.source = ${_t.source} does not equal this.source = ${this.source}`),_t.minzoom&&this.zoom<Math.floor(_t.minzoom)||_t.maxzoom&&this.zoom>=_t.maxzoom||_t.visibility!=="none"&&(P(Fr,this.zoom,Ie),(qe[_t.id]=_t.createBucket({index:Ve.bucketLayerIDs.length,layers:Fr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Zi,sourceID:this.source})).populate(Ut,Ke,this.tileID.canonical),Ve.bucketLayerIDs.push(Fr.map(Vr=>Vr.id)))}}let vt,ft,Ot,ur;const jt=u.mapObject(Ke.glyphDependencies,zr=>Object.keys(zr).map(Number));this.inFlightDependencies.forEach(zr=>zr==null?void 0:zr.cancel()),this.inFlightDependencies=[];const Xt=++this.dependencySentinel;Object.keys(jt).length?this.inFlightDependencies.push(Ne.send("getGlyphs",{uid:this.uid,stacks:jt,source:this.source,tileID:this.tileID,type:"glyphs"},(zr,Cr)=>{Xt===this.dependencySentinel&&(vt||(vt=zr,ft=Cr,$r.call(this)))})):ft={};const Ht=Object.keys(Ke.iconDependencies);Ht.length?this.inFlightDependencies.push(Ne.send("getImages",{icons:Ht,source:this.source,tileID:this.tileID,type:"icons"},(zr,Cr)=>{Xt===this.dependencySentinel&&(vt||(vt=zr,Ot=Cr,$r.call(this)))})):Ot={};const Ur=Object.keys(Ke.patternDependencies);function $r(){if(vt)return Ue(vt);if(ft&&Ot&&ur){const zr=new m(ft),Cr=new u.ImageAtlas(Ot,ur);for(const Zi in qe){const Ut=qe[Zi];Ut instanceof u.SymbolBucket?(P(Ut.layers,this.zoom,Ie),u.performSymbolLayout({bucket:Ut,glyphMap:ft,glyphPositions:zr.positions,imageMap:Ot,imagePositions:Cr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ut.hasPattern&&(Ut instanceof u.LineBucket||Ut instanceof u.FillBucket||Ut instanceof u.FillExtrusionBucket)&&(P(Ut.layers,this.zoom,Ie),Ut.addFeatures(Ke,this.tileID.canonical,Cr.patternPositions))}this.status="done",Ue(null,{buckets:Object.values(qe).filter(Zi=>!Zi.isEmpty()),featureIndex:Ve,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:zr.image,imageAtlas:Cr,glyphMap:this.returnDependencies?ft:null,iconMap:this.returnDependencies?Ot:null,glyphPositions:this.returnDependencies?zr.positions:null})}}Ur.length?this.inFlightDependencies.push(Ne.send("getImages",{icons:Ur,source:this.source,tileID:this.tileID,type:"patterns"},(zr,Cr)=>{Xt===this.dependencySentinel&&(vt||(vt=zr,ur=Cr,$r.call(this)))})):ur={},$r.call(this)}}function P(Le,ne,pe){const Ie=new u.EvaluationParameters(ne);for(const Ne of Le)Ne.recalculate(Ie,pe)}function O(Le,ne){const pe=u.getArrayBuffer(Le.request,(Ie,Ne,Ue,et)=>{Ie?ne(Ie):Ne&&ne(null,{vectorTile:new u.vectorTile.VectorTile(new u.Protobuf(Ne)),rawData:Ne,cacheControl:Ue,expires:et})});return()=>{pe.cancel(),ne()}}class M{constructor(ne,pe,Ie,Ne){this.actor=ne,this.layerIndex=pe,this.availableImages=Ie,this.loadVectorData=Ne||O,this.fetching={},this.loading={},this.loaded={}}loadTile(ne,pe){const Ie=ne.uid;this.loading||(this.loading={});const Ne=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new u.RequestPerformance(ne.request),Ue=this.loading[Ie]=new S(ne);Ue.abort=this.loadVectorData(ne,(et,Ve)=>{if(delete this.loading[Ie],et||!Ve)return Ue.status="done",this.loaded[Ie]=Ue,pe(et);const qe=Ve.rawData,Ke={};Ve.expires&&(Ke.expires=Ve.expires),Ve.cacheControl&&(Ke.cacheControl=Ve.cacheControl);const gt={};if(Ne){const vt=Ne.finish();vt&&(gt.resourceTiming=JSON.parse(JSON.stringify(vt)))}Ue.vectorTile=Ve.vectorTile,Ue.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,(vt,ft)=>{if(delete this.fetching[Ie],vt||!ft)return pe(vt);pe(null,u.extend({rawTileData:qe.slice(0)},ft,Ke,gt))}),this.loaded=this.loaded||{},this.loaded[Ie]=Ue,this.fetching[Ie]={rawTileData:qe,cacheControl:Ke,resourceTiming:gt}})}reloadTile(ne,pe){const Ie=this.loaded,Ne=ne.uid;if(Ie&&Ie[Ne]){const Ue=Ie[Ne];Ue.showCollisionBoxes=ne.showCollisionBoxes,Ue.status==="parsing"?Ue.parse(Ue.vectorTile,this.layerIndex,this.availableImages,this.actor,(et,Ve)=>{if(et||!Ve)return pe(et,Ve);let qe;if(this.fetching[Ne]){const{rawTileData:Ke,cacheControl:gt,resourceTiming:vt}=this.fetching[Ne];delete this.fetching[Ne],qe=u.extend({rawTileData:Ke.slice(0)},Ve,gt,vt)}else qe=Ve;pe(null,qe)}):Ue.status==="done"&&(Ue.vectorTile?Ue.parse(Ue.vectorTile,this.layerIndex,this.availableImages,this.actor,pe):pe())}}abortTile(ne,pe){const Ie=this.loading,Ne=ne.uid;Ie&&Ie[Ne]&&Ie[Ne].abort&&(Ie[Ne].abort(),delete Ie[Ne]),pe()}removeTile(ne,pe){const Ie=this.loaded,Ne=ne.uid;Ie&&Ie[Ne]&&delete Ie[Ne],pe()}}class B{constructor(){this.loaded={}}loadTile(ne,pe){const{uid:Ie,encoding:Ne,rawImageData:Ue}=ne,et=u.isImageBitmap(Ue)?this.getImageData(Ue):Ue,Ve=new u.DEMData(Ie,et,Ne);this.loaded=this.loaded||{},this.loaded[Ie]=Ve,pe(null,Ve)}getImageData(ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);const pe=this.offscreenCanvasContext.getImageData(-1,-1,ne.width+2,ne.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new u.RGBAImage({width:pe.width,height:pe.height},pe.data)}removeTile(ne){const pe=this.loaded,Ie=ne.uid;pe&&pe[Ie]&&delete pe[Ie]}}function $(Le,ne){if(Le.length!==0){q(Le[0],ne);for(var pe=1;pe<Le.length;pe++)q(Le[pe],!ne)}}function q(Le,ne){for(var pe=0,Ie=0,Ne=0,Ue=Le.length,et=Ue-1;Ne<Ue;et=Ne++){var Ve=(Le[Ne][0]-Le[et][0])*(Le[et][1]+Le[Ne][1]),qe=pe+Ve;Ie+=Math.abs(pe)>=Math.abs(Ve)?pe-qe+Ve:Ve-qe+pe,pe=qe}pe+Ie>=0!=!!ne&&Le.reverse()}var X=u.getDefaultExportFromCjs(function Le(ne,pe){var Ie,Ne=ne&&ne.type;if(Ne==="FeatureCollection")for(Ie=0;Ie<ne.features.length;Ie++)Le(ne.features[Ie],pe);else if(Ne==="GeometryCollection")for(Ie=0;Ie<ne.geometries.length;Ie++)Le(ne.geometries[Ie],pe);else if(Ne==="Feature")Le(ne.geometry,pe);else if(Ne==="Polygon")$(ne.coordinates,pe);else if(Ne==="MultiPolygon")for(Ie=0;Ie<ne.coordinates.length;Ie++)$(ne.coordinates[Ie],pe);return ne});const R=u.vectorTile.VectorTileFeature.prototype.toGeoJSON;var k={exports:{}},U=u.pointGeometry,H=u.vectorTile.VectorTileFeature,ue=ie;function ie(Le,ne){this.options=ne||{},this.features=Le,this.length=Le.length}function ee(Le,ne){this.id=typeof Le.id=="number"?Le.id:void 0,this.type=Le.type,this.rawGeometry=Le.type===1?[Le.geometry]:Le.geometry,this.properties=Le.tags,this.extent=ne||4096}ie.prototype.feature=function(Le){return new ee(this.features[Le],this.options.extent)},ee.prototype.loadGeometry=function(){var Le=this.rawGeometry;this.geometry=[];for(var ne=0;ne<Le.length;ne++){for(var pe=Le[ne],Ie=[],Ne=0;Ne<pe.length;Ne++)Ie.push(new U(pe[Ne][0],pe[Ne][1]));this.geometry.push(Ie)}return this.geometry},ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Le=this.geometry,ne=1/0,pe=-1/0,Ie=1/0,Ne=-1/0,Ue=0;Ue<Le.length;Ue++)for(var et=Le[Ue],Ve=0;Ve<et.length;Ve++){var qe=et[Ve];ne=Math.min(ne,qe.x),pe=Math.max(pe,qe.x),Ie=Math.min(Ie,qe.y),Ne=Math.max(Ne,qe.y)}return[ne,Ie,pe,Ne]},ee.prototype.toGeoJSON=H.prototype.toGeoJSON;var W=u.pbf,J=ue;function be(Le){var ne=new W;return function(pe,Ie){for(var Ne in pe.layers)Ie.writeMessage(3,Oe,pe.layers[Ne])}(Le,ne),ne.finish()}function Oe(Le,ne){var pe;ne.writeVarintField(15,Le.version||1),ne.writeStringField(1,Le.name||""),ne.writeVarintField(5,Le.extent||4096);var Ie={keys:[],values:[],keycache:{},valuecache:{}};for(pe=0;pe<Le.length;pe++)Ie.feature=Le.feature(pe),ne.writeMessage(2,Ae,Ie);var Ne=Ie.keys;for(pe=0;pe<Ne.length;pe++)ne.writeStringField(3,Ne[pe]);var Ue=Ie.values;for(pe=0;pe<Ue.length;pe++)ne.writeMessage(4,Q,Ue[pe])}function Ae(Le,ne){var pe=Le.feature;pe.id!==void 0&&ne.writeVarintField(1,pe.id),ne.writeMessage(2,ae,Le),ne.writeVarintField(3,pe.type),ne.writeMessage(4,V,pe)}function ae(Le,ne){var pe=Le.feature,Ie=Le.keys,Ne=Le.values,Ue=Le.keycache,et=Le.valuecache;for(var Ve in pe.properties){var qe=pe.properties[Ve],Ke=Ue[Ve];if(qe!==null){Ke===void 0&&(Ie.push(Ve),Ue[Ve]=Ke=Ie.length-1),ne.writeVarint(Ke);var gt=typeof qe;gt!=="string"&&gt!=="boolean"&&gt!=="number"&&(qe=JSON.stringify(qe));var vt=gt+":"+qe,ft=et[vt];ft===void 0&&(Ne.push(qe),et[vt]=ft=Ne.length-1),ne.writeVarint(ft)}}}function ct(Le,ne){return(ne<<3)+(7&Le)}function Pe(Le){return Le<<1^Le>>31}function V(Le,ne){for(var pe=Le.loadGeometry(),Ie=Le.type,Ne=0,Ue=0,et=pe.length,Ve=0;Ve<et;Ve++){var qe=pe[Ve],Ke=1;Ie===1&&(Ke=qe.length),ne.writeVarint(ct(1,Ke));for(var gt=Ie===3?qe.length-1:qe.length,vt=0;vt<gt;vt++){vt===1&&Ie!==1&&ne.writeVarint(ct(2,gt-1));var ft=qe[vt].x-Ne,Ot=qe[vt].y-Ue;ne.writeVarint(Pe(ft)),ne.writeVarint(Pe(Ot)),Ne+=ft,Ue+=Ot}Ie===3&&ne.writeVarint(ct(7,1))}}function Q(Le,ne){var pe=typeof Le;pe==="string"?ne.writeStringField(1,Le):pe==="boolean"?ne.writeBooleanField(7,Le):pe==="number"&&(Le%1!=0?ne.writeDoubleField(3,Le):Le<0?ne.writeSVarintField(6,Le):ne.writeVarintField(5,Le))}k.exports=be,k.exports.fromVectorTileJs=be,k.exports.fromGeojsonVt=function(Le,ne){ne=ne||{};var pe={};for(var Ie in Le)pe[Ie]=new J(Le[Ie].features,ne),pe[Ie].name=Ie,pe[Ie].version=ne.version,pe[Ie].extent=ne.extent;return be({layers:pe})},k.exports.GeoJSONWrapper=J;var he=u.getDefaultExportFromCjs(k.exports);const fe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Le=>Le},ye=Math.fround||(se=new Float32Array(1),Le=>(se[0]=+Le,se[0]));var se;const De=3,ke=5,We=6;class He{constructor(ne){this.options=Object.assign(Object.create(fe),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:pe,minZoom:Ie,maxZoom:Ne}=this.options,Ue=`prepare ${ne.length} points`;this.points=ne;const et=[];for(let qe=0;qe<ne.length;qe++){const Ke=ne[qe];if(!Ke.geometry)continue;const[gt,vt]=Ke.geometry.coordinates,ft=ye(Lt(gt)),Ot=ye(pt(vt));et.push(ft,Ot,1/0,qe,-1,1),this.options.reduce&&et.push(0)}let Ve=this.trees[Ne+1]=this._createTree(et);for(let qe=Ne;qe>=Ie;qe--){const Ke=+Date.now();Ve=this.trees[qe]=this._createTree(this._cluster(Ve,qe))}return this}getClusters(ne,pe){let Ie=((ne[0]+180)%360+360)%360-180;const Ne=Math.max(-90,Math.min(90,ne[1]));let Ue=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const et=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)Ie=-180,Ue=180;else if(Ie>Ue){const vt=this.getClusters([Ie,Ne,180,et],pe),ft=this.getClusters([-180,Ne,Ue,et],pe);return vt.concat(ft)}const Ve=this.trees[this._limitZoom(pe)],qe=Ve.range(Lt(Ie),pt(et),Lt(Ue),pt(Ne)),Ke=Ve.data,gt=[];for(const vt of qe){const ft=this.stride*vt;gt.push(Ke[ft+ke]>1?dt(Ke,ft,this.clusterProps):this.points[Ke[ft+De]])}return gt}getChildren(ne){const pe=this._getOriginId(ne),Ie=this._getOriginZoom(ne),Ne="No cluster with the specified id.",Ue=this.trees[Ie];if(!Ue)throw new Error(Ne);const et=Ue.data;if(pe*this.stride>=et.length)throw new Error(Ne);const Ve=this.options.radius/(this.options.extent*Math.pow(2,Ie-1)),qe=Ue.within(et[pe*this.stride],et[pe*this.stride+1],Ve),Ke=[];for(const gt of qe){const vt=gt*this.stride;et[vt+4]===ne&&Ke.push(et[vt+ke]>1?dt(et,vt,this.clusterProps):this.points[et[vt+De]])}if(Ke.length===0)throw new Error(Ne);return Ke}getLeaves(ne,pe,Ie){const Ne=[];return this._appendLeaves(Ne,ne,pe=pe||10,Ie=Ie||0,0),Ne}getTile(ne,pe,Ie){const Ne=this.trees[this._limitZoom(ne)],Ue=Math.pow(2,ne),{extent:et,radius:Ve}=this.options,qe=Ve/et,Ke=(Ie-qe)/Ue,gt=(Ie+1+qe)/Ue,vt={features:[]};return this._addTileFeatures(Ne.range((pe-qe)/Ue,Ke,(pe+1+qe)/Ue,gt),Ne.data,pe,Ie,Ue,vt),pe===0&&this._addTileFeatures(Ne.range(1-qe/Ue,Ke,1,gt),Ne.data,Ue,Ie,Ue,vt),pe===Ue-1&&this._addTileFeatures(Ne.range(0,Ke,qe/Ue,gt),Ne.data,-1,Ie,Ue,vt),vt.features.length?vt:null}getClusterExpansionZoom(ne){let pe=this._getOriginZoom(ne)-1;for(;pe<=this.options.maxZoom;){const Ie=this.getChildren(ne);if(pe++,Ie.length!==1)break;ne=Ie[0].properties.cluster_id}return pe}_appendLeaves(ne,pe,Ie,Ne,Ue){const et=this.getChildren(pe);for(const Ve of et){const qe=Ve.properties;if(qe&&qe.cluster?Ue+qe.point_count<=Ne?Ue+=qe.point_count:Ue=this._appendLeaves(ne,qe.cluster_id,Ie,Ne,Ue):Ue<Ne?Ue++:ne.push(Ve),ne.length===Ie)break}return Ue}_createTree(ne){const pe=new u.KDBush(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ie=0;Ie<ne.length;Ie+=this.stride)pe.add(ne[Ie],ne[Ie+1]);return pe.finish(),pe.data=ne,pe}_addTileFeatures(ne,pe,Ie,Ne,Ue,et){for(const Ve of ne){const qe=Ve*this.stride,Ke=pe[qe+ke]>1;let gt,vt,ft;if(Ke)gt=yt(pe,qe,this.clusterProps),vt=pe[qe],ft=pe[qe+1];else{const jt=this.points[pe[qe+De]];gt=jt.properties;const[Xt,Ht]=jt.geometry.coordinates;vt=Lt(Xt),ft=pt(Ht)}const Ot={type:1,geometry:[[Math.round(this.options.extent*(vt*Ue-Ie)),Math.round(this.options.extent*(ft*Ue-Ne))]],tags:gt};let ur;ur=Ke||this.options.generateId?pe[qe+De]:this.points[pe[qe+De]].id,ur!==void 0&&(Ot.id=ur),et.features.push(Ot)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,pe){const{radius:Ie,extent:Ne,reduce:Ue,minPoints:et}=this.options,Ve=Ie/(Ne*Math.pow(2,pe)),qe=ne.data,Ke=[],gt=this.stride;for(let vt=0;vt<qe.length;vt+=gt){if(qe[vt+2]<=pe)continue;qe[vt+2]=pe;const ft=qe[vt],Ot=qe[vt+1],ur=ne.within(qe[vt],qe[vt+1],Ve),jt=qe[vt+ke];let Xt=jt;for(const Ht of ur){const Ur=Ht*gt;qe[Ur+2]>pe&&(Xt+=qe[Ur+ke])}if(Xt>jt&&Xt>=et){let Ht,Ur=ft*jt,$r=Ot*jt,zr=-1;const Cr=((vt/gt|0)<<5)+(pe+1)+this.points.length;for(const Zi of ur){const Ut=Zi*gt;if(qe[Ut+2]<=pe)continue;qe[Ut+2]=pe;const Fr=qe[Ut+ke];Ur+=qe[Ut]*Fr,$r+=qe[Ut+1]*Fr,qe[Ut+4]=Cr,Ue&&(Ht||(Ht=this._map(qe,vt,!0),zr=this.clusterProps.length,this.clusterProps.push(Ht)),Ue(Ht,this._map(qe,Ut)))}qe[vt+4]=Cr,Ke.push(Ur/Xt,$r/Xt,1/0,Cr,-1,Xt),Ue&&Ke.push(zr)}else{for(let Ht=0;Ht<gt;Ht++)Ke.push(qe[vt+Ht]);if(Xt>1)for(const Ht of ur){const Ur=Ht*gt;if(!(qe[Ur+2]<=pe)){qe[Ur+2]=pe;for(let $r=0;$r<gt;$r++)Ke.push(qe[Ur+$r])}}}}return Ke}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,pe,Ie){if(ne[pe+ke]>1){const et=this.clusterProps[ne[pe+We]];return Ie?Object.assign({},et):et}const Ne=this.points[ne[pe+De]].properties,Ue=this.options.map(Ne);return Ie&&Ue===Ne?Object.assign({},Ue):Ue}}function dt(Le,ne,pe){return{type:"Feature",id:Le[ne+De],properties:yt(Le,ne,pe),geometry:{type:"Point",coordinates:[(Ie=Le[ne],360*(Ie-.5)),Ct(Le[ne+1])]}};var Ie}function yt(Le,ne,pe){const Ie=Le[ne+ke],Ne=Ie>=1e4?`${Math.round(Ie/1e3)}k`:Ie>=1e3?Math.round(Ie/100)/10+"k":Ie,Ue=Le[ne+We],et=Ue===-1?{}:Object.assign({},pe[Ue]);return Object.assign(et,{cluster:!0,cluster_id:Le[ne+De],point_count:Ie,point_count_abbreviated:Ne})}function Lt(Le){return Le/360+.5}function pt(Le){const ne=Math.sin(Le*Math.PI/180),pe=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return pe<0?0:pe>1?1:pe}function Ct(Le){const ne=(180-360*Le)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function mt(Le,ne,pe,Ie){for(var Ne,Ue=Ie,et=pe-ne>>1,Ve=pe-ne,qe=Le[ne],Ke=Le[ne+1],gt=Le[pe],vt=Le[pe+1],ft=ne+3;ft<pe;ft+=3){var Ot=Ye(Le[ft],Le[ft+1],qe,Ke,gt,vt);if(Ot>Ue)Ne=ft,Ue=Ot;else if(Ot===Ue){var ur=Math.abs(ft-et);ur<Ve&&(Ne=ft,Ve=ur)}}Ue>Ie&&(Ne-ne>3&&mt(Le,ne,Ne,Ie),Le[Ne+2]=Ue,pe-Ne>3&&mt(Le,Ne,pe,Ie))}function Ye(Le,ne,pe,Ie,Ne,Ue){var et=Ne-pe,Ve=Ue-Ie;if(et!==0||Ve!==0){var qe=((Le-pe)*et+(ne-Ie)*Ve)/(et*et+Ve*Ve);qe>1?(pe=Ne,Ie=Ue):qe>0&&(pe+=et*qe,Ie+=Ve*qe)}return(et=Le-pe)*et+(Ve=ne-Ie)*Ve}function Zt(Le,ne,pe,Ie){var Ne={id:Le===void 0?null:Le,type:ne,geometry:pe,tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ue){var et=Ue.geometry,Ve=Ue.type;if(Ve==="Point"||Ve==="MultiPoint"||Ve==="LineString")hr(Ue,et);else if(Ve==="Polygon"||Ve==="MultiLineString")for(var qe=0;qe<et.length;qe++)hr(Ue,et[qe]);else if(Ve==="MultiPolygon")for(qe=0;qe<et.length;qe++)for(var Ke=0;Ke<et[qe].length;Ke++)hr(Ue,et[qe][Ke])}(Ne),Ne}function hr(Le,ne){for(var pe=0;pe<ne.length;pe+=3)Le.minX=Math.min(Le.minX,ne[pe]),Le.minY=Math.min(Le.minY,ne[pe+1]),Le.maxX=Math.max(Le.maxX,ne[pe]),Le.maxY=Math.max(Le.maxY,ne[pe+1])}function $t(Le,ne,pe,Ie){if(ne.geometry){var Ne=ne.geometry.coordinates,Ue=ne.geometry.type,et=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2),Ve=[],qe=ne.id;if(pe.promoteId?qe=ne.properties[pe.promoteId]:pe.generateId&&(qe=Ie||0),Ue==="Point")yr(Ne,Ve);else if(Ue==="MultiPoint")for(var Ke=0;Ke<Ne.length;Ke++)yr(Ne[Ke],Ve);else if(Ue==="LineString")nn(Ne,Ve,et,!1);else if(Ue==="MultiLineString"){if(pe.lineMetrics){for(Ke=0;Ke<Ne.length;Ke++)nn(Ne[Ke],Ve=[],et,!1),Le.push(Zt(qe,"LineString",Ve,ne.properties));return}rt(Ne,Ve,et,!1)}else if(Ue==="Polygon")rt(Ne,Ve,et,!0);else{if(Ue!=="MultiPolygon"){if(Ue==="GeometryCollection"){for(Ke=0;Ke<ne.geometry.geometries.length;Ke++)$t(Le,{id:qe,geometry:ne.geometry.geometries[Ke],properties:ne.properties},pe,Ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ke=0;Ke<Ne.length;Ke++){var gt=[];rt(Ne[Ke],gt,et,!0),Ve.push(gt)}}Le.push(Zt(qe,Ue,Ve,ne.properties))}}function yr(Le,ne){ne.push(Se(Le[0])),ne.push(ce(Le[1])),ne.push(0)}function nn(Le,ne,pe,Ie){for(var Ne,Ue,et=0,Ve=0;Ve<Le.length;Ve++){var qe=Se(Le[Ve][0]),Ke=ce(Le[Ve][1]);ne.push(qe),ne.push(Ke),ne.push(0),Ve>0&&(et+=Ie?(Ne*Ke-qe*Ue)/2:Math.sqrt(Math.pow(qe-Ne,2)+Math.pow(Ke-Ue,2))),Ne=qe,Ue=Ke}var gt=ne.length-3;ne[2]=1,mt(ne,0,gt,pe),ne[gt+2]=1,ne.size=Math.abs(et),ne.start=0,ne.end=ne.size}function rt(Le,ne,pe,Ie){for(var Ne=0;Ne<Le.length;Ne++){var Ue=[];nn(Le[Ne],Ue,pe,Ie),ne.push(Ue)}}function Se(Le){return Le/360+.5}function ce(Le){var ne=Math.sin(Le*Math.PI/180),pe=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return pe<0?0:pe>1?1:pe}function ge(Le,ne,pe,Ie,Ne,Ue,et,Ve){if(Ie/=ne,Ue>=(pe/=ne)&&et<Ie)return Le;if(et<pe||Ue>=Ie)return null;for(var qe=[],Ke=0;Ke<Le.length;Ke++){var gt=Le[Ke],vt=gt.geometry,ft=gt.type,Ot=Ne===0?gt.minX:gt.minY,ur=Ne===0?gt.maxX:gt.maxY;if(Ot>=pe&&ur<Ie)qe.push(gt);else if(!(ur<pe||Ot>=Ie)){var jt=[];if(ft==="Point"||ft==="MultiPoint")Be(vt,jt,pe,Ie,Ne);else if(ft==="LineString")Xe(vt,jt,pe,Ie,Ne,!1,Ve.lineMetrics);else if(ft==="MultiLineString")ht(vt,jt,pe,Ie,Ne,!1);else if(ft==="Polygon")ht(vt,jt,pe,Ie,Ne,!0);else if(ft==="MultiPolygon")for(var Xt=0;Xt<vt.length;Xt++){var Ht=[];ht(vt[Xt],Ht,pe,Ie,Ne,!0),Ht.length&&jt.push(Ht)}if(jt.length){if(Ve.lineMetrics&&ft==="LineString"){for(Xt=0;Xt<jt.length;Xt++)qe.push(Zt(gt.id,ft,jt[Xt],gt.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(jt.length===1?(ft="LineString",jt=jt[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=jt.length===3?"Point":"MultiPoint"),qe.push(Zt(gt.id,ft,jt,gt.tags))}}}return qe.length?qe:null}function Be(Le,ne,pe,Ie,Ne){for(var Ue=0;Ue<Le.length;Ue+=3){var et=Le[Ue+Ne];et>=pe&&et<=Ie&&(ne.push(Le[Ue]),ne.push(Le[Ue+1]),ne.push(Le[Ue+2]))}}function Xe(Le,ne,pe,Ie,Ne,Ue,et){for(var Ve,qe,Ke=$e(Le),gt=Ne===0?Vt:ir,vt=Le.start,ft=0;ft<Le.length-3;ft+=3){var Ot=Le[ft],ur=Le[ft+1],jt=Le[ft+2],Xt=Le[ft+3],Ht=Le[ft+4],Ur=Ne===0?Ot:ur,$r=Ne===0?Xt:Ht,zr=!1;et&&(Ve=Math.sqrt(Math.pow(Ot-Xt,2)+Math.pow(ur-Ht,2))),Ur<pe?$r>pe&&(qe=gt(Ke,Ot,ur,Xt,Ht,pe),et&&(Ke.start=vt+Ve*qe)):Ur>Ie?$r<Ie&&(qe=gt(Ke,Ot,ur,Xt,Ht,Ie),et&&(Ke.start=vt+Ve*qe)):Qe(Ke,Ot,ur,jt),$r<pe&&Ur>=pe&&(qe=gt(Ke,Ot,ur,Xt,Ht,pe),zr=!0),$r>Ie&&Ur<=Ie&&(qe=gt(Ke,Ot,ur,Xt,Ht,Ie),zr=!0),!Ue&&zr&&(et&&(Ke.end=vt+Ve*qe),ne.push(Ke),Ke=$e(Le)),et&&(vt+=Ve)}var Cr=Le.length-3;Ot=Le[Cr],ur=Le[Cr+1],jt=Le[Cr+2],(Ur=Ne===0?Ot:ur)>=pe&&Ur<=Ie&&Qe(Ke,Ot,ur,jt),Cr=Ke.length-3,Ue&&Cr>=3&&(Ke[Cr]!==Ke[0]||Ke[Cr+1]!==Ke[1])&&Qe(Ke,Ke[0],Ke[1],Ke[2]),Ke.length&&ne.push(Ke)}function $e(Le){var ne=[];return ne.size=Le.size,ne.start=Le.start,ne.end=Le.end,ne}function ht(Le,ne,pe,Ie,Ne,Ue){for(var et=0;et<Le.length;et++)Xe(Le[et],ne,pe,Ie,Ne,Ue,!1)}function Qe(Le,ne,pe,Ie){Le.push(ne),Le.push(pe),Le.push(Ie)}function Vt(Le,ne,pe,Ie,Ne,Ue){var et=(Ue-ne)/(Ie-ne);return Le.push(Ue),Le.push(pe+(Ne-pe)*et),Le.push(1),et}function ir(Le,ne,pe,Ie,Ne,Ue){var et=(Ue-pe)/(Ne-pe);return Le.push(ne+(Ie-ne)*et),Le.push(Ue),Le.push(1),et}function it(Le,ne){for(var pe=[],Ie=0;Ie<Le.length;Ie++){var Ne,Ue=Le[Ie],et=Ue.type;if(et==="Point"||et==="MultiPoint"||et==="LineString")Ne=Tt(Ue.geometry,ne);else if(et==="MultiLineString"||et==="Polygon"){Ne=[];for(var Ve=0;Ve<Ue.geometry.length;Ve++)Ne.push(Tt(Ue.geometry[Ve],ne))}else if(et==="MultiPolygon")for(Ne=[],Ve=0;Ve<Ue.geometry.length;Ve++){for(var qe=[],Ke=0;Ke<Ue.geometry[Ve].length;Ke++)qe.push(Tt(Ue.geometry[Ve][Ke],ne));Ne.push(qe)}pe.push(Zt(Ue.id,et,Ne,Ue.tags))}return pe}function Tt(Le,ne){var pe=[];pe.size=Le.size,Le.start!==void 0&&(pe.start=Le.start,pe.end=Le.end);for(var Ie=0;Ie<Le.length;Ie+=3)pe.push(Le[Ie]+ne,Le[Ie+1],Le[Ie+2]);return pe}function Nt(Le,ne){if(Le.transformed)return Le;var pe,Ie,Ne,Ue=1<<Le.z,et=Le.x,Ve=Le.y;for(pe=0;pe<Le.features.length;pe++){var qe=Le.features[pe],Ke=qe.geometry,gt=qe.type;if(qe.geometry=[],gt===1)for(Ie=0;Ie<Ke.length;Ie+=2)qe.geometry.push(Ar(Ke[Ie],Ke[Ie+1],ne,Ue,et,Ve));else for(Ie=0;Ie<Ke.length;Ie++){var vt=[];for(Ne=0;Ne<Ke[Ie].length;Ne+=2)vt.push(Ar(Ke[Ie][Ne],Ke[Ie][Ne+1],ne,Ue,et,Ve));qe.geometry.push(vt)}}return Le.transformed=!0,Le}function Ar(Le,ne,pe,Ie,Ne,Ue){return[Math.round(pe*(Le*Ie-Ne)),Math.round(pe*(ne*Ie-Ue))]}function Ir(Le,ne,pe,Ie,Ne){for(var Ue=ne===Ne.maxZoom?0:Ne.tolerance/((1<<ne)*Ne.extent),et={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pe,y:Ie,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ve=0;Ve<Le.length;Ve++){et.numFeatures++,Rt(et,Le[Ve],Ue,Ne);var qe=Le[Ve].minX,Ke=Le[Ve].minY,gt=Le[Ve].maxX,vt=Le[Ve].maxY;qe<et.minX&&(et.minX=qe),Ke<et.minY&&(et.minY=Ke),gt>et.maxX&&(et.maxX=gt),vt>et.maxY&&(et.maxY=vt)}return et}function Rt(Le,ne,pe,Ie){var Ne=ne.geometry,Ue=ne.type,et=[];if(Ue==="Point"||Ue==="MultiPoint")for(var Ve=0;Ve<Ne.length;Ve+=3)et.push(Ne[Ve]),et.push(Ne[Ve+1]),Le.numPoints++,Le.numSimplified++;else if(Ue==="LineString")sn(et,Ne,Le,pe,!1,!1);else if(Ue==="MultiLineString"||Ue==="Polygon")for(Ve=0;Ve<Ne.length;Ve++)sn(et,Ne[Ve],Le,pe,Ue==="Polygon",Ve===0);else if(Ue==="MultiPolygon")for(var qe=0;qe<Ne.length;qe++){var Ke=Ne[qe];for(Ve=0;Ve<Ke.length;Ve++)sn(et,Ke[Ve],Le,pe,!0,Ve===0)}if(et.length){var gt=ne.tags||null;if(Ue==="LineString"&&Ie.lineMetrics){for(var vt in gt={},ne.tags)gt[vt]=ne.tags[vt];gt.mapbox_clip_start=Ne.start/Ne.size,gt.mapbox_clip_end=Ne.end/Ne.size}var ft={geometry:et,type:Ue==="Polygon"||Ue==="MultiPolygon"?3:Ue==="LineString"||Ue==="MultiLineString"?2:1,tags:gt};ne.id!==null&&(ft.id=ne.id),Le.features.push(ft)}}function sn(Le,ne,pe,Ie,Ne,Ue){var et=Ie*Ie;if(Ie>0&&ne.size<(Ne?et:Ie))pe.numPoints+=ne.length/3;else{for(var Ve=[],qe=0;qe<ne.length;qe+=3)(Ie===0||ne[qe+2]>et)&&(pe.numSimplified++,Ve.push(ne[qe]),Ve.push(ne[qe+1])),pe.numPoints++;Ne&&function(Ke,gt){for(var vt=0,ft=0,Ot=Ke.length,ur=Ot-2;ft<Ot;ur=ft,ft+=2)vt+=(Ke[ft]-Ke[ur])*(Ke[ft+1]+Ke[ur+1]);if(vt>0===gt)for(ft=0,Ot=Ke.length;ft<Ot/2;ft+=2){var jt=Ke[ft],Xt=Ke[ft+1];Ke[ft]=Ke[Ot-2-ft],Ke[ft+1]=Ke[Ot-1-ft],Ke[Ot-2-ft]=jt,Ke[Ot-1-ft]=Xt}}(Ve,Ue),Le.push(Ve)}}function un(Le,ne){var pe=(ne=this.options=function(Ne,Ue){for(var et in Ue)Ne[et]=Ue[et];return Ne}(Object.create(this.options),ne)).debug;if(ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ie=function(Ne,Ue){var et=[];if(Ne.type==="FeatureCollection")for(var Ve=0;Ve<Ne.features.length;Ve++)$t(et,Ne.features[Ve],Ue,Ve);else $t(et,Ne.type==="Feature"?Ne:{geometry:Ne},Ue);return et}(Le,ne);this.tiles={},this.tileCoords=[],pe&&(this.stats={},this.total=0),Ie=function(Ne,Ue){var et=Ue.buffer/Ue.extent,Ve=Ne,qe=ge(Ne,1,-1-et,et,0,-1,2,Ue),Ke=ge(Ne,1,1-et,2+et,0,-1,2,Ue);return(qe||Ke)&&(Ve=ge(Ne,1,-et,1+et,0,-1,2,Ue)||[],qe&&(Ve=it(qe,1).concat(Ve)),Ke&&(Ve=Ve.concat(it(Ke,-1)))),Ve}(Ie,ne),Ie.length&&this.splitTile(Ie,0,0,0),pe&&Ie.length}function Gn(Le,ne,pe){return 32*((1<<Le)*pe+ne)+Le}function rn(Le,ne){return ne?Le.properties[ne]:Le.id}function qr(Le,ne){if(Le==null)return!0;if(Le.type==="Feature")return rn(Le,ne)!=null;if(Le.type==="FeatureCollection"){const pe=new Set;for(const Ie of Le.features){const Ne=rn(Ie,ne);if(Ne==null||pe.has(Ne))return!1;pe.add(Ne)}return!0}return!1}function Fn(Le,ne){const pe=new Map;if(Le!=null)if(Le.type==="Feature")pe.set(rn(Le,ne),Le);else for(const Ie of Le.features)pe.set(rn(Ie,ne),Ie);return pe}function Lr(Le,ne){const pe=Le.tileID.canonical;if(!this._geoJSONIndex)return ne(null,null);const Ie=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!Ie)return ne(null,null);const Ne=new class{constructor(et){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=et.length,this._features=et}feature(et){return new class{constructor(Ve){this._feature=Ve,this.extent=u.EXTENT,this.type=Ve.type,this.properties=Ve.tags,"id"in Ve&&!isNaN(Ve.id)&&(this.id=parseInt(Ve.id,10))}loadGeometry(){if(this._feature.type===1){const Ve=[];for(const qe of this._feature.geometry)Ve.push([new u.Point(qe[0],qe[1])]);return Ve}{const Ve=[];for(const qe of this._feature.geometry){const Ke=[];for(const gt of qe)Ke.push(new u.Point(gt[0],gt[1]));Ve.push(Ke)}return Ve}}toGeoJSON(Ve,qe,Ke){return R.call(this,Ve,qe,Ke)}}(this._features[et])}}(Ie.features);let Ue=he(Ne);Ue.byteOffset===0&&Ue.byteLength===Ue.buffer.byteLength||(Ue=new Uint8Array(Ue)),ne(null,{vectorTile:Ne,rawData:Ue.buffer})}un.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},un.prototype.splitTile=function(Le,ne,pe,Ie,Ne,Ue,et){for(var Ve=[Le,ne,pe,Ie],qe=this.options,Ke=qe.debug;Ve.length;){Ie=Ve.pop(),pe=Ve.pop(),ne=Ve.pop(),Le=Ve.pop();var gt=1<<ne,vt=Gn(ne,pe,Ie),ft=this.tiles[vt];if(!ft&&(Ke>1,ft=this.tiles[vt]=Ir(Le,ne,pe,Ie,qe),this.tileCoords.push({z:ne,x:pe,y:Ie}),Ke)){Ke>1;var Ot="z"+ne;this.stats[Ot]=(this.stats[Ot]||0)+1,this.total++}if(ft.source=Le,Ne){if(ne===qe.maxZoom||ne===Ne)continue;var ur=1<<Ne-ne;if(pe!==Math.floor(Ue/ur)||Ie!==Math.floor(et/ur))continue}else if(ne===qe.indexMaxZoom||ft.numPoints<=qe.indexMaxPoints)continue;if(ft.source=null,Le.length!==0){Ke>1;var jt,Xt,Ht,Ur,$r,zr,Cr=.5*qe.buffer/qe.extent,Zi=.5-Cr,Ut=.5+Cr,Fr=1+Cr;jt=Xt=Ht=Ur=null,$r=ge(Le,gt,pe-Cr,pe+Ut,0,ft.minX,ft.maxX,qe),zr=ge(Le,gt,pe+Zi,pe+Fr,0,ft.minX,ft.maxX,qe),Le=null,$r&&(jt=ge($r,gt,Ie-Cr,Ie+Ut,1,ft.minY,ft.maxY,qe),Xt=ge($r,gt,Ie+Zi,Ie+Fr,1,ft.minY,ft.maxY,qe),$r=null),zr&&(Ht=ge(zr,gt,Ie-Cr,Ie+Ut,1,ft.minY,ft.maxY,qe),Ur=ge(zr,gt,Ie+Zi,Ie+Fr,1,ft.minY,ft.maxY,qe),zr=null),Ke>1,Ve.push(jt||[],ne+1,2*pe,2*Ie),Ve.push(Xt||[],ne+1,2*pe,2*Ie+1),Ve.push(Ht||[],ne+1,2*pe+1,2*Ie),Ve.push(Ur||[],ne+1,2*pe+1,2*Ie+1)}}},un.prototype.getTile=function(Le,ne,pe){var Ie=this.options,Ne=Ie.extent,Ue=Ie.debug;if(Le<0||Le>24)return null;var et=1<<Le,Ve=Gn(Le,ne=(ne%et+et)%et,pe);if(this.tiles[Ve])return Nt(this.tiles[Ve],Ne);Ue>1;for(var qe,Ke=Le,gt=ne,vt=pe;!qe&&Ke>0;)Ke--,gt=Math.floor(gt/2),vt=Math.floor(vt/2),qe=this.tiles[Gn(Ke,gt,vt)];return qe&&qe.source?(Ue>1,Ue>1,this.splitTile(qe.source,Ke,gt,vt,Le,ne,pe),Ue>1,this.tiles[Ve]?Nt(this.tiles[Ve],Ne):null):null};class Et extends M{constructor(ne,pe,Ie,Ne){super(ne,pe,Ie,Lr),this._dataUpdateable=new Map,this.loadGeoJSON=(Ue,et)=>{const{promoteId:Ve}=Ue;if(Ue.request)return u.getJSON(Ue.request,(qe,Ke,gt,vt)=>{this._dataUpdateable=qr(Ke,Ve)?Fn(Ke,Ve):void 0,et(qe,Ke,gt,vt)});if(typeof Ue.data=="string")try{const qe=JSON.parse(Ue.data);this._dataUpdateable=qr(qe,Ve)?Fn(qe,Ve):void 0,et(null,qe)}catch{et(new Error(`Input data given to '${Ue.source}' is not a valid GeoJSON object.`))}else Ue.dataDiff?this._dataUpdateable?(function(qe,Ke,gt){var vt,ft,Ot,ur;if(Ke.removeAll&&qe.clear(),Ke.remove)for(const jt of Ke.remove)qe.delete(jt);if(Ke.add)for(const jt of Ke.add){const Xt=rn(jt,gt);Xt!=null&&qe.set(Xt,jt)}if(Ke.update)for(const jt of Ke.update){let Xt=qe.get(jt.id);if(Xt==null)continue;const Ht=!jt.removeAllProperties&&(((vt=jt.removeProperties)===null||vt===void 0?void 0:vt.length)>0||((ft=jt.addOrUpdateProperties)===null||ft===void 0?void 0:ft.length)>0);if((jt.newGeometry||jt.removeAllProperties||Ht)&&(Xt={...Xt},qe.set(jt.id,Xt),Ht&&(Xt.properties={...Xt.properties})),jt.newGeometry&&(Xt.geometry=jt.newGeometry),jt.removeAllProperties)Xt.properties={};else if(((Ot=jt.removeProperties)===null||Ot===void 0?void 0:Ot.length)>0)for(const Ur of jt.removeProperties)Object.prototype.hasOwnProperty.call(Xt.properties,Ur)&&delete Xt.properties[Ur];if(((ur=jt.addOrUpdateProperties)===null||ur===void 0?void 0:ur.length)>0)for(const{key:Ur,value:$r}of jt.addOrUpdateProperties)Xt.properties[Ur]=$r}}(this._dataUpdateable,Ue.dataDiff,Ve),et(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):et(new Error(`Cannot update existing geojson data in ${Ue.source}`)):et(new Error(`Input data given to '${Ue.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},Ne&&(this.loadGeoJSON=Ne)}loadData(ne,pe){var Ie;(Ie=this._pendingRequest)===null||Ie===void 0||Ie.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const Ne=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new u.RequestPerformance(ne.request);this._pendingCallback=pe,this._pendingRequest=this.loadGeoJSON(ne,(Ue,et)=>{if(delete this._pendingCallback,delete this._pendingRequest,Ue||!et)return pe(Ue);if(typeof et!="object")return pe(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));{X(et,!0);try{if(ne.filter){const qe=u.createExpression(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(qe.result==="error")throw new Error(qe.value.map(gt=>`${gt.key}: ${gt.message}`).join(", "));et={type:"FeatureCollection",features:et.features.filter(gt=>qe.value.evaluate({zoom:0},gt))}}this._geoJSONIndex=ne.cluster?new He(function({superclusterOptions:qe,clusterProperties:Ke}){if(!Ke||!qe)return qe;const gt={},vt={},ft={accumulated:null,zoom:0},Ot={properties:null},ur=Object.keys(Ke);for(const jt of ur){const[Xt,Ht]=Ke[jt],Ur=u.createExpression(Ht),$r=u.createExpression(typeof Xt=="string"?[Xt,["accumulated"],["get",jt]]:Xt);gt[jt]=Ur.value,vt[jt]=$r.value}return qe.map=jt=>{Ot.properties=jt;const Xt={};for(const Ht of ur)Xt[Ht]=gt[Ht].evaluate(ft,Ot);return Xt},qe.reduce=(jt,Xt)=>{Ot.properties=Xt;for(const Ht of ur)ft.accumulated=jt[Ht],jt[Ht]=vt[Ht].evaluate(ft,Ot)},qe}(ne)).load(et.features):function(qe,Ke){return new un(qe,Ke)}(et,ne.geojsonVtOptions)}catch(qe){return pe(qe)}this.loaded={};const Ve={};if(Ne){const qe=Ne.finish();qe&&(Ve.resourceTiming={},Ve.resourceTiming[ne.source]=JSON.parse(JSON.stringify(qe)))}pe(null,Ve)}})}reloadTile(ne,pe){const Ie=this.loaded;return Ie&&Ie[ne.uid]?super.reloadTile(ne,pe):this.loadTile(ne,pe)}removeSource(ne,pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),pe()}getClusterExpansionZoom(ne,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId))}catch(Ie){pe(Ie)}}getClusterChildren(ne,pe){try{pe(null,this._geoJSONIndex.getChildren(ne.clusterId))}catch(Ie){pe(Ie)}}getClusterLeaves(ne,pe){try{pe(null,this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset))}catch(Ie){pe(Ie)}}}class li{constructor(ne){this.self=ne,this.actor=new u.Actor(ne,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:M,geojson:Et},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pe,Ie)=>{if(this.workerSourceTypes[pe])throw new Error(`Worker source with name "${pe}" already registered.`);this.workerSourceTypes[pe]=Ie},this.self.registerRTLTextPlugin=pe=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=pe.applyArabicShaping,u.plugin.processBidirectionalText=pe.processBidirectionalText,u.plugin.processStyledBidirectionalText=pe.processStyledBidirectionalText}}setReferrer(ne,pe){this.referrer=pe}setImages(ne,pe,Ie){this.availableImages[ne]=pe;for(const Ne in this.workerSources[ne]){const Ue=this.workerSources[ne][Ne];for(const et in Ue)Ue[et].availableImages=pe}Ie()}setLayers(ne,pe,Ie){this.getLayerIndex(ne).replace(pe),Ie()}updateLayers(ne,pe,Ie){this.getLayerIndex(ne).update(pe.layers,pe.removedIds),Ie()}loadTile(ne,pe,Ie){this.getWorkerSource(ne,pe.type,pe.source).loadTile(pe,Ie)}loadDEMTile(ne,pe,Ie){this.getDEMWorkerSource(ne,pe.source).loadTile(pe,Ie)}reloadTile(ne,pe,Ie){this.getWorkerSource(ne,pe.type,pe.source).reloadTile(pe,Ie)}abortTile(ne,pe,Ie){this.getWorkerSource(ne,pe.type,pe.source).abortTile(pe,Ie)}removeTile(ne,pe,Ie){this.getWorkerSource(ne,pe.type,pe.source).removeTile(pe,Ie)}removeDEMTile(ne,pe){this.getDEMWorkerSource(ne,pe.source).removeTile(pe)}removeSource(ne,pe,Ie){if(!this.workerSources[ne]||!this.workerSources[ne][pe.type]||!this.workerSources[ne][pe.type][pe.source])return;const Ne=this.workerSources[ne][pe.type][pe.source];delete this.workerSources[ne][pe.type][pe.source],Ne.removeSource!==void 0?Ne.removeSource(pe,Ie):Ie()}loadWorkerSource(ne,pe,Ie){try{this.self.importScripts(pe.url),Ie()}catch(Ne){Ie(Ne.toString())}}syncRTLPluginState(ne,pe,Ie){try{u.plugin.setState(pe);const Ne=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&Ne!=null){this.self.importScripts(Ne);const Ue=u.plugin.isParsed();Ie(Ue?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ne}`),Ue)}}catch(Ne){Ie(Ne.toString())}}getAvailableImages(ne){let pe=this.availableImages[ne];return pe||(pe=[]),pe}getLayerIndex(ne){let pe=this.layerIndexes[ne];return pe||(pe=this.layerIndexes[ne]=new _),pe}getWorkerSource(ne,pe,Ie){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][pe]||(this.workerSources[ne][pe]={}),!this.workerSources[ne][pe][Ie]){const Ne={send:(Ue,et,Ve)=>{this.actor.send(Ue,et,Ve,ne)}};this.workerSources[ne][pe][Ie]=new this.workerSourceTypes[pe](Ne,this.getLayerIndex(ne),this.getAvailableImages(ne))}return this.workerSources[ne][pe][Ie]}getDEMWorkerSource(ne,pe){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][pe]||(this.demWorkerSources[ne][pe]=new B),this.demWorkerSources[ne][pe]}}return u.isWorker()&&(self.worker=new li(self)),li}),l(["./shared"],function(u){var _="3.3.1";class m{static testProp(a){if(!m.docStyle)return a[0];for(let d=0;d<a.length;d++)if(a[d]in m.docStyle)return a[d];return a[0]}static create(a,d,b){const w=window.document.createElement(a);return d!==void 0&&(w.className=d),b&&b.appendChild(w),w}static createNS(a,d){return window.document.createElementNS(a,d)}static disableDrag(){m.docStyle&&m.selectProp&&(m.userSelect=m.docStyle[m.selectProp],m.docStyle[m.selectProp]="none")}static enableDrag(){m.docStyle&&m.selectProp&&(m.docStyle[m.selectProp]=m.userSelect)}static setTransform(a,d){a.style[m.transformProp]=d}static addEventListener(a,d,b,w={}){a.addEventListener(d,b,"passive"in w?w:w.capture)}static removeEventListener(a,d,b,w={}){a.removeEventListener(d,b,"passive"in w?w:w.capture)}static suppressClickInternal(a){a.preventDefault(),a.stopPropagation(),window.removeEventListener("click",m.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",m.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",m.suppressClickInternal,!0)},0)}static mousePos(a,d){const b=a.getBoundingClientRect();return new u.Point(d.clientX-b.left-a.clientLeft,d.clientY-b.top-a.clientTop)}static touchPos(a,d){const b=a.getBoundingClientRect(),w=[];for(let I=0;I<d.length;I++)w.push(new u.Point(d[I].clientX-b.left-a.clientLeft,d[I].clientY-b.top-a.clientTop));return w}static mouseButton(a){return a.button}static remove(a){a.parentNode&&a.parentNode.removeChild(a)}}m.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,m.selectProp=m.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),m.transformProp=m.testProp(["transform","WebkitTransform"]);const S={supported:!1,testSupport:function(x){!M&&O&&(B?$(x):P=x)}};let P,O,M=!1,B=!1;function $(x){const a=x.createTexture();x.bindTexture(x.TEXTURE_2D,a);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,O),x.isContextLost())return;S.supported=!0}catch{}x.deleteTexture(a),M=!0}var q,X;typeof document<"u"&&(O=document.createElement("img"),O.onload=function(){P&&$(P),P=null,B=!0},O.onerror=function(){M=!0,P=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(x){let a,d,b,w;x.resetRequestQueue=()=>{a=[],d=0,b=0,w={}},x.addThrottleControl=Y=>{const K=b++;return w[K]=Y,K},x.removeThrottleControl=Y=>{delete w[Y],F()},x.getImage=(Y,K,re=!0)=>{S.supported&&(Y.headers||(Y.headers={}),Y.headers.accept="image/webp,*/*");const me={requestParameters:Y,supportImageRefresh:re,callback:K,cancelled:!1,completed:!1,cancel:()=>{me.completed||me.cancelled||(me.cancelled=!0,me.innerRequest&&(me.innerRequest.cancel(),d--),F())}};return a.push(me),F(),me};const I=Y=>{const{requestParameters:K,supportImageRefresh:re,callback:me}=Y;return u.extend(K,{type:"image"}),(re!==!1||u.isWorker()||u.getProtocolAction(K.url)||K.headers&&!Object.keys(K.headers).reduce((Me,Te)=>Me&&Te==="accept",!0)?u.makeRequest:j)(K,(Me,Te,Fe,Ce)=>{L(Y,me,Me,Te,Fe,Ce)})},L=(Y,K,re,me,Me,Te)=>{re?K(re):me instanceof HTMLImageElement||u.isImageBitmap(me)?K(null,me):me&&((Fe,Ce)=>{typeof createImageBitmap=="function"?u.arrayBufferToImageBitmap(Fe,Ce):u.arrayBufferToImage(Fe,Ce)})(me,(Fe,Ce)=>{Fe!=null?K(Fe):Ce!=null&&K(null,Ce,{cacheControl:Me,expires:Te})}),Y.cancelled||(Y.completed=!0,d--,F())},F=()=>{const Y=(()=>{const K=Object.keys(w);let re=!1;if(K.length>0){for(const me of K)if(re=w[me](),re)break}return re})()?u.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let K=d;K<Y&&a.length>0;K++){const re=a.shift();if(re.cancelled){K--;continue}const me=I(re);d++,re.innerRequest=me}},j=(Y,K)=>{const re=new Image,me=Y.url;let Me=!1;const Te=Y.credentials;return Te&&Te==="include"?re.crossOrigin="use-credentials":(Te&&Te==="same-origin"||!u.sameOrigin(me))&&(re.crossOrigin="anonymous"),re.fetchPriority="high",re.onload=()=>{K(null,re),re.onerror=re.onload=null},re.onerror=()=>{Me||K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),re.onerror=re.onload=null},re.src=me,{cancel:()=>{Me=!0,re.src=""}}}}(q||(q={})),q.resetRequestQueue(),function(x){x.Glyphs="Glyphs",x.Image="Image",x.Source="Source",x.SpriteImage="SpriteImage",x.SpriteJSON="SpriteJSON",x.Style="Style",x.Tile="Tile",x.Unknown="Unknown"}(X||(X={}));class R{constructor(a){this._transformRequestFn=a}transformRequest(a,d){return this._transformRequestFn&&this._transformRequestFn(a,d)||{url:a}}normalizeSpriteURL(a,d,b){const w=function(I){const L=I.match(k);if(!L)throw new Error(`Unable to parse URL "${I}"`);return{protocol:L[1],authority:L[2],path:L[3]||"/",params:L[4]?L[4].split("&"):[]}}(a);return w.path+=`${d}${b}`,function(I){const L=I.params.length?`?${I.params.join("&")}`:"";return`${I.protocol}://${I.authority}${I.path}${L}`}(w)}setTransformRequest(a){this._transformRequestFn=a}}const k=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function U(x){var a=new u.ARRAY_TYPE(3);return a[0]=x[0],a[1]=x[1],a[2]=x[2],a}var H,ue=function(x,a,d){return x[0]=a[0]-d[0],x[1]=a[1]-d[1],x[2]=a[2]-d[2],x};H=new u.ARRAY_TYPE(3),u.ARRAY_TYPE!=Float32Array&&(H[0]=0,H[1]=0,H[2]=0);var ie=function(x){var a=x[0],d=x[1];return a*a+d*d};function ee(x){const a=[];if(typeof x=="string")a.push({id:"default",url:x});else if(x&&x.length>0){const d=[];for(const{id:b,url:w}of x){const I=`${b}${w}`;d.indexOf(I)===-1&&(d.push(I),a.push({id:b,url:w}))}}return a}function W(x,a,d,b,w){if(b)return void x(b);if(w!==Object.values(a).length||w!==Object.values(d).length)return;const I={};for(const L in a){I[L]={};const F=u.browser.getImageCanvasContext(d[L]),j=a[L];for(const Y in j){const{width:K,height:re,x:me,y:Me,sdf:Te,pixelRatio:Fe,stretchX:Ce,stretchY:Je,content:at}=j[Y];I[L][Y]={data:null,pixelRatio:Fe,sdf:Te,stretchX:Ce,stretchY:Je,content:at,spriteData:{width:K,height:re,x:me,y:Me,context:F}}}}x(null,I)}(function(){var x=new u.ARRAY_TYPE(2);u.ARRAY_TYPE!=Float32Array&&(x[0]=0,x[1]=0)})();class J{constructor(a,d,b,w){this.context=a,this.format=b,this.texture=a.gl.createTexture(),this.update(d,w)}update(a,d,b){const{width:w,height:I}=a,L=!(this.size&&this.size[0]===w&&this.size[1]===I||b),{context:F}=this,{gl:j}=F;if(this.useMipmap=!!(d&&d.useMipmap),j.bindTexture(j.TEXTURE_2D,this.texture),F.pixelStoreUnpackFlipY.set(!1),F.pixelStoreUnpack.set(1),F.pixelStoreUnpackPremultiplyAlpha.set(this.format===j.RGBA&&(!d||d.premultiply!==!1)),L)this.size=[w,I],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||u.isImageBitmap(a)?j.texImage2D(j.TEXTURE_2D,0,this.format,this.format,j.UNSIGNED_BYTE,a):j.texImage2D(j.TEXTURE_2D,0,this.format,w,I,0,this.format,j.UNSIGNED_BYTE,a.data);else{const{x:Y,y:K}=b||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||u.isImageBitmap(a)?j.texSubImage2D(j.TEXTURE_2D,0,Y,K,j.RGBA,j.UNSIGNED_BYTE,a):j.texSubImage2D(j.TEXTURE_2D,0,Y,K,w,I,j.RGBA,j.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&j.generateMipmap(j.TEXTURE_2D)}bind(a,d,b){const{context:w}=this,{gl:I}=w;I.bindTexture(I.TEXTURE_2D,this.texture),b!==I.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(b=I.LINEAR),a!==this.filter&&(I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,a),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,b||a),this.filter=a),d!==this.wrap&&(I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,d),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}function be(x){const{userImage:a}=x;return!!(a&&a.render&&a.render())&&(x.data.replace(new Uint8Array(a.data.buffer)),!0)}class Oe extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:d,callback:b}of this.requestors)this._notify(d,b);this.requestors=[]}}getImage(a){const d=this.images[a];if(d&&!d.data&&d.spriteData){const b=d.spriteData;d.data=new u.RGBAImage({width:b.width,height:b.height},b.context.getImageData(b.x,b.y,b.width,b.height).data),d.spriteData=null}return d}addImage(a,d){if(this.images[a])throw new Error(`Image id ${a} already exist, use updateImage instead`);this._validate(a,d)&&(this.images[a]=d)}_validate(a,d){let b=!0;const w=d.data||d.spriteData;return this._validateStretch(d.stretchX,w&&w.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),b=!1),this._validateStretch(d.stretchY,w&&w.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),b=!1),this._validateContent(d.content,d)||(this.fire(new u.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),b=!1),b}_validateStretch(a,d){if(!a)return!0;let b=0;for(const w of a){if(w[0]<b||w[1]<w[0]||d<w[1])return!1;b=w[1]}return!0}_validateContent(a,d){if(!a)return!0;if(a.length!==4)return!1;const b=d.spriteData,w=b&&b.width||d.data.width,I=b&&b.height||d.data.height;return!(a[0]<0||w<a[0]||a[1]<0||I<a[1]||a[2]<0||w<a[2]||a[3]<0||I<a[3]||a[2]<a[0]||a[3]<a[1])}updateImage(a,d,b=!0){const w=this.getImage(a);if(b&&(w.data.width!==d.data.width||w.data.height!==d.data.height))throw new Error(`size mismatch between old image (${w.data.width}x${w.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=w.version+1,this.images[a]=d,this.updatedImages[a]=!0}removeImage(a){const d=this.images[a];delete this.images[a],delete this.patterns[a],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,d){let b=!0;if(!this.isLoaded())for(const w of a)this.images[w]||(b=!1);this.isLoaded()||b?this._notify(a,d):this.requestors.push({ids:a,callback:d})}_notify(a,d){const b={};for(const w of a){let I=this.getImage(w);I||(this.fire(new u.Event("styleimagemissing",{id:w})),I=this.getImage(w)),I?b[w]={data:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:!!(I.userImage&&I.userImage.render)}:u.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,b)}getPixelSize(){const{width:a,height:d}=this.atlasImage;return{width:a,height:d}}getPattern(a){const d=this.patterns[a],b=this.getImage(a);if(!b)return null;if(d&&d.position.version===b.version)return d.position;if(d)d.position.version=b.version;else{const w={w:b.data.width+2,h:b.data.height+2,x:0,y:0},I=new u.ImagePosition(w,b);this.patterns[a]={bin:w,position:I}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const d=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new J(a,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const I in this.patterns)a.push(this.patterns[I].bin);const{w:d,h:b}=u.potpack(a),w=this.atlasImage;w.resize({width:d||1,height:b||1});for(const I in this.patterns){const{bin:L}=this.patterns[I],F=L.x+1,j=L.y+1,Y=this.getImage(I).data,K=Y.width,re=Y.height;u.RGBAImage.copy(Y,w,{x:0,y:0},{x:F,y:j},{width:K,height:re}),u.RGBAImage.copy(Y,w,{x:0,y:re-1},{x:F,y:j-1},{width:K,height:1}),u.RGBAImage.copy(Y,w,{x:0,y:0},{x:F,y:j+re},{width:K,height:1}),u.RGBAImage.copy(Y,w,{x:K-1,y:0},{x:F-1,y:j},{width:1,height:re}),u.RGBAImage.copy(Y,w,{x:0,y:0},{x:F+K,y:j},{width:1,height:re})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const d of a){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const b=this.getImage(d);b||u.warnOnce(`Image with ID: "${d}" was not found`),be(b)&&this.updateImage(d,b)}}}const Ae=1e20;function ae(x,a,d,b,w,I,L,F,j){for(let Y=a;Y<a+b;Y++)ct(x,d*I+Y,I,w,L,F,j);for(let Y=d;Y<d+w;Y++)ct(x,Y*I+a,1,b,L,F,j)}function ct(x,a,d,b,w,I,L){I[0]=0,L[0]=-Ae,L[1]=Ae,w[0]=x[a];for(let F=1,j=0,Y=0;F<b;F++){w[F]=x[a+F*d];const K=F*F;do{const re=I[j];Y=(w[F]-w[re]+K-re*re)/(F-re)/2}while(Y<=L[j]&&--j>-1);j++,I[j]=F,L[j]=Y,L[j+1]=Ae}for(let F=0,j=0;F<b;F++){for(;L[j+1]<F;)j++;const Y=I[j],K=F-Y;x[a+F*d]=w[Y]+K*K}}class Pe{constructor(a,d){this.requestManager=a,this.localIdeographFontFamily=d,this.entries={}}setURL(a){this.url=a}getGlyphs(a,d){const b=[];for(const w in a)for(const I of a[w])b.push({stack:w,id:I});u.asyncAll(b,({stack:w,id:I},L)=>{let F=this.entries[w];F||(F=this.entries[w]={glyphs:{},requests:{},ranges:{}});let j=F.glyphs[I];if(j!==void 0)return void L(null,{stack:w,id:I,glyph:j});if(j=this._tinySDF(F,w,I),j)return F.glyphs[I]=j,void L(null,{stack:w,id:I,glyph:j});const Y=Math.floor(I/256);if(256*Y>65535)return void L(new Error("glyphs > 65535 not supported"));if(F.ranges[Y])return void L(null,{stack:w,id:I,glyph:j});if(!this.url)return void L(new Error("glyphsUrl is not set"));let K=F.requests[Y];K||(K=F.requests[Y]=[],Pe.loadGlyphRange(w,Y,this.url,this.requestManager,(re,me)=>{if(me){for(const Me in me)this._doesCharSupportLocalGlyph(+Me)||(F.glyphs[+Me]=me[+Me]);F.ranges[Y]=!0}for(const Me of K)Me(re,me);delete F.requests[Y]})),K.push((re,me)=>{re?L(re):me&&L(null,{stack:w,id:I,glyph:me[I]||null})})},(w,I)=>{if(w)d(w);else if(I){const L={};for(const{stack:F,id:j,glyph:Y}of I)(L[F]||(L[F]={}))[j]=Y&&{id:Y.id,bitmap:Y.bitmap.clone(),metrics:Y.metrics};d(null,L)}})}_doesCharSupportLocalGlyph(a){return!!this.localIdeographFontFamily&&(u.unicodeBlockLookup["CJK Unified Ideographs"](a)||u.unicodeBlockLookup["Hangul Syllables"](a)||u.unicodeBlockLookup.Hiragana(a)||u.unicodeBlockLookup.Katakana(a))}_tinySDF(a,d,b){const w=this.localIdeographFontFamily;if(!w||!this._doesCharSupportLocalGlyph(b))return;let I=a.tinySDF;if(!I){let F="400";/bold/i.test(d)?F="900":/medium/i.test(d)?F="500":/light/i.test(d)&&(F="200"),I=a.tinySDF=new Pe.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:w,fontWeight:F})}const L=I.draw(String.fromCharCode(b));return{id:b,bitmap:new u.AlphaImage({width:L.width||30,height:L.height||30},L.data),metrics:{width:L.glyphWidth||24,height:L.glyphHeight||24,left:L.glyphLeft||0,top:L.glyphTop-27||-8,advance:L.glyphAdvance||24}}}}Pe.loadGlyphRange=function(x,a,d,b,w){const I=256*a,L=I+255,F=b.transformRequest(d.replace("{fontstack}",x).replace("{range}",`${I}-${L}`),X.Glyphs);u.getArrayBuffer(F,(j,Y)=>{if(j)w(j);else if(Y){const K={};for(const re of u.parseGlyphPbf(Y))K[re.id]=re;w(null,K)}})},Pe.TinySDF=class{constructor({fontSize:x=24,buffer:a=3,radius:d=8,cutoff:b=.25,fontFamily:w="sans-serif",fontWeight:I="normal",fontStyle:L="normal"}={}){this.buffer=a,this.cutoff=b,this.radius=d;const F=this.size=x+4*a,j=this._createCanvas(F),Y=this.ctx=j.getContext("2d",{willReadFrequently:!0});Y.font=`${L} ${I} ${x}px ${w}`,Y.textBaseline="alphabetic",Y.textAlign="left",Y.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(x){const a=document.createElement("canvas");return a.width=a.height=x,a}draw(x){const{width:a,actualBoundingBoxAscent:d,actualBoundingBoxDescent:b,actualBoundingBoxLeft:w,actualBoundingBoxRight:I}=this.ctx.measureText(x),L=Math.ceil(d),F=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(I-w))),j=Math.min(this.size-this.buffer,L+Math.ceil(b)),Y=F+2*this.buffer,K=j+2*this.buffer,re=Math.max(Y*K,0),me=new Uint8ClampedArray(re),Me={data:me,width:Y,height:K,glyphWidth:F,glyphHeight:j,glyphTop:L,glyphLeft:0,glyphAdvance:a};if(F===0||j===0)return Me;const{ctx:Te,buffer:Fe,gridInner:Ce,gridOuter:Je}=this;Te.clearRect(Fe,Fe,F,j),Te.fillText(x,Fe,Fe+L);const at=Te.getImageData(Fe,Fe,F,j);Je.fill(Ae,0,re),Ce.fill(0,0,re);for(let je=0;je<j;je++)for(let tt=0;tt<F;tt++){const ut=at.data[4*(je*F+tt)+3]/255;if(ut===0)continue;const lt=(je+Fe)*Y+tt+Fe;if(ut===1)Je[lt]=0,Ce[lt]=Ae;else{const bt=.5-ut;Je[lt]=bt>0?bt*bt:0,Ce[lt]=bt<0?bt*bt:0}}ae(Je,0,0,Y,K,Y,this.f,this.v,this.z),ae(Ce,Fe,Fe,F,j,Y,this.f,this.v,this.z);for(let je=0;je<re;je++){const tt=Math.sqrt(Je[je])-Math.sqrt(Ce[je]);me[je]=Math.round(255-255*(tt/this.radius+this.cutoff))}return Me}};class V{constructor(){this.specification=u.v8Spec.light.position}possiblyEvaluate(a,d){return u.sphericalToCartesian(a.expression.evaluate(d))}interpolate(a,d,b){return{x:u.interpolate.number(a.x,d.x,b),y:u.interpolate.number(a.y,d.y,b),z:u.interpolate.number(a.z,d.z,b)}}}let Q,he;class fe extends u.Evented{constructor(a){super(),Q=Q||new u.Properties({anchor:new u.DataConstantProperty(u.v8Spec.light.anchor),position:new V,color:new u.DataConstantProperty(u.v8Spec.light.color),intensity:new u.DataConstantProperty(u.v8Spec.light.intensity)}),this._transitionable=new u.Transitionable(Q),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,d={}){if(!this._validate(u.validateLight,a,d))for(const b in a){const w=a[b];b.endsWith("-transition")?this._transitionable.setTransition(b.slice(0,-11),w):this._transitionable.setValue(b,w)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,d,b){return(!b||b.validate!==!1)&&u.emitValidationErrors(this,a.call(u.validateStyle,u.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:u.v8Spec})))}}class ye{constructor(a,d){this.width=a,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(a,d){const b=a.join(",")+String(d);return this.dashEntry[b]||(this.dashEntry[b]=this.addDash(a,d)),this.dashEntry[b]}getDashRanges(a,d,b){const w=[];let I=a.length%2==1?-a[a.length-1]*b:0,L=a[0]*b,F=!0;w.push({left:I,right:L,isDash:F,zeroLength:a[0]===0});let j=a[0];for(let Y=1;Y<a.length;Y++){F=!F;const K=a[Y];I=j*b,j+=K,L=j*b,w.push({left:I,right:L,isDash:F,zeroLength:K===0})}return w}addRoundDash(a,d,b){const w=d/2;for(let I=-b;I<=b;I++){const L=this.width*(this.nextRow+b+I);let F=0,j=a[F];for(let Y=0;Y<this.width;Y++){Y/j.right>1&&(j=a[++F]);const K=Math.abs(Y-j.left),re=Math.abs(Y-j.right),me=Math.min(K,re);let Me;const Te=I/b*(w+1);if(j.isDash){const Fe=w-Math.abs(Te);Me=Math.sqrt(me*me+Fe*Fe)}else Me=w-Math.sqrt(me*me+Te*Te);this.data[L+Y]=Math.max(0,Math.min(255,Me+128))}}}addRegularDash(a){for(let F=a.length-1;F>=0;--F){const j=a[F],Y=a[F+1];j.zeroLength?a.splice(F,1):Y&&Y.isDash===j.isDash&&(Y.left=j.left,a.splice(F,1))}const d=a[0],b=a[a.length-1];d.isDash===b.isDash&&(d.left=b.left-this.width,b.right=d.right+this.width);const w=this.width*this.nextRow;let I=0,L=a[I];for(let F=0;F<this.width;F++){F/L.right>1&&(L=a[++I]);const j=Math.abs(F-L.left),Y=Math.abs(F-L.right),K=Math.min(j,Y);this.data[w+F]=Math.max(0,Math.min(255,(L.isDash?K:-K)+128))}}addDash(a,d){const b=d?7:0,w=2*b+1;if(this.nextRow+w>this.height)return u.warnOnce("LineAtlas out of space"),null;let I=0;for(let F=0;F<a.length;F++)I+=a[F];if(I!==0){const F=this.width/I,j=this.getDashRanges(a,this.width,F);d?this.addRoundDash(j,F,b):this.addRegularDash(j)}const L={y:(this.nextRow+b+.5)/this.height,height:2*b/this.height,width:I};return this.nextRow+=w,this.dirty=!0,L}bind(a){const d=a.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class se{constructor(a,d,b){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=b;const w=this.workerPool.acquire(b);for(let I=0;I<w.length;I++){const L=new se.Actor(w[I],d,b);L.name=`Worker ${I}`,this.actors.push(L)}if(!this.actors.length)throw new Error("No actors found")}broadcast(a,d,b){u.asyncAll(this.actors,(w,I)=>{w.send(a,d,I)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(a=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],a&&this.workerPool.release(this.id)}}function De(x,a,d){const b=function(w,I){if(w)return d(w);if(I){const L=u.pick(u.extend(I,x),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(L.vectorLayers=I.vector_layers,L.vectorLayerIds=L.vectorLayers.map(F=>F.id)),d(null,L)}};return x.url?u.getJSON(a.transformRequest(x.url,X.Source),b):u.browser.frame(()=>b(null,x))}se.Actor=u.Actor;class ke{constructor(a,d){a&&(d?this.setSouthWest(a).setNorthEast(d):Array.isArray(a)&&(a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1])))}setNorthEast(a){return this._ne=a instanceof u.LngLat?new u.LngLat(a.lng,a.lat):u.LngLat.convert(a),this}setSouthWest(a){return this._sw=a instanceof u.LngLat?new u.LngLat(a.lng,a.lat):u.LngLat.convert(a),this}extend(a){const d=this._sw,b=this._ne;let w,I;if(a instanceof u.LngLat)w=a,I=a;else{if(!(a instanceof ke))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(ke.convert(a)):this.extend(u.LngLat.convert(a)):a&&("lng"in a||"lon"in a)&&"lat"in a?this.extend(u.LngLat.convert(a)):this;if(w=a._sw,I=a._ne,!w||!I)return this}return d||b?(d.lng=Math.min(w.lng,d.lng),d.lat=Math.min(w.lat,d.lat),b.lng=Math.max(I.lng,b.lng),b.lat=Math.max(I.lat,b.lat)):(this._sw=new u.LngLat(w.lng,w.lat),this._ne=new u.LngLat(I.lng,I.lat)),this}getCenter(){return new u.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new u.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:d,lat:b}=u.LngLat.convert(a);let w=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(w=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=b&&b<=this._ne.lat&&w}static convert(a){return a instanceof ke?a:a&&new ke(a)}static fromLngLat(a,d=0){const b=360*d/40075017,w=b/Math.cos(Math.PI/180*a.lat);return new ke(new u.LngLat(a.lng-w,a.lat-b),new u.LngLat(a.lng+w,a.lat+b))}}class We{constructor(a,d,b){this.bounds=ke.convert(this.validateBounds(a)),this.minzoom=d||0,this.maxzoom=b||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const d=Math.pow(2,a.z),b=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*d),w=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*d),I=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*d),L=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*d);return a.x>=b&&a.x<I&&a.y>=w&&a.y<L}}class He extends u.Evented{constructor(a,d,b,w){if(super(),this.load=()=>{this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=De(this._options,this.map._requestManager,(I,L)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),I?this.fire(new u.ErrorEvent(I)):L&&(u.extend(this,L),L.bounds&&(this.tileBounds=new We(L.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>u.extend({},this._options),this.id=a,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(d,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}setSourceProperty(a){this._tileJSONRequest&&this._tileJSONRequest.cancel(),a(),this.load()}setTiles(a){return this.setSourceProperty(()=>{this._options.tiles=a}),this}setUrl(a){return this.setSourceProperty(()=>{this.url=a,this._options.url=a}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(a,d){const b=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(b,X.Tile),uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function I(L,F){return delete a.request,a.aborted?d(null):L&&L.status!==404?d(L):(F&&F.resourceTiming&&(a.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&F&&a.setExpiryData(F),a.loadVectorData(F,this.map.painter),d(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired"?a.state==="loading"?a.reloadCallback=d:a.request=a.actor.send("reloadTile",w,I.bind(this)):(a.actor=this.dispatcher.getActor(),a.request=a.actor.send("loadTile",w,I.bind(this)))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)}unloadTile(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class dt extends u.Evented{constructor(a,d,b,w){super(),this.id=a,this.dispatcher=b,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},d),u.extend(this,u.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=De(this._options,this.map._requestManager,(a,d)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new u.ErrorEvent(a)):d&&(u.extend(this,d),d.bounds&&(this.tileBounds=new We(d.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,d){const b=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);a.request=q.getImage(this.map._requestManager.transformRequest(b,X.Tile),(w,I,L)=>{if(delete a.request,a.aborted)a.state="unloaded",d(null);else if(w)a.state="errored",d(w);else if(I){this.map._refreshExpiredTiles&&L&&a.setExpiryData(L);const F=this.map.painter.context,j=F.gl;a.texture=this.map.painter.getTileTexture(I.width),a.texture?a.texture.update(I,{useMipmap:!0}):(a.texture=new J(F,I,j.RGBA,{useMipmap:!0}),a.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),F.extTextureFilterAnisotropic&&j.texParameterf(j.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax)),a.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(a,d){a.request&&(a.request.cancel(),delete a.request),d()}unloadTile(a,d){a.texture&&this.map.painter.saveTileTexture(a.texture),d()}hasTransition(){return!1}}class yt extends dt{constructor(a,d,b,w){super(a,d,b,w),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}loadTile(a,d){const b=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function w(I,L){I&&(a.state="errored",d(I)),L&&(a.dem=L,a.needsHillshadePrepare=!0,a.needsTerrainPrepare=!0,a.state="loaded",d(null))}a.request=q.getImage(this.map._requestManager.transformRequest(b,X.Tile),(function(I,L){if(delete a.request,a.aborted)a.state="unloaded",d(null);else if(I)a.state="errored",d(I);else if(L){this.map._refreshExpiredTiles&&a.setExpiryData(L),delete L.cacheControl,delete L.expires;const F=u.isImageBitmap(L)&&(he==null&&(he=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),he)?L:u.browser.getImageData(L,1),j={uid:a.uid,coord:a.tileID,source:this.id,rawImageData:F,encoding:this.encoding};a.actor&&a.state!=="expired"||(a.actor=this.dispatcher.getActor(),a.actor.send("loadDEMTile",j,w.bind(this)))}}).bind(this),this.map._refreshExpiredTiles),a.neighboringTiles=this._getNeighboringTiles(a.tileID)}_getNeighboringTiles(a){const d=a.canonical,b=Math.pow(2,d.z),w=(d.x-1+b)%b,I=d.x===0?a.wrap-1:a.wrap,L=(d.x+1+b)%b,F=d.x+1===b?a.wrap+1:a.wrap,j={};return j[new u.OverscaledTileID(a.overscaledZ,I,d.z,w,d.y).key]={backfilled:!1},j[new u.OverscaledTileID(a.overscaledZ,F,d.z,L,d.y).key]={backfilled:!1},d.y>0&&(j[new u.OverscaledTileID(a.overscaledZ,I,d.z,w,d.y-1).key]={backfilled:!1},j[new u.OverscaledTileID(a.overscaledZ,a.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},j[new u.OverscaledTileID(a.overscaledZ,F,d.z,L,d.y-1).key]={backfilled:!1}),d.y+1<b&&(j[new u.OverscaledTileID(a.overscaledZ,I,d.z,w,d.y+1).key]={backfilled:!1},j[new u.OverscaledTileID(a.overscaledZ,a.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},j[new u.OverscaledTileID(a.overscaledZ,F,d.z,L,d.y+1).key]={backfilled:!1}),j}unloadTile(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})}}class Lt extends u.Evented{constructor(a,d,b,w){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>u.extend({},this._options,{type:this.type,data:this._data}),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=b.getActor(),this.setEventedParent(w),this._data=d.data,this._options=u.extend({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const I=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*I,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*I,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:u.EXTENT,radius:(d.clusterRadius||50)*I,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(a){this.map=a,this.load()}setData(a){return this._data=a,this._updateWorkerData(),this}updateData(a){return this._updateWorkerData(a),this}setClusterOptions(a){return this.workerOptions.cluster=a.cluster,a&&(a.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=a.clusterRadius),a.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=a.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(a,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},d),this}getClusterChildren(a,d){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},d),this}getClusterLeaves(a,d,b,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:d,offset:b},w),this}_updateWorkerData(a){const d=u.extend({},this.workerOptions);a?d.dataDiff=a:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(u.browser.resolveURL(this._data),X.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(b,w)=>{if(this._pendingLoads--,this._removed||w&&w.abandoned)return void this.fire(new u.Event("dataabort",{dataType:"source"}));let I=null;if(w&&w.resourceTiming&&w.resourceTiming[this.id]&&(I=w.resourceTiming[this.id].slice(0)),b)return void this.fire(new u.ErrorEvent(b));const L={dataType:"source"};this._collectResourceTiming&&I&&I.length>0&&u.extend(L,{resourceTiming:I}),this.fire(new u.Event("data",{...L,sourceDataType:"metadata"})),this.fire(new u.Event("data",{...L,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(a,d){const b=a.actor?"reloadTile":"loadTile";a.actor=this.actor;const w={type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};a.request=this.actor.send(b,w,(I,L)=>(delete a.request,a.unloadVectorData(),a.aborted?d(null):I?d(I):(a.loadVectorData(L,this.map.painter,b==="reloadTile"),d(null))))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0}unloadTile(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var pt=u.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ct extends u.Evented{constructor(a,d,b,w){super(),this.load=(I,L)=>{this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=q.getImage(this.map._requestManager.transformRequest(this.url,X.Image),(F,j)=>{this._request=null,this._loaded=!0,F?this.fire(new u.ErrorEvent(F)):j&&(this.image=j,I&&(this.coordinates=I),L&&L(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const I=this.map.painter.context,L=I.gl;this.boundsBuffer||(this.boundsBuffer=I.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new J(I,this.image,L.RGBA),this.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE));let F=!1;for(const j in this.tiles){const Y=this.tiles[j];Y.state!=="loaded"&&(Y.state="loaded",Y.texture=this.texture,F=!0)}F&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=a,this.dispatcher=b,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=d}loaded(){return this._loaded}updateImage(a){return a.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=a.url,this.load(a.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(a){this.coordinates=a;const d=a.map(u.MercatorCoordinate.fromLngLat);this.tileID=function(w){let I=1/0,L=1/0,F=-1/0,j=-1/0;for(const me of w)I=Math.min(I,me.x),L=Math.min(L,me.y),F=Math.max(F,me.x),j=Math.max(j,me.y);const Y=Math.max(F-I,j-L),K=Math.max(0,Math.floor(-Math.log(Y)/Math.LN2)),re=Math.pow(2,K);return new u.CanonicalTileID(K,Math.floor((I+F)/2*re),Math.floor((L+j)/2*re))}(d),this.minzoom=this.maxzoom=this.tileID.z;const b=d.map(w=>this.tileID.getTilePoint(w)._round());return this._boundsArray=new u.RasterBoundsArray,this._boundsArray.emplaceBack(b[0].x,b[0].y,0,0),this._boundsArray.emplaceBack(b[1].x,b[1].y,u.EXTENT,0),this._boundsArray.emplaceBack(b[3].x,b[3].y,0,u.EXTENT),this._boundsArray.emplaceBack(b[2].x,b[2].y,u.EXTENT,u.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(a,d){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},d(null)):(a.state="errored",d(null))}hasTransition(){return!1}}class mt extends Ct{constructor(a,d,b,w){super(a,d,b,w),this.load=()=>{this._loaded=!1;const I=this.options;this.urls=[];for(const L of I.urls)this.urls.push(this.map._requestManager.transformRequest(L,X.Source).url);u.getVideo(this.urls,(L,F)=>{this._loaded=!0,L?this.fire(new u.ErrorEvent(L)):F&&(this.video=F,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const I=this.map.painter.context,L=I.gl;this.boundsBuffer||(this.boundsBuffer=I.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE),L.texSubImage2D(L.TEXTURE_2D,0,0,0,L.RGBA,L.UNSIGNED_BYTE,this.video)):(this.texture=new J(I,this.video,L.RGBA),this.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE));let F=!1;for(const j in this.tiles){const Y=this.tiles[j];Y.state!=="loaded"&&(Y.state="loaded",Y.texture=this.texture,F=!0)}F&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=d}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(a){if(this.video){const d=this.video.seekable;a<d.start(0)||a>d.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=a}}getVideo(){return this.video}onAdd(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Ye extends Ct{constructor(a,d,b,w){super(a,d,b,w),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let I=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,I=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,I=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const L=this.map.painter.context,F=L.gl;this.boundsBuffer||(this.boundsBuffer=L.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(I||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new J(L,this.canvas,F.RGBA,{premultiply:!0});let j=!1;for(const Y in this.tiles){const K=this.tiles[Y];K.state!=="loaded"&&(K.state="loaded",K.texture=this.texture,j=!0)}j&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(I=>!Array.isArray(I)||I.length!==2||I.some(L=>typeof L!="number"))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${a}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${a}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${a}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${a}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${a}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}getCanvas(){return this.canvas}onAdd(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const a of[this.canvas.width,this.canvas.height])if(isNaN(a)||a<=0)return!0;return!1}}const Zt={},hr=x=>{switch(x){case"geojson":return Lt;case"image":return Ct;case"raster":return dt;case"raster-dem":return yt;case"vector":return He;case"video":return mt;case"canvas":return Ye}return Zt[x]};function $t(x,a){const d=u.create();return u.translate(d,d,[1,1,0]),u.scale(d,d,[.5*x.width,.5*x.height,1]),u.multiply(d,d,x.calculatePosMatrix(a.toUnwrapped()))}function yr(x,a,d,b,w,I){const L=function(re,me,Me){if(re)for(const Te of re){const Fe=me[Te];if(Fe&&Fe.source===Me&&Fe.type==="fill-extrusion")return!0}else for(const Te in me){const Fe=me[Te];if(Fe.source===Me&&Fe.type==="fill-extrusion")return!0}return!1}(w&&w.layers,a,x.id),F=I.maxPitchScaleFactor(),j=x.tilesIn(b,F,L);j.sort(nn);const Y=[];for(const re of j)Y.push({wrappedTileID:re.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(a,d,x._state,re.queryGeometry,re.cameraQueryGeometry,re.scale,w,I,F,$t(x.transform,re.tileID))});const K=function(re){const me={},Me={};for(const Te of re){const Fe=Te.queryResults,Ce=Te.wrappedTileID,Je=Me[Ce]=Me[Ce]||{};for(const at in Fe){const je=Fe[at],tt=Je[at]=Je[at]||{},ut=me[at]=me[at]||[];for(const lt of je)tt[lt.featureIndex]||(tt[lt.featureIndex]=!0,ut.push(lt))}}return me}(Y);for(const re in K)K[re].forEach(me=>{const Me=me.feature,Te=x.getFeatureState(Me.layer["source-layer"],Me.id);Me.source=Me.layer.source,Me.layer["source-layer"]&&(Me.sourceLayer=Me.layer["source-layer"]),Me.state=Te});return K}function nn(x,a){const d=x.tileID,b=a.tileID;return d.overscaledZ-b.overscaledZ||d.canonical.y-b.canonical.y||d.wrap-b.wrap||d.canonical.x-b.canonical.x}class rt{constructor(a,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=a,this.uid=u.uniqueId(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(a){const d=a+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(a){this.demTexture&&a.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(a,d,b){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(w,I){const L={};if(!I)return L;for(const F of w){const j=F.layerIds.map(Y=>I.getLayer(Y)).filter(Boolean);if(j.length!==0){F.layers=j,F.stateDependentLayerIds&&(F.stateDependentLayers=F.stateDependentLayerIds.map(Y=>j.filter(K=>K.id===Y)[0]));for(const Y of j)L[Y.id]=F}}return L}(a.buckets,d.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const I=this.buckets[w];if(I instanceof u.SymbolBucket){if(this.hasSymbolBuckets=!0,!b)break;I.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const I=this.buckets[w];if(I instanceof u.SymbolBucket&&I.hasRTLText){this.hasRTLText=!0,u.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const w in this.buckets){const I=this.buckets[w];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(w).queryRadius(I))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new u.CollisionBoxArray}unloadVectorData(){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(a){return this.buckets[a.id]}upload(a){for(const b in this.buckets){const w=this.buckets[b];w.uploadPending()&&w.upload(a)}const d=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new J(a,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new J(a,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,d,b,w,I,L,F,j,Y,K){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:w,cameraQueryGeometry:I,scale:L,tileSize:this.tileSize,pixelPosMatrix:K,transform:j,params:F,queryPadding:this.queryPadding*Y},a,d,b):{}}querySourceFeatures(a,d){const b=this.latestFeatureIndex;if(!b||!b.rawTileData)return;const w=b.loadVTLayers(),I=d&&d.sourceLayer?d.sourceLayer:"",L=w._geojsonTileLayer||w[I];if(!L)return;const F=u.createFilter(d&&d.filter),{z:j,x:Y,y:K}=this.tileID.canonical,re={z:j,x:Y,y:K};for(let me=0;me<L.length;me++){const Me=L.feature(me);if(F.needGeometry){const Ce=u.toEvaluationFeature(Me,!0);if(!F.filter(new u.EvaluationParameters(this.tileID.overscaledZ),Ce,this.tileID.canonical))continue}else if(!F.filter(new u.EvaluationParameters(this.tileID.overscaledZ),Me))continue;const Te=b.getId(Me,I),Fe=new u.GeoJSONFeature(Me,j,Y,K,Te);Fe.tile=re,a.push(Fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const d=this.expirationTime;if(a.cacheControl){const b=u.parseCacheControl(a.cacheControl);b["max-age"]&&(this.expirationTime=Date.now()+1e3*b["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const b=Date.now();let w=!1;if(this.expirationTime>b)w=!1;else if(d)if(this.expirationTime<d)w=!0;else{const I=this.expirationTime-d;I?this.expirationTime=b+Math.max(I,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0)return;const b=this.latestFeatureIndex.loadVTLayers();for(const w in this.buckets){if(!d.style.hasLayer(w))continue;const I=this.buckets[w],L=I.layers[0].sourceLayer||"_geojsonTileLayer",F=b[L],j=a[L];if(!F||!j||Object.keys(j).length===0)continue;I.update(j,F,this.imageAtlas&&this.imageAtlas.patternPositions||{});const Y=d&&d.style&&d.style.getLayer(w);Y&&(this.queryPadding=Math.max(this.queryPadding,Y.queryRadius(I)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=u.browser.now()+a}setDependencies(a,d){const b={};for(const w of d)b[w]=!0;this.dependencies[a]=b}hasDependency(a,d){for(const b of a){const w=this.dependencies[b];if(w){for(const I of d)if(w[I])return!0}}return!1}}class Se{constructor(a,d){this.max=a,this.onRemove=d,this.reset()}reset(){for(const a in this.data)for(const d of this.data[a])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(a,d,b){const w=a.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);const I={value:d,timeout:void 0};if(b!==void 0&&(I.timeout=setTimeout(()=>{this.remove(a,I)},b)),this.data[w].push(I),this.order.push(w),this.order.length>this.max){const L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const d=this.data[a].shift();return d.timeout&&clearTimeout(d.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),d.value}getByKey(a){const d=this.data[a];return d?d[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,d){if(!this.has(a))return this;const b=a.wrapped().key,w=d===void 0?0:this.data[b].indexOf(d),I=this.data[b][w];return this.data[b].splice(w,1),I.timeout&&clearTimeout(I.timeout),this.data[b].length===0&&delete this.data[b],this.onRemove(I.value),this.order.splice(this.order.indexOf(b),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(a){const d=[];for(const b in this.data)for(const w of this.data[b])a(w.value)||d.push(w);for(const b of d)this.remove(b.value.tileID,b)}}class ce{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,d,b){const w=String(d);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][w]=this.stateChanges[a][w]||{},u.extend(this.stateChanges[a][w],b),this.deletedStates[a]===null){this.deletedStates[a]={};for(const I in this.state[a])I!==w&&(this.deletedStates[a][I]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][w]===null){this.deletedStates[a][w]={};for(const I in this.state[a][w])b[I]||(this.deletedStates[a][w][I]=null)}else for(const I in b)this.deletedStates[a]&&this.deletedStates[a][w]&&this.deletedStates[a][w][I]===null&&delete this.deletedStates[a][w][I]}removeFeatureState(a,d,b){if(this.deletedStates[a]===null)return;const w=String(d);if(this.deletedStates[a]=this.deletedStates[a]||{},b&&d!==void 0)this.deletedStates[a][w]!==null&&(this.deletedStates[a][w]=this.deletedStates[a][w]||{},this.deletedStates[a][w][b]=null);else if(d!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][w])for(b in this.deletedStates[a][w]={},this.stateChanges[a][w])this.deletedStates[a][w][b]=null;else this.deletedStates[a][w]=null;else this.deletedStates[a]=null}getState(a,d){const b=String(d),w=u.extend({},(this.state[a]||{})[b],(this.stateChanges[a]||{})[b]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const I=this.deletedStates[a][d];if(I===null)return{};for(const L in I)delete w[L]}return w}initializeTileState(a,d){a.setFeatureState(this.state,d)}coalesceChanges(a,d){const b={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const I={};for(const L in this.stateChanges[w])this.state[w][L]||(this.state[w][L]={}),u.extend(this.state[w][L],this.stateChanges[w][L]),I[L]=this.state[w][L];b[w]=I}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const I={};if(this.deletedStates[w]===null)for(const L in this.state[w])I[L]={},this.state[w][L]={};else for(const L in this.deletedStates[w]){if(this.deletedStates[w][L]===null)this.state[w][L]={};else for(const F of Object.keys(this.deletedStates[w][L]))delete this.state[w][L][F];I[L]=this.state[w][L]}b[w]=b[w]||{},u.extend(b[w],I)}if(this.stateChanges={},this.deletedStates={},Object.keys(b).length!==0)for(const w in a)a[w].setFeatureState(b,d)}}class ge extends u.Evented{constructor(a,d,b){super(),this.id=a,this.dispatcher=b,this.on("data",w=>{w.dataType==="source"&&w.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((w,I,L,F)=>{const j=new(hr(I.type))(w,I,L,F);if(j.id!==w)throw new Error(`Expected Source id to be ${w} instead of ${j.id}`);return j})(a,d,b,this),this._tiles={},this._cache=new Se(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ce,this._didEmitContent=!1,this._updated=!1}onAdd(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._maxTileCacheZoomLevels=a?a._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(a)}onRemove(a){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(a)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const a in this._tiles){const d=this._tiles[a];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(a,d){return this._source.loadTile(a,d)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){this._source.abortTile&&this._source.abortTile(a,()=>{}),this._source.fire(new u.Event("dataabort",{tile:a,coord:a.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const b=this._tiles[d];b.upload(a),b.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(a=>a.tileID).sort(Be).map(a=>a.key)}getRenderableIds(a){const d=[];for(const b in this._tiles)this._isIdRenderable(b,a)&&d.push(this._tiles[b]);return a?d.sort((b,w)=>{const I=b.tileID,L=w.tileID,F=new u.Point(I.canonical.x,I.canonical.y)._rotate(this.transform.angle),j=new u.Point(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return I.overscaledZ-L.overscaledZ||j.y-F.y||j.x-F.x}).map(b=>b.tileID.key):d.map(b=>b.tileID).sort(Be).map(b=>b.key)}hasRenderableParent(a){const d=this.findLoadedParent(a,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(a,d){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(d||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(a,d){const b=this._tiles[a];b&&(b.state!=="loading"&&(b.state=d),this._loadTile(b,this._tileLoaded.bind(this,b,a,d)))}_tileLoaded(a,d,b,w){if(w)return a.state="errored",void(w.status!==404?this._source.fire(new u.ErrorEvent(w,{tile:a})):this.update(this.transform,this.terrain));a.timeAdded=u.browser.now(),b==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(d,a),this.getSource().type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),a.aborted||this._source.fire(new u.Event("data",{dataType:"source",tile:a,coord:a.tileID}))}_backfillDEM(a){const d=this.getRenderableIds();for(let w=0;w<d.length;w++){const I=d[w];if(a.neighboringTiles&&a.neighboringTiles[I]){const L=this.getTileByID(I);b(a,L),b(L,a)}}function b(w,I){w.needsHillshadePrepare=!0,w.needsTerrainPrepare=!0;let L=I.tileID.canonical.x-w.tileID.canonical.x;const F=I.tileID.canonical.y-w.tileID.canonical.y,j=Math.pow(2,w.tileID.canonical.z),Y=I.tileID.key;L===0&&F===0||Math.abs(F)>1||(Math.abs(L)>1&&(Math.abs(L+j)===1?L+=j:Math.abs(L-j)===1&&(L-=j)),I.dem&&w.dem&&(w.dem.backfillBorder(I.dem,L,F),w.neighboringTiles&&w.neighboringTiles[Y]&&(w.neighboringTiles[Y].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,d,b,w){for(const I in this._tiles){let L=this._tiles[I];if(w[I]||!L.hasData()||L.tileID.overscaledZ<=d||L.tileID.overscaledZ>b)continue;let F=L.tileID;for(;L&&L.tileID.overscaledZ>d+1;){const Y=L.tileID.scaledTo(L.tileID.overscaledZ-1);L=this._tiles[Y.key],L&&L.hasData()&&(F=Y)}let j=F;for(;j.overscaledZ>d;)if(j=j.scaledTo(j.overscaledZ-1),a[j.key]){w[F.key]=F;break}}}findLoadedParent(a,d){if(a.key in this._loadedParentTiles){const b=this._loadedParentTiles[a.key];return b&&b.tileID.overscaledZ>=d?b:null}for(let b=a.overscaledZ-1;b>=d;b--){const w=a.scaledTo(b),I=this._getLoadedTile(w);if(I)return I}}_getLoadedTile(a){const d=this._tiles[a.key];return d&&d.hasData()?d:this._cache.getByKey(a.wrapped().key)}updateCacheSize(a){const d=Math.ceil(a.width/this._source.tileSize)+1,b=Math.ceil(a.height/this._source.tileSize)+1,w=Math.floor(d*b*(this._maxTileCacheZoomLevels===null?u.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(I)}handleWrapJump(a){const d=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,d){const b={};for(const w in this._tiles){const I=this._tiles[w];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+d),b[I.tileID.key]=I}this._tiles=b;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(w,this._tiles[w])}}update(a,d){if(this.transform=a,this.terrain=d,!this._sourceLoaded||this._paused)return;let b;this.updateCacheSize(a),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?b=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(K=>new u.OverscaledTileID(K.canonical.z,K.wrap,K.canonical.z,K.canonical.x,K.canonical.y)):(b=a.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(b=b.filter(K=>this._source.hasTile(K)))):b=[];const w=a.coveringZoomLevel(this._source),I=Math.max(w-ge.maxOverzooming,this._source.minzoom),L=Math.max(w+ge.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const K={};for(const re of b)if(re.canonical.z>this._source.minzoom){const me=re.scaledTo(re.canonical.z-1);K[me.key]=me;const Me=re.scaledTo(Math.max(this._source.minzoom,Math.min(re.canonical.z,5)));K[Me.key]=Me}b=b.concat(Object.values(K))}const F=b.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,F&&this.fire(new u.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const j=this._updateRetainedTiles(b,w);if(Xe(this._source.type)){const K={},re={},me=Object.keys(j),Me=u.browser.now();for(const Te of me){const Fe=j[Te],Ce=this._tiles[Te];if(!Ce||Ce.fadeEndTime!==0&&Ce.fadeEndTime<=Me)continue;const Je=this.findLoadedParent(Fe,I);Je&&(this._addTile(Je.tileID),K[Je.tileID.key]=Je.tileID),re[Te]=Fe}this._retainLoadedChildren(re,w,L,j);for(const Te in K)j[Te]||(this._coveredTiles[Te]=!0,j[Te]=K[Te]);if(d){const Te={},Fe={};for(const Ce of b)this._tiles[Ce.key].hasData()?Te[Ce.key]=Ce:Fe[Ce.key]=Ce;for(const Ce in Fe){const Je=Fe[Ce].children(this._source.maxzoom);this._tiles[Je[0].key]&&this._tiles[Je[1].key]&&this._tiles[Je[2].key]&&this._tiles[Je[3].key]&&(Te[Je[0].key]=j[Je[0].key]=Je[0],Te[Je[1].key]=j[Je[1].key]=Je[1],Te[Je[2].key]=j[Je[2].key]=Je[2],Te[Je[3].key]=j[Je[3].key]=Je[3],delete Fe[Ce])}for(const Ce in Fe){const Je=this.findLoadedParent(Fe[Ce],this._source.minzoom);if(Je){Te[Je.tileID.key]=j[Je.tileID.key]=Je.tileID;for(const at in Te)Te[at].isChildOf(Je.tileID)&&delete Te[at]}}for(const Ce in this._tiles)Te[Ce]||(this._coveredTiles[Ce]=!0)}}for(const K in j)this._tiles[K].clearFadeHold();const Y=u.keysDifference(this._tiles,j);for(const K of Y){const re=this._tiles[K];re.hasSymbolBuckets&&!re.holdingForFade()?re.setHoldDuration(this.map._fadeDuration):re.hasSymbolBuckets&&!re.symbolFadeFinished()||this._removeTile(K)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)}_updateRetainedTiles(a,d){const b={},w={},I=Math.max(d-ge.maxOverzooming,this._source.minzoom),L=Math.max(d+ge.maxUnderzooming,this._source.minzoom),F={};for(const j of a){const Y=this._addTile(j);b[j.key]=j,Y.hasData()||d<this._source.maxzoom&&(F[j.key]=j)}this._retainLoadedChildren(F,d,L,b);for(const j of a){let Y=this._tiles[j.key];if(Y.hasData())continue;if(d+1>this._source.maxzoom){const re=j.children(this._source.maxzoom)[0],me=this.getTile(re);if(me&&me.hasData()){b[re.key]=re;continue}}else{const re=j.children(this._source.maxzoom);if(b[re[0].key]&&b[re[1].key]&&b[re[2].key]&&b[re[3].key])continue}let K=Y.wasRequested();for(let re=j.overscaledZ-1;re>=I;--re){const me=j.scaledTo(re);if(w[me.key])break;if(w[me.key]=!0,Y=this.getTile(me),!Y&&K&&(Y=this._addTile(me)),Y){const Me=Y.hasData();if((K||Me)&&(b[me.key]=me),K=Y.wasRequested(),Me)break}}}return b}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const d=[];let b,w=this._tiles[a].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){b=this._loadedParentTiles[w.key];break}d.push(w.key);const I=w.scaledTo(w.overscaledZ-1);if(b=this._getLoadedTile(I),b)break;w=I}for(const I of d)this._loadedParentTiles[I]=b}}_addTile(a){let d=this._tiles[a.key];if(d)return d;d=this._cache.getAndRemove(a),d&&(this._setTileReloadTimer(a.key,d),d.tileID=a,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,d)));const b=d;return d||(d=new rt(a,this._source.tileSize*a.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,a.key,d.state))),d.uses++,this._tiles[a.key]=d,b||this._source.fire(new u.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(a,d){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const b=d.getExpiryTimeout();b&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},b))}_removeTile(a){const d=this._tiles[a];d&&(d.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(a);this._cache.reset()}tilesIn(a,d,b){const w=[],I=this.transform;if(!I)return w;const L=b?I.getCameraQueryGeometry(a):a,F=a.map(Te=>I.pointCoordinate(Te,this.terrain)),j=L.map(Te=>I.pointCoordinate(Te,this.terrain)),Y=this.getIds();let K=1/0,re=1/0,me=-1/0,Me=-1/0;for(const Te of j)K=Math.min(K,Te.x),re=Math.min(re,Te.y),me=Math.max(me,Te.x),Me=Math.max(Me,Te.y);for(let Te=0;Te<Y.length;Te++){const Fe=this._tiles[Y[Te]];if(Fe.holdingForFade())continue;const Ce=Fe.tileID,Je=Math.pow(2,I.zoom-Fe.tileID.overscaledZ),at=d*Fe.queryPadding*u.EXTENT/Fe.tileSize/Je,je=[Ce.getTilePoint(new u.MercatorCoordinate(K,re)),Ce.getTilePoint(new u.MercatorCoordinate(me,Me))];if(je[0].x-at<u.EXTENT&&je[0].y-at<u.EXTENT&&je[1].x+at>=0&&je[1].y+at>=0){const tt=F.map(lt=>Ce.getTilePoint(lt)),ut=j.map(lt=>Ce.getTilePoint(lt));w.push({tile:Fe,tileID:Ce,queryGeometry:tt,cameraQueryGeometry:ut,scale:Je})}}return w}getVisibleCoordinates(a){const d=this.getRenderableIds(a).map(b=>this._tiles[b].tileID);for(const b of d)b.posMatrix=this.transform.calculatePosMatrix(b.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Xe(this._source.type)){const a=u.browser.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=a)return!0}return!1}setFeatureState(a,d,b){this._state.updateState(a=a||"_geojsonTileLayer",d,b)}removeFeatureState(a,d,b){this._state.removeFeatureState(a=a||"_geojsonTileLayer",d,b)}getFeatureState(a,d){return this._state.getState(a=a||"_geojsonTileLayer",d)}setDependencies(a,d,b){const w=this._tiles[a];w&&w.setDependencies(d,b)}reloadTilesForDependencies(a,d){for(const b in this._tiles)this._tiles[b].hasDependency(a,d)&&this._reloadTile(b,"reloading");this._cache.filter(b=>!b.hasDependency(a,d))}}function Be(x,a){const d=Math.abs(2*x.wrap)-+(x.wrap<0),b=Math.abs(2*a.wrap)-+(a.wrap<0);return x.overscaledZ-a.overscaledZ||b-d||a.canonical.y-x.canonical.y||a.canonical.x-x.canonical.x}function Xe(x){return x==="raster"||x==="image"||x==="video"}ge.maxOverzooming=10,ge.maxUnderzooming=3;const $e="mapboxgl_preloaded_worker_pool";class ht{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<ht.workerCount;)this.workers.push(new Worker(u.config.WORKER_URL));return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[$e]}numActive(){return Object.keys(this.active).length}}const Qe=Math.floor(u.browser.hardwareConcurrency/2);let Vt;function ir(){return Vt||(Vt=new ht),Vt}ht.workerCount=u.isSafari(globalThis)?Math.max(Math.min(Qe,3),1):1;class it{constructor(a,d){this.reset(a,d)}reset(a,d){this.points=a||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=u.clamp(a,0,1);let d=1,b=this._distances[d];const w=a*this.paddedLength+this.padding;for(;b<w&&d<this._distances.length;)b=this._distances[++d];const I=d-1,L=this._distances[I],F=b-L,j=F>0?(w-L)/F:0;return this.points[I].mult(1-j).add(this.points[d].mult(j))}}function Tt(x,a){let d=!0;return x==="always"||x!=="never"&&a!=="never"||(d=!1),d}class Nt{constructor(a,d,b){const w=this.boxCells=[],I=this.circleCells=[];this.xCellCount=Math.ceil(a/b),this.yCellCount=Math.ceil(d/b);for(let L=0;L<this.xCellCount*this.yCellCount;L++)w.push([]),I.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=d,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,d,b,w,I){this._forEachCell(d,b,w,I,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(d),this.bboxes.push(b),this.bboxes.push(w),this.bboxes.push(I)}insertCircle(a,d,b,w){this._forEachCell(d-w,b-w,d+w,b+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(d),this.circles.push(b),this.circles.push(w)}_insertBoxCell(a,d,b,w,I,L){this.boxCells[I].push(L)}_insertCircleCell(a,d,b,w,I,L){this.circleCells[I].push(L)}_query(a,d,b,w,I,L,F){if(b<0||a>this.width||w<0||d>this.height)return[];const j=[];if(a<=0&&d<=0&&this.width<=b&&this.height<=w){if(I)return[{key:null,x1:a,y1:d,x2:b,y2:w}];for(let Y=0;Y<this.boxKeys.length;Y++)j.push({key:this.boxKeys[Y],x1:this.bboxes[4*Y],y1:this.bboxes[4*Y+1],x2:this.bboxes[4*Y+2],y2:this.bboxes[4*Y+3]});for(let Y=0;Y<this.circleKeys.length;Y++){const K=this.circles[3*Y],re=this.circles[3*Y+1],me=this.circles[3*Y+2];j.push({key:this.circleKeys[Y],x1:K-me,y1:re-me,x2:K+me,y2:re+me})}}else this._forEachCell(a,d,b,w,this._queryCell,j,{hitTest:I,overlapMode:L,seenUids:{box:{},circle:{}}},F);return j}query(a,d,b,w){return this._query(a,d,b,w,!1,null)}hitTest(a,d,b,w,I,L){return this._query(a,d,b,w,!0,I,L).length>0}hitTestCircle(a,d,b,w,I){const L=a-b,F=a+b,j=d-b,Y=d+b;if(F<0||L>this.width||Y<0||j>this.height)return!1;const K=[];return this._forEachCell(L,j,F,Y,this._queryCellCircle,K,{hitTest:!0,overlapMode:w,circle:{x:a,y:d,radius:b},seenUids:{box:{},circle:{}}},I),K.length>0}_queryCell(a,d,b,w,I,L,F,j){const{seenUids:Y,hitTest:K,overlapMode:re}=F,me=this.boxCells[I];if(me!==null){const Te=this.bboxes;for(const Fe of me)if(!Y.box[Fe]){Y.box[Fe]=!0;const Ce=4*Fe,Je=this.boxKeys[Fe];if(a<=Te[Ce+2]&&d<=Te[Ce+3]&&b>=Te[Ce+0]&&w>=Te[Ce+1]&&(!j||j(Je))&&(!K||!Tt(re,Je.overlapMode))&&(L.push({key:Je,x1:Te[Ce],y1:Te[Ce+1],x2:Te[Ce+2],y2:Te[Ce+3]}),K))return!0}}const Me=this.circleCells[I];if(Me!==null){const Te=this.circles;for(const Fe of Me)if(!Y.circle[Fe]){Y.circle[Fe]=!0;const Ce=3*Fe,Je=this.circleKeys[Fe];if(this._circleAndRectCollide(Te[Ce],Te[Ce+1],Te[Ce+2],a,d,b,w)&&(!j||j(Je))&&(!K||!Tt(re,Je.overlapMode))){const at=Te[Ce],je=Te[Ce+1],tt=Te[Ce+2];if(L.push({key:Je,x1:at-tt,y1:je-tt,x2:at+tt,y2:je+tt}),K)return!0}}}return!1}_queryCellCircle(a,d,b,w,I,L,F,j){const{circle:Y,seenUids:K,overlapMode:re}=F,me=this.boxCells[I];if(me!==null){const Te=this.bboxes;for(const Fe of me)if(!K.box[Fe]){K.box[Fe]=!0;const Ce=4*Fe,Je=this.boxKeys[Fe];if(this._circleAndRectCollide(Y.x,Y.y,Y.radius,Te[Ce+0],Te[Ce+1],Te[Ce+2],Te[Ce+3])&&(!j||j(Je))&&!Tt(re,Je.overlapMode))return L.push(!0),!0}}const Me=this.circleCells[I];if(Me!==null){const Te=this.circles;for(const Fe of Me)if(!K.circle[Fe]){K.circle[Fe]=!0;const Ce=3*Fe,Je=this.circleKeys[Fe];if(this._circlesCollide(Te[Ce],Te[Ce+1],Te[Ce+2],Y.x,Y.y,Y.radius)&&(!j||j(Je))&&!Tt(re,Je.overlapMode))return L.push(!0),!0}}}_forEachCell(a,d,b,w,I,L,F,j){const Y=this._convertToXCellCoord(a),K=this._convertToYCellCoord(d),re=this._convertToXCellCoord(b),me=this._convertToYCellCoord(w);for(let Me=Y;Me<=re;Me++)for(let Te=K;Te<=me;Te++)if(I.call(this,a,d,b,w,this.xCellCount*Te+Me,L,F,j))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,d,b,w,I,L){const F=w-a,j=I-d,Y=b+L;return Y*Y>F*F+j*j}_circleAndRectCollide(a,d,b,w,I,L,F){const j=(L-w)/2,Y=Math.abs(a-(w+j));if(Y>j+b)return!1;const K=(F-I)/2,re=Math.abs(d-(I+K));if(re>K+b)return!1;if(Y<=j||re<=K)return!0;const me=Y-j,Me=re-K;return me*me+Me*Me<=b*b}}function Ar(x,a,d,b,w){const I=u.create();return a?(u.scale(I,I,[1/w,1/w,1]),d||u.rotateZ(I,I,b.angle)):u.multiply(I,b.labelPlaneMatrix,x),I}function Ir(x,a,d,b,w){if(a){const I=u.clone(x);return u.scale(I,I,[w,w,1]),d||u.rotateZ(I,I,-b.angle),I}return b.glCoordMatrix}function Rt(x,a,d){let b;d?(b=[x.x,x.y,d(x.x,x.y),1],u.transformMat4(b,b,a)):(b=[x.x,x.y,0,1],Ne(b,b,a));const w=b[3];return{point:new u.Point(b[0]/w,b[1]/w),signedDistanceFromCamera:w}}function sn(x,a){return .5+x/a*.5}function un(x,a){const d=x[0]/x[3],b=x[1]/x[3];return d>=-a[0]&&d<=a[0]&&b>=-a[1]&&b<=a[1]}function Gn(x,a,d,b,w,I,L,F,j,Y){const K=b?x.textSizeData:x.iconSizeData,re=u.evaluateSizeForZoom(K,d.transform.zoom),me=[256/d.width*2+1,256/d.height*2+1],Me=b?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;Me.clear();const Te=x.lineVertexArray,Fe=b?x.text.placedSymbolArray:x.icon.placedSymbolArray,Ce=d.transform.width/d.transform.height;let Je=!1;for(let at=0;at<Fe.length;at++){const je=Fe.get(at);if(je.hidden||je.writingMode===u.WritingMode.vertical&&!Je){Ie(je.numGlyphs,Me);continue}let tt;if(Je=!1,Y?(tt=[je.anchorX,je.anchorY,Y(je.anchorX,je.anchorY),1],u.transformMat4(tt,tt,a)):(tt=[je.anchorX,je.anchorY,0,1],Ne(tt,tt,a)),!un(tt,me)){Ie(je.numGlyphs,Me);continue}const ut=sn(d.transform.cameraToCenterDistance,tt[3]),lt=u.evaluateSizeForFeature(K,re,je),bt=L?lt/ut:lt*ut,St=new u.Point(je.anchorX,je.anchorY),wt=Rt(St,w,Y).point,Mt={projections:{},offsets:{}},lr=Fn(je,bt,!1,F,a,w,I,x.glyphOffsetArray,Te,Me,wt,St,Mt,Ce,j,Y);Je=lr.useVertical,(lr.notEnoughRoom||Je||lr.needsFlipping&&Fn(je,bt,!0,F,a,w,I,x.glyphOffsetArray,Te,Me,wt,St,Mt,Ce,j,Y).notEnoughRoom)&&Ie(je.numGlyphs,Me)}b?x.text.dynamicLayoutVertexBuffer.updateData(Me):x.icon.dynamicLayoutVertexBuffer.updateData(Me)}function rn(x,a,d,b,w,I,L,F,j,Y,K,re,me){const Me=F.glyphStartIndex+F.numGlyphs,Te=F.lineStartIndex,Fe=F.lineStartIndex+F.lineLength,Ce=a.getoffsetX(F.glyphStartIndex),Je=a.getoffsetX(Me-1),at=ne(x*Ce,d,b,w,I,L,F.segment,Te,Fe,j,Y,K,re,me);if(!at)return null;const je=ne(x*Je,d,b,w,I,L,F.segment,Te,Fe,j,Y,K,re,me);return je?{first:at,last:je}:null}function qr(x,a,d,b){return x===u.WritingMode.horizontal&&Math.abs(d.y-a.y)>Math.abs(d.x-a.x)*b?{useVertical:!0}:(x===u.WritingMode.vertical?a.y<d.y:a.x>d.x)?{needsFlipping:!0}:null}function Fn(x,a,d,b,w,I,L,F,j,Y,K,re,me,Me,Te,Fe){const Ce=a/24,Je=x.lineOffsetX*Ce,at=x.lineOffsetY*Ce;let je;if(x.numGlyphs>1){const tt=x.glyphStartIndex+x.numGlyphs,ut=x.lineStartIndex,lt=x.lineStartIndex+x.lineLength,bt=rn(Ce,F,Je,at,d,K,re,x,j,I,me,Te,Fe);if(!bt)return{notEnoughRoom:!0};const St=Rt(bt.first.point,L,Fe).point,wt=Rt(bt.last.point,L,Fe).point;if(b&&!d){const Mt=qr(x.writingMode,St,wt,Me);if(Mt)return Mt}je=[bt.first];for(let Mt=x.glyphStartIndex+1;Mt<tt-1;Mt++)je.push(ne(Ce*F.getoffsetX(Mt),Je,at,d,K,re,x.segment,ut,lt,j,I,me,Te,Fe));je.push(bt.last)}else{if(b&&!d){const ut=Rt(re,w,Fe).point,lt=x.lineStartIndex+x.segment+1,bt=new u.Point(j.getx(lt),j.gety(lt)),St=Rt(bt,w,Fe),wt=St.signedDistanceFromCamera>0?St.point:Lr(re,bt,ut,1,w,Fe),Mt=qr(x.writingMode,ut,wt,Me);if(Mt)return Mt}const tt=ne(Ce*F.getoffsetX(x.glyphStartIndex),Je,at,d,K,re,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,j,I,me,Te,Fe);if(!tt)return{notEnoughRoom:!0};je=[tt]}for(const tt of je)u.addDynamicAttributes(Y,tt.point,tt.angle);return{}}function Lr(x,a,d,b,w,I){const L=Rt(x.add(x.sub(a)._unit()),w,I).point,F=d.sub(L);return d.add(F._mult(b/F.mag()))}function Et(x,a){const{projectionCache:d,lineVertexArray:b,labelPlaneMatrix:w,tileAnchorPoint:I,distanceFromAnchor:L,getElevation:F,previousVertex:j,direction:Y,absOffsetX:K}=a;if(d.projections[x])return d.projections[x];const re=new u.Point(b.getx(x),b.gety(x)),me=Rt(re,w,F);if(me.signedDistanceFromCamera>0)return d.projections[x]=me.point,me.point;const Me=x-Y;return Lr(L===0?I:new u.Point(b.getx(Me),b.gety(Me)),re,j,K-L+1,w,F)}function li(x,a,d){return x._unit()._perp()._mult(a*d)}function Le(x,a,d,b,w,I,L,F){const{projectionCache:j,direction:Y}=F;if(j.offsets[x])return j.offsets[x];const K=d.add(a);if(x+Y<b||x+Y>=w)return j.offsets[x]=K,K;const re=Et(x+Y,F),me=li(re.sub(d),L,Y),Me=d.add(me),Te=re.add(me);return j.offsets[x]=u.findLineIntersection(I,K,Me,Te)||K,j.offsets[x]}function ne(x,a,d,b,w,I,L,F,j,Y,K,re,me,Me){const Te=b?x-a:x+a;let Fe=Te>0?1:-1,Ce=0;b&&(Fe*=-1,Ce=Math.PI),Fe<0&&(Ce+=Math.PI);let Je,at,je=Fe>0?F+L:F+L+1,tt=w,ut=w,lt=0,bt=0;const St=Math.abs(Te),wt=[];let Mt;for(;lt+bt<=St;){if(je+=Fe,je<F||je>=j)return null;lt+=bt,ut=tt,at=Je;const kt={projectionCache:re,lineVertexArray:Y,labelPlaneMatrix:K,tileAnchorPoint:I,distanceFromAnchor:lt,getElevation:Me,previousVertex:ut,direction:Fe,absOffsetX:St};if(tt=Et(je,kt),d===0)wt.push(ut),Mt=tt.sub(ut);else{let gr;const ar=tt.sub(ut);gr=ar.mag()===0?li(Et(je+Fe,kt).sub(tt),d,Fe):li(ar,d,Fe),at||(at=ut.add(gr)),Je=Le(je,gr,tt,F,j,at,d,kt),wt.push(at),Mt=Je.sub(at)}bt=Mt.mag()}const lr=Mt._mult((St-lt)/bt)._add(at||ut),Qr=Ce+Math.atan2(tt.y-ut.y,tt.x-ut.x);return wt.push(lr),{point:lr,angle:me?Qr:0,path:wt}}const pe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ie(x,a){for(let d=0;d<x;d++){const b=a.length;a.resize(b+4),a.float32.set(pe,3*b)}}function Ne(x,a,d){const b=a[0],w=a[1];return x[0]=d[0]*b+d[4]*w+d[12],x[1]=d[1]*b+d[5]*w+d[13],x[3]=d[3]*b+d[7]*w+d[15],x}const Ue=100;class et{constructor(a,d=new Nt(a.width+200,a.height+200,25),b=new Nt(a.width+200,a.height+200,25)){this.transform=a,this.grid=d,this.ignoredGrid=b,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+Ue,this.screenBottomBoundary=a.height+Ue,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(a,d,b,w,I,L){const F=this.projectAndGetPerspectiveRatio(w,a.anchorPointX,a.anchorPointY,L),j=b*F.perspectiveRatio,Y=a.x1*j+F.point.x,K=a.y1*j+F.point.y,re=a.x2*j+F.point.x,me=a.y2*j+F.point.y;return!this.isInsideGrid(Y,K,re,me)||d!=="always"&&this.grid.hitTest(Y,K,re,me,d,I)||F.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[Y,K,re,me],offscreen:this.isOffscreen(Y,K,re,me)}}placeCollisionCircles(a,d,b,w,I,L,F,j,Y,K,re,me,Me,Te){const Fe=[],Ce=new u.Point(d.anchorX,d.anchorY),Je=Rt(Ce,L,Te),at=sn(this.transform.cameraToCenterDistance,Je.signedDistanceFromCamera),je=(K?I/at:I*at)/u.ONE_EM,tt=Rt(Ce,F,Te).point,ut=rn(je,w,d.lineOffsetX*je,d.lineOffsetY*je,!1,tt,Ce,d,b,F,{projections:{},offsets:{}},!1,Te);let lt=!1,bt=!1,St=!0;if(ut){const wt=.5*me*at+Me,Mt=new u.Point(-100,-100),lr=new u.Point(this.screenRightBoundary,this.screenBottomBoundary),Qr=new it,kt=ut.first,gr=ut.last;let ar=[];for(let _r=kt.path.length-1;_r>=1;_r--)ar.push(kt.path[_r]);for(let _r=1;_r<gr.path.length;_r++)ar.push(gr.path[_r]);const Ii=2.5*wt;if(j){const _r=ar.map(tn=>Rt(tn,j,Te));ar=_r.some(tn=>tn.signedDistanceFromCamera<=0)?[]:_r.map(tn=>tn.point)}let en=[];if(ar.length>0){const _r=ar[0].clone(),tn=ar[0].clone();for(let Bi=1;Bi<ar.length;Bi++)_r.x=Math.min(_r.x,ar[Bi].x),_r.y=Math.min(_r.y,ar[Bi].y),tn.x=Math.max(tn.x,ar[Bi].x),tn.y=Math.max(tn.y,ar[Bi].y);en=_r.x>=Mt.x&&tn.x<=lr.x&&_r.y>=Mt.y&&tn.y<=lr.y?[ar]:tn.x<Mt.x||_r.x>lr.x||tn.y<Mt.y||_r.y>lr.y?[]:u.clipLine([ar],Mt.x,Mt.y,lr.x,lr.y)}for(const _r of en){Qr.reset(_r,.25*wt);let tn=0;tn=Qr.length<=.5*wt?1:Math.ceil(Qr.paddedLength/Ii)+1;for(let Bi=0;Bi<tn;Bi++){const ri=Bi/Math.max(tn-1,1),xs=Qr.lerp(ri),ia=xs.x+Ue,ro=xs.y+Ue;Fe.push(ia,ro,wt,0);const es=ia-wt,Ou=ro-wt,su=ia+wt,Cu=ro+wt;if(St=St&&this.isOffscreen(es,Ou,su,Cu),bt=bt||this.isInsideGrid(es,Ou,su,Cu),a!=="always"&&this.grid.hitTestCircle(ia,ro,wt,a,re)&&(lt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:lt}}}}return{circles:!Y&&lt||!bt||at<this.perspectiveRatioCutoff?[]:Fe,offscreen:St,collisionDetected:lt}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let b=1/0,w=1/0,I=-1/0,L=-1/0;for(const K of a){const re=new u.Point(K.x+Ue,K.y+Ue);b=Math.min(b,re.x),w=Math.min(w,re.y),I=Math.max(I,re.x),L=Math.max(L,re.y),d.push(re)}const F=this.grid.query(b,w,I,L).concat(this.ignoredGrid.query(b,w,I,L)),j={},Y={};for(const K of F){const re=K.key;if(j[re.bucketInstanceId]===void 0&&(j[re.bucketInstanceId]={}),j[re.bucketInstanceId][re.featureIndex])continue;const me=[new u.Point(K.x1,K.y1),new u.Point(K.x2,K.y1),new u.Point(K.x2,K.y2),new u.Point(K.x1,K.y2)];u.polygonIntersectsPolygon(d,me)&&(j[re.bucketInstanceId][re.featureIndex]=!0,Y[re.bucketInstanceId]===void 0&&(Y[re.bucketInstanceId]=[]),Y[re.bucketInstanceId].push(re.featureIndex))}return Y}insertCollisionBox(a,d,b,w,I,L){(b?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:I,collisionGroupID:L,overlapMode:d},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,d,b,w,I,L){const F=b?this.ignoredGrid:this.grid,j={bucketInstanceId:w,featureIndex:I,collisionGroupID:L,overlapMode:d};for(let Y=0;Y<a.length;Y+=4)F.insertCircle(j,a[Y],a[Y+1],a[Y+2])}projectAndGetPerspectiveRatio(a,d,b,w){let I;return w?(I=[d,b,w(d,b),1],u.transformMat4(I,I,a)):(I=[d,b,0,1],Ne(I,I,a)),{point:new u.Point((I[0]/I[3]+1)/2*this.transform.width+Ue,(-I[1]/I[3]+1)/2*this.transform.height+Ue),perspectiveRatio:.5+this.transform.cameraToCenterDistance/I[3]*.5}}isOffscreen(a,d,b,w){return b<Ue||a>=this.screenRightBoundary||w<Ue||d>this.screenBottomBoundary}isInsideGrid(a,d,b,w){return b>=0&&a<this.gridRightBoundary&&w>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const a=u.identity([]);return u.translate(a,a,[-100,-100,0]),a}}function Ve(x,a,d){return a*(u.EXTENT/(x.tileSize*Math.pow(2,d-x.tileID.overscaledZ)))}class qe{constructor(a,d,b,w){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?d:-d))):w&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class Ke{constructor(a,d,b,w,I){this.text=new qe(a?a.text:null,d,b,I),this.icon=new qe(a?a.icon:null,d,w,I)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gt{constructor(a,d,b){this.text=a,this.icon=d,this.skipFade=b}}class vt{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class ft{constructor(a,d,b,w,I){this.bucketInstanceId=a,this.featureIndex=d,this.sourceLayerIndex=b,this.bucketIndex=w,this.tileID=I}}class Ot{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const d=++this.maxGroupID;this.collisionGroups[a]={ID:d,predicate:b=>b.collisionGroupID===d}}return this.collisionGroups[a]}}function ur(x,a,d,b,w){const{horizontalAlign:I,verticalAlign:L}=u.getAnchorAlignment(x);return new u.Point(-(I-.5)*a+b[0]*w,-(L-.5)*d+b[1]*w)}function jt(x,a,d,b,w,I){const{x1:L,x2:F,y1:j,y2:Y,anchorPointX:K,anchorPointY:re}=x,me=new u.Point(a,d);return b&&me._rotate(w?I:-I),{x1:L+me.x,y1:j+me.y,x2:F+me.x,y2:Y+me.y,anchorPointX:K,anchorPointY:re}}class Xt{constructor(a,d,b,w,I){this.transform=a.clone(),this.terrain=d,this.collisionIndex=new et(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new Ot(w),this.collisionCircleArrays={},this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,d,b,w){const I=b.getBucket(d),L=b.latestFeatureIndex;if(!I||!L||d.id!==I.layerIds[0])return;const F=b.collisionBoxArray,j=I.layers[0].layout,Y=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),K=b.tileSize/u.EXTENT,re=this.transform.calculatePosMatrix(b.tileID.toUnwrapped()),me=j.get("text-pitch-alignment")==="map",Me=j.get("text-rotation-alignment")==="map",Te=Ve(b,1,this.transform.zoom),Fe=Ar(re,me,Me,this.transform,Te);let Ce=null;if(me){const at=Ir(re,me,Me,this.transform,Te);Ce=u.multiply([],this.transform.labelPlaneMatrix,at)}this.retainedQueryData[I.bucketInstanceId]=new ft(I.bucketInstanceId,L,I.sourceLayerIndex,I.index,b.tileID);const Je={bucket:I,layout:j,posMatrix:re,textLabelPlaneMatrix:Fe,labelToScreenMatrix:Ce,scale:Y,textPixelRatio:K,holdingForFade:b.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(I.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(I.sourceID)};if(w)for(const at of I.sortKeyRanges){const{sortKey:je,symbolInstanceStart:tt,symbolInstanceEnd:ut}=at;a.push({sortKey:je,symbolInstanceStart:tt,symbolInstanceEnd:ut,parameters:Je})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:I.symbolInstances.length,parameters:Je})}attemptAnchorPlacement(a,d,b,w,I,L,F,j,Y,K,re,me,Me,Te,Fe,Ce){const Je=u.TextAnchorEnum[a.textAnchor],at=[a.textOffset0,a.textOffset1],je=ur(Je,b,w,at,I),tt=this.collisionIndex.placeCollisionBox(jt(d,je.x,je.y,L,F,this.transform.angle),re,j,Y,K.predicate,Ce);if((!Fe||this.collisionIndex.placeCollisionBox(jt(Fe,je.x,je.y,L,F,this.transform.angle),re,j,Y,K.predicate,Ce).box.length!==0)&&tt.box.length>0){let ut;if(this.prevPlacement&&this.prevPlacement.variableOffsets[me.crossTileID]&&this.prevPlacement.placements[me.crossTileID]&&this.prevPlacement.placements[me.crossTileID].text&&(ut=this.prevPlacement.variableOffsets[me.crossTileID].anchor),me.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[me.crossTileID]={textOffset:at,width:b,height:w,anchor:Je,textBoxScale:I,prevAnchor:ut},this.markUsedJustification(Me,Je,me,Te),Me.allowVerticalPlacement&&(this.markUsedOrientation(Me,Te,me),this.placedOrientations[me.crossTileID]=Te),{shift:je,placedGlyphBoxes:tt}}}placeLayerBucketPart(a,d,b){const{bucket:w,layout:I,posMatrix:L,textLabelPlaneMatrix:F,labelToScreenMatrix:j,textPixelRatio:Y,holdingForFade:K,collisionBoxArray:re,partiallyEvaluatedTextSize:me,collisionGroup:Me}=a.parameters,Te=I.get("text-optional"),Fe=I.get("icon-optional"),Ce=u.getOverlapMode(I,"text-overlap","text-allow-overlap"),Je=Ce==="always",at=u.getOverlapMode(I,"icon-overlap","icon-allow-overlap"),je=at==="always",tt=I.get("text-rotation-alignment")==="map",ut=I.get("text-pitch-alignment")==="map",lt=I.get("icon-text-fit")!=="none",bt=I.get("symbol-z-order")==="viewport-y",St=Je&&(je||!w.hasIconData()||Fe),wt=je&&(Je||!w.hasTextData()||Te);!w.collisionArrays&&re&&w.deserializeCollisionBoxes(re);const Mt=this.retainedQueryData[w.bucketInstanceId].tileID,lr=this.terrain?(kt,gr)=>this.terrain.getElevation(Mt,kt,gr):null,Qr=(kt,gr)=>{var ar,Ii;if(d[kt.crossTileID])return;if(K)return void(this.placements[kt.crossTileID]=new gt(!1,!1,!1));let en=!1,_r=!1,tn=!0,Bi=null,ri={box:null,offscreen:null},xs={box:null,offscreen:null},ia=null,ro=null,es=null,Ou=0,su=0,Cu=0;gr.textFeatureIndex?Ou=gr.textFeatureIndex:kt.useRuntimeCollisionCircles&&(Ou=kt.featureIndex),gr.verticalTextFeatureIndex&&(su=gr.verticalTextFeatureIndex);const ac=gr.textBox;if(ac){const ho=Lo=>{let _o=u.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Lo&&this.prevPlacement){const ya=this.prevPlacement.placedOrientations[kt.crossTileID];ya&&(this.placedOrientations[kt.crossTileID]=ya,_o=ya,this.markUsedOrientation(w,_o,kt))}return _o},Mo=(Lo,_o)=>{if(w.allowVerticalPlacement&&kt.numVerticalGlyphVertices>0&&gr.verticalTextBox){for(const ya of w.writingModes)if(ya===u.WritingMode.vertical?(ri=_o(),xs=ri):ri=Lo(),ri&&ri.box&&ri.box.length)break}else ri=Lo()},va=kt.textAnchorOffsetStartIndex,sc=kt.textAnchorOffsetEndIndex;if(sc===va){const Lo=(_o,ya)=>{const zi=this.collisionIndex.placeCollisionBox(_o,Ce,Y,L,Me.predicate,lr);return zi&&zi.box&&zi.box.length&&(this.markUsedOrientation(w,ya,kt),this.placedOrientations[kt.crossTileID]=ya),zi};Mo(()=>Lo(ac,u.WritingMode.horizontal),()=>{const _o=gr.verticalTextBox;return w.allowVerticalPlacement&&kt.numVerticalGlyphVertices>0&&_o?Lo(_o,u.WritingMode.vertical):{box:null,offscreen:null}}),ho(ri&&ri.box&&ri.box.length)}else{let Lo=u.TextAnchorEnum[(Ii=(ar=this.prevPlacement)===null||ar===void 0?void 0:ar.variableOffsets[kt.crossTileID])===null||Ii===void 0?void 0:Ii.anchor];const _o=(zi,Bu,uu)=>{const ll=zi.x2-zi.x1,xg=zi.y2-zi.y1,kl=kt.textBoxScale,f0=lt&&at==="never"?Bu:null;let Bl={box:[],offscreen:!1},Yi=Ce==="never"?1:2,Th="never";Lo&&Yi++;for(let Wf=0;Wf<Yi;Wf++){for(let zu=va;zu<sc;zu++){const cl=w.textAnchorOffsets.get(zu);if(Lo&&cl.textAnchor!==Lo)continue;const uc=this.attemptAnchorPlacement(cl,zi,ll,xg,kl,tt,ut,Y,L,Me,Th,kt,w,uu,f0,lr);if(uc&&(Bl=uc.placedGlyphBoxes,Bl&&Bl.box&&Bl.box.length))return en=!0,Bi=uc.shift,Bl}Lo?Lo=null:Th=Ce}return Bl};Mo(()=>_o(ac,gr.iconBox,u.WritingMode.horizontal),()=>{const zi=gr.verticalTextBox;return w.allowVerticalPlacement&&!(ri&&ri.box&&ri.box.length)&&kt.numVerticalGlyphVertices>0&&zi?_o(zi,gr.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null}}),ri&&(en=ri.box,tn=ri.offscreen);const ya=ho(ri&&ri.box);if(!en&&this.prevPlacement){const zi=this.prevPlacement.variableOffsets[kt.crossTileID];zi&&(this.variableOffsets[kt.crossTileID]=zi,this.markUsedJustification(w,zi.anchor,kt,ya))}}}if(ia=ri,en=ia&&ia.box&&ia.box.length>0,tn=ia&&ia.offscreen,kt.useRuntimeCollisionCircles){const ho=w.text.placedSymbolArray.get(kt.centerJustifiedTextSymbolIndex),Mo=u.evaluateSizeForFeature(w.textSizeData,me,ho),va=I.get("text-padding");ro=this.collisionIndex.placeCollisionCircles(Ce,ho,w.lineVertexArray,w.glyphOffsetArray,Mo,L,F,j,b,ut,Me.predicate,kt.collisionCircleDiameter,va,lr),ro.circles.length&&ro.collisionDetected&&!b&&u.warnOnce("Collisions detected, but collision boxes are not shown"),en=Je||ro.circles.length>0&&!ro.collisionDetected,tn=tn&&ro.offscreen}if(gr.iconFeatureIndex&&(Cu=gr.iconFeatureIndex),gr.iconBox){const ho=Mo=>{const va=lt&&Bi?jt(Mo,Bi.x,Bi.y,tt,ut,this.transform.angle):Mo;return this.collisionIndex.placeCollisionBox(va,at,Y,L,Me.predicate,lr)};xs&&xs.box&&xs.box.length&&gr.verticalIconBox?(es=ho(gr.verticalIconBox),_r=es.box.length>0):(es=ho(gr.iconBox),_r=es.box.length>0),tn=tn&&es.offscreen}const ul=Te||kt.numHorizontalGlyphVertices===0&&kt.numVerticalGlyphVertices===0,ku=Fe||kt.numIconVertices===0;if(ul||ku?ku?ul||(_r=_r&&en):en=_r&&en:_r=en=_r&&en,en&&ia&&ia.box&&this.collisionIndex.insertCollisionBox(ia.box,Ce,I.get("text-ignore-placement"),w.bucketInstanceId,xs&&xs.box&&su?su:Ou,Me.ID),_r&&es&&this.collisionIndex.insertCollisionBox(es.box,at,I.get("icon-ignore-placement"),w.bucketInstanceId,Cu,Me.ID),ro&&(en&&this.collisionIndex.insertCollisionCircles(ro.circles,Ce,I.get("text-ignore-placement"),w.bucketInstanceId,Ou,Me.ID),b)){const ho=w.bucketInstanceId;let Mo=this.collisionCircleArrays[ho];Mo===void 0&&(Mo=this.collisionCircleArrays[ho]=new vt);for(let va=0;va<ro.circles.length;va+=4)Mo.circles.push(ro.circles[va+0]),Mo.circles.push(ro.circles[va+1]),Mo.circles.push(ro.circles[va+2]),Mo.circles.push(ro.collisionDetected?1:0)}if(kt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(w.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[kt.crossTileID]=new gt(en||St,_r||wt,tn||w.justReloaded),d[kt.crossTileID]=!0};if(bt){if(a.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const kt=w.getSortedSymbolIndexes(this.transform.angle);for(let gr=kt.length-1;gr>=0;--gr){const ar=kt[gr];Qr(w.symbolInstances.get(ar),w.collisionArrays[ar])}}else for(let kt=a.symbolInstanceStart;kt<a.symbolInstanceEnd;kt++)Qr(w.symbolInstances.get(kt),w.collisionArrays[kt]);if(b&&w.bucketInstanceId in this.collisionCircleArrays){const kt=this.collisionCircleArrays[w.bucketInstanceId];u.invert(kt.invProjMatrix,L),kt.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(a,d,b,w){let I;I=w===u.WritingMode.vertical?b.verticalPlacedTextSymbolIndex:{left:b.leftJustifiedTextSymbolIndex,center:b.centerJustifiedTextSymbolIndex,right:b.rightJustifiedTextSymbolIndex}[u.getAnchorJustification(d)];const L=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex,b.verticalPlacedTextSymbolIndex];for(const F of L)F>=0&&(a.text.placedSymbolArray.get(F).crossTileID=I>=0&&F!==I?0:b.crossTileID)}markUsedOrientation(a,d,b){const w=d===u.WritingMode.horizontal||d===u.WritingMode.horizontalOnly?d:0,I=d===u.WritingMode.vertical?d:0,L=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex];for(const F of L)a.text.placedSymbolArray.get(F).placedOrientation=w;b.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(b.verticalPlacedTextSymbolIndex).placedOrientation=I)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let b=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const w=d?d.symbolFadeChange(a):1,I=d?d.opacities:{},L=d?d.variableOffsets:{},F=d?d.placedOrientations:{};for(const j in this.placements){const Y=this.placements[j],K=I[j];K?(this.opacities[j]=new Ke(K,w,Y.text,Y.icon),b=b||Y.text!==K.text.placed||Y.icon!==K.icon.placed):(this.opacities[j]=new Ke(null,w,Y.text,Y.icon,Y.skipFade),b=b||Y.text||Y.icon)}for(const j in I){const Y=I[j];if(!this.opacities[j]){const K=new Ke(Y,w,!1,!1);K.isHidden()||(this.opacities[j]=K,b=b||Y.text.placed||Y.icon.placed)}}for(const j in L)this.variableOffsets[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.variableOffsets[j]=L[j]);for(const j in F)this.placedOrientations[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.placedOrientations[j]=F[j]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");b?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:a)}updateLayerOpacities(a,d){const b={};for(const w of d){const I=w.getBucket(a);I&&w.latestFeatureIndex&&a.id===I.layerIds[0]&&this.updateBucketOpacities(I,b,w.collisionBoxArray)}}updateBucketOpacities(a,d,b){a.hasTextData()&&(a.text.opacityVertexArray.clear(),a.text.hasVisibleVertices=!1),a.hasIconData()&&(a.icon.opacityVertexArray.clear(),a.icon.hasVisibleVertices=!1),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const w=a.layers[0],I=w.layout,L=new Ke(null,0,!1,!1,!0),F=I.get("text-allow-overlap"),j=I.get("icon-allow-overlap"),Y=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),K=I.get("text-rotation-alignment")==="map",re=I.get("text-pitch-alignment")==="map",me=I.get("icon-text-fit")!=="none",Me=new Ke(null,0,F&&(j||!a.hasIconData()||I.get("icon-optional")),j&&(F||!a.hasTextData()||I.get("text-optional")),!0);!a.collisionArrays&&b&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(b);const Te=(Fe,Ce,Je)=>{for(let at=0;at<Ce/4;at++)Fe.opacityVertexArray.emplaceBack(Je);Fe.hasVisibleVertices=Fe.hasVisibleVertices||Je!==Vr};for(let Fe=0;Fe<a.symbolInstances.length;Fe++){const Ce=a.symbolInstances.get(Fe),{numHorizontalGlyphVertices:Je,numVerticalGlyphVertices:at,crossTileID:je}=Ce;let tt=this.opacities[je];d[je]?tt=L:tt||(tt=Me,this.opacities[je]=tt),d[je]=!0;const ut=Ce.numIconVertices>0,lt=this.placedOrientations[Ce.crossTileID],bt=lt===u.WritingMode.vertical,St=lt===u.WritingMode.horizontal||lt===u.WritingMode.horizontalOnly;if(Je>0||at>0){const wt=_t(tt.text);Te(a.text,Je,bt?Vr:wt),Te(a.text,at,St?Vr:wt);const Mt=tt.text.isHidden();[Ce.rightJustifiedTextSymbolIndex,Ce.centerJustifiedTextSymbolIndex,Ce.leftJustifiedTextSymbolIndex].forEach(kt=>{kt>=0&&(a.text.placedSymbolArray.get(kt).hidden=Mt||bt?1:0)}),Ce.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(Ce.verticalPlacedTextSymbolIndex).hidden=Mt||St?1:0);const lr=this.variableOffsets[Ce.crossTileID];lr&&this.markUsedJustification(a,lr.anchor,Ce,lt);const Qr=this.placedOrientations[Ce.crossTileID];Qr&&(this.markUsedJustification(a,"left",Ce,Qr),this.markUsedOrientation(a,Qr,Ce))}if(ut){const wt=_t(tt.icon),Mt=!(me&&Ce.verticalPlacedIconSymbolIndex&&bt);Ce.placedIconSymbolIndex>=0&&(Te(a.icon,Ce.numIconVertices,Mt?wt:Vr),a.icon.placedSymbolArray.get(Ce.placedIconSymbolIndex).hidden=tt.icon.isHidden()),Ce.verticalPlacedIconSymbolIndex>=0&&(Te(a.icon,Ce.numVerticalIconVertices,Mt?Vr:wt),a.icon.placedSymbolArray.get(Ce.verticalPlacedIconSymbolIndex).hidden=tt.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const wt=a.collisionArrays[Fe];if(wt){let Mt=new u.Point(0,0);if(wt.textBox||wt.verticalTextBox){let Qr=!0;if(Y){const kt=this.variableOffsets[je];kt?(Mt=ur(kt.anchor,kt.width,kt.height,kt.textOffset,kt.textBoxScale),K&&Mt._rotate(re?this.transform.angle:-this.transform.angle)):Qr=!1}wt.textBox&&Ht(a.textCollisionBox.collisionVertexArray,tt.text.placed,!Qr||bt,Mt.x,Mt.y),wt.verticalTextBox&&Ht(a.textCollisionBox.collisionVertexArray,tt.text.placed,!Qr||St,Mt.x,Mt.y)}const lr=!!(!St&&wt.verticalIconBox);wt.iconBox&&Ht(a.iconCollisionBox.collisionVertexArray,tt.icon.placed,lr,me?Mt.x:0,me?Mt.y:0),wt.verticalIconBox&&Ht(a.iconCollisionBox.collisionVertexArray,tt.icon.placed,!lr,me?Mt.x:0,me?Mt.y:0)}}}if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.text.opacityVertexArray.length!==a.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${a.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${a.text.layoutVertexArray.length}) / 4`);if(a.icon.opacityVertexArray.length!==a.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${a.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${a.icon.layoutVertexArray.length}) / 4`);if(a.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=Fe.invProjMatrix,a.placementViewportMatrix=Fe.viewportMatrix,a.collisionCircleArray=Fe.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,d){const b=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*b>a}setStale(){this.stale=!0}}function Ht(x,a,d,b,w){x.emplaceBack(a?1:0,d?1:0,b||0,w||0),x.emplaceBack(a?1:0,d?1:0,b||0,w||0),x.emplaceBack(a?1:0,d?1:0,b||0,w||0),x.emplaceBack(a?1:0,d?1:0,b||0,w||0)}const Ur=Math.pow(2,25),$r=Math.pow(2,24),zr=Math.pow(2,17),Cr=Math.pow(2,16),Zi=Math.pow(2,9),Ut=Math.pow(2,8),Fr=Math.pow(2,1);function _t(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const a=x.placed?1:0,d=Math.floor(127*x.opacity);return d*Ur+a*$r+d*zr+a*Cr+d*Zi+a*Ut+d*Fr+a}const Vr=0;class vi{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&!a.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(a,d,b,w,I){const L=this._bucketParts;for(;this._currentTileIndex<a.length;)if(d.getBucketParts(L,w,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,I())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((F,j)=>F.sortKey-j.sortKey));this._currentPartIndex<L.length;)if(d.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,b),this._currentPartIndex++,I())return!0;return!1}}class ii{constructor(a,d,b,w,I,L,F,j){this.placement=new Xt(a,d,L,F,j),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(a,d,b){const w=u.browser.now(),I=()=>!this._forceFullPlacement&&u.browser.now()-w>2;for(;this._currentPlacementIndex>=0;){const L=d[a[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=F)&&(!L.maxzoom||L.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new vi(L)),this._inProgressLayer.continuePlacement(b[L.source],this.placement,this._showCollisionBoxes,L,I))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const ci=512/u.EXTENT/2;class hi{constructor(a,d,b){this.tileID=a,this.bucketInstanceId=b,this._symbolsByKey={};const w=new Map;for(let I=0;I<d.length;I++){const L=d.get(I),F=L.key,j=w.get(F);j?j.push(L):w.set(F,[L])}for(const[I,L]of w){const F={positions:L.map(j=>({x:Math.floor(j.anchorX*ci),y:Math.floor(j.anchorY*ci)})),crossTileIDs:L.map(j=>j.crossTileID)};if(F.positions.length>128){const j=new u.KDBush(F.positions.length,16,Uint16Array);for(const{x:Y,y:K}of F.positions)j.add(Y,K);j.finish(),delete F.positions,F.index=j}this._symbolsByKey[I]=F}}getScaledCoordinates(a,d){const{x:b,y:w,z:I}=this.tileID.canonical,{x:L,y:F,z:j}=d.canonical,Y=ci/Math.pow(2,j-I),K=(F*u.EXTENT+a.anchorY)*Y,re=w*u.EXTENT*ci;return{x:Math.floor((L*u.EXTENT+a.anchorX)*Y-b*u.EXTENT*ci),y:Math.floor(K-re)}}findMatches(a,d,b){const w=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let I=0;I<a.length;I++){const L=a.get(I);if(L.crossTileID)continue;const F=this._symbolsByKey[L.key];if(!F)continue;const j=this.getScaledCoordinates(L,d);if(F.index){const Y=F.index.range(j.x-w,j.y-w,j.x+w,j.y+w).sort();for(const K of Y){const re=F.crossTileIDs[K];if(!b[re]){b[re]=!0,L.crossTileID=re;break}}}else if(F.positions)for(let Y=0;Y<F.positions.length;Y++){const K=F.positions[Y],re=F.crossTileIDs[Y];if(Math.abs(K.x-j.x)<=w&&Math.abs(K.y-j.y)<=w&&!b[re]){b[re]=!0,L.crossTileID=re;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:a})=>a)}}class Bo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ji{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const d=Math.round((a-this.lng)/360);if(d!==0)for(const b in this.indexes){const w=this.indexes[b],I={};for(const L in w){const F=w[L];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+d),I[F.tileID.key]=F}this.indexes[b]=I}this.lng=a}addBucket(a,d,b){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let I=0;I<d.symbolInstances.length;I++)d.symbolInstances.get(I).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});const w=this.usedCrossTileIDs[a.overscaledZ];for(const I in this.indexes){const L=this.indexes[I];if(Number(I)>a.overscaledZ)for(const F in L){const j=L[F];j.tileID.isChildOf(a)&&j.findMatches(d.symbolInstances,a,w)}else{const F=L[a.scaledTo(Number(I)).key];F&&F.findMatches(d.symbolInstances,a,w)}}for(let I=0;I<d.symbolInstances.length;I++){const L=d.symbolInstances.get(I);L.crossTileID||(L.crossTileID=b.generate(),w[L.crossTileID]=!0)}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new hi(a,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(a,d){for(const b of d.getCrossTileIDsLists())for(const w of b)delete this.usedCrossTileIDs[a][w]}removeStaleBuckets(a){let d=!1;for(const b in this.indexes){const w=this.indexes[b];for(const I in w)a[w[I].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,w[I]),delete w[I],d=!0)}return d}}class Qn{constructor(){this.layerIndexes={},this.crossTileIDs=new Bo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,d,b){let w=this.layerIndexes[a.id];w===void 0&&(w=this.layerIndexes[a.id]=new ji);let I=!1;const L={};w.handleWrapJump(b);for(const F of d){const j=F.getBucket(a);j&&a.id===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(F.tileID,j,this.crossTileIDs)&&(I=!0),L[j.bucketInstanceId]=!0)}return w.removeStaleBuckets(L)&&(I=!0),I}pruneUnusedLayers(a){const d={};a.forEach(b=>{d[b]=!0});for(const b in this.layerIndexes)d[b]||delete this.layerIndexes[b]}}const Eo=(x,a)=>u.emitValidationErrors(x,a&&a.filter(d=>d.identifier!=="source.canvas")),Xo=u.pick(u.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Xn=u.pick(u.operations,["setCenter","setZoom","setBearing","setPitch"]),kn=u.emptyStyle();class Ui extends u.Evented{constructor(a,d={}){super(),this.map=a,this.dispatcher=new se(ir(),this,a._getMapId()),this.imageManager=new Oe,this.imageManager.setEventedParent(this),this.glyphManager=new Pe(a._requestManager,d.localIdeographFontFamily),this.lineAtlas=new ye(256,512),this.crossTileSymbolIndex=new Qn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const b=this;this._rtlTextPluginCallback=Ui.registerForPluginStateChange(w=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(I,L)=>{if(u.triggerPluginCompletionEvent(I),L&&L.every(F=>F))for(const F in b.sourceCaches){const j=b.sourceCaches[F].getSource().type;j!=="vector"&&j!=="geojson"||b.sourceCaches[F].reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const I=this.sourceCaches[w.sourceId];if(!I)return;const L=I.getSource();if(L&&L.vectorLayerIds)for(const F in this._layers){const j=this._layers[F];j.source===L.id&&this._validateLayer(j)}})}loadURL(a,d={},b){this.fire(new u.Event("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const w=this.map._requestManager.transformRequest(a,X.Style);this._request=u.getJSON(w,(I,L)=>{this._request=null,I?this.fire(new u.ErrorEvent(I)):L&&this._load(L,d,b)})}loadJSON(a,d={},b){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.browser.frame(()=>{this._request=null,d.validate=d.validate!==!1,this._load(a,d,b)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(kn,{validate:!1})}_load(a,d,b){var w;const I=d.transformStyle?d.transformStyle(b,a):a;if(!d.validate||!Eo(this,u.validateStyle(I))){this._loaded=!0,this.stylesheet=I;for(const L in I.sources)this.addSource(L,I.sources[L],{validate:!1});I.sprite?this._loadSprite(I.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(I.glyphs),this._createLayers(),this.light=new fe(this.stylesheet.light),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}}_createLayers(){const a=u.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",a),this._order=a.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of a){const b=u.createStyleLayer(d);b.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=b}}_loadSprite(a,d=!1,b=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(w,I,L,F){const j=ee(w),Y=j.length,K=L>1?"@2x":"",re={},me={},Me={};for(const{id:Te,url:Fe}of j){const Ce=I.transformRequest(I.normalizeSpriteURL(Fe,K,".json"),X.SpriteJSON),Je=`${Te}_${Ce.url}`;re[Je]=u.getJSON(Ce,(tt,ut)=>{delete re[Je],me[Te]=ut,W(F,me,Me,tt,Y)});const at=I.transformRequest(I.normalizeSpriteURL(Fe,K,".png"),X.SpriteImage),je=`${Te}_${at.url}`;re[je]=q.getImage(at,(tt,ut)=>{delete re[je],Me[Te]=ut,W(F,me,Me,tt,Y)})}return{cancel(){for(const Te of Object.values(re))Te.cancel()}}}(a,this.map._requestManager,this.map.getPixelRatio(),(w,I)=>{if(this._spriteRequest=null,w)this.fire(new u.ErrorEvent(w));else if(I)for(const L in I){this._spritesImagesIds[L]=[];const F=this._spritesImagesIds[L]?this._spritesImagesIds[L].filter(j=>!(j in I)):[];for(const j of F)this.imageManager.removeImage(j),this._changedImages[j]=!0;for(const j in I[L]){const Y=L==="default"?j:`${L}:${j}`;this._spritesImagesIds[L].push(Y),Y in this.imageManager.images?this.imageManager.updateImage(Y,I[L][j],!1):this.imageManager.addImage(Y,I[L][j]),d&&(this._changedImages[Y]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"})),b&&b(w)})}_unloadSprite(){for(const a of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(a),this._changedImages[a]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}_validateLayer(a){const d=this.sourceCaches[a.source];if(!d)return;const b=a.sourceLayer;if(!b)return;const w=d.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(b)===-1)&&this.fire(new u.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${w.id}" as specified by style layer "${a.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(a){const d=this._serializedAllLayers();if(!a||a.length===0)return Object.values(d);const b=[];for(const w of a)d[w]&&b.push(d[w]);return b}_serializedAllLayers(){let a=this._serializedLayers;if(a)return a;a=this._serializedLayers={};const d=Object.keys(this._layers);for(const b of d){const w=this._layers[b];w.type!=="custom"&&(a[b]=w.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(a){if(!this._loaded)return;const d=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),I=Object.keys(this._removedLayers);(w.length||I.length)&&this._updateWorkerLayers(w,I);for(const L in this._updatedSources){const F=this._updatedSources[L];if(F==="reload")this._reloadSource(L);else{if(F!=="clear")throw new Error(`Invalid action ${F}`);this._clearSource(L)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(a);this.light.updateTransitions(a),this._resetUpdates()}const b={};for(const w in this.sourceCaches){const I=this.sourceCaches[w];b[w]=I.used,I.used=!1}for(const w of this._order){const I=this._layers[w];I.recalculate(a,this._availableImages),!I.isHidden(a.zoom)&&I.source&&(this.sourceCaches[I.source].used=!0)}for(const w in b){const I=this.sourceCaches[w];b[w]!==I.used&&I.fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w}))}this.light.recalculate(a),this.z=a.zoom,d&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(a,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(a),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(a,d={}){this._checkLoaded();const b=this.serialize();if(a=d.transformStyle?d.transformStyle(b,a):a,Eo(this,u.validateStyle(a)))return!1;(a=u.clone$1(a)).layers=u.derefLayers(a.layers);const w=u.diffStyles(b,a).filter(L=>!(L.command in Xn));if(w.length===0)return!1;const I=w.filter(L=>!(L.command in Xo));if(I.length>0)throw new Error(`Unimplemented: ${I.map(L=>L.command).join(", ")}.`);for(const L of w)L.command!=="setTransition"&&this[L.command].apply(this,L.args);return this.stylesheet=a,!0}addImage(a,d){if(this.getImage(a))return this.fire(new u.ErrorEvent(new Error(`An image named "${a}" already exists.`)));this.imageManager.addImage(a,d),this._afterImageUpdated(a)}updateImage(a,d){this.imageManager.updateImage(a,d)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){if(!this.getImage(a))return this.fire(new u.ErrorEvent(new Error(`An image named "${a}" does not exist.`)));this.imageManager.removeImage(a),this._afterImageUpdated(a)}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(a,d,b={}){if(this._checkLoaded(),this.sourceCaches[a]!==void 0)throw new Error(`Source "${a}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(u.validateStyle.source,`sources.${a}`,d,null,b))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const w=this.sourceCaches[a]=new ge(a,d,this.dispatcher);w.style=this,w.setEventedParent(this,()=>({isSourceLoaded:w.loaded(),source:w.serialize(),sourceId:a})),w.onAdd(this.map),this._changed=!0}removeSource(a){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===a)return this.fire(new u.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${b}" is using it.`)));const d=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],d.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:a})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(a,d){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error(`There is no source with this ID=${a}`);const b=this.sourceCaches[a].getSource();if(b.type!=="geojson")throw new Error(`geojsonSource.type is ${b.type}, which is !== 'geojson`);b.setData(d),this._changed=!0}getSource(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()}addLayer(a,d,b={}){this._checkLoaded();const w=a.id;if(this.getLayer(w))return void this.fire(new u.ErrorEvent(new Error(`Layer "${w}" already exists on this map.`)));let I;if(a.type==="custom"){if(Eo(this,u.validateCustomStyleLayer(a)))return;I=u.createStyleLayer(a)}else{if("source"in a&&typeof a.source=="object"&&(this.addSource(w,a.source),a=u.clone$1(a),a=u.extend(a,{source:w})),this._validate(u.validateStyle.layer,`layers.${w}`,a,{arrayIndex:-1},b))return;I=u.createStyleLayer(a),this._validateLayer(I),I.setEventedParent(this,{layer:{id:w}})}const L=d?this._order.indexOf(d):this._order.length;if(d&&L===-1)this.fire(new u.ErrorEvent(new Error(`Cannot add layer "${w}" before non-existing layer "${d}".`)));else{if(this._order.splice(L,0,w),this._layerOrderChanged=!0,this._layers[w]=I,this._removedLayers[w]&&I.source&&I.type!=="custom"){const F=this._removedLayers[w];delete this._removedLayers[w],F.type!==I.type?this._updatedSources[I.source]="clear":(this._updatedSources[I.source]="reload",this.sourceCaches[I.source].pause())}this._updateLayer(I),I.onAdd&&I.onAdd(this.map)}}moveLayer(a,d){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new u.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===d)return;const b=this._order.indexOf(a);this._order.splice(b,1);const w=d?this._order.indexOf(d):this._order.length;d&&w===-1?this.fire(new u.ErrorEvent(new Error(`Cannot move layer "${a}" before non-existing layer "${d}".`))):(this._order.splice(w,0,a),this._layerOrderChanged=!0)}removeLayer(a){this._checkLoaded();const d=this._layers[a];if(!d)return void this.fire(new u.ErrorEvent(new Error(`Cannot remove non-existing layer "${a}".`)));d.setEventedParent(null);const b=this._order.indexOf(a);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=d,delete this._layers[a],this._serializedLayers&&delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],d.onRemove&&d.onRemove(this.map)}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}setLayerZoomRange(a,d,b){this._checkLoaded();const w=this.getLayer(a);w?w.minzoom===d&&w.maxzoom===b||(d!=null&&(w.minzoom=d),b!=null&&(w.maxzoom=b),this._updateLayer(w)):this.fire(new u.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${a}".`)))}setFilter(a,d,b={}){this._checkLoaded();const w=this.getLayer(a);if(w){if(!u.deepEqual(w.filter,d))return d==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(u.validateStyle.filter,`layers.${w.id}.filter`,d,null,b)||(w.filter=u.clone$1(d),this._updateLayer(w)))}else this.fire(new u.ErrorEvent(new Error(`Cannot filter non-existing layer "${a}".`)))}getFilter(a){return u.clone$1(this.getLayer(a).filter)}setLayoutProperty(a,d,b,w={}){this._checkLoaded();const I=this.getLayer(a);I?u.deepEqual(I.getLayoutProperty(d),b)||(I.setLayoutProperty(d,b,w),this._updateLayer(I)):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getLayoutProperty(a,d){const b=this.getLayer(a);if(b)return b.getLayoutProperty(d);this.fire(new u.ErrorEvent(new Error(`Cannot get style of non-existing layer "${a}".`)))}setPaintProperty(a,d,b,w={}){this._checkLoaded();const I=this.getLayer(a);I?u.deepEqual(I.getPaintProperty(d),b)||(I.setPaintProperty(d,b,w)&&this._updateLayer(I),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getPaintProperty(a,d){return this.getLayer(a).getPaintProperty(d)}setFeatureState(a,d){this._checkLoaded();const b=a.source,w=a.sourceLayer,I=this.sourceCaches[b];if(I===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const L=I.getSource().type;L==="geojson"&&w?this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):L!=="vector"||w?(a.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),I.setFeatureState(w,a.id,d)):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(a,d){this._checkLoaded();const b=a.source,w=this.sourceCaches[b];if(w===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const I=w.getSource().type,L=I==="vector"?a.sourceLayer:void 0;I!=="vector"||L?d&&typeof a.id!="string"&&typeof a.id!="number"?this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(L,a.id,d):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(a){this._checkLoaded();const d=a.source,b=a.sourceLayer,w=this.sourceCaches[d];if(w!==void 0)return w.getSource().type!=="vector"||b?(a.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(b,a.id)):void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const a=u.mapObject(this.sourceCaches,w=>w.serialize()),d=this._serializeByIds(this._order),b=this.stylesheet;return u.filterObject({version:b.version,name:b.name,metadata:b.metadata,light:b.light,center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,sprite:b.sprite,glyphs:b.glyphs,transition:b.transition,sources:a,layers:d},w=>w!==void 0)}_updateLayer(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&this.sourceCaches[a.source].getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(a){const d=L=>this._layers[L].type==="fill-extrusion",b={},w=[];for(let L=this._order.length-1;L>=0;L--){const F=this._order[L];if(d(F)){b[F]=L;for(const j of a){const Y=j[F];if(Y)for(const K of Y)w.push(K)}}}w.sort((L,F)=>F.intersectionZ-L.intersectionZ);const I=[];for(let L=this._order.length-1;L>=0;L--){const F=this._order[L];if(d(F))for(let j=w.length-1;j>=0;j--){const Y=w[j].feature;if(b[Y.layer.id]<L)break;I.push(Y),w.pop()}else for(const j of a){const Y=j[F];if(Y)for(const K of Y)I.push(K.feature)}}return I}queryRenderedFeatures(a,d,b){d&&d.filter&&this._validate(u.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);const w={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of d.layers){const j=this._layers[F];if(!j)return this.fire(new u.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];w[j.source]=!0}}const I=[];d.availableImages=this._availableImages;const L=this._serializedAllLayers();for(const F in this.sourceCaches)d.layers&&!w[F]||I.push(yr(this.sourceCaches[F],this._layers,L,a,d,b));return this.placement&&I.push(function(F,j,Y,K,re,me,Me){const Te={},Fe=me.queryRenderedSymbols(K),Ce=[];for(const Je of Object.keys(Fe).map(Number))Ce.push(Me[Je]);Ce.sort(nn);for(const Je of Ce){const at=Je.featureIndex.lookupSymbolFeatures(Fe[Je.bucketInstanceId],j,Je.bucketIndex,Je.sourceLayerIndex,re.filter,re.layers,re.availableImages,F);for(const je in at){const tt=Te[je]=Te[je]||[],ut=at[je];ut.sort((lt,bt)=>{const St=Je.featureSortOrder;if(St){const wt=St.indexOf(lt.featureIndex);return St.indexOf(bt.featureIndex)-wt}return bt.featureIndex-lt.featureIndex});for(const lt of ut)tt.push(lt)}}for(const Je in Te)Te[Je].forEach(at=>{const je=at.feature,tt=Y[F[Je].source].getFeatureState(je.layer["source-layer"],je.id);je.source=je.layer.source,je.layer["source-layer"]&&(je.sourceLayer=je.layer["source-layer"]),je.state=tt});return Te}(this._layers,L,this.sourceCaches,a,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(I)}querySourceFeatures(a,d){d&&d.filter&&this._validate(u.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);const b=this.sourceCaches[a];return b?function(w,I){const L=w.getRenderableIds().map(Y=>w.getTileByID(Y)),F=[],j={};for(let Y=0;Y<L.length;Y++){const K=L[Y],re=K.tileID.canonical.key;j[re]||(j[re]=!0,K.querySourceFeatures(F,I))}return F}(b,d):[]}addSourceType(a,d,b){return hr(a)?b(new Error(`A source type called "${a}" already exists.`)):(((w,I)=>{Zt[w]=I})(a,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:d.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(a,d={}){this._checkLoaded();const b=this.light.getLight();let w=!1;for(const L in a)if(!u.deepEqual(a[L],b[L])){w=!0;break}if(!w)return;const I={now:u.browser.now(),transition:u.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(a,d),this.light.updateTransitions(I)}_validate(a,d,b,w,I={}){return(!I||I.validate!==!1)&&Eo(this,a.call(u.validateStyle,u.extend({key:d,style:this.serialize(),value:b,styleSpec:u.v8Spec},w)))}_remove(a=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const b=this.sourceCaches[d];b.setEventedParent(null),b.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(a)}_clearSource(a){this.sourceCaches[a].clearTiles()}_reloadSource(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()}_updateSources(a){for(const d in this.sourceCaches)this.sourceCaches[d].update(a,this.map.terrain)}_generateCollisionBoxes(){for(const a in this.sourceCaches)this._reloadSource(a)}_updatePlacement(a,d,b,w,I=!1){let L=!1,F=!1;const j={};for(const Y of this._order){const K=this._layers[Y];if(K.type!=="symbol")continue;if(!j[K.source]){const me=this.sourceCaches[K.source];j[K.source]=me.getRenderableIds(!0).map(Me=>me.getTileByID(Me)).sort((Me,Te)=>Te.tileID.overscaledZ-Me.tileID.overscaledZ||(Me.tileID.isLessThan(Te.tileID)?-1:1))}const re=this.crossTileSymbolIndex.addLayer(K,j[K.source],a.center.lng);L=L||re}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((I=I||this._layerOrderChanged||b===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.browser.now(),a.zoom))&&(this.pauseablePlacement=new ii(a,this.map.terrain,this._order,I,d,b,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,j),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.browser.now()),F=!0),L&&this.pauseablePlacement.placement.setStale()),F||L)for(const Y of this._order){const K=this._layers[Y];K.type==="symbol"&&this.placement.updateLayerOpacities(K,j[K.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.browser.now())}_releaseSymbolFadeTiles(){for(const a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,d,b){this.imageManager.getImages(d.icons,b),this._updateTilesForChangedImages();const w=this.sourceCaches[d.source];w&&w.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(a,d,b){this.glyphManager.getGlyphs(d.stacks,b);const w=this.sourceCaches[d.source];w&&w.setDependencies(d.tileID.key,d.type,[""])}getResource(a,d,b){return u.makeRequest(d,b)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(a,d={}){this._checkLoaded(),a&&this._validate(u.validateStyle.glyphs,"glyphs",a,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=a,this.glyphManager.entries={},this.glyphManager.setURL(a))}addSprite(a,d,b={},w){this._checkLoaded();const I=[{id:a,url:d}],L=[...ee(this.stylesheet.sprite),...I];this._validate(u.validateStyle.sprite,"sprite",L,null,b)||(this.stylesheet.sprite=L,this._loadSprite(I,!0,w))}removeSprite(a){this._checkLoaded();const d=ee(this.stylesheet.sprite);if(d.find(b=>b.id===a)){if(this._spritesImagesIds[a])for(const b of this._spritesImagesIds[a])this.imageManager.removeImage(b),this._changedImages[b]=!0;d.splice(d.findIndex(b=>b.id===a),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[a],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}else this.fire(new u.ErrorEvent(new Error(`Sprite "${a}" doesn't exists on this map.`)))}getSprite(){return ee(this.stylesheet.sprite)}setSprite(a,d={},b){this._checkLoaded(),a&&this._validate(u.validateStyle.sprite,"sprite",a,null,d)||(this.stylesheet.sprite=a,a?this._loadSprite(a,!0,b):(this._unloadSprite(),b&&b(null)))}}Ui.registerForPluginStateChange=u.registerForPluginStateChange;var mo=u.createLayout([{name:"a_pos",type:"Int16",components:2}]),zo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Ls={prelude:er(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:er(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:er(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:er(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:er("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:er(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:er("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:er("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:er("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:er(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:er(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:er(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:er(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:er(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:er(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:er(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:er(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:er("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",zo),terrainDepth:er("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",zo),terrainCoords:er("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",zo)};function er(x,a){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=a.match(/attribute ([\w]+) ([\w]+)/g),w=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),I=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=I?I.concat(w):w,F={};return{fragmentSource:x=x.replace(d,(j,Y,K,re,me)=>(F[me]=!0,Y==="define"?`
#ifndef HAS_UNIFORM_u_${me}
varying ${K} ${re} ${me};
#else
uniform ${K} ${re} u_${me};
#endif
`:`
#ifdef HAS_UNIFORM_u_${me}
    ${K} ${re} ${me} = u_${me};
#endif
`)),vertexSource:a=a.replace(d,(j,Y,K,re,me)=>{const Me=re==="float"?"vec2":"vec4",Te=me.match(/color/)?"color":Me;return F[me]?Y==="define"?`
#ifndef HAS_UNIFORM_u_${me}
uniform lowp float u_${me}_t;
attribute ${K} ${Me} a_${me};
varying ${K} ${re} ${me};
#else
uniform ${K} ${re} u_${me};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${me}
    ${me} = a_${me};
#else
    ${K} ${re} ${me} = u_${me};
#endif
`:`
#ifndef HAS_UNIFORM_u_${me}
    ${me} = unpack_mix_${Te}(a_${me}, u_${me}_t);
#else
    ${K} ${re} ${me} = u_${me};
#endif
`:Y==="define"?`
#ifndef HAS_UNIFORM_u_${me}
uniform lowp float u_${me}_t;
attribute ${K} ${Me} a_${me};
#else
uniform ${K} ${re} u_${me};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${me}
    ${K} ${re} ${me} = a_${me};
#else
    ${K} ${re} ${me} = u_${me};
#endif
`:`
#ifndef HAS_UNIFORM_u_${me}
    ${K} ${re} ${me} = unpack_mix_${Te}(a_${me}, u_${me}_t);
#else
    ${K} ${re} ${me} = u_${me};
#endif
`}),staticAttributes:b,staticUniforms:L}}class Rs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(a,d,b,w,I,L,F,j,Y){this.context=a;let K=this.boundPaintVertexBuffers.length!==w.length;for(let re=0;!K&&re<w.length;re++)this.boundPaintVertexBuffers[re]!==w[re]&&(K=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==b||K||this.boundIndexBuffer!==I||this.boundVertexOffset!==L||this.boundDynamicVertexBuffer!==F||this.boundDynamicVertexBuffer2!==j||this.boundDynamicVertexBuffer3!==Y?this.freshBind(d,b,w,I,L,F,j,Y):(a.bindVertexArray.set(this.vao),F&&F.bind(),I&&I.dynamicDraw&&I.bind(),j&&j.bind(),Y&&Y.bind())}freshBind(a,d,b,w,I,L,F,j){const Y=a.numAttributes,K=this.context,re=K.gl;this.vao&&this.destroy(),this.vao=K.createVertexArray(),K.bindVertexArray.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=w,this.boundVertexOffset=I,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=F,this.boundDynamicVertexBuffer3=j,d.enableAttributes(re,a);for(const me of b)me.enableAttributes(re,a);L&&L.enableAttributes(re,a),F&&F.enableAttributes(re,a),j&&j.enableAttributes(re,a),d.bind(),d.setVertexAttribPointers(re,a,I);for(const me of b)me.bind(),me.setVertexAttribPointers(re,a,I);L&&(L.bind(),L.setVertexAttribPointers(re,a,I)),w&&w.bind(),F&&(F.bind(),F.setVertexAttribPointers(re,a,I)),j&&(j.bind(),j.setVertexAttribPointers(re,a,I)),K.currentNumAttributes=Y}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function $i(x){const a=[];for(let d=0;d<x.length;d++){if(x[d]===null)continue;const b=x[d].split(" ");a.push(b.pop())}return a}class ha{constructor(a,d,b,w,I,L){const F=a.gl;this.program=F.createProgram();const j=$i(d.staticAttributes),Y=b?b.getBinderAttributes():[],K=j.concat(Y),re=Ls.prelude.staticUniforms?$i(Ls.prelude.staticUniforms):[],me=d.staticUniforms?$i(d.staticUniforms):[],Me=b?b.getBinderUniforms():[],Te=re.concat(me).concat(Me),Fe=[];for(const lt of Te)Fe.indexOf(lt)<0&&Fe.push(lt);const Ce=b?b.defines():[];I&&Ce.push("#define OVERDRAW_INSPECTOR;"),L&&Ce.push("#define TERRAIN3D;");const Je=Ce.concat(Ls.prelude.fragmentSource,d.fragmentSource).join(`
`),at=Ce.concat(Ls.prelude.vertexSource,d.vertexSource).join(`
`),je=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(je,Je),F.compileShader(je),!F.getShaderParameter(je,F.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${F.getShaderInfoLog(je)}`);F.attachShader(this.program,je);const tt=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(tt,at),F.compileShader(tt),!F.getShaderParameter(tt,F.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${F.getShaderInfoLog(tt)}`);F.attachShader(this.program,tt),this.attributes={};const ut={};this.numAttributes=K.length;for(let lt=0;lt<this.numAttributes;lt++)K[lt]&&(F.bindAttribLocation(this.program,lt,K[lt]),this.attributes[K[lt]]=lt);if(F.linkProgram(this.program),!F.getProgramParameter(this.program,F.LINK_STATUS))throw new Error(`Program failed to link: ${F.getProgramInfoLog(this.program)}`);F.deleteShader(tt),F.deleteShader(je);for(let lt=0;lt<Fe.length;lt++){const bt=Fe[lt];if(bt&&!ut[bt]){const St=F.getUniformLocation(this.program,bt);St&&(ut[bt]=St)}}this.fixedUniforms=w(a,ut),this.terrainUniforms=((lt,bt)=>({u_depth:new u.Uniform1i(lt,bt.u_depth),u_terrain:new u.Uniform1i(lt,bt.u_terrain),u_terrain_dim:new u.Uniform1f(lt,bt.u_terrain_dim),u_terrain_matrix:new u.UniformMatrix4f(lt,bt.u_terrain_matrix),u_terrain_unpack:new u.Uniform4f(lt,bt.u_terrain_unpack),u_terrain_exaggeration:new u.Uniform1f(lt,bt.u_terrain_exaggeration)}))(a,ut),this.binderUniforms=b?b.getUniforms(a,ut):[]}draw(a,d,b,w,I,L,F,j,Y,K,re,me,Me,Te,Fe,Ce,Je,at){const je=a.gl;if(this.failedToCreate)return;if(a.program.set(this.program),a.setDepthMode(b),a.setStencilMode(w),a.setColorMode(I),a.setCullFace(L),j){a.activeTexture.set(je.TEXTURE2),je.bindTexture(je.TEXTURE_2D,j.depthTexture),a.activeTexture.set(je.TEXTURE3),je.bindTexture(je.TEXTURE_2D,j.texture);for(const ut in this.terrainUniforms)this.terrainUniforms[ut].set(j[ut])}for(const ut in this.fixedUniforms)this.fixedUniforms[ut].set(F[ut]);Fe&&Fe.setUniforms(a,this.binderUniforms,Me,{zoom:Te});let tt=0;switch(d){case je.LINES:tt=2;break;case je.TRIANGLES:tt=3;break;case je.LINE_STRIP:tt=1}for(const ut of me.get()){const lt=ut.vaos||(ut.vaos={});(lt[Y]||(lt[Y]=new Rs)).bind(a,this,K,Fe?Fe.getPaintVertexBuffers():[],re,ut.vertexOffset,Ce,Je,at),je.drawElements(d,ut.primitiveLength*tt,je.UNSIGNED_SHORT,ut.primitiveOffset*tt*2)}}}function Rr(x,a,d){const b=1/Ve(d,1,a.transform.tileZoom),w=Math.pow(2,d.tileID.overscaledZ),I=d.tileSize*Math.pow(2,a.transform.tileZoom)/w,L=I*(d.tileID.canonical.x+d.tileID.wrap*w),F=I*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[b,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[L>>16,F>>16],u_pixel_coord_lower:[65535&L,65535&F]}}const Ds=(x,a,d,b)=>{const w=a.style.light,I=w.properties.get("position"),L=[I.x,I.y,I.z],F=function(){var Y=new u.ARRAY_TYPE(9);return u.ARRAY_TYPE!=Float32Array&&(Y[1]=0,Y[2]=0,Y[3]=0,Y[5]=0,Y[6]=0,Y[7]=0),Y[0]=1,Y[4]=1,Y[8]=1,Y}();w.properties.get("anchor")==="viewport"&&function(Y,K){var re=Math.sin(K),me=Math.cos(K);Y[0]=me,Y[1]=re,Y[2]=0,Y[3]=-re,Y[4]=me,Y[5]=0,Y[6]=0,Y[7]=0,Y[8]=1}(F,-a.transform.angle),function(Y,K,re){var me=K[0],Me=K[1],Te=K[2];Y[0]=me*re[0]+Me*re[3]+Te*re[6],Y[1]=me*re[1]+Me*re[4]+Te*re[7],Y[2]=me*re[2]+Me*re[5]+Te*re[8]}(L,L,F);const j=w.properties.get("color");return{u_matrix:x,u_lightpos:L,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+d,u_opacity:b}},Il=(x,a,d,b,w,I,L)=>u.extend(Ds(x,a,d,b),Rr(I,a,L),{u_height_factor:-Math.pow(2,w.overscaledZ)/L.tileSize/8}),Ws=x=>({u_matrix:x}),Hi=(x,a,d,b)=>u.extend(Ws(x),Rr(d,a,b)),Yo=(x,a)=>({u_matrix:x,u_world:a}),Zs=(x,a,d,b,w)=>u.extend(Hi(x,a,d,b),{u_world:w}),Qu=(x,a,d,b)=>{const w=x.transform;let I,L;if(b.paint.get("circle-pitch-alignment")==="map"){const F=Ve(d,1,w.zoom);I=!0,L=[F,F]}else I=!1,L=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(b.paint.get("circle-pitch-scale")==="map"),u_matrix:x.translatePosMatrix(a.posMatrix,d,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_pitch_with_map:+I,u_device_pixel_ratio:x.pixelRatio,u_extrude_scale:L}},Pt=(x,a,d)=>{const b=Ve(d,1,a.zoom),w=Math.pow(2,a.zoom-d.tileID.overscaledZ),I=d.tileID.overscaleFactor();return{u_matrix:x,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:b,u_extrude_scale:[a.pixelsToGLUnits[0]/(b*w),a.pixelsToGLUnits[1]/(b*w)],u_overscale_factor:I}},Hs=(x,a,d=1)=>({u_matrix:x,u_color:a,u_overlay:0,u_overlay_scale:d}),io=x=>({u_matrix:x}),Wo=(x,a,d,b)=>({u_matrix:x,u_extrude_scale:Ve(a,1,d),u_intensity:b});function Js(x,a){const d=Math.pow(2,a.canonical.z),b=a.canonical.y;return[new u.MercatorCoordinate(0,b/d).toLngLat().lat,new u.MercatorCoordinate(0,(b+1)/d).toLngLat().lat]}const fi=(x,a,d,b)=>{const w=x.transform;return{u_matrix:Ks(x,a,d,b),u_ratio:1/Ve(a,1,w.zoom),u_device_pixel_ratio:x.pixelRatio,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},an=(x,a,d,b,w)=>u.extend(fi(x,a,d,w),{u_image:0,u_image_height:b}),Xr=(x,a,d,b,w)=>{const I=x.transform,L=So(a,I);return{u_matrix:Ks(x,a,d,w),u_texsize:a.imageAtlasTexture.size,u_ratio:1/Ve(a,1,I.zoom),u_device_pixel_ratio:x.pixelRatio,u_image:0,u_scale:[L,b.fromScale,b.toScale],u_fade:b.t,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]]}},Bn=(x,a,d,b,w,I)=>{const L=x.lineAtlas,F=So(a,x.transform),j=d.layout.get("line-cap")==="round",Y=L.getDash(b.from,j),K=L.getDash(b.to,j),re=Y.width*w.fromScale,me=K.width*w.toScale;return u.extend(fi(x,a,d,I),{u_patternscale_a:[F/re,-Y.height/2],u_patternscale_b:[F/me,-K.height/2],u_sdfgamma:L.width/(256*Math.min(re,me)*x.pixelRatio)/2,u_image:0,u_tex_y_a:Y.y,u_tex_y_b:K.y,u_mix:w.t})};function So(x,a){return 1/Ve(x,1,a.tileZoom)}function Ks(x,a,d,b){return x.translatePosMatrix(b?b.posMatrix:a.tileID.posMatrix,a,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const Ci=(x,a,d,b,w)=>{return{u_matrix:x,u_tl_parent:a,u_scale_parent:d,u_buffer_scale:1,u_fade_t:b.mix,u_opacity:b.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(L=w.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(I=w.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:Ua(w.paint.get("raster-hue-rotate"))};var I,L};function Ua(x){x*=Math.PI/180;const a=Math.sin(x),d=Math.cos(x);return[(2*d+1)/3,(-Math.sqrt(3)*a-d+1)/3,(Math.sqrt(3)*a-d+1)/3]}const Ji=(x,a,d,b,w,I,L,F,j,Y)=>{const K=w.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:K.width/K.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:L,u_coord_matrix:F,u_is_text:+j,u_pitch_with_map:+b,u_texsize:Y,u_texture:0}},Zr=(x,a,d,b,w,I,L,F,j,Y,K)=>{const re=w.transform;return u.extend(Ji(x,a,d,b,w,I,L,F,j,Y),{u_gamma_scale:b?Math.cos(re._pitch)*re.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+K})},Oa=(x,a,d,b,w,I,L,F,j,Y)=>u.extend(Zr(x,a,d,b,w,I,L,F,!0,j,!0),{u_texsize_icon:Y,u_texture_icon:1}),Yn=(x,a,d)=>({u_matrix:x,u_opacity:a,u_color:d}),Ns=(x,a,d,b,w,I)=>u.extend(function(L,F,j,Y){const K=j.imageManager.getPattern(L.from.toString()),re=j.imageManager.getPattern(L.to.toString()),{width:me,height:Me}=j.imageManager.getPixelSize(),Te=Math.pow(2,Y.tileID.overscaledZ),Fe=Y.tileSize*Math.pow(2,j.transform.tileZoom)/Te,Ce=Fe*(Y.tileID.canonical.x+Y.tileID.wrap*Te),Je=Fe*Y.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:K.tl,u_pattern_br_a:K.br,u_pattern_tl_b:re.tl,u_pattern_br_b:re.br,u_texsize:[me,Me],u_mix:F.t,u_pattern_size_a:K.displaySize,u_pattern_size_b:re.displaySize,u_scale_a:F.fromScale,u_scale_b:F.toScale,u_tile_units_to_pixels:1/Ve(Y,1,j.transform.tileZoom),u_pixel_coord_upper:[Ce>>16,Je>>16],u_pixel_coord_lower:[65535&Ce,65535&Je]}}(b,I,d,w),{u_matrix:x,u_opacity:a}),Ti={fillExtrusion:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_lightpos:new u.Uniform3f(x,a.u_lightpos),u_lightintensity:new u.Uniform1f(x,a.u_lightintensity),u_lightcolor:new u.Uniform3f(x,a.u_lightcolor),u_vertical_gradient:new u.Uniform1f(x,a.u_vertical_gradient),u_opacity:new u.Uniform1f(x,a.u_opacity)}),fillExtrusionPattern:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_lightpos:new u.Uniform3f(x,a.u_lightpos),u_lightintensity:new u.Uniform1f(x,a.u_lightintensity),u_lightcolor:new u.Uniform3f(x,a.u_lightcolor),u_vertical_gradient:new u.Uniform1f(x,a.u_vertical_gradient),u_height_factor:new u.Uniform1f(x,a.u_height_factor),u_image:new u.Uniform1i(x,a.u_image),u_texsize:new u.Uniform2f(x,a.u_texsize),u_pixel_coord_upper:new u.Uniform2f(x,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(x,a.u_pixel_coord_lower),u_scale:new u.Uniform3f(x,a.u_scale),u_fade:new u.Uniform1f(x,a.u_fade),u_opacity:new u.Uniform1f(x,a.u_opacity)}),fill:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix)}),fillPattern:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_image:new u.Uniform1i(x,a.u_image),u_texsize:new u.Uniform2f(x,a.u_texsize),u_pixel_coord_upper:new u.Uniform2f(x,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(x,a.u_pixel_coord_lower),u_scale:new u.Uniform3f(x,a.u_scale),u_fade:new u.Uniform1f(x,a.u_fade)}),fillOutline:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_world:new u.Uniform2f(x,a.u_world)}),fillOutlinePattern:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_world:new u.Uniform2f(x,a.u_world),u_image:new u.Uniform1i(x,a.u_image),u_texsize:new u.Uniform2f(x,a.u_texsize),u_pixel_coord_upper:new u.Uniform2f(x,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(x,a.u_pixel_coord_lower),u_scale:new u.Uniform3f(x,a.u_scale),u_fade:new u.Uniform1f(x,a.u_fade)}),circle:(x,a)=>({u_camera_to_center_distance:new u.Uniform1f(x,a.u_camera_to_center_distance),u_scale_with_map:new u.Uniform1i(x,a.u_scale_with_map),u_pitch_with_map:new u.Uniform1i(x,a.u_pitch_with_map),u_extrude_scale:new u.Uniform2f(x,a.u_extrude_scale),u_device_pixel_ratio:new u.Uniform1f(x,a.u_device_pixel_ratio),u_matrix:new u.UniformMatrix4f(x,a.u_matrix)}),collisionBox:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_camera_to_center_distance:new u.Uniform1f(x,a.u_camera_to_center_distance),u_pixels_to_tile_units:new u.Uniform1f(x,a.u_pixels_to_tile_units),u_extrude_scale:new u.Uniform2f(x,a.u_extrude_scale),u_overscale_factor:new u.Uniform1f(x,a.u_overscale_factor)}),collisionCircle:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_inv_matrix:new u.UniformMatrix4f(x,a.u_inv_matrix),u_camera_to_center_distance:new u.Uniform1f(x,a.u_camera_to_center_distance),u_viewport_size:new u.Uniform2f(x,a.u_viewport_size)}),debug:(x,a)=>({u_color:new u.UniformColor(x,a.u_color),u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_overlay:new u.Uniform1i(x,a.u_overlay),u_overlay_scale:new u.Uniform1f(x,a.u_overlay_scale)}),clippingMask:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix)}),heatmap:(x,a)=>({u_extrude_scale:new u.Uniform1f(x,a.u_extrude_scale),u_intensity:new u.Uniform1f(x,a.u_intensity),u_matrix:new u.UniformMatrix4f(x,a.u_matrix)}),heatmapTexture:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_world:new u.Uniform2f(x,a.u_world),u_image:new u.Uniform1i(x,a.u_image),u_color_ramp:new u.Uniform1i(x,a.u_color_ramp),u_opacity:new u.Uniform1f(x,a.u_opacity)}),hillshade:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_image:new u.Uniform1i(x,a.u_image),u_latrange:new u.Uniform2f(x,a.u_latrange),u_light:new u.Uniform2f(x,a.u_light),u_shadow:new u.UniformColor(x,a.u_shadow),u_highlight:new u.UniformColor(x,a.u_highlight),u_accent:new u.UniformColor(x,a.u_accent)}),hillshadePrepare:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_image:new u.Uniform1i(x,a.u_image),u_dimension:new u.Uniform2f(x,a.u_dimension),u_zoom:new u.Uniform1f(x,a.u_zoom),u_unpack:new u.Uniform4f(x,a.u_unpack)}),line:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_ratio:new u.Uniform1f(x,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(x,a.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(x,a.u_units_to_pixels)}),lineGradient:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_ratio:new u.Uniform1f(x,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(x,a.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(x,a.u_units_to_pixels),u_image:new u.Uniform1i(x,a.u_image),u_image_height:new u.Uniform1f(x,a.u_image_height)}),linePattern:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_texsize:new u.Uniform2f(x,a.u_texsize),u_ratio:new u.Uniform1f(x,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(x,a.u_device_pixel_ratio),u_image:new u.Uniform1i(x,a.u_image),u_units_to_pixels:new u.Uniform2f(x,a.u_units_to_pixels),u_scale:new u.Uniform3f(x,a.u_scale),u_fade:new u.Uniform1f(x,a.u_fade)}),lineSDF:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_ratio:new u.Uniform1f(x,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(x,a.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(x,a.u_units_to_pixels),u_patternscale_a:new u.Uniform2f(x,a.u_patternscale_a),u_patternscale_b:new u.Uniform2f(x,a.u_patternscale_b),u_sdfgamma:new u.Uniform1f(x,a.u_sdfgamma),u_image:new u.Uniform1i(x,a.u_image),u_tex_y_a:new u.Uniform1f(x,a.u_tex_y_a),u_tex_y_b:new u.Uniform1f(x,a.u_tex_y_b),u_mix:new u.Uniform1f(x,a.u_mix)}),raster:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_tl_parent:new u.Uniform2f(x,a.u_tl_parent),u_scale_parent:new u.Uniform1f(x,a.u_scale_parent),u_buffer_scale:new u.Uniform1f(x,a.u_buffer_scale),u_fade_t:new u.Uniform1f(x,a.u_fade_t),u_opacity:new u.Uniform1f(x,a.u_opacity),u_image0:new u.Uniform1i(x,a.u_image0),u_image1:new u.Uniform1i(x,a.u_image1),u_brightness_low:new u.Uniform1f(x,a.u_brightness_low),u_brightness_high:new u.Uniform1f(x,a.u_brightness_high),u_saturation_factor:new u.Uniform1f(x,a.u_saturation_factor),u_contrast_factor:new u.Uniform1f(x,a.u_contrast_factor),u_spin_weights:new u.Uniform3f(x,a.u_spin_weights)}),symbolIcon:(x,a)=>({u_is_size_zoom_constant:new u.Uniform1i(x,a.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(x,a.u_is_size_feature_constant),u_size_t:new u.Uniform1f(x,a.u_size_t),u_size:new u.Uniform1f(x,a.u_size),u_camera_to_center_distance:new u.Uniform1f(x,a.u_camera_to_center_distance),u_pitch:new u.Uniform1f(x,a.u_pitch),u_rotate_symbol:new u.Uniform1i(x,a.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(x,a.u_aspect_ratio),u_fade_change:new u.Uniform1f(x,a.u_fade_change),u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(x,a.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(x,a.u_coord_matrix),u_is_text:new u.Uniform1i(x,a.u_is_text),u_pitch_with_map:new u.Uniform1i(x,a.u_pitch_with_map),u_texsize:new u.Uniform2f(x,a.u_texsize),u_texture:new u.Uniform1i(x,a.u_texture)}),symbolSDF:(x,a)=>({u_is_size_zoom_constant:new u.Uniform1i(x,a.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(x,a.u_is_size_feature_constant),u_size_t:new u.Uniform1f(x,a.u_size_t),u_size:new u.Uniform1f(x,a.u_size),u_camera_to_center_distance:new u.Uniform1f(x,a.u_camera_to_center_distance),u_pitch:new u.Uniform1f(x,a.u_pitch),u_rotate_symbol:new u.Uniform1i(x,a.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(x,a.u_aspect_ratio),u_fade_change:new u.Uniform1f(x,a.u_fade_change),u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(x,a.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(x,a.u_coord_matrix),u_is_text:new u.Uniform1i(x,a.u_is_text),u_pitch_with_map:new u.Uniform1i(x,a.u_pitch_with_map),u_texsize:new u.Uniform2f(x,a.u_texsize),u_texture:new u.Uniform1i(x,a.u_texture),u_gamma_scale:new u.Uniform1f(x,a.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(x,a.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(x,a.u_is_halo)}),symbolTextAndIcon:(x,a)=>({u_is_size_zoom_constant:new u.Uniform1i(x,a.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(x,a.u_is_size_feature_constant),u_size_t:new u.Uniform1f(x,a.u_size_t),u_size:new u.Uniform1f(x,a.u_size),u_camera_to_center_distance:new u.Uniform1f(x,a.u_camera_to_center_distance),u_pitch:new u.Uniform1f(x,a.u_pitch),u_rotate_symbol:new u.Uniform1i(x,a.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(x,a.u_aspect_ratio),u_fade_change:new u.Uniform1f(x,a.u_fade_change),u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(x,a.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(x,a.u_coord_matrix),u_is_text:new u.Uniform1i(x,a.u_is_text),u_pitch_with_map:new u.Uniform1i(x,a.u_pitch_with_map),u_texsize:new u.Uniform2f(x,a.u_texsize),u_texsize_icon:new u.Uniform2f(x,a.u_texsize_icon),u_texture:new u.Uniform1i(x,a.u_texture),u_texture_icon:new u.Uniform1i(x,a.u_texture_icon),u_gamma_scale:new u.Uniform1f(x,a.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(x,a.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(x,a.u_is_halo)}),background:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_opacity:new u.Uniform1f(x,a.u_opacity),u_color:new u.UniformColor(x,a.u_color)}),backgroundPattern:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_opacity:new u.Uniform1f(x,a.u_opacity),u_image:new u.Uniform1i(x,a.u_image),u_pattern_tl_a:new u.Uniform2f(x,a.u_pattern_tl_a),u_pattern_br_a:new u.Uniform2f(x,a.u_pattern_br_a),u_pattern_tl_b:new u.Uniform2f(x,a.u_pattern_tl_b),u_pattern_br_b:new u.Uniform2f(x,a.u_pattern_br_b),u_texsize:new u.Uniform2f(x,a.u_texsize),u_mix:new u.Uniform1f(x,a.u_mix),u_pattern_size_a:new u.Uniform2f(x,a.u_pattern_size_a),u_pattern_size_b:new u.Uniform2f(x,a.u_pattern_size_b),u_scale_a:new u.Uniform1f(x,a.u_scale_a),u_scale_b:new u.Uniform1f(x,a.u_scale_b),u_pixel_coord_upper:new u.Uniform2f(x,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(x,a.u_pixel_coord_lower),u_tile_units_to_pixels:new u.Uniform1f(x,a.u_tile_units_to_pixels)}),terrain:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_texture:new u.Uniform1i(x,a.u_texture),u_ele_delta:new u.Uniform1f(x,a.u_ele_delta)}),terrainDepth:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_ele_delta:new u.Uniform1f(x,a.u_ele_delta)}),terrainCoords:(x,a)=>({u_matrix:new u.UniformMatrix4f(x,a.u_matrix),u_texture:new u.Uniform1i(x,a.u_texture),u_terrain_coords_id:new u.Uniform1f(x,a.u_terrain_coords_id),u_ele_delta:new u.Uniform1f(x,a.u_ele_delta)})};class Yr{constructor(a,d,b){this.context=a;const w=a.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Mi={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fa{constructor(a,d,b,w){this.length=d.length,this.attributes=b,this.itemSize=d.bytesPerElement,this.dynamicDraw=w,this.context=a;const I=a.gl;this.buffer=I.createBuffer(),a.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){if(a.length!==this.length)throw new Error(`Length of new data is ${a.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,d){for(let b=0;b<this.attributes.length;b++){const w=d.attributes[this.attributes[b].name];w!==void 0&&a.enableVertexAttribArray(w)}}setVertexAttribPointers(a,d,b){for(let w=0;w<this.attributes.length;w++){const I=this.attributes[w],L=d.attributes[I.name];L!==void 0&&a.vertexAttribPointer(L,I.components,a[Mi[I.type]],!1,this.itemSize,I.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const wi=new WeakMap;function oo(x){if(wi.has(x))return wi.get(x);{const a=x.getParameter(x.VERSION).startsWith("WebGL 2.0");return wi.set(x,a),a}}class Gr{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class pa extends Gr{getDefault(){return u.Color.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Wn extends Gr{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class bu extends Gr{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class Ki extends Gr{getDefault(){return[!0,!0,!0,!0]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Zn extends Gr{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class pi extends Gr{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class Ca extends Gr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const d=this.current;(a.func!==d.func||a.ref!==d.ref||a.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Ol extends Gr{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class Fs extends Gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=a,this.dirty=!1}}class el extends Gr{getDefault(){return[0,1]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class ds extends Gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=a,this.dirty=!1}}class di extends Gr{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class Gi extends Gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.BLEND):d.disable(d.BLEND),this.current=a,this.dirty=!1}}class qn extends Gr{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class $a extends Gr{getDefault(){return u.Color.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Zo extends Gr{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class Qs extends Gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=a,this.dirty=!1}}class zn extends Gr{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class or extends Gr{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}class Cl extends Gr{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}}class eu extends Gr{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class _i extends Gr{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Ho extends Gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class Jo extends Gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class Ga extends Gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class tl extends Gr{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class rl extends Gr{getDefault(){return null}set(a){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class tr extends Gr{getDefault(){return null}set(a){var d;if(a===this.current&&!this.dirty)return;const b=this.gl;oo(b)?b.bindVertexArray(a):(d=b.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(a),this.current=a,this.dirty=!1}}class Ko extends Gr{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class ei extends Gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class xu extends Gr{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class Ei extends Gr{constructor(a,d){super(a),this.context=a,this.parent=d}getDefault(){return null}}class nc extends Ei{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class Wr extends Ei{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class ks extends Ei{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class Un{constructor(a,d,b,w,I){this.context=a,this.width=d,this.height=b;const L=a.gl,F=this.framebuffer=L.createFramebuffer();if(this.colorAttachment=new nc(a,F),w)this.depthAttachment=I?new ks(a,F):new Wr(a,F);else if(I)throw new Error("Stencil cannot be setted without depth");if(L.checkFramebufferStatus(L.FRAMEBUFFER)!==L.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const a=this.context.gl,d=this.colorAttachment.get();if(d&&a.deleteTexture(d),this.depthAttachment){const b=this.depthAttachment.get();b&&a.deleteRenderbuffer(b)}a.deleteFramebuffer(this.framebuffer)}}class Hn{constructor(a,d,b){this.blendFunction=a,this.blendColor=d,this.mask=b}}Hn.Replace=[1,0],Hn.disabled=new Hn(Hn.Replace,u.Color.transparent,[!1,!1,!1,!1]),Hn.unblended=new Hn(Hn.Replace,u.Color.transparent,[!0,!0,!0,!0]),Hn.alphaBlended=new Hn([1,771],u.Color.transparent,[!0,!0,!0,!0]);class Li{constructor(a){var d,b;if(this.gl=a,this.clearColor=new pa(this),this.clearDepth=new Wn(this),this.clearStencil=new bu(this),this.colorMask=new Ki(this),this.depthMask=new Zn(this),this.stencilMask=new pi(this),this.stencilFunc=new Ca(this),this.stencilOp=new Ol(this),this.stencilTest=new Fs(this),this.depthRange=new el(this),this.depthTest=new ds(this),this.depthFunc=new di(this),this.blend=new Gi(this),this.blendFunc=new qn(this),this.blendColor=new $a(this),this.blendEquation=new Zo(this),this.cullFace=new Qs(this),this.cullFaceSide=new zn(this),this.frontFace=new or(this),this.program=new Cl(this),this.activeTexture=new eu(this),this.viewport=new _i(this),this.bindFramebuffer=new Ho(this),this.bindRenderbuffer=new Jo(this),this.bindTexture=new Ga(this),this.bindVertexBuffer=new tl(this),this.bindElementBuffer=new rl(this),this.bindVertexArray=new tr(this),this.pixelStoreUnpack=new Ko(this),this.pixelStoreUnpackPremultiplyAlpha=new ei(this),this.pixelStoreUnpackFlipY=new xu(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),oo(a)){this.HALF_FLOAT=a.HALF_FLOAT;const w=a.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=a.RGBA16F)!==null&&d!==void 0?d:w==null?void 0:w.RGBA16F_EXT,this.RGB16F=(b=a.RGB16F)!==null&&b!==void 0?b:w==null?void 0:w.RGB16F_EXT,a.getExtension("EXT_color_buffer_float")}else{a.getExtension("EXT_color_buffer_half_float"),a.getExtension("OES_texture_half_float_linear");const w=a.getExtension("OES_texture_half_float");this.HALF_FLOAT=w==null?void 0:w.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,d){return new Yr(this,a,d)}createVertexBuffer(a,d,b){return new fa(this,a,d,b)}createRenderbuffer(a,d,b){const w=this.gl,I=w.createRenderbuffer();return this.bindRenderbuffer.set(I),w.renderbufferStorage(w.RENDERBUFFER,a,d,b),this.bindRenderbuffer.set(null),I}createFramebuffer(a,d,b,w){return new Un(this,a,d,b,w)}clear({color:a,depth:d,stencil:b}){const w=this.gl;let I=0;a&&(I|=w.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(I|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),b!==void 0&&(I|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),w.clear(I)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){u.deepEqual(a.blendFunction,Hn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}createVertexArray(){var a;return oo(this.gl)?this.gl.createVertexArray():(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.createVertexArrayOES()}deleteVertexArray(a){var d;return oo(this.gl)?this.gl.deleteVertexArray(a):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(a)}unbindVAO(){this.bindVertexArray.set(null)}}class Br{constructor(a,d,b){this.func=a,this.mask=d,this.range=b}}Br.ReadOnly=!1,Br.ReadWrite=!0,Br.disabled=new Br(519,Br.ReadOnly,[0,1]);const wu=7680;class ln{constructor(a,d,b,w,I,L){this.test=a,this.ref=d,this.mask=b,this.fail=w,this.depthFail=I,this.pass=L}}ln.disabled=new ln({func:519,mask:0},0,0,wu,wu,wu);class dr{constructor(a,d,b){this.enable=a,this.mode=d,this.frontFace=b}}let Ri;function qa(x,a,d,b,w,I,L){const F=x.context,j=F.gl,Y=x.useProgram("collisionBox"),K=[];let re=0,me=0;for(let je=0;je<b.length;je++){const tt=b[je],ut=a.getTile(tt),lt=ut.getBucket(d);if(!lt)continue;let bt=tt.posMatrix;w[0]===0&&w[1]===0||(bt=x.translatePosMatrix(tt.posMatrix,ut,w,I));const St=L?lt.textCollisionBox:lt.iconCollisionBox,wt=lt.collisionCircleArray;if(wt.length>0){const Mt=u.create(),lr=bt;u.mul(Mt,lt.placementInvProjMatrix,x.transform.glCoordMatrix),u.mul(Mt,Mt,lt.placementViewportMatrix),K.push({circleArray:wt,circleOffset:me,transform:lr,invTransform:Mt,coord:tt}),re+=wt.length/4,me=re}St&&Y.draw(F,j.LINES,Br.disabled,ln.disabled,x.colorModeForRenderPass(),dr.disabled,Pt(bt,x.transform,ut),x.style.map.terrain&&x.style.map.terrain.getTerrainData(tt),d.id,St.layoutVertexBuffer,St.indexBuffer,St.segments,null,x.transform.zoom,null,null,St.collisionVertexBuffer)}if(!L||!K.length)return;const Me=x.useProgram("collisionCircle"),Te=new u.CollisionCircleLayoutArray;Te.resize(4*re),Te._trim();let Fe=0;for(const je of K)for(let tt=0;tt<je.circleArray.length/4;tt++){const ut=4*tt,lt=je.circleArray[ut+0],bt=je.circleArray[ut+1],St=je.circleArray[ut+2],wt=je.circleArray[ut+3];Te.emplace(Fe++,lt,bt,St,wt,0),Te.emplace(Fe++,lt,bt,St,wt,1),Te.emplace(Fe++,lt,bt,St,wt,2),Te.emplace(Fe++,lt,bt,St,wt,3)}(!Ri||Ri.length<2*re)&&(Ri=function(je){const tt=2*je,ut=new u.QuadTriangleArray;ut.resize(tt),ut._trim();for(let lt=0;lt<tt;lt++){const bt=6*lt;ut.uint16[bt+0]=4*lt+0,ut.uint16[bt+1]=4*lt+1,ut.uint16[bt+2]=4*lt+2,ut.uint16[bt+3]=4*lt+2,ut.uint16[bt+4]=4*lt+3,ut.uint16[bt+5]=4*lt+0}return ut}(re));const Ce=F.createIndexBuffer(Ri,!0),Je=F.createVertexBuffer(Te,u.collisionCircleLayout.members,!0);for(const je of K){const tt={u_matrix:je.transform,u_inv_matrix:je.invTransform,u_camera_to_center_distance:(at=x.transform).cameraToCenterDistance,u_viewport_size:[at.width,at.height]};Me.draw(F,j.TRIANGLES,Br.disabled,ln.disabled,x.colorModeForRenderPass(),dr.disabled,tt,x.style.map.terrain&&x.style.map.terrain.getTerrainData(je.coord),d.id,Je,Ce,u.SegmentVector.simpleSegment(0,2*je.circleOffset,je.circleArray.length,je.circleArray.length/2),null,x.transform.zoom,null,null,null)}var at;Je.destroy(),Ce.destroy()}dr.disabled=new dr(!1,1029,2305),dr.backCCW=new dr(!0,1029,2305);const Qo=u.identity(new Float32Array(16));function Po(x,a,d,b,w,I){const{horizontalAlign:L,verticalAlign:F}=u.getAnchorAlignment(x);return new u.Point((-(L-.5)*a/w+b[0])*I,(-(F-.5)*d/w+b[1])*I)}function Si(x,a,d,b,w,I,L,F,j,Y,K){const re=x.text.placedSymbolArray,me=x.text.dynamicLayoutVertexArray,Me=x.icon.dynamicLayoutVertexArray,Te={};me.clear();for(let Fe=0;Fe<re.length;Fe++){const Ce=re.get(Fe),Je=Ce.hidden||!Ce.crossTileID||x.allowVerticalPlacement&&!Ce.placedOrientation?null:b[Ce.crossTileID];if(Je){const at=new u.Point(Ce.anchorX,Ce.anchorY),je=Rt(at,d?L:I,K),tt=sn(w.cameraToCenterDistance,je.signedDistanceFromCamera);let ut=u.evaluateSizeForFeature(x.textSizeData,j,Ce)*tt/u.ONE_EM;d&&(ut*=x.tilePixelRatio/F);const{width:lt,height:bt,anchor:St,textOffset:wt,textBoxScale:Mt}=Je,lr=Po(St,lt,bt,wt,Mt,ut),Qr=d?Rt(at.add(lr),I,K).point:je.point.add(a?lr.rotate(-w.angle):lr),kt=x.allowVerticalPlacement&&Ce.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let gr=0;gr<Ce.numGlyphs;gr++)u.addDynamicAttributes(me,Qr,kt);Y&&Ce.associatedIconIndex>=0&&(Te[Ce.associatedIconIndex]={shiftedAnchor:Qr,angle:kt})}else Ie(Ce.numGlyphs,me)}if(Y){Me.clear();const Fe=x.icon.placedSymbolArray;for(let Ce=0;Ce<Fe.length;Ce++){const Je=Fe.get(Ce);if(Je.hidden)Ie(Je.numGlyphs,Me);else{const at=Te[Ce];if(at)for(let je=0;je<Je.numGlyphs;je++)u.addDynamicAttributes(Me,at.shiftedAnchor,at.angle);else Ie(Je.numGlyphs,Me)}}x.icon.dynamicLayoutVertexBuffer.updateData(Me)}x.text.dynamicLayoutVertexBuffer.updateData(me)}function Nc(x,a,d){return d.iconsInText&&a?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function nl(x,a,d,b,w,I,L,F,j,Y,K,re){const me=x.context,Me=me.gl,Te=x.transform,Fe=F==="map",Ce=j==="map",Je=F!=="viewport"&&d.layout.get("symbol-placement")!=="point",at=Fe&&!Ce&&!Je,je=!d.layout.get("symbol-sort-key").isConstant();let tt=!1;const ut=x.depthModeForSublayer(0,Br.ReadOnly),lt=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),bt=[];for(const St of b){const wt=a.getTile(St),Mt=wt.getBucket(d);if(!Mt)continue;const lr=w?Mt.text:Mt.icon;if(!lr||!lr.segments.get().length||!lr.hasVisibleVertices)continue;const Qr=lr.programConfigurations.get(d.id),kt=w||Mt.sdfIcons,gr=w?Mt.textSizeData:Mt.iconSizeData,ar=Ce||Te.pitch!==0,Ii=x.useProgram(Nc(kt,w,Mt),Qr),en=u.evaluateSizeForZoom(gr,Te.zoom),_r=x.style.map.terrain&&x.style.map.terrain.getTerrainData(St);let tn,Bi,ri,xs,ia=[0,0],ro=null;if(w)Bi=wt.glyphAtlasTexture,ri=Me.LINEAR,tn=wt.glyphAtlasTexture.size,Mt.iconsInText&&(ia=wt.imageAtlasTexture.size,ro=wt.imageAtlasTexture,xs=ar||x.options.rotating||x.options.zooming||gr.kind==="composite"||gr.kind==="camera"?Me.LINEAR:Me.NEAREST);else{const Lo=d.layout.get("icon-size").constantOr(0)!==1||Mt.iconsNeedLinear;Bi=wt.imageAtlasTexture,ri=kt||x.options.rotating||x.options.zooming||Lo||ar?Me.LINEAR:Me.NEAREST,tn=wt.imageAtlasTexture.size}const es=Ve(wt,1,x.transform.zoom),Ou=Ar(St.posMatrix,Ce,Fe,x.transform,es),su=Ir(St.posMatrix,Ce,Fe,x.transform,es),Cu=lt&&Mt.hasTextData(),ac=d.layout.get("icon-text-fit")!=="none"&&Cu&&Mt.hasIconData();if(Je){const Lo=x.style.map.terrain?(ya,zi)=>x.style.map.terrain.getElevation(St,ya,zi):null,_o=d.layout.get("text-rotation-alignment")==="map";Gn(Mt,St.posMatrix,x,w,Ou,su,Ce,Y,_o,Lo)}const ul=x.translatePosMatrix(St.posMatrix,wt,I,L),ku=Je||w&&lt||ac?Qo:Ou,ho=x.translatePosMatrix(su,wt,I,L,!0),Mo=kt&&d.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let va;va=kt?Mt.iconsInText?Oa(gr.kind,en,at,Ce,x,ul,ku,ho,tn,ia):Zr(gr.kind,en,at,Ce,x,ul,ku,ho,w,tn,!0):Ji(gr.kind,en,at,Ce,x,ul,ku,ho,w,tn);const sc={program:Ii,buffers:lr,uniformValues:va,atlasTexture:Bi,atlasTextureIcon:ro,atlasInterpolation:ri,atlasInterpolationIcon:xs,isSDF:kt,hasHalo:Mo};if(je&&Mt.canOverlap){tt=!0;const Lo=lr.segments.get();for(const _o of Lo)bt.push({segments:new u.SegmentVector([_o]),sortKey:_o.sortKey,state:sc,terrainData:_r})}else bt.push({segments:lr.segments,sortKey:0,state:sc,terrainData:_r})}tt&&bt.sort((St,wt)=>St.sortKey-wt.sortKey);for(const St of bt){const wt=St.state;if(me.activeTexture.set(Me.TEXTURE0),wt.atlasTexture.bind(wt.atlasInterpolation,Me.CLAMP_TO_EDGE),wt.atlasTextureIcon&&(me.activeTexture.set(Me.TEXTURE1),wt.atlasTextureIcon&&wt.atlasTextureIcon.bind(wt.atlasInterpolationIcon,Me.CLAMP_TO_EDGE)),wt.isSDF){const Mt=wt.uniformValues;wt.hasHalo&&(Mt.u_is_halo=1,ea(wt.buffers,St.segments,d,x,wt.program,ut,K,re,Mt,St.terrainData)),Mt.u_is_halo=0}ea(wt.buffers,St.segments,d,x,wt.program,ut,K,re,wt.uniformValues,St.terrainData)}}function ea(x,a,d,b,w,I,L,F,j,Y){const K=b.context;w.draw(K,K.gl.TRIANGLES,I,L,F,dr.disabled,j,Y,d.id,x.layoutVertexBuffer,x.indexBuffer,a,d.paint,b.transform.zoom,x.programConfigurations.get(d.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function vo(x,a,d,b,w){if(!d||!b||!b.imageAtlas)return;const I=b.imageAtlas.patternPositions;let L=I[d.to.toString()],F=I[d.from.toString()];if(!L||!F){const j=w.getPaintProperty(a);L=I[j],F=I[j]}L&&F&&x.setConstantPatternPositions(L,F)}function Va(x,a,d,b,w,I,L){const F=x.context.gl,j="fill-pattern",Y=d.paint.get(j),K=Y&&Y.constantOr(1),re=d.getCrossfadeParameters();let me,Me,Te,Fe,Ce;L?(Me=K&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",me=F.LINES):(Me=K?"fillPattern":"fill",me=F.TRIANGLES);const Je=Y.constantOr(null);for(const at of b){const je=a.getTile(at);if(K&&!je.patternsLoaded())continue;const tt=je.getBucket(d);if(!tt)continue;const ut=tt.programConfigurations.get(d.id),lt=x.useProgram(Me,ut),bt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(at);K&&(x.context.activeTexture.set(F.TEXTURE0),je.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),ut.updatePaintBuffers(re)),vo(ut,j,Je,je,d);const St=bt?at:null,wt=x.translatePosMatrix(St?St.posMatrix:at.posMatrix,je,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(L){Fe=tt.indexBuffer2,Ce=tt.segments2;const Mt=[F.drawingBufferWidth,F.drawingBufferHeight];Te=Me==="fillOutlinePattern"&&K?Zs(wt,x,re,je,Mt):Yo(wt,Mt)}else Fe=tt.indexBuffer,Ce=tt.segments,Te=K?Hi(wt,x,re,je):Ws(wt);lt.draw(x.context,me,w,x.stencilModeForClipping(at),I,dr.disabled,Te,bt,d.id,tt.layoutVertexBuffer,Fe,Ce,d.paint,x.transform.zoom,ut)}}function Qi(x,a,d,b,w,I,L){const F=x.context,j=F.gl,Y="fill-extrusion-pattern",K=d.paint.get(Y),re=K.constantOr(1),me=d.getCrossfadeParameters(),Me=d.paint.get("fill-extrusion-opacity"),Te=K.constantOr(null);for(const Fe of b){const Ce=a.getTile(Fe),Je=Ce.getBucket(d);if(!Je)continue;const at=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Fe),je=Je.programConfigurations.get(d.id),tt=x.useProgram(re?"fillExtrusionPattern":"fillExtrusion",je);re&&(x.context.activeTexture.set(j.TEXTURE0),Ce.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),je.updatePaintBuffers(me)),vo(je,Y,Te,Ce,d);const ut=x.translatePosMatrix(Fe.posMatrix,Ce,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),lt=d.paint.get("fill-extrusion-vertical-gradient"),bt=re?Il(ut,x,lt,Me,Fe,me,Ce):Ds(ut,x,lt,Me);tt.draw(F,F.gl.TRIANGLES,w,I,L,dr.backCCW,bt,at,d.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,d.paint,x.transform.zoom,je,x.style.map.terrain&&Je.centroidVertexBuffer)}}function Or(x,a,d,b,w,I,L){const F=x.context,j=F.gl,Y=d.fbo;if(!Y)return;const K=x.useProgram("hillshade"),re=x.style.map.terrain&&x.style.map.terrain.getTerrainData(a);F.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,Y.colorAttachment.get()),K.draw(F,j.TRIANGLES,w,I,L,dr.disabled,((me,Me,Te,Fe)=>{const Ce=Te.paint.get("hillshade-shadow-color"),Je=Te.paint.get("hillshade-highlight-color"),at=Te.paint.get("hillshade-accent-color");let je=Te.paint.get("hillshade-illumination-direction")*(Math.PI/180);Te.paint.get("hillshade-illumination-anchor")==="viewport"&&(je-=me.transform.angle);const tt=!me.options.moving;return{u_matrix:Fe?Fe.posMatrix:me.transform.calculatePosMatrix(Me.tileID.toUnwrapped(),tt),u_image:0,u_latrange:Js(0,Me.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),je],u_shadow:Ce,u_highlight:Je,u_accent:at}})(x,d,b,re?a:null),re,b.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}function Ao(x,a,d,b,w,I){const L=x.context,F=L.gl,j=a.dem;if(j&&j.data){const Y=j.dim,K=j.stride,re=j.getPixels();if(L.activeTexture.set(F.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||x.getTileTexture(K),a.demTexture){const Me=a.demTexture;Me.update(re,{premultiply:!1}),Me.bind(F.NEAREST,F.CLAMP_TO_EDGE)}else a.demTexture=new J(L,re,F.RGBA,{premultiply:!1}),a.demTexture.bind(F.NEAREST,F.CLAMP_TO_EDGE);L.activeTexture.set(F.TEXTURE0);let me=a.fbo;if(!me){const Me=new J(L,{width:Y,height:Y,data:null},F.RGBA);Me.bind(F.LINEAR,F.CLAMP_TO_EDGE),me=a.fbo=L.createFramebuffer(Y,Y,!0,!1),me.colorAttachment.set(Me.texture)}L.bindFramebuffer.set(me.framebuffer),L.viewport.set([0,0,Y,Y]),x.useProgram("hillshadePrepare").draw(L,F.TRIANGLES,b,w,I,dr.disabled,((Me,Te)=>{const Fe=Te.stride,Ce=u.create();return u.ortho(Ce,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(Ce,Ce,[0,-u.EXTENT,0]),{u_matrix:Ce,u_image:1,u_dimension:[Fe,Fe],u_zoom:Me.overscaledZ,u_unpack:Te.getUnpackVector()}})(a.tileID,j),null,d.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Ta(x,a,d,b,w,I){const L=b.paint.get("raster-fade-duration");if(!I&&L>0){const F=u.browser.now(),j=(F-x.timeAdded)/L,Y=a?(F-a.timeAdded)/L:-1,K=d.getSource(),re=w.coveringZoomLevel({tileSize:K.tileSize,roundZoom:K.roundZoom}),me=!a||Math.abs(a.tileID.overscaledZ-re)>Math.abs(x.tileID.overscaledZ-re),Me=me&&x.refreshedUponExpiration?1:u.clamp(me?j:1-Y,0,1);return x.refreshedUponExpiration&&j>=1&&(x.refreshedUponExpiration=!1),a?{opacity:1,mix:1-Me}:{opacity:Me,mix:0}}return{opacity:1,mix:0}}const da=new u.Color(1,0,0,1),Hr=new u.Color(0,1,0,1),Eu=new u.Color(0,0,1,1),ta=new u.Color(1,0,1,1),eo=new u.Color(0,1,1,1);function Xa(x,a,d,b){Bs(x,0,a+d/2,x.transform.width,d,b)}function ga(x,a,d,b){Bs(x,a-d/2,0,d,x.transform.height,b)}function Bs(x,a,d,b,w,I){const L=x.context,F=L.gl;F.enable(F.SCISSOR_TEST),F.scissor(a*x.pixelRatio,d*x.pixelRatio,b*x.pixelRatio,w*x.pixelRatio),L.clear({color:I}),F.disable(F.SCISSOR_TEST)}function qi(x,a,d){const b=x.context,w=b.gl,I=d.posMatrix,L=x.useProgram("debug"),F=Br.disabled,j=ln.disabled,Y=x.colorModeForRenderPass(),K="$debug",re=x.style.map.terrain&&x.style.map.terrain.getTerrainData(d);b.activeTexture.set(w.TEXTURE0);const me=a.getTileByID(d.key).latestRawTileData,Me=Math.floor((me&&me.byteLength||0)/1024),Te=a.getTile(d).tileSize,Fe=512/Math.min(Te,512)*(d.overscaledZ/x.transform.zoom)*.5;let Ce=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Ce+=` => ${d.overscaledZ}`),function(Je,at){Je.initDebugOverlayCanvas();const je=Je.debugOverlayCanvas,tt=Je.context.gl,ut=Je.debugOverlayCanvas.getContext("2d");ut.clearRect(0,0,je.width,je.height),ut.shadowColor="white",ut.shadowBlur=2,ut.lineWidth=1.5,ut.strokeStyle="white",ut.textBaseline="top",ut.font="bold 36px Open Sans, sans-serif",ut.fillText(at,5,5),ut.strokeText(at,5,5),Je.debugOverlayTexture.update(je),Je.debugOverlayTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}(x,`${Ce} ${Me}kB`),L.draw(b,w.TRIANGLES,F,j,Hn.alphaBlended,dr.disabled,Hs(I,u.Color.transparent,Fe),null,K,x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),L.draw(b,w.LINE_STRIP,F,j,Y,dr.disabled,Hs(I,u.Color.red),re,K,x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}function Tl(x,a,d){const b=x.context,w=b.gl,I=x.colorModeForRenderPass(),L=new Br(w.LEQUAL,Br.ReadWrite,x.depthRangeFor3D),F=x.useProgram("terrain"),j=a.getTerrainMesh();b.bindFramebuffer.set(null),b.viewport.set([0,0,x.width,x.height]);for(const Y of d){const K=x.renderToTexture.getTexture(Y),re=a.getTerrainData(Y.tileID);b.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,K.texture);const me={u_matrix:x.transform.calculatePosMatrix(Y.tileID.toUnwrapped()),u_texture:0,u_ele_delta:a.getMeshFrameDelta(x.transform.zoom)};F.draw(b,w.TRIANGLES,L,ln.disabled,I,dr.backCCW,me,re,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}class il{constructor(a,d){this.context=new Li(a),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.create(),renderTime:0},this.setup(),this.numSublayers=ge.maxUnderzooming+ge.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qn}resize(a,d,b){if(this.width=Math.floor(a*b),this.height=Math.floor(d*b),this.pixelRatio=b,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style._order)this.style._layers[w].resize()}setup(){const a=this.context,d=new u.PosArray;d.emplaceBack(0,0),d.emplaceBack(u.EXTENT,0),d.emplaceBack(0,u.EXTENT),d.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(d,mo.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const b=new u.PosArray;b.emplaceBack(0,0),b.emplaceBack(u.EXTENT,0),b.emplaceBack(0,u.EXTENT),b.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=a.createVertexBuffer(b,mo.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const w=new u.RasterBoundsArray;w.emplaceBack(0,0,0,0),w.emplaceBack(u.EXTENT,0,u.EXTENT,0),w.emplaceBack(0,u.EXTENT,0,u.EXTENT),w.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.rasterBoundsBuffer=a.createVertexBuffer(w,pt.members),this.rasterBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const I=new u.PosArray;I.emplaceBack(0,0),I.emplaceBack(1,0),I.emplaceBack(0,1),I.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(I,mo.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const L=new u.LineStripIndexArray;L.emplaceBack(0),L.emplaceBack(1),L.emplaceBack(3),L.emplaceBack(2),L.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(L);const F=new u.TriangleIndexArray;F.emplaceBack(0,1,2),F.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(F);const j=this.context.gl;this.stencilClearMode=new ln({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO)}clearStencil(){const a=this.context,d=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const b=u.create();u.ortho(b,0,this.width,this.height,0,0,1),u.scale(b,b,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,d.TRIANGLES,Br.disabled,this.stencilClearMode,Hn.disabled,dr.disabled,io(b),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(a,d){if(this.currentStencilSource===a.source||!a.isTileClipped()||!d||!d.length)return;this.currentStencilSource=a.source;const b=this.context,w=b.gl;this.nextStencilID+d.length>256&&this.clearStencil(),b.setColorMode(Hn.disabled),b.setDepthMode(Br.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of d){const F=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L);I.draw(b,w.TRIANGLES,Br.disabled,new ln({func:w.ALWAYS,mask:0},F,255,w.KEEP,w.KEEP,w.REPLACE),Hn.disabled,dr.disabled,io(L.posMatrix),j,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,d=this.context.gl;return new ln({func:d.NOTEQUAL,mask:255},a,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(a){const d=this.context.gl;return new ln({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(a){const d=this.context.gl,b=a.sort((L,F)=>F.overscaledZ-L.overscaledZ),w=b[b.length-1].overscaledZ,I=b[0].overscaledZ-w+1;if(I>1){this.currentStencilSource=void 0,this.nextStencilID+I>256&&this.clearStencil();const L={};for(let F=0;F<I;F++)L[F+w]=new ln({func:d.GEQUAL,mask:255},F+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=I,[L,b]}return[{[w]:ln.disabled},b]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new Hn([a.CONSTANT_COLOR,a.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Hn.unblended:Hn.alphaBlended}depthModeForSublayer(a,d,b){if(!this.opaquePassEnabledForLayer())return Br.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new Br(b||this.context.gl.LEQUAL,d,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,d){this.style=a,this.options=d,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(u.browser.now()),this.imageManager.beginFrame();const b=this.style._order,w=this.style.sourceCaches,I={},L={},F={};for(const j in w){const Y=w[j];Y.used&&Y.prepare(this.context),I[j]=Y.getVisibleCoordinates(),L[j]=I[j].slice().reverse(),F[j]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<b.length;j++)if(this.style._layers[b[j]].is3D()){this.opaquePassCutoff=j;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const j=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||j.length)&&(u.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(Y,K){const re=Y.context,me=re.gl,Me=Hn.unblended,Te=new Br(me.LEQUAL,Br.ReadWrite,[0,1]),Fe=K.getTerrainMesh(),Ce=K.sourceCache.getRenderableTiles(),Je=Y.useProgram("terrainDepth");re.bindFramebuffer.set(K.getFramebuffer("depth").framebuffer),re.viewport.set([0,0,Y.width/devicePixelRatio,Y.height/devicePixelRatio]),re.clear({color:u.Color.transparent,depth:1});for(const at of Ce){const je=K.getTerrainData(at.tileID),tt={u_matrix:Y.transform.calculatePosMatrix(at.tileID.toUnwrapped()),u_ele_delta:K.getMeshFrameDelta(Y.transform.zoom)};Je.draw(re,me.TRIANGLES,Te,ln.disabled,Me,dr.backCCW,tt,je,"terrain",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}re.bindFramebuffer.set(null),re.viewport.set([0,0,Y.width,Y.height])}(this,this.style.map.terrain),function(Y,K){const re=Y.context,me=re.gl,Me=Hn.unblended,Te=new Br(me.LEQUAL,Br.ReadWrite,[0,1]),Fe=K.getTerrainMesh(),Ce=K.getCoordsTexture(),Je=K.sourceCache.getRenderableTiles(),at=Y.useProgram("terrainCoords");re.bindFramebuffer.set(K.getFramebuffer("coords").framebuffer),re.viewport.set([0,0,Y.width/devicePixelRatio,Y.height/devicePixelRatio]),re.clear({color:u.Color.transparent,depth:1}),K.coordsIndex=[];for(const je of Je){const tt=K.getTerrainData(je.tileID);re.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_2D,Ce.texture);const ut={u_matrix:Y.transform.calculatePosMatrix(je.tileID.toUnwrapped()),u_terrain_coords_id:(255-K.coordsIndex.length)/255,u_texture:0,u_ele_delta:K.getMeshFrameDelta(Y.transform.zoom)};at.draw(re,me.TRIANGLES,Te,ln.disabled,Me,dr.backCCW,ut,tt,"terrain",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments),K.coordsIndex.push(je.tileID.key)}re.bindFramebuffer.set(null),re.viewport.set([0,0,Y.width,Y.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const j of b){const Y=this.style._layers[j];if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const K=L[Y.source];(Y.type==="custom"||K.length)&&this.renderLayer(this,w[Y.source],Y,K)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[b[this.currentLayer]],Y=w[j.source],K=I[j.source];this._renderTileClippingMasks(j,K),this.renderLayer(this,Y,j,K)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const j=this.style._layers[b[this.currentLayer]],Y=w[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j))continue;const K=(j.type==="symbol"?F:L)[j.source];this._renderTileClippingMasks(j,I[j.source]),this.renderLayer(this,Y,j,K)}if(this.options.showTileBoundaries){const j=function(Y,K){let re=null;const me=Object.values(Y._layers).flatMap(Ce=>Ce.source&&!Ce.isHidden(K)?[Y.sourceCaches[Ce.source]]:[]),Me=me.filter(Ce=>Ce.getSource().type==="vector"),Te=me.filter(Ce=>Ce.getSource().type!=="vector"),Fe=Ce=>{(!re||re.getSource().maxzoom<Ce.getSource().maxzoom)&&(re=Ce)};return Me.forEach(Ce=>Fe(Ce)),re||Te.forEach(Ce=>Fe(Ce)),re}(this.style,this.transform.zoom);j&&function(Y,K,re){for(let me=0;me<re.length;me++)qi(Y,K,re[me])}(this,j,j.getVisibleCoordinates())}this.options.showPadding&&function(j){const Y=j.transform.padding;Xa(j,j.transform.height-(Y.top||0),3,da),Xa(j,Y.bottom||0,3,Hr),ga(j,Y.left||0,3,Eu),ga(j,j.transform.width-(Y.right||0),3,ta);const K=j.transform.centerPoint;(function(re,me,Me,Te){Bs(re,me-1,Me-10,2,20,Te),Bs(re,me-10,Me-1,20,2,Te)})(j,K.x,j.transform.height-K.y,eo)}(this),this.context.setDefault()}renderLayer(a,d,b,w){if(!b.isHidden(this.transform.zoom)&&(b.type==="background"||b.type==="custom"||(w||[]).length))switch(this.id=b.id,b.type){case"symbol":(function(I,L,F,j,Y){if(I.renderPass!=="translucent")return;const K=ln.disabled,re=I.colorModeForRenderPass();(F._unevaluatedLayout.hasValue("text-variable-anchor")||F._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(me,Me,Te,Fe,Ce,Je,at){const je=Me.transform,tt=Ce==="map",ut=Je==="map";for(const lt of me){const bt=Fe.getTile(lt),St=bt.getBucket(Te);if(!St||!St.text||!St.text.segments.get().length)continue;const wt=u.evaluateSizeForZoom(St.textSizeData,je.zoom),Mt=Ve(bt,1,Me.transform.zoom),lr=Ar(lt.posMatrix,ut,tt,Me.transform,Mt),Qr=Te.layout.get("icon-text-fit")!=="none"&&St.hasIconData();if(wt){const kt=Math.pow(2,je.zoom-bt.tileID.overscaledZ);Si(St,tt,ut,at,je,lr,lt.posMatrix,kt,wt,Qr,Me.style.map.terrain?(gr,ar)=>Me.style.map.terrain.getElevation(lt,gr,ar):null)}}}(j,I,F,L,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),Y),F.paint.get("icon-opacity").constantOr(1)!==0&&nl(I,L,F,j,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),K,re),F.paint.get("text-opacity").constantOr(1)!==0&&nl(I,L,F,j,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),K,re),L.map.showCollisionBoxes&&(qa(I,L,F,j,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),qa(I,L,F,j,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))})(a,d,b,w,this.style.placement.variableOffsets);break;case"circle":(function(I,L,F,j){if(I.renderPass!=="translucent")return;const Y=F.paint.get("circle-opacity"),K=F.paint.get("circle-stroke-width"),re=F.paint.get("circle-stroke-opacity"),me=!F.layout.get("circle-sort-key").isConstant();if(Y.constantOr(1)===0&&(K.constantOr(1)===0||re.constantOr(1)===0))return;const Me=I.context,Te=Me.gl,Fe=I.depthModeForSublayer(0,Br.ReadOnly),Ce=ln.disabled,Je=I.colorModeForRenderPass(),at=[];for(let je=0;je<j.length;je++){const tt=j[je],ut=L.getTile(tt),lt=ut.getBucket(F);if(!lt)continue;const bt=lt.programConfigurations.get(F.id),St=I.useProgram("circle",bt),wt=lt.layoutVertexBuffer,Mt=lt.indexBuffer,lr=I.style.map.terrain&&I.style.map.terrain.getTerrainData(tt),Qr={programConfiguration:bt,program:St,layoutVertexBuffer:wt,indexBuffer:Mt,uniformValues:Qu(I,tt,ut,F),terrainData:lr};if(me){const kt=lt.segments.get();for(const gr of kt)at.push({segments:new u.SegmentVector([gr]),sortKey:gr.sortKey,state:Qr})}else at.push({segments:lt.segments,sortKey:0,state:Qr})}me&&at.sort((je,tt)=>je.sortKey-tt.sortKey);for(const je of at){const{programConfiguration:tt,program:ut,layoutVertexBuffer:lt,indexBuffer:bt,uniformValues:St,terrainData:wt}=je.state;ut.draw(Me,Te.TRIANGLES,Fe,Ce,Je,dr.disabled,St,wt,F.id,lt,bt,je.segments,F.paint,I.transform.zoom,tt)}})(a,d,b,w);break;case"heatmap":(function(I,L,F,j){if(F.paint.get("heatmap-opacity")!==0)if(I.renderPass==="offscreen"){const Y=I.context,K=Y.gl,re=ln.disabled,me=new Hn([K.ONE,K.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(Me,Te,Fe){const Ce=Me.gl;Me.activeTexture.set(Ce.TEXTURE1),Me.viewport.set([0,0,Te.width/4,Te.height/4]);let Je=Fe.heatmapFbo;if(Je)Ce.bindTexture(Ce.TEXTURE_2D,Je.colorAttachment.get()),Me.bindFramebuffer.set(Je.framebuffer);else{const at=Ce.createTexture();Ce.bindTexture(Ce.TEXTURE_2D,at),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_S,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_T,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MIN_FILTER,Ce.LINEAR),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MAG_FILTER,Ce.LINEAR),Je=Fe.heatmapFbo=Me.createFramebuffer(Te.width/4,Te.height/4,!1,!1),function(je,tt,ut,lt){var bt,St;const wt=je.gl,Mt=(bt=je.HALF_FLOAT)!==null&&bt!==void 0?bt:wt.UNSIGNED_BYTE,lr=(St=je.RGBA16F)!==null&&St!==void 0?St:wt.RGBA;wt.texImage2D(wt.TEXTURE_2D,0,lr,tt.width/4,tt.height/4,0,wt.RGBA,Mt,null),lt.colorAttachment.set(ut)}(Me,Te,at,Je)}})(Y,I,F),Y.clear({color:u.Color.transparent});for(let Me=0;Me<j.length;Me++){const Te=j[Me];if(L.hasRenderableParent(Te))continue;const Fe=L.getTile(Te),Ce=Fe.getBucket(F);if(!Ce)continue;const Je=Ce.programConfigurations.get(F.id),at=I.useProgram("heatmap",Je),{zoom:je}=I.transform;at.draw(Y,K.TRIANGLES,Br.disabled,re,me,dr.disabled,Wo(Te.posMatrix,Fe,je,F.paint.get("heatmap-intensity")),null,F.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,F.paint,I.transform.zoom,Je)}Y.viewport.set([0,0,I.width,I.height])}else I.renderPass==="translucent"&&(I.context.setColorMode(I.colorModeForRenderPass()),function(Y,K){const re=Y.context,me=re.gl,Me=K.heatmapFbo;if(!Me)return;re.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_2D,Me.colorAttachment.get()),re.activeTexture.set(me.TEXTURE1);let Te=K.colorRampTexture;Te||(Te=K.colorRampTexture=new J(re,K.colorRamp,me.RGBA)),Te.bind(me.LINEAR,me.CLAMP_TO_EDGE),Y.useProgram("heatmapTexture").draw(re,me.TRIANGLES,Br.disabled,ln.disabled,Y.colorModeForRenderPass(),dr.disabled,((Fe,Ce,Je,at)=>{const je=u.create();u.ortho(je,0,Fe.width,Fe.height,0,0,1);const tt=Fe.context.gl;return{u_matrix:je,u_world:[tt.drawingBufferWidth,tt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ce.paint.get("heatmap-opacity")}})(Y,K),null,K.id,Y.viewportBuffer,Y.quadTriangleIndexBuffer,Y.viewportSegments,K.paint,Y.transform.zoom)}(I,F))})(a,d,b,w);break;case"line":(function(I,L,F,j){if(I.renderPass!=="translucent")return;const Y=F.paint.get("line-opacity"),K=F.paint.get("line-width");if(Y.constantOr(1)===0||K.constantOr(1)===0)return;const re=I.depthModeForSublayer(0,Br.ReadOnly),me=I.colorModeForRenderPass(),Me=F.paint.get("line-dasharray"),Te=F.paint.get("line-pattern"),Fe=Te.constantOr(1),Ce=F.paint.get("line-gradient"),Je=F.getCrossfadeParameters(),at=Fe?"linePattern":Me?"lineSDF":Ce?"lineGradient":"line",je=I.context,tt=je.gl;let ut=!0;for(const lt of j){const bt=L.getTile(lt);if(Fe&&!bt.patternsLoaded())continue;const St=bt.getBucket(F);if(!St)continue;const wt=St.programConfigurations.get(F.id),Mt=I.context.program.get(),lr=I.useProgram(at,wt),Qr=ut||lr.program!==Mt,kt=I.style.map.terrain&&I.style.map.terrain.getTerrainData(lt),gr=Te.constantOr(null);if(gr&&bt.imageAtlas){const en=bt.imageAtlas,_r=en.patternPositions[gr.to.toString()],tn=en.patternPositions[gr.from.toString()];_r&&tn&&wt.setConstantPatternPositions(_r,tn)}const ar=kt?lt:null,Ii=Fe?Xr(I,bt,F,Je,ar):Me?Bn(I,bt,F,Me,Je,ar):Ce?an(I,bt,F,St.lineClipsArray.length,ar):fi(I,bt,F,ar);if(Fe)je.activeTexture.set(tt.TEXTURE0),bt.imageAtlasTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE),wt.updatePaintBuffers(Je);else if(Me&&(Qr||I.lineAtlas.dirty))je.activeTexture.set(tt.TEXTURE0),I.lineAtlas.bind(je);else if(Ce){const en=St.gradients[F.id];let _r=en.texture;if(F.gradientVersion!==en.version){let tn=256;if(F.stepInterpolant){const Bi=L.getSource().maxzoom,ri=lt.canonical.z===Bi?Math.ceil(1<<I.transform.maxZoom-lt.canonical.z):1;tn=u.clamp(u.nextPowerOfTwo(St.maxLineLength/u.EXTENT*1024*ri),256,je.maxTextureSize)}en.gradient=u.renderColorRamp({expression:F.gradientExpression(),evaluationKey:"lineProgress",resolution:tn,image:en.gradient||void 0,clips:St.lineClipsArray}),en.texture?en.texture.update(en.gradient):en.texture=new J(je,en.gradient,tt.RGBA),en.version=F.gradientVersion,_r=en.texture}je.activeTexture.set(tt.TEXTURE0),_r.bind(F.stepInterpolant?tt.NEAREST:tt.LINEAR,tt.CLAMP_TO_EDGE)}lr.draw(je,tt.TRIANGLES,re,I.stencilModeForClipping(lt),me,dr.disabled,Ii,kt,F.id,St.layoutVertexBuffer,St.indexBuffer,St.segments,F.paint,I.transform.zoom,wt,St.layoutVertexBuffer2),ut=!1}})(a,d,b,w);break;case"fill":(function(I,L,F,j){const Y=F.paint.get("fill-color"),K=F.paint.get("fill-opacity");if(K.constantOr(1)===0)return;const re=I.colorModeForRenderPass(),me=F.paint.get("fill-pattern"),Me=I.opaquePassEnabledForLayer()&&!me.constantOr(1)&&Y.constantOr(u.Color.transparent).a===1&&K.constantOr(0)===1?"opaque":"translucent";if(I.renderPass===Me){const Te=I.depthModeForSublayer(1,I.renderPass==="opaque"?Br.ReadWrite:Br.ReadOnly);Va(I,L,F,j,Te,re,!1)}if(I.renderPass==="translucent"&&F.paint.get("fill-antialias")){const Te=I.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Br.ReadOnly);Va(I,L,F,j,Te,re,!0)}})(a,d,b,w);break;case"fill-extrusion":(function(I,L,F,j){const Y=F.paint.get("fill-extrusion-opacity");if(Y!==0&&I.renderPass==="translucent"){const K=new Br(I.context.gl.LEQUAL,Br.ReadWrite,I.depthRangeFor3D);if(Y!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))Qi(I,L,F,j,K,ln.disabled,Hn.disabled),Qi(I,L,F,j,K,I.stencilModeFor3D(),I.colorModeForRenderPass());else{const re=I.colorModeForRenderPass();Qi(I,L,F,j,K,ln.disabled,re)}}})(a,d,b,w);break;case"hillshade":(function(I,L,F,j){if(I.renderPass!=="offscreen"&&I.renderPass!=="translucent")return;const Y=I.context,K=I.depthModeForSublayer(0,Br.ReadOnly),re=I.colorModeForRenderPass(),[me,Me]=I.renderPass==="translucent"?I.stencilConfigForOverlap(j):[{},j];for(const Te of Me){const Fe=L.getTile(Te);Fe.needsHillshadePrepare!==void 0&&Fe.needsHillshadePrepare&&I.renderPass==="offscreen"?Ao(I,Fe,F,K,ln.disabled,re):I.renderPass==="translucent"&&Or(I,Te,Fe,F,K,me[Te.overscaledZ],re)}Y.viewport.set([0,0,I.width,I.height])})(a,d,b,w);break;case"raster":(function(I,L,F,j){if(I.renderPass!=="translucent"||F.paint.get("raster-opacity")===0||!j.length)return;const Y=I.context,K=Y.gl,re=L.getSource(),me=I.useProgram("raster"),Me=I.colorModeForRenderPass(),[Te,Fe]=re instanceof Ct?[{},j]:I.stencilConfigForOverlap(j),Ce=Fe[Fe.length-1].overscaledZ,Je=!I.options.moving;for(const at of Fe){const je=I.depthModeForSublayer(at.overscaledZ-Ce,F.paint.get("raster-opacity")===1?Br.ReadWrite:Br.ReadOnly,K.LESS),tt=L.getTile(at);tt.registerFadeDuration(F.paint.get("raster-fade-duration"));const ut=L.findLoadedParent(at,0),lt=Ta(tt,ut,L,F,I.transform,I.style.map.terrain);let bt,St;const wt=F.paint.get("raster-resampling")==="nearest"?K.NEAREST:K.LINEAR;Y.activeTexture.set(K.TEXTURE0),tt.texture.bind(wt,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),Y.activeTexture.set(K.TEXTURE1),ut?(ut.texture.bind(wt,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),bt=Math.pow(2,ut.tileID.overscaledZ-tt.tileID.overscaledZ),St=[tt.tileID.canonical.x*bt%1,tt.tileID.canonical.y*bt%1]):tt.texture.bind(wt,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST);const Mt=I.style.map.terrain&&I.style.map.terrain.getTerrainData(at),lr=Mt?at:null,Qr=lr?lr.posMatrix:I.transform.calculatePosMatrix(at.toUnwrapped(),Je),kt=Ci(Qr,St||[0,0],bt||1,lt,F);re instanceof Ct?me.draw(Y,K.TRIANGLES,je,ln.disabled,Me,dr.disabled,kt,Mt,F.id,re.boundsBuffer,I.quadTriangleIndexBuffer,re.boundsSegments):me.draw(Y,K.TRIANGLES,je,Te[at.overscaledZ],Me,dr.disabled,kt,Mt,F.id,I.rasterBoundsBuffer,I.quadTriangleIndexBuffer,I.rasterBoundsSegments)}})(a,d,b,w);break;case"background":(function(I,L,F,j){const Y=F.paint.get("background-color"),K=F.paint.get("background-opacity");if(K===0)return;const re=I.context,me=re.gl,Me=I.transform,Te=Me.tileSize,Fe=F.paint.get("background-pattern");if(I.isPatternMissing(Fe))return;const Ce=!Fe&&Y.a===1&&K===1&&I.opaquePassEnabledForLayer()?"opaque":"translucent";if(I.renderPass!==Ce)return;const Je=ln.disabled,at=I.depthModeForSublayer(0,Ce==="opaque"?Br.ReadWrite:Br.ReadOnly),je=I.colorModeForRenderPass(),tt=I.useProgram(Fe?"backgroundPattern":"background"),ut=j||Me.coveringTiles({tileSize:Te,terrain:I.style.map.terrain});Fe&&(re.activeTexture.set(me.TEXTURE0),I.imageManager.bind(I.context));const lt=F.getCrossfadeParameters();for(const bt of ut){const St=j?bt.posMatrix:I.transform.calculatePosMatrix(bt.toUnwrapped()),wt=Fe?Ns(St,K,I,Fe,{tileID:bt,tileSize:Te},lt):Yn(St,K,Y),Mt=I.style.map.terrain&&I.style.map.terrain.getTerrainData(bt);tt.draw(re,me.TRIANGLES,at,Je,je,dr.disabled,wt,Mt,F.id,I.tileExtentBuffer,I.quadTriangleIndexBuffer,I.tileExtentSegments)}})(a,0,b,w);break;case"custom":(function(I,L,F){const j=I.context,Y=F.implementation;if(I.renderPass==="offscreen"){const K=Y.prerender;K&&(I.setCustomLayerDefaults(),j.setColorMode(I.colorModeForRenderPass()),K.call(Y,j.gl,I.transform.customLayerMatrix()),j.setDirty(),I.setBaseState())}else if(I.renderPass==="translucent"){I.setCustomLayerDefaults(),j.setColorMode(I.colorModeForRenderPass()),j.setStencilMode(ln.disabled);const K=Y.renderingMode==="3d"?new Br(I.context.gl.LEQUAL,Br.ReadWrite,I.depthRangeFor3D):I.depthModeForSublayer(0,Br.ReadOnly);j.setDepthMode(K),Y.render(j.gl,I.transform.customLayerMatrix()),j.setDirty(),I.setBaseState(),j.bindFramebuffer.set(null)}})(a,0,b)}}translatePosMatrix(a,d,b,w,I){if(!b[0]&&!b[1])return a;const L=I?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(L){const Y=Math.sin(L),K=Math.cos(L);b=[b[0]*K-b[1]*Y,b[0]*Y+b[1]*K]}const F=[I?b[0]:Ve(d,b[0],this.transform.zoom),I?b[1]:Ve(d,b[1],this.transform.zoom),0],j=new Float32Array(16);return u.translate(j,a,F),j}saveTileTexture(a){const d=this._tileTextures[a.size[0]];d?d.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const d=this._tileTextures[a];return d&&d.length>0?d.pop():null}isPatternMissing(a){if(!a)return!1;if(!a.from||!a.to)return!0;const d=this.imageManager.getPattern(a.from.toString()),b=this.imageManager.getPattern(a.to.toString());return!d||!b}useProgram(a,d){this.cache=this.cache||{};const b=a+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[b]||(this.cache[b]=new ha(this.context,Ls[a],d,Ti[a],this._showOverdrawInspector,this.style.map.terrain)),this.cache[b]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new J(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:a,drawingBufferHeight:d}=this.context.gl;return this.width!==a||this.height!==d}}class tu{constructor(a,d){this.points=a,this.planes=d}static fromInvProjectionMatrix(a,d,b){const w=Math.pow(2,b),I=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(F=>{const j=1/(F=u.transformMat4([],F,a))[3]/d*w;return u.mul$1(F,F,[j,j,1/F[3],j])}),L=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(F=>{const j=function(me,Me){var Te=Me[0],Fe=Me[1],Ce=Me[2],Je=Te*Te+Fe*Fe+Ce*Ce;return Je>0&&(Je=1/Math.sqrt(Je)),me[0]=Me[0]*Je,me[1]=Me[1]*Je,me[2]=Me[2]*Je,me}([],function(me,Me,Te){var Fe=Me[0],Ce=Me[1],Je=Me[2],at=Te[0],je=Te[1],tt=Te[2];return me[0]=Ce*tt-Je*je,me[1]=Je*at-Fe*tt,me[2]=Fe*je-Ce*at,me}([],ue([],I[F[0]],I[F[1]]),ue([],I[F[2]],I[F[1]]))),Y=-((K=j)[0]*(re=I[F[1]])[0]+K[1]*re[1]+K[2]*re[2]);var K,re;return j.concat(Y)});return new tu(I,L)}}class ol{constructor(a,d){this.min=a,this.max=d,this.center=function(b,w,I){return b[0]=.5*w[0],b[1]=.5*w[1],b[2]=.5*w[2],b}([],function(b,w,I){return b[0]=w[0]+I[0],b[1]=w[1]+I[1],b[2]=w[2]+I[2],b}([],this.min,this.max))}quadrant(a){const d=[a%2==0,a<2],b=U(this.min),w=U(this.max);for(let I=0;I<d.length;I++)b[I]=d[I]?this.min[I]:this.center[I],w[I]=d[I]?this.center[I]:this.max[I];return w[2]=this.max[2],new ol(b,w)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}intersects(a){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let b=!0;for(let w=0;w<a.planes.length;w++){const I=a.planes[w];let L=0;for(let F=0;F<d.length;F++)u.dot(I,d[F])>=0&&L++;if(L===0)return 0;L!==d.length&&(b=!1)}if(b)return 2;for(let w=0;w<3;w++){let I=Number.MAX_VALUE,L=-Number.MAX_VALUE;for(let F=0;F<a.points.length;F++){const j=a.points[F][w]-this.min[w];I=Math.min(I,j),L=Math.max(L,j)}if(L<0||I>this.max[w]-this.min[w])return 0}return 1}}class Ml{constructor(a=0,d=0,b=0,w=0){if(isNaN(a)||a<0||isNaN(d)||d<0||isNaN(b)||b<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=d,this.left=b,this.right=w}interpolate(a,d,b){return d.top!=null&&a.top!=null&&(this.top=u.interpolate.number(a.top,d.top,b)),d.bottom!=null&&a.bottom!=null&&(this.bottom=u.interpolate.number(a.bottom,d.bottom,b)),d.left!=null&&a.left!=null&&(this.left=u.interpolate.number(a.left,d.left,b)),d.right!=null&&a.right!=null&&(this.right=u.interpolate.number(a.right,d.right,b)),this}getCenter(a,d){const b=u.clamp((this.left+a-this.right)/2,0,a),w=u.clamp((this.top+d-this.bottom)/2,0,d);return new u.Point(b,w)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Ml(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class zs{constructor(a,d,b,w,I){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=I===void 0||!!I,this._minZoom=a||0,this._maxZoom=d||22,this._minPitch=b??0,this._maxPitch=w??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ml,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const a=new zs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.apply(this),a}apply(a){this.tileSize=a.tileSize,this.latRange=a.latRange,this.width=a.width,this.height=a.height,this._center=a._center,this._elevation=a._elevation,this._minEleveationForCurrentTile=a._minEleveationForCurrentTile,this.zoom=a.zoom,this.angle=a.angle,this._fov=a._fov,this._pitch=a._pitch,this._unmodified=a._unmodified,this._edgeInsets=a._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(a){const d=-u.wrap(a,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var b=new u.ARRAY_TYPE(4);return u.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}(),function(b,w,I){var L=w[0],F=w[1],j=w[2],Y=w[3],K=Math.sin(I),re=Math.cos(I);b[0]=L*re+j*K,b[1]=F*re+Y*K,b[2]=L*-K+j*re,b[3]=F*-K+Y*re}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const d=u.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(a){const d=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(a){a!==this._elevation&&(this._elevation=a,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,d,b){this._unmodified=!1,this._edgeInsets.interpolate(a,d,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const d=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(a){const d=[new u.UnwrappedTileID(0,a)];if(this._renderWorldCopies){const b=this.pointCoordinate(new u.Point(0,0)),w=this.pointCoordinate(new u.Point(this.width,0)),I=this.pointCoordinate(new u.Point(this.width,this.height)),L=this.pointCoordinate(new u.Point(0,this.height)),F=Math.floor(Math.min(b.x,w.x,I.x,L.x)),j=Math.floor(Math.max(b.x,w.x,I.x,L.x)),Y=1;for(let K=F-Y;K<=j+Y;K++)K!==0&&d.push(new u.UnwrappedTileID(K,a))}return d}coveringTiles(a){var d,b;let w=this.coveringZoomLevel(a);const I=w;if(a.minzoom!==void 0&&w<a.minzoom)return[];a.maxzoom!==void 0&&w>a.maxzoom&&(w=a.maxzoom);const L=this.pointCoordinate(this.getCameraPoint()),F=u.MercatorCoordinate.fromLngLat(this.center),j=Math.pow(2,w),Y=[j*L.x,j*L.y,0],K=[j*F.x,j*F.y,0],re=tu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,w);let me=a.minzoom||0;!a.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(me=w);const Me=a.terrain?2/Math.min(this.tileSize,a.tileSize)*this.tileSize:3,Te=je=>({aabb:new ol([je*j,0,0],[(je+1)*j,j,0]),zoom:0,x:0,y:0,wrap:je,fullyVisible:!1}),Fe=[],Ce=[],Je=w,at=a.reparseOverscaled?I:w;if(this._renderWorldCopies)for(let je=1;je<=3;je++)Fe.push(Te(-je)),Fe.push(Te(je));for(Fe.push(Te(0));Fe.length>0;){const je=Fe.pop(),tt=je.x,ut=je.y;let lt=je.fullyVisible;if(!lt){const lr=je.aabb.intersects(re);if(lr===0)continue;lt=lr===2}const bt=a.terrain?Y:K,St=je.aabb.distanceX(bt),wt=je.aabb.distanceY(bt),Mt=Math.max(Math.abs(St),Math.abs(wt));if(je.zoom===Je||Mt>Me+(1<<Je-je.zoom)-2&&je.zoom>=me){const lr=Je-je.zoom,Qr=Y[0]-.5-(tt<<lr),kt=Y[1]-.5-(ut<<lr);Ce.push({tileID:new u.OverscaledTileID(je.zoom===Je?at:je.zoom,je.wrap,je.zoom,tt,ut),distanceSq:ie([K[0]-.5-tt,K[1]-.5-ut]),tileDistanceToCamera:Math.sqrt(Qr*Qr+kt*kt)})}else for(let lr=0;lr<4;lr++){const Qr=(tt<<1)+lr%2,kt=(ut<<1)+(lr>>1),gr=je.zoom+1;let ar=je.aabb.quadrant(lr);if(a.terrain){const Ii=new u.OverscaledTileID(gr,je.wrap,gr,Qr,kt),en=a.terrain.getMinMaxElevation(Ii),_r=(d=en.minElevation)!==null&&d!==void 0?d:this.elevation,tn=(b=en.maxElevation)!==null&&b!==void 0?b:this.elevation;ar=new ol([ar.min[0],ar.min[1],_r],[ar.max[0],ar.max[1],tn])}Fe.push({aabb:ar,zoom:gr,x:Qr,y:kt,wrap:je.wrap,fullyVisible:lt})}}return Ce.sort((je,tt)=>je.distanceSq-tt.distanceSq).map(je=>je.tileID)}resize(a,d){this.width=a,this.height=d,this.pixelsToGLUnits=[2/a,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const d=u.clamp(a.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.Point(u.mercatorXfromLng(a.lng)*this.worldSize,u.mercatorYfromLat(d)*this.worldSize)}unproject(a){return new u.MercatorCoordinate(a.x/this.worldSize,a.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(a){const d=this.pointLocation(this.centerPoint,a),b=a.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-b))return;const w=this.getCameraPosition(),I=u.MercatorCoordinate.fromLngLat(w.lngLat,w.altitude),L=u.MercatorCoordinate.fromLngLat(d,b),F=I.x-L.x,j=I.y-L.y,Y=I.z-L.z,K=Math.sqrt(F*F+j*j+Y*Y),re=this.scaleZoom(this.cameraToCenterDistance/K/this.tileSize);this._elevation=b,this._center=d,this.zoom=re}setLocationAtPoint(a,d){const b=this.pointCoordinate(d),w=this.pointCoordinate(this.centerPoint),I=this.locationCoordinate(a),L=new u.MercatorCoordinate(I.x-(b.x-w.x),I.y-(b.y-w.y));this.center=this.coordinateLocation(L),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(a,d){return d?this.coordinatePoint(this.locationCoordinate(a),d.getElevationForLngLatZoom(a,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(a))}pointLocation(a,d){return this.coordinateLocation(this.pointCoordinate(a,d))}locationCoordinate(a){return u.MercatorCoordinate.fromLngLat(a)}coordinateLocation(a){return a&&a.toLngLat()}pointCoordinate(a,d){if(d){const me=d.pointCoordinate(a);if(me!=null)return me}const b=[a.x,a.y,0,1],w=[a.x,a.y,1,1];u.transformMat4(b,b,this.pixelMatrixInverse),u.transformMat4(w,w,this.pixelMatrixInverse);const I=b[3],L=w[3],F=b[1]/I,j=w[1]/L,Y=b[2]/I,K=w[2]/L,re=Y===K?0:(0-Y)/(K-Y);return new u.MercatorCoordinate(u.interpolate.number(b[0]/I,w[0]/L,re)/this.worldSize,u.interpolate.number(F,j,re)/this.worldSize)}coordinatePoint(a,d=0,b=this.pixelMatrix){const w=[a.x*this.worldSize,a.y*this.worldSize,d,1];return u.transformMat4(w,w,b),new u.Point(w[0]/w[3],w[1]/w[3])}getBounds(){const a=Math.max(0,this.height/2-this.getHorizon());return new ke().extend(this.pointLocation(new u.Point(0,a))).extend(this.pointLocation(new u.Point(this.width,a))).extend(this.pointLocation(new u.Point(this.width,this.height))).extend(this.pointLocation(new u.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ke([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(a,d=!1){const b=a.key,w=d?this._alignedPosMatrixCache:this._posMatrixCache;if(w[b])return w[b];const I=a.canonical,L=this.worldSize/this.zoomScale(I.z),F=I.x+Math.pow(2,I.z)*a.wrap,j=u.identity(new Float64Array(16));return u.translate(j,j,[F*L,I.y*L,0]),u.scale(j,j,[L/u.EXTENT,L/u.EXTENT,1]),u.multiply(j,d?this.alignedProjMatrix:this.projMatrix,j),w[b]=new Float32Array(j),w[b]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let a,d,b,w,I=-90,L=90,F=-180,j=180;const Y=this.size,K=this._unmodified;if(this.latRange){const Me=this.latRange;I=u.mercatorYfromLat(Me[1])*this.worldSize,L=u.mercatorYfromLat(Me[0])*this.worldSize,a=L-I<Y.y?Y.y/(L-I):0}if(this.lngRange){const Me=this.lngRange;F=u.wrap(u.mercatorXfromLng(Me[0])*this.worldSize,0,this.worldSize),j=u.wrap(u.mercatorXfromLng(Me[1])*this.worldSize,0,this.worldSize),j<F&&(j+=this.worldSize),d=j-F<Y.x?Y.x/(j-F):0}const re=this.point,me=Math.max(d||0,a||0);if(me)return this.center=this.unproject(new u.Point(d?(j+F)/2:re.x,a?(L+I)/2:re.y)),this.zoom+=this.scaleZoom(me),this._unmodified=K,void(this._constraining=!1);if(this.latRange){const Me=re.y,Te=Y.y/2;Me-Te<I&&(w=I+Te),Me+Te>L&&(w=L-Te)}if(this.lngRange){const Me=(F+j)/2,Te=u.wrap(re.x,Me-this.worldSize/2,Me+this.worldSize/2),Fe=Y.x/2;Te-Fe<F&&(b=F+Fe),Te+Fe>j&&(b=j-Fe)}b===void 0&&w===void 0||(this.center=this.unproject(new u.Point(b!==void 0?b:re.x,w!==void 0?w:re.y)).wrap()),this._unmodified=K,this._constraining=!1}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,d=this.point.x,b=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let w=u.identity(new Float64Array(16));u.scale(w,w,[this.width/2,-this.height/2,1]),u.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=u.identity(new Float64Array(16)),u.scale(w,w,[1,-1,1]),u.translate(w,w,[-1,-1,0]),u.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w;const I=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),L=Math.min(this.elevation,this._minEleveationForCurrentTile),F=I-L*this._pixelPerMeter/Math.cos(this._pitch),j=L<0?F:I,Y=Math.PI/2+this._pitch,K=this._fov*(.5+a.y/this.height),re=Math.sin(K)*j/Math.sin(u.clamp(Math.PI-Y-K,.01,Math.PI-.01)),me=this.getHorizon(),Me=2*Math.atan(me/this.cameraToCenterDistance)*(.5+a.y/(2*me)),Te=Math.sin(Me)*j/Math.sin(u.clamp(Math.PI-Y-Me,.01,Math.PI-.01)),Fe=Math.min(re,Te),Ce=1.01*(Math.cos(Math.PI/2-this._pitch)*Fe+j),Je=this.height/50;w=new Float64Array(16),u.perspective(w,this._fov,this.width/this.height,Je,Ce),w[8]=2*-a.x/this.width,w[9]=2*a.y/this.height,u.scale(w,w,[1,-1,1]),u.translate(w,w,[0,0,-this.cameraToCenterDistance]),u.rotateX(w,w,this._pitch),u.rotateZ(w,w,this.angle),u.translate(w,w,[-d,-b,0]),this.mercatorMatrix=u.scale([],w,[this.worldSize,this.worldSize,this.worldSize]),u.scale(w,w,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,w),u.translate(w,w,[0,0,-this.elevation]),this.projMatrix=w,this.invProjMatrix=u.invert([],w),this.pixelMatrix3D=u.multiply(new Float64Array(16),this.labelPlaneMatrix,w);const at=this.width%2/2,je=this.height%2/2,tt=Math.cos(this.angle),ut=Math.sin(this.angle),lt=d-Math.round(d)+tt*at+ut*je,bt=b-Math.round(b)+tt*je+ut*at,St=new Float64Array(w);if(u.translate(St,St,[lt>.5?lt-1:lt,bt>.5?bt-1:bt,0]),this.alignedProjMatrix=St,w=u.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");this.pixelMatrixInverse=w,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const a=this.pointCoordinate(new u.Point(0,0)),d=[a.x*this.worldSize,a.y*this.worldSize,0,1];return u.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.Point(0,a))}getCameraQueryGeometry(a){const d=this.getCameraPoint();if(a.length===1)return[a[0],d];{let b=d.x,w=d.y,I=d.x,L=d.y;for(const F of a)b=Math.min(b,F.x),w=Math.min(w,F.y),I=Math.max(I,F.x),L=Math.max(L,F.y);return[new u.Point(b,w),new u.Point(I,w),new u.Point(I,L),new u.Point(b,L),new u.Point(b,w)]}}}function yo(x,a){let d,b=!1,w=null,I=null;const L=()=>{w=null,b&&(x.apply(I,d),w=setTimeout(L,a),b=!1)};return(...F)=>(b=!0,I=this,d=F,w||L(),w)}class Vi{constructor(a){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let b;return d.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(b=w)}),(b&&b[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(b=>isNaN(b))){const b=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:b,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=yo(this._updateHashUnthrottled,300),this._hashName=a&&encodeURIComponent(a)}addTo(a){return this._map=a,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(a){const d=this._map.getCenter(),b=Math.round(100*this._map.getZoom())/100,w=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,w),L=Math.round(d.lng*I)/I,F=Math.round(d.lat*I)/I,j=this._map.getBearing(),Y=this._map.getPitch();let K="";if(K+=a?`/${L}/${F}/${b}`:`${b}/${F}/${L}`,(j||Y)&&(K+="/"+Math.round(10*j)/10),Y&&(K+=`/${Math.round(Y)}`),this._hashName){const re=this._hashName;let me=!1;const Me=window.location.hash.slice(1).split("&").map(Te=>{const Fe=Te.split("=")[0];return Fe===re?(me=!0,`${Fe}=${K}`):Te}).filter(Te=>Te);return me||Me.push(`${re}=${K}`),`#${Me.join("&")}`}return`#${K}`}}const js={linearity:.3,easing:u.bezier(0,0,.3,1)},ao=u.extend({deceleration:2500,maxSpeed:1400},js),Ya=u.extend({deceleration:20,maxSpeed:1400},js),ru=u.extend({deceleration:1e3,maxSpeed:360},js),ic=u.extend({deceleration:1e3,maxSpeed:90},js);class gs{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.browser.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,d=u.browser.now();for(;a.length>0&&d-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new u.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:I}of this._inertiaBuffer)d.zoom+=I.zoomDelta||0,d.bearing+=I.bearingDelta||0,d.pitch+=I.pitchDelta||0,I.panDelta&&d.pan._add(I.panDelta),I.around&&(d.around=I.around),I.pinchAround&&(d.pinchAround=I.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(d.pan.mag()){const I=Di(d.pan.mag(),b,u.extend({},ao,a||{}));w.offset=d.pan.mult(I.amount/d.pan.mag()),w.center=this._map.transform.center,Ma(w,I)}if(d.zoom){const I=Di(d.zoom,b,Ya);w.zoom=this._map.transform.zoom+I.amount,Ma(w,I)}if(d.bearing){const I=Di(d.bearing,b,ru);w.bearing=this._map.transform.bearing+u.clamp(I.amount,-179,179),Ma(w,I)}if(d.pitch){const I=Di(d.pitch,b,ic);w.pitch=this._map.transform.pitch+I.amount,Ma(w,I)}if(w.zoom||w.bearing){const I=d.pinchAround===void 0?d.around:d.pinchAround;w.around=I?this._map.unproject(I):this._map.getCenter()}return this.clear(),u.extend(w,{noMoveStart:!0})}}function Ma(x,a){(!x.duration||x.duration<a.duration)&&(x.duration=a.duration,x.easing=a.easing)}function Di(x,a,d){const{maxSpeed:b,linearity:w,deceleration:I}=d,L=u.clamp(x*w/(a/1e3),-b,b),F=Math.abs(L)/(I*w);return{easing:d.easing,duration:1e3*F,amount:L*(F/2)}}class Kr extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,b,w={}){const I=m.mousePos(d.getCanvasContainer(),b),L=d.unproject(I);super(a,u.extend({point:I,lngLat:L,originalEvent:b},w)),this._defaultPrevented=!1,this.target=d}}class Io extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,b){const w=a==="touchend"?b.changedTouches:b.touches,I=m.touchPos(d.getCanvasContainer(),w),L=I.map(j=>d.unproject(j)),F=I.reduce((j,Y,K,re)=>j.add(Y.div(re.length)),new u.Point(0,0));super(a,{points:I,point:F,lngLats:L,lngLat:d.unproject(F),originalEvent:b}),this._defaultPrevented=!1}}class gi extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,b){super(a,{originalEvent:b}),this._defaultPrevented=!1}}class al{constructor(a,d){this._map=a,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(a){return this._firePreventable(new gi(a.type,this._map,a))}mousedown(a,d){return this._mousedownPos=d,this._firePreventable(new Kr(a.type,this._map,a))}mouseup(a){this._map.fire(new Kr(a.type,this._map,a))}click(a,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new Kr(a.type,this._map,a))}dblclick(a){return this._firePreventable(new Kr(a.type,this._map,a))}mouseover(a){this._map.fire(new Kr(a.type,this._map,a))}mouseout(a){this._map.fire(new Kr(a.type,this._map,a))}touchstart(a){return this._firePreventable(new Io(a.type,this._map,a))}touchmove(a){this._map.fire(new Io(a.type,this._map,a))}touchend(a){this._map.fire(new Io(a.type,this._map,a))}touchcancel(a){this._map.fire(new Io(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nu{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(a){this._map.fire(new Kr(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Kr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._ignoreContextMenu||this._map.fire(new Kr(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ms{constructor(a){this._map=a}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(a){return this.transform.pointLocation(u.Point.convert(a),this._map.terrain)}}class to{constructor(a,d){this._map=a,this._tr=new ms(a),this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,d){this.isEnabled()&&a.shiftKey&&a.button===0&&(m.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(a,d){if(!this._active)return;const b=d;if(this._lastPos.equals(b)||!this._box&&b.dist(this._startPos)<this._clickTolerance)return;const w=this._startPos;this._lastPos=b,this._box||(this._box=m.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",a));const I=Math.min(w.x,b.x),L=Math.max(w.x,b.x),F=Math.min(w.y,b.y),j=Math.max(w.y,b.y);m.setTransform(this._box,`translate(${I}px,${F}px)`),this._box.style.width=L-I+"px",this._box.style.height=j-F+"px"}mouseupWindow(a,d){if(!this._active||a.button!==0)return;const b=this._startPos,w=d;if(this.reset(),m.suppressClick(),b.x!==w.x||b.y!==w.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:I=>I.fitScreenCoordinates(b,w,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",a)}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(m.remove(this._box),this._box=null),m.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(a,d){return this._map.fire(new u.Event(a,{originalEvent:d}))}}function Ni(x,a){if(x.length!==a.length)throw new Error(`The number of touches and points are not equal - touches ${x.length}, points ${a.length}`);const d={};for(let b=0;b<x.length;b++)d[x[b].identifier]=a[b];return d}class jo{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(a,d,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=a.timeStamp),b.length===this.numTouches&&(this.centroid=function(w){const I=new u.Point(0,0);for(const L of w)I._add(L);return I.div(w.length)}(d),this.touches=Ni(b,d)))}touchmove(a,d,b){if(this.aborted||!this.centroid)return;const w=Ni(b,d);for(const I in this.touches){const L=w[I];(!L||L.dist(this.touches[I])>30)&&(this.aborted=!0)}}touchend(a,d,b){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Pi{constructor(a){this.singleTap=new jo(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(a,d,b){this.singleTap.touchstart(a,d,b)}touchmove(a,d,b){this.singleTap.touchmove(a,d,b)}touchend(a,d,b){const w=this.singleTap.touchend(a,d,b);if(w){const I=a.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(w)<30;if(I&&L||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Yt{constructor(a){this._tr=new ms(a),this._zoomIn=new Pi({numTouches:1,numTaps:2}),this._zoomOut=new Pi({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,d,b){this._zoomIn.touchstart(a,d,b),this._zoomOut.touchstart(a,d,b)}touchmove(a,d,b){this._zoomIn.touchmove(a,d,b),this._zoomOut.touchmove(a,d,b)}touchend(a,d,b){const w=this._zoomIn.touchend(a,d,b),I=this._zoomOut.touchend(a,d,b),L=this._tr;return w?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:L.zoom+1,around:L.unproject(w)},{originalEvent:a})}):I?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:L.zoom-1,around:L.unproject(I)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wa{constructor(a){this._enabled=!!a.enable,this._moveStateManager=a.moveStateManager,this._clickTolerance=a.clickTolerance||1,this._moveFunction=a.move,this._activateOnStart=!!a.activateOnStart,a.assignEvents(this),this.reset()}reset(a){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(a)}_move(...a){const d=this._moveFunction(...a);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(a,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(a)&&(this._moveStateManager.startMove(a),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(a,d){if(!this.isEnabled())return;const b=this._lastPoint;if(!b)return;if(a.preventDefault(),!this._moveStateManager.isValidMoveEvent(a))return void this.reset(a);const w=d.length?d[0]:d;return!this._moved&&w.dist(b)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=w,this._move(b,w))}dragEnd(a){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(a)&&(this._moved&&m.suppressClick(),this.reset(a))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const La={0:1,2:2};class Fi{constructor(a){this._correctEvent=a.checkCorrectEvent}startMove(a){const d=m.mouseButton(a);this._eventButton=d}endMove(a){delete this._eventButton}isValidStartEvent(a){return this._correctEvent(a)}isValidMoveEvent(a){return!function(d,b){const w=La[b];return d.buttons===void 0||(d.buttons&w)!==w}(a,this._eventButton)}isValidEndEvent(a){return m.mouseButton(a)===this._eventButton}}class Ll{constructor(){this._firstTouch=void 0}_isOneFingerTouch(a){return a.targetTouches.length===1}_isSameTouchEvent(a){return a.targetTouches[0].identifier===this._firstTouch}startMove(a){this._firstTouch=a.targetTouches[0].identifier}endMove(a){delete this._firstTouch}isValidStartEvent(a){return this._isOneFingerTouch(a)}isValidMoveEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}isValidEndEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}}const It=x=>{x.mousedown=x.dragStart,x.mousemoveWindow=x.dragMove,x.mouseup=x.dragEnd,x.contextmenu=function(a){a.preventDefault()}},sl=({enable:x,clickTolerance:a,bearingDegreesPerPixelMoved:d=.8})=>{const b=new Fi({checkCorrectEvent:w=>m.mouseButton(w)===0&&w.ctrlKey||m.mouseButton(w)===2});return new Wa({clickTolerance:a,move:(w,I)=>({bearingDelta:(I.x-w.x)*d}),moveStateManager:b,enable:x,assignEvents:It})},Ra=({enable:x,clickTolerance:a,pitchDegreesPerPixelMoved:d=-.5})=>{const b=new Fi({checkCorrectEvent:w=>m.mouseButton(w)===0&&w.ctrlKey||m.mouseButton(w)===2});return new Wa({clickTolerance:a,move:(w,I)=>({pitchDelta:(I.y-w.y)*d}),moveStateManager:b,enable:x,assignEvents:It})};class Xi{constructor(a,d){this._minTouches=a.cooperativeGestures?2:1,this._clickTolerance=a.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(a,d,b){return this._calculateTransform(a,d,b)}touchmove(a,d,b){if(this._map._cooperativeGestures&&(this._minTouches===2&&b.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(a,!1,b.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(b.length<this._minTouches))return a.preventDefault(),this._calculateTransform(a,d,b)}touchend(a,d,b){this._calculateTransform(a,d,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,d,b){b.length>0&&(this._active=!0);const w=Ni(b,d),I=new u.Point(0,0),L=new u.Point(0,0);let F=0;for(const Y in w){const K=w[Y],re=this._touches[Y];re&&(I._add(K),L._add(K.sub(re)),F++,w[Y]=K)}if(this._touches=w,F<this._minTouches||!L.mag())return;const j=L.div(F);return this._sum._add(j),this._sum.mag()<this._clickTolerance?void 0:{around:I.div(F),panDelta:j}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(a,d,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([d[0],d[1]]))}touchmove(a,d,b){if(!this._firstTwoTouches)return;a.preventDefault();const[w,I]=this._firstTwoTouches,L=Za(b,d,w),F=Za(b,d,I);if(!L||!F)return;const j=this._aroundCenter?null:L.add(F).div(2);return this._move([L,F],j,a)}touchend(a,d,b){if(!this._firstTwoTouches)return;const[w,I]=this._firstTwoTouches,L=Za(b,d,w),F=Za(b,d,I);L&&F||(this._active&&m.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Za(x,a,d){for(let b=0;b<x.length;b++)if(x[b].identifier===d)return a[b]}function iu(x,a){return Math.log(x/a)/Math.LN2}class Ha extends Oo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,d){const b=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(iu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:iu(this._distance,b),pinchAround:d}}}function Su(x,a){return 180*x.angleWith(a)/Math.PI}class so extends Oo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,d){const b=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Su(this._vector,b),pinchAround:d}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const d=25/(Math.PI*this._minDiameter)*360,b=Su(a,this._startVector);return Math.abs(b)<d}}function ra(x){return Math.abs(x.y)>Math.abs(x.x)}class oi extends Oo{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(a,d,b){super.touchstart(a,d,b),this._currentTouchCount=b.length}_start(a){this._lastPoints=a,ra(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,d,b){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const w=a[0].sub(this._lastPoints[0]),I=a[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(w,I,b.timeStamp),this._valid?(this._lastPoints=a,this._active=!0,{pitchDelta:(w.y+I.y)/2*-.5}):void 0}gestureBeginsVertically(a,d,b){if(this._valid!==void 0)return this._valid;const w=a.mag()>=2,I=d.mag()>=2;if(!w&&!I)return;if(!w||!I)return this._firstMove===void 0&&(this._firstMove=b),b-this._firstMove<100&&void 0;const L=a.y>0==d.y>0;return ra(a)&&ra(d)&&L}}const oc={panStep:100,bearingStep:15,pitchStep:10};class na{constructor(a){this._tr=new ms(a);const d=oc;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let d=0,b=0,w=0,I=0,L=0;switch(a.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:a.shiftKey?b=-1:(a.preventDefault(),I=-1);break;case 39:a.shiftKey?b=1:(a.preventDefault(),I=1);break;case 38:a.shiftKey?w=1:(a.preventDefault(),L=-1);break;case 40:a.shiftKey?w=-1:(a.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(b=0,w=0),{cameraAnimation:F=>{const j=this._tr;F.easeTo({duration:300,easeId:"keyboardHandler",easing:yi,zoom:d?Math.round(j.zoom)+d*(a.shiftKey?2:1):j.zoom,bearing:j.bearing+b*this._bearingStep,pitch:j.pitch+w*this._pitchStep,offset:[-I*this._panStep,-L*this._panStep],center:j.center},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function yi(x){return x*(2-x)}const vs=4.000244140625;class Rl{constructor(a,d){this._onTimeout=b=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(b)},this._map=a,this._tr=new ms(a),this._el=a.getCanvasContainer(),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!a[this._map._metaKey])return;a.preventDefault()}let d=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const b=u.browser.now(),w=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,d!==0&&d%vs==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(w*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),a.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=a,this._delta-=d,this._active||this._start(a)),a.preventDefault()}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=m.mousePos(this._el,a),b=this._tr;this._around=u.LngLat.convert(this._aroundCenter?b.center:b.unproject(d)),this._aroundPoint=b.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._tr.transform;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>vs?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&j!==0&&(j=1/j);const Y=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(Y*j))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,b=this._startZoom,w=this._easing;let I,L=!1;if(this._type==="wheel"&&b&&w){const F=Math.min((u.browser.now()-this._lastWheelEventTime)/200,1),j=w(F);I=u.interpolate.number(b,d,j),F<1?this._frameId||(this._frameId=!0):L=!0}else I=d,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:I-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let d=u.defaultEasing;if(this._prevEase){const b=this._prevEase,w=(u.browser.now()-b.start)/b.duration,I=b.easing(w+.01)-b.easing(w),L=.27/Math.sqrt(I*I+1e-4)*.01,F=Math.sqrt(.0729-L*L);d=u.bezier(L,F,.25,1)}return this._prevEase={start:u.browser.now(),duration:a,easing:d},d}reset(){this._active=!1}}class ou{constructor(a,d){this._clickZoom=a,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ys{constructor(a){this._tr=new ms(a),this.reset()}reset(){this._active=!1}dblclick(a,d){return a.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:this._tr.zoom+(a.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ki{constructor(){this._tap=new Pi({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(a,d,b){if(!this._swipePoint)if(this._tapTime){const w=d[0],I=a.timeStamp-this._tapTime<500,L=this._tapPoint.dist(w)<30;I&&L?b.length>0&&(this._swipePoint=w,this._swipeTouch=b[0].identifier):this.reset()}else this._tap.touchstart(a,d,b)}touchmove(a,d,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const w=d[0],I=w.y-this._swipePoint.y;return this._swipePoint=w,a.preventDefault(),this._active=!0,{zoomDelta:I/128}}}else this._tap.touchmove(a,d,b)}touchend(a,d,b){if(this._tapTime)this._swipePoint&&b.length===0&&this.reset();else{const w=this._tap.touchend(a,d,b);w&&(this._tapTime=a.timeStamp,this._tapPoint=w)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jn{constructor(a,d,b){this._el=a,this._mousePan=d,this._touchPan=b}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Kn{constructor(a,d,b){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=d,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class uo{constructor(a,d,b,w){this._el=a,this._touchZoom=d,this._touchRotate=b,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Pu=x=>x.zoom||x.drag||x.pitch||x.rotate;class Dl extends u.Event{}function Ai(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class Ch{constructor(a,d){this.handleWindowEvent=w=>{this.handleEvent(w,`${w.type}Window`)},this.handleEvent=(w,I)=>{if(w.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const L=w.type==="renderFrame"?void 0:w,F={needsRenderFrame:!1},j={},Y={},K=w.touches,re=K?this._getMapTouches(K):void 0,me=re?m.touchPos(this._el,re):m.mousePos(this._el,w);for(const{handlerName:Fe,handler:Ce,allowed:Je}of this._handlers){if(!Ce.isEnabled())continue;let at;this._blockedByActive(Y,Je,Fe)?Ce.reset():Ce[I||w.type]&&(at=Ce[I||w.type](w,me,re),this.mergeHandlerResult(F,j,at,Fe,L),at&&at.needsRenderFrame&&this._triggerRenderFrame()),(at||Ce.isActive())&&(Y[Fe]=Ce)}const Me={};for(const Fe in this._previousActiveHandlers)Y[Fe]||(Me[Fe]=L);this._previousActiveHandlers=Y,(Object.keys(Me).length||Ai(F))&&(this._changes.push([F,j,Me]),this._triggerRenderFrame()),(Object.keys(Y).length||Ai(F))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Te}=F;Te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Te(this._map))},this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gs(a),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,I,L]of this._listeners)m.addEventListener(w,I,w===document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[a,d,b]of this._listeners)m.removeEventListener(a,d,a===document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(a){const d=this._map,b=d.getCanvasContainer();this._add("mapEvent",new al(d,a));const w=d.boxZoom=new to(d,a);this._add("boxZoom",w),a.interactive&&a.boxZoom&&w.enable();const I=new Yt(d),L=new ys(d);d.doubleClickZoom=new ou(L,I),this._add("tapZoom",I),this._add("clickZoom",L),a.interactive&&a.doubleClickZoom&&d.doubleClickZoom.enable();const F=new ki;this._add("tapDragZoom",F);const j=d.touchPitch=new oi(d);this._add("touchPitch",j),a.interactive&&a.touchPitch&&d.touchPitch.enable(a.touchPitch);const Y=sl(a),K=Ra(a);d.dragRotate=new Kn(a,Y,K),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",K,["mouseRotate"]),a.interactive&&a.dragRotate&&d.dragRotate.enable();const re=(({enable:Je,clickTolerance:at})=>{const je=new Fi({checkCorrectEvent:tt=>m.mouseButton(tt)===0&&!tt.ctrlKey});return new Wa({clickTolerance:at,move:(tt,ut)=>({around:ut,panDelta:ut.sub(tt)}),activateOnStart:!0,moveStateManager:je,enable:Je,assignEvents:It})})(a),me=new Xi(a,d);d.dragPan=new Jn(b,re,me),this._add("mousePan",re),this._add("touchPan",me,["touchZoom","touchRotate"]),a.interactive&&a.dragPan&&d.dragPan.enable(a.dragPan);const Me=new so,Te=new Ha;d.touchZoomRotate=new uo(b,Te,Me,F),this._add("touchRotate",Me,["touchPan","touchZoom"]),this._add("touchZoom",Te,["touchPan","touchRotate"]),a.interactive&&a.touchZoomRotate&&d.touchZoomRotate.enable(a.touchZoomRotate);const Fe=d.scrollZoom=new Rl(d,()=>this._triggerRenderFrame());this._add("scrollZoom",Fe,["mousePan"]),a.interactive&&a.scrollZoom&&d.scrollZoom.enable(a.scrollZoom);const Ce=d.keyboard=new na(d);this._add("keyboard",Ce),a.interactive&&a.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new nu(d))}_add(a,d,b){this._handlers.push({handlerName:a,handler:d,allowed:b}),this._handlersById[a]=d}stop(a){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Pu(this._eventsInProgress)||this.isZooming()}_blockedByActive(a,d,b){for(const w in a)if(w!==b&&(!d||d.indexOf(w)<0))return!0;return!1}_getMapTouches(a){const d=[];for(const b of a)this._el.contains(b.target)&&d.push(b);return d}mergeHandlerResult(a,d,b,w,I){if(!b)return;u.extend(a,b);const L={handlerName:w,originalEvent:b.originalEvent||I};b.zoomDelta!==void 0&&(d.zoom=L),b.panDelta!==void 0&&(d.drag=L),b.pitchDelta!==void 0&&(d.pitch=L),b.bearingDelta!==void 0&&(d.rotate=L)}_applyChanges(){const a={},d={},b={};for(const[w,I,L]of this._changes)w.panDelta&&(a.panDelta=(a.panDelta||new u.Point(0,0))._add(w.panDelta)),w.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(a.around=w.around),w.pinchAround!==void 0&&(a.pinchAround=w.pinchAround),w.noInertia&&(a.noInertia=w.noInertia),u.extend(d,I),u.extend(b,L);this._updateMapTransform(a,d,b),this._changes=[]}_updateMapTransform(a,d,b){const w=this._map,I=w._getTransformForUpdate(),L=w.terrain;if(!(Ai(a)||L&&this._terrainMovement))return this._fireEvents(d,b,!0);let{panDelta:F,zoomDelta:j,bearingDelta:Y,pitchDelta:K,around:re,pinchAround:me}=a;me!==void 0&&(re=me),w._stop(!0),re=re||w.transform.centerPoint;const Me=I.pointLocation(F?re.sub(F):re);Y&&(I.bearing+=Y),K&&(I.pitch+=K),j&&(I.zoom+=j),L?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?I.center=I.pointLocation(I.centerPoint.sub(F)):I.setLocationAtPoint(Me,re):(this._terrainMovement=!0,this._map._elevationFreeze=!0,I.setLocationAtPoint(Me,re),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,I.recalculateZoom(w.terrain)})):I.setLocationAtPoint(Me,re),w._applyUpdatedTransform(I),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(d,b,!0)}_fireEvents(a,d,b){const w=Pu(this._eventsInProgress),I=Pu(a),L={};for(const K in a){const{originalEvent:re}=a[K];this._eventsInProgress[K]||(L[`${K}start`]=re),this._eventsInProgress[K]=a[K]}!w&&I&&this._fireEvent("movestart",I.originalEvent);for(const K in L)this._fireEvent(K,L[K]);I&&this._fireEvent("move",I.originalEvent);for(const K in a){const{originalEvent:re}=a[K];this._fireEvent(K,re)}const F={};let j;for(const K in this._eventsInProgress){const{handlerName:re,originalEvent:me}=this._eventsInProgress[K];this._handlersById[re].isActive()||(delete this._eventsInProgress[K],j=d[re]||me,F[`${K}end`]=j)}for(const K in F)this._fireEvent(K,F[K]);const Y=Pu(this._eventsInProgress);if(b&&(w||I)&&!Y){this._updatingCamera=!0;const K=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=me=>me!==0&&-this._bearingSnap<me&&me<this._bearingSnap;K?(re(K.bearing||this._map.getBearing())&&(K.bearing=0),K.freezeElevation=!0,this._map.easeTo(K,{originalEvent:j})):(this._map.fire(new u.Event("moveend",{originalEvent:j})),re(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,d){this._map.fire(new u.Event(a,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{delete this._frameId,this.handleEvent(new Dl("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class _s extends u.Evented{constructor(a,d){super(),this._renderFrameCallback=()=>{const b=Math.min((u.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,d){return this.jumpTo({center:a},d)}panBy(a,d,b){return a=u.Point.convert(a).mult(-1),this.panTo(this.transform.center,u.extend({offset:a},d),b)}panTo(a,d,b){return this.easeTo(u.extend({center:a},d),b)}getZoom(){return this.transform.zoom}setZoom(a,d){return this.jumpTo({zoom:a},d),this}zoomTo(a,d,b){return this.easeTo(u.extend({zoom:a},d),b)}zoomIn(a,d){return this.zoomTo(this.getZoom()+1,a,d),this}zoomOut(a,d){return this.zoomTo(this.getZoom()-1,a,d),this}getBearing(){return this.transform.bearing}setBearing(a,d){return this.jumpTo({bearing:a},d),this}getPadding(){return this.transform.padding}setPadding(a,d){return this.jumpTo({padding:a},d),this}rotateTo(a,d,b){return this.easeTo(u.extend({bearing:a},d),b)}resetNorth(a,d){return this.rotateTo(0,u.extend({duration:1e3},a),d),this}resetNorthPitch(a,d){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},a),d),this}snapToNorth(a,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,d):this}getPitch(){return this.transform.pitch}setPitch(a,d){return this.jumpTo({pitch:a},d),this}cameraForBounds(a,d){a=ke.convert(a);const b=d&&d.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),b,d)}_cameraForBoxAndBearing(a,d,b,w){const I={top:0,bottom:0,right:0,left:0};if(typeof(w=u.extend({padding:I,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){const ut=w.padding;w.padding={top:ut,bottom:ut,right:ut,left:ut}}w.padding=u.extend(I,w.padding);const L=this.transform,F=L.padding,j=L.project(u.LngLat.convert(a)),Y=L.project(u.LngLat.convert(d)),K=j.rotate(-b*Math.PI/180),re=Y.rotate(-b*Math.PI/180),me=new u.Point(Math.max(K.x,re.x),Math.max(K.y,re.y)),Me=new u.Point(Math.min(K.x,re.x),Math.min(K.y,re.y)),Te=me.sub(Me),Fe=(L.width-(F.left+F.right+w.padding.left+w.padding.right))/Te.x,Ce=(L.height-(F.top+F.bottom+w.padding.top+w.padding.bottom))/Te.y;if(Ce<0||Fe<0)return void u.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Je=Math.min(L.scaleZoom(L.scale*Math.min(Fe,Ce)),w.maxZoom),at=u.Point.convert(w.offset),je=new u.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(b*Math.PI/180),tt=at.add(je).mult(L.scale/L.zoomScale(Je));return{center:L.unproject(j.add(Y).div(2).sub(tt)),zoom:Je,bearing:b}}fitBounds(a,d,b){return this._fitInternal(this.cameraForBounds(a,d),d,b)}fitScreenCoordinates(a,d,b,w,I){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.Point.convert(a)),this.transform.pointLocation(u.Point.convert(d)),b,w),w,I)}_fitInternal(a,d,b){return a?(delete(d=u.extend(a,d)).padding,d.linear?this.easeTo(d,b):this.flyTo(d,b)):this}jumpTo(a,d){this.stop();const b=this._getTransformForUpdate();let w=!1,I=!1,L=!1;return"zoom"in a&&b.zoom!==+a.zoom&&(w=!0,b.zoom=+a.zoom),a.center!==void 0&&(b.center=u.LngLat.convert(a.center)),"bearing"in a&&b.bearing!==+a.bearing&&(I=!0,b.bearing=+a.bearing),"pitch"in a&&b.pitch!==+a.pitch&&(L=!0,b.pitch=+a.pitch),a.padding==null||b.isPaddingEqual(a.padding)||(b.padding=a.padding),this._applyUpdatedTransform(b),this.fire(new u.Event("movestart",d)).fire(new u.Event("move",d)),w&&this.fire(new u.Event("zoomstart",d)).fire(new u.Event("zoom",d)).fire(new u.Event("zoomend",d)),I&&this.fire(new u.Event("rotatestart",d)).fire(new u.Event("rotate",d)).fire(new u.Event("rotateend",d)),L&&this.fire(new u.Event("pitchstart",d)).fire(new u.Event("pitch",d)).fire(new u.Event("pitchend",d)),this.fire(new u.Event("moveend",d))}calculateCameraOptionsFromTo(a,d,b,w=0){const I=u.MercatorCoordinate.fromLngLat(a,d),L=u.MercatorCoordinate.fromLngLat(b,w),F=L.x-I.x,j=L.y-I.y,Y=L.z-I.z,K=Math.hypot(F,j,Y);if(K===0)throw new Error("Can't calculate camera options with same From and To");const re=Math.hypot(F,j),me=this.transform.scaleZoom(this.transform.cameraToCenterDistance/K/this.transform.tileSize),Me=180*Math.atan2(F,-j)/Math.PI;let Te=180*Math.acos(re/K)/Math.PI;return Te=Y<0?90-Te:90+Te,{center:L.toLngLat(),zoom:me,pitch:Te,bearing:Me}}easeTo(a,d){this._stop(!1,a.easeId),((a=u.extend({offset:[0,0],duration:500,easing:u.defaultEasing},a)).animate===!1||!a.essential&&u.browser.prefersReducedMotion)&&(a.duration=0);const b=this._getTransformForUpdate(),w=this.getZoom(),I=this.getBearing(),L=this.getPitch(),F=this.getPadding(),j="zoom"in a?+a.zoom:w,Y="bearing"in a?this._normalizeBearing(a.bearing,I):I,K="pitch"in a?+a.pitch:L,re="padding"in a?a.padding:b.padding,me=u.Point.convert(a.offset);let Me=b.centerPoint.add(me);const Te=b.pointLocation(Me),Fe=u.LngLat.convert(a.center||Te);this._normalizeCenter(Fe);const Ce=b.project(Te),Je=b.project(Fe).sub(Ce),at=b.zoomScale(j-w);let je,tt;a.around&&(je=u.LngLat.convert(a.around),tt=b.locationPoint(je));const ut={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||j!==w,this._rotating=this._rotating||I!==Y,this._pitching=this._pitching||K!==L,this._padding=!b.isPaddingEqual(re),this._easeId=a.easeId,this._prepareEase(d,a.noMoveStart,ut),this.terrain&&this._prepareElevation(Fe),this._ease(lt=>{if(this._zooming&&(b.zoom=u.interpolate.number(w,j,lt)),this._rotating&&(b.bearing=u.interpolate.number(I,Y,lt)),this._pitching&&(b.pitch=u.interpolate.number(L,K,lt)),this._padding&&(b.interpolatePadding(F,re,lt),Me=b.centerPoint.add(me)),this.terrain&&!a.freezeElevation&&this._updateElevation(lt),je)b.setLocationAtPoint(je,tt);else{const bt=b.zoomScale(b.zoom-w),St=j>w?Math.min(2,at):Math.max(.5,at),wt=Math.pow(St,1-lt),Mt=b.unproject(Ce.add(Je.mult(lt*wt)).mult(bt));b.setLocationAtPoint(b.renderWorldCopies?Mt.wrap():Mt,Me)}this._applyUpdatedTransform(b),this._fireMoveEvents(d)},lt=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,lt)},a),this}_prepareEase(a,d,b={}){this._moving=!0,d||b.moving||this.fire(new u.Event("movestart",a)),this._zooming&&!b.zooming&&this.fire(new u.Event("zoomstart",a)),this._rotating&&!b.rotating&&this.fire(new u.Event("rotatestart",a)),this._pitching&&!b.pitching&&this.fire(new u.Event("pitchstart",a))}_prepareElevation(a){this._elevationCenter=a,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(a){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(a<1&&d!==this._elevationTarget){const b=this._elevationTarget-this._elevationStart;this._elevationStart+=a*(b-(d-(b*a+this._elevationStart))/(1-a)),this._elevationTarget=d}this.transform.elevation=u.interpolate.number(this._elevationStart,this._elevationTarget,a)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(a){if(!this.transformCameraUpdate)return;const d=a.clone(),{center:b,zoom:w,pitch:I,bearing:L,elevation:F}=this.transformCameraUpdate(d);b&&(d.center=b),w!==void 0&&(d.zoom=w),I!==void 0&&(d.pitch=I),L!==void 0&&(d.bearing=L),F!==void 0&&(d.elevation=F),this.transform.apply(d)}_fireMoveEvents(a){this.fire(new u.Event("move",a)),this._zooming&&this.fire(new u.Event("zoom",a)),this._rotating&&this.fire(new u.Event("rotate",a)),this._pitching&&this.fire(new u.Event("pitch",a))}_afterEase(a,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const b=this._zooming,w=this._rotating,I=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new u.Event("zoomend",a)),w&&this.fire(new u.Event("rotateend",a)),I&&this.fire(new u.Event("pitchend",a)),this.fire(new u.Event("moveend",a))}flyTo(a,d){if(!a.essential&&u.browser.prefersReducedMotion){const ar=u.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ar,d)}this.stop(),a=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.defaultEasing},a);const b=this._getTransformForUpdate(),w=this.getZoom(),I=this.getBearing(),L=this.getPitch(),F=this.getPadding(),j="zoom"in a?u.clamp(+a.zoom,b.minZoom,b.maxZoom):w,Y="bearing"in a?this._normalizeBearing(a.bearing,I):I,K="pitch"in a?+a.pitch:L,re="padding"in a?a.padding:b.padding,me=b.zoomScale(j-w),Me=u.Point.convert(a.offset);let Te=b.centerPoint.add(Me);const Fe=b.pointLocation(Te),Ce=u.LngLat.convert(a.center||Fe);this._normalizeCenter(Ce);const Je=b.project(Fe),at=b.project(Ce).sub(Je);let je=a.curve;const tt=Math.max(b.width,b.height),ut=tt/me,lt=at.mag();if("minZoom"in a){const ar=u.clamp(Math.min(a.minZoom,w,j),b.minZoom,b.maxZoom),Ii=tt/b.zoomScale(ar-w);je=Math.sqrt(Ii/lt*2)}const bt=je*je;function St(ar){const Ii=(ut*ut-tt*tt+(ar?-1:1)*bt*bt*lt*lt)/(2*(ar?ut:tt)*bt*lt);return Math.log(Math.sqrt(Ii*Ii+1)-Ii)}function wt(ar){return(Math.exp(ar)-Math.exp(-ar))/2}function Mt(ar){return(Math.exp(ar)+Math.exp(-ar))/2}const lr=St(!1);let Qr=function(ar){return Mt(lr)/Mt(lr+je*ar)},kt=function(ar){return tt*((Mt(lr)*(wt(Ii=lr+je*ar)/Mt(Ii))-wt(lr))/bt)/lt;var Ii},gr=(St(!0)-lr)/je;if(Math.abs(lt)<1e-6||!isFinite(gr)){if(Math.abs(tt-ut)<1e-6)return this.easeTo(a,d);const ar=ut<tt?-1:1;gr=Math.abs(Math.log(ut/tt))/je,kt=function(){return 0},Qr=function(Ii){return Math.exp(ar*je*Ii)}}return a.duration="duration"in a?+a.duration:1e3*gr/("screenSpeed"in a?+a.screenSpeed/je:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this._zooming=!0,this._rotating=I!==Y,this._pitching=K!==L,this._padding=!b.isPaddingEqual(re),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(Ce),this._ease(ar=>{const Ii=ar*gr,en=1/Qr(Ii);b.zoom=ar===1?j:w+b.scaleZoom(en),this._rotating&&(b.bearing=u.interpolate.number(I,Y,ar)),this._pitching&&(b.pitch=u.interpolate.number(L,K,ar)),this._padding&&(b.interpolatePadding(F,re,ar),Te=b.centerPoint.add(Me)),this.terrain&&!a.freezeElevation&&this._updateElevation(ar);const _r=ar===1?Ce:b.unproject(Je.add(at.mult(kt(Ii))).mult(en));b.setLocationAtPoint(b.renderWorldCopies?_r.wrap():_r,Te),this._applyUpdatedTransform(b),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,d)}if(!a){const b=this.handlers;b&&b.stop(!1)}return this}_ease(a,d,b){b.animate===!1||b.duration===0?(a(1),d()):(this._easeStart=u.browser.now(),this._easeOptions=b,this._onEaseFrame=a,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(a,d){a=u.wrap(a,-180,180);const b=Math.abs(a-d);return Math.abs(a-360-d)<b&&(a-=360),Math.abs(a+360-d)<b&&(a+=360),a}_normalizeCenter(a){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const b=a.lng-d.center.lng;a.lng+=b>180?-360:b<-180?360:0}queryTerrainElevation(a){return this.terrain?this.terrain.getElevationForLngLatZoom(u.LngLat.convert(a),this.transform.tileZoom)-this.transform.elevation:null}}class Ja{constructor(a={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=a}getDefaultPosition(){return"bottom-right"}onAdd(a){return this._map=a,this._compact=this.options&&this.options.compact,this._container=m.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=m.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=m.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){m.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(a,d){const b=this._map._getUIString(`AttributionControl.${d}`);a.title=b,a.setAttribute("aria-label",b)}_updateAttributions(){if(!this._map.style)return;let a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(w=>typeof w!="string"?"":w)):typeof this.options.customAttribution=="string"&&a.push(this.options.customAttribution)),this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const d=this._map.style.sourceCaches;for(const w in d){const I=d[w];if(I.used||I.usedForTerrain){const L=I.getSource();L.attribution&&a.indexOf(L.attribution)<0&&a.push(L.attribution)}}a=a.filter(w=>String(w).trim()),a.sort((w,I)=>w.length-I.length),a=a.filter((w,I)=>{for(let L=I+1;L<a.length;L++)if(a[L].indexOf(w)>=0)return!1;return!0});const b=a.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,a.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class au{constructor(a={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const b=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&b.classList.add("maplibregl-compact"):b.classList.remove("maplibregl-compact")}},this.options=a}getDefaultPosition(){return"bottom-left"}onAdd(a){this._map=a,this._compact=this.options&&this.options.compact,this._container=m.create("div","maplibregl-ctrl");const d=m.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){m.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class fr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const d=++this._id;return this._queue.push({callback:a,id:d,cancelled:!1}),d}remove(a){const d=this._currentlyRunning,b=d?this._queue.concat(d):this._queue;for(const w of b)if(w.id===a)return void(w.cancelled=!0)}run(a=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const b of d)if(!b.cancelled&&(b.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Er={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var ma=u.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class Au extends u.Evented{constructor(a){super(),this.sourceCache=a,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,a.usedForTerrain=!0,a.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(a,d){this.sourceCache.update(a,d),this._renderableTilesKeys=[];const b={};for(const w of a.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))b[w.key]=!0,this._renderableTilesKeys.push(w.key),this._tiles[w.key]||(w.posMatrix=new Float64Array(16),u.ortho(w.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),this._tiles[w.key]=new rt(w,this.tileSize));for(const w in this._tiles)b[w]||delete this._tiles[w]}freeRtt(a){for(const d in this._tiles){const b=this._tiles[d];(!a||b.tileID.equals(a)||b.tileID.isChildOf(a)||a.isChildOf(b.tileID))&&(b.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(a=>this.getTileByID(a))}getTileByID(a){return this._tiles[a]}getTerrainCoords(a){const d={};for(const b of this._renderableTilesKeys){const w=this._tiles[b].tileID;if(w.canonical.equals(a.canonical)){const I=a.clone();I.posMatrix=new Float64Array(16),u.ortho(I.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),d[b]=I}else if(w.canonical.isChildOf(a.canonical)){const I=a.clone();I.posMatrix=new Float64Array(16);const L=w.canonical.z-a.canonical.z,F=w.canonical.x-(w.canonical.x>>L<<L),j=w.canonical.y-(w.canonical.y>>L<<L),Y=u.EXTENT>>L;u.ortho(I.posMatrix,0,Y,0,Y,0,1),u.translate(I.posMatrix,I.posMatrix,[-F*Y,-j*Y,0]),d[b]=I}else if(a.canonical.isChildOf(w.canonical)){const I=a.clone();I.posMatrix=new Float64Array(16);const L=a.canonical.z-w.canonical.z,F=a.canonical.x-(a.canonical.x>>L<<L),j=a.canonical.y-(a.canonical.y>>L<<L),Y=u.EXTENT>>L;u.ortho(I.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),u.translate(I.posMatrix,I.posMatrix,[F*Y,j*Y,0]),u.scale(I.posMatrix,I.posMatrix,[1/2**L,1/2**L,0]),d[b]=I}}return d}getSourceTile(a,d){const b=this.sourceCache._source;let w=a.overscaledZ-this.deltaZoom;if(w>b.maxzoom&&(w=b.maxzoom),w<b.minzoom)return null;this._sourceTileCache[a.key]||(this._sourceTileCache[a.key]=a.scaledTo(w).key);let I=this.sourceCache.getTileByID(this._sourceTileCache[a.key]);if((!I||!I.dem)&&d)for(;w>=b.minzoom&&(!I||!I.dem);)I=this.sourceCache.getTileByID(a.scaledTo(w--).key);return I}tilesAfterTime(a=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=a)}}class Iu{constructor(a,d,b){this.painter=a,this.sourceCache=new Au(d),this.options=b,this.exaggeration=typeof b.exaggeration=="number"?b.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(a,d,b,w=u.EXTENT){var I;if(!(d>=0&&d<w&&b>=0&&b<w))return 0;const L=this.getTerrainData(a),F=(I=L.tile)===null||I===void 0?void 0:I.dem;if(!F)return 0;const j=function(Te,Fe,Ce){var Je=Fe[0],at=Fe[1];return Te[0]=Ce[0]*Je+Ce[4]*at+Ce[12],Te[1]=Ce[1]*Je+Ce[5]*at+Ce[13],Te}([],[d/w*u.EXTENT,b/w*u.EXTENT],L.u_terrain_matrix),Y=[j[0]*F.dim,j[1]*F.dim],K=Math.floor(Y[0]),re=Math.floor(Y[1]),me=Y[0]-K,Me=Y[1]-re;return F.get(K,re)*(1-me)*(1-Me)+F.get(K+1,re)*me*(1-Me)+F.get(K,re+1)*(1-me)*Me+F.get(K+1,re+1)*me*Me}getElevationForLngLatZoom(a,d){const{tileID:b,mercatorX:w,mercatorY:I}=this._getOverscaledTileIDFromLngLatZoom(a,d);return this.getElevation(b,w%u.EXTENT,I%u.EXTENT,u.EXTENT)}getElevation(a,d,b,w=u.EXTENT){return this.getDEMElevation(a,d,b,w)*this.exaggeration}getTerrainData(a){if(!this._emptyDemTexture){const w=this.painter.context,I=new u.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new J(w,I,w.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new J(w,new u.RGBAImage({width:1,height:1}),w.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(w.gl.NEAREST,w.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.identity([])}const d=this.sourceCache.getSourceTile(a,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const w=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new J(w,d.dem.getPixels(),w.gl.RGBA,{premultiply:!1}),d.demTexture.bind(w.gl.NEAREST,w.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const b=d&&d+d.tileID.key+a.key;if(b&&!this._demMatrixCache[b]){const w=this.sourceCache.sourceCache._source.maxzoom;let I=a.canonical.z-d.tileID.canonical.z;a.overscaledZ>a.canonical.z&&(a.canonical.z>=w?I=a.canonical.z-w:u.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const L=a.canonical.x-(a.canonical.x>>I<<I),F=a.canonical.y-(a.canonical.y>>I<<I),j=u.fromScaling(new Float64Array(16),[1/(u.EXTENT<<I),1/(u.EXTENT<<I),0]);u.translate(j,j,[L*u.EXTENT,F*u.EXTENT,0]),this._demMatrixCache[a.key]={matrix:j,coord:a}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:b?this._demMatrixCache[a.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(a){const d=this.painter,b=d.width/devicePixelRatio,w=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===b&&this._fbo.height===w||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new J(d.context,{width:b,height:w,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new J(d.context,{width:b,height:w,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(b,w,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,b,w))),this._fbo.colorAttachment.set(a==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const a=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let I=0,L=0;I<this._coordsTextureSize;I++)for(let F=0;F<this._coordsTextureSize;F++,L+=4)d[L+0]=255&F,d[L+1]=255&I,d[L+2]=F>>8<<4|I>>8,d[L+3]=0;const b=new u.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),w=new J(a,b,a.gl.RGBA,{premultiply:!1});return w.bind(a.gl.NEAREST,a.gl.CLAMP_TO_EDGE),this._coordsTexture=w,w}pointCoordinate(a){const d=new Uint8Array(4),b=this.painter.context,w=b.gl;b.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),w.readPixels(a.x,this.painter.height/devicePixelRatio-a.y-1,1,1,w.RGBA,w.UNSIGNED_BYTE,d),b.bindFramebuffer.set(null);const I=d[0]+(d[2]>>4<<8),L=d[1]+((15&d[2])<<8),F=this.coordsIndex[255-d[3]],j=F&&this.sourceCache.getTileByID(F);if(!j)return null;const Y=this._coordsTextureSize,K=(1<<j.tileID.canonical.z)*Y;return new u.MercatorCoordinate((j.tileID.canonical.x*Y+I)/K,(j.tileID.canonical.y*Y+L)/K,this.getElevation(j.tileID,I,L,Y))}getTerrainMesh(){if(this._mesh)return this._mesh;const a=this.painter.context,d=new u.Pos3dArray,b=new u.TriangleIndexArray,w=this.meshSize,I=u.EXTENT/w,L=w*w;for(let re=0;re<=w;re++)for(let me=0;me<=w;me++)d.emplaceBack(me*I,re*I,0);for(let re=0;re<L;re+=w+1)for(let me=0;me<w;me++)b.emplaceBack(me+re,w+me+re+1,w+me+re+2),b.emplaceBack(me+re,w+me+re+2,me+re+1);const F=d.length,j=F+2*(w+1);for(const re of[0,1])for(let me=0;me<=w;me++)for(const Me of[0,1])d.emplaceBack(me*I,re*u.EXTENT,Me);for(let re=0;re<2*w;re+=2)b.emplaceBack(j+re,j+re+1,j+re+3),b.emplaceBack(j+re,j+re+3,j+re+2),b.emplaceBack(F+re,F+re+3,F+re+1),b.emplaceBack(F+re,F+re+2,F+re+3);const Y=d.length,K=Y+2*(w+1);for(const re of[0,1])for(let me=0;me<=w;me++)for(const Me of[0,1])d.emplaceBack(re*u.EXTENT,me*I,Me);for(let re=0;re<2*w;re+=2)b.emplaceBack(Y+re,Y+re+1,Y+re+3),b.emplaceBack(Y+re,Y+re+3,Y+re+2),b.emplaceBack(K+re,K+re+3,K+re+1),b.emplaceBack(K+re,K+re+2,K+re+3);return this._mesh={indexBuffer:a.createIndexBuffer(b),vertexBuffer:a.createVertexBuffer(d,ma.members),segments:u.SegmentVector.simpleSegment(0,0,d.length,b.length)},this._mesh}getMeshFrameDelta(a){return 2*Math.PI*u.earthRadius/Math.pow(2,a)/5}getMinTileElevationForLngLatZoom(a,d){var b;const{tileID:w}=this._getOverscaledTileIDFromLngLatZoom(a,d);return(b=this.getMinMaxElevation(w).minElevation)!==null&&b!==void 0?b:0}getMinMaxElevation(a){const d=this.getTerrainData(a).tile,b={minElevation:null,maxElevation:null};return d&&d.dem&&(b.minElevation=d.dem.min*this.exaggeration,b.maxElevation=d.dem.max*this.exaggeration),b}_getOverscaledTileIDFromLngLatZoom(a,d){const b=u.MercatorCoordinate.fromLngLat(a.wrap()),w=(1<<d)*u.EXTENT,I=b.x*w,L=b.y*w,F=Math.floor(I/u.EXTENT),j=Math.floor(L/u.EXTENT);return{tileID:new u.OverscaledTileID(d,0,d,F,j),mercatorX:I,mercatorY:L}}}class Uo{constructor(a,d,b){this._context=a,this._size=d,this._tileSize=b,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const a of this._objects)a.texture.destroy(),a.fbo.destroy()}_createObject(a){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),b=new J(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return b.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(b.texture),{id:a,fbo:d,texture:b,stamp:-1,inUse:!1}}getObjectForId(a){return this._objects[a]}useObject(a){a.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>a.id!==d),this._recentlyUsed.push(a.id)}stampObject(a){a.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const a=this._createObject(this._objects.length);return this._objects.push(a),a}freeObject(a){a.inUse=!1}freeAllObjects(){for(const a of this._objects)this.freeObject(a)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(a=>!a.inUse)===!1}}const Ka={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Co{constructor(a,d){this.painter=a,this.terrain=d,this.pool=new Uo(a.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(a){return this.pool.getObjectForId(a.rtt[this._stacks.length-1].id).texture}prepareForRender(a,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=a._order.filter(b=>!a._layers[b].isHidden(d)),this._coordsDescendingInv={};for(const b in a.sourceCaches){this._coordsDescendingInv[b]={};const w=a.sourceCaches[b].getVisibleCoordinates();for(const I of w){const L=this.terrain.sourceCache.getTerrainCoords(I);for(const F in L)this._coordsDescendingInv[b][F]||(this._coordsDescendingInv[b][F]=[]),this._coordsDescendingInv[b][F].push(L[F])}}this._coordsDescendingInvStr={};for(const b of a._order){const w=a._layers[b],I=w.source;if(Ka[w.type]&&!this._coordsDescendingInvStr[I]){this._coordsDescendingInvStr[I]={};for(const L in this._coordsDescendingInv[I])this._coordsDescendingInvStr[I][L]=this._coordsDescendingInv[I][L].map(F=>F.key).sort().join()}}for(const b of this._renderableTiles)for(const w in this._coordsDescendingInvStr){const I=this._coordsDescendingInvStr[w][b.tileID.key];I&&I!==b.rttCoords[w]&&(b.rtt=[])}}renderLayer(a){if(a.isHidden(this.painter.transform.zoom))return!1;const d=a.type,b=this.painter,w=this._renderableLayerIds[this._renderableLayerIds.length-1]===a.id;if(Ka[d]&&(this._prevType&&Ka[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(a.id),!w))return!0;if(Ka[this._prevType]||Ka[d]&&w){this._prevType=d;const I=this._stacks.length-1,L=this._stacks[I]||[];for(const F of this._renderableTiles){if(this.pool.isFull()&&(Tl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(F),F.rtt[I]){const Y=this.pool.getObjectForId(F.rtt[I].id);if(Y.stamp===F.rtt[I].stamp){this.pool.useObject(Y);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),F.rtt[I]={id:j.id,stamp:j.stamp},b.context.bindFramebuffer.set(j.fbo.framebuffer),b.context.clear({color:u.Color.transparent,stencil:0}),b.currentStencilSource=void 0;for(let Y=0;Y<L.length;Y++){const K=b.style._layers[L[Y]],re=K.source?this._coordsDescendingInv[K.source][F.tileID.key]:[F.tileID];b.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),b._renderTileClippingMasks(K,re),b.renderLayer(b,b.style.sourceCaches[K.source],K,re),K.source&&(F.rttCoords[K.source]=this._coordsDescendingInvStr[K.source][F.tileID.key])}}return Tl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ka[d]}return!1}}const Nl=_,Us={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},$n=x=>{x.touchstart=x.dragStart,x.touchmoveWindow=x.dragMove,x.touchend=x.dragEnd},Kt={showCompass:!0,showZoom:!0,visualizePitch:!1};class $s{constructor(a,d,b=!1){this.mousedown=L=>{this.startMouse(u.extend({},L,{ctrlKey:!0,preventDefault:()=>L.preventDefault()}),m.mousePos(this.element,L)),m.addEventListener(window,"mousemove",this.mousemove),m.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=L=>{this.moveMouse(L,m.mousePos(this.element,L))},this.mouseup=L=>{this.mouseRotate.dragEnd(L),this.mousePitch&&this.mousePitch.dragEnd(L),this.offTemp()},this.touchstart=L=>{L.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=m.touchPos(this.element,L.targetTouches)[0],this.startTouch(L,this._startPos),m.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.addEventListener(window,"touchend",this.touchend))},this.touchmove=L=>{L.targetTouches.length!==1?this.reset():(this._lastPos=m.touchPos(this.element,L.targetTouches)[0],this.moveTouch(L,this._lastPos))},this.touchend=L=>{L.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const w=a.dragRotate._mouseRotate.getClickTolerance(),I=a.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=sl({clickTolerance:w,enable:!0}),this.touchRotate=(({enable:L,clickTolerance:F,bearingDegreesPerPixelMoved:j=.8})=>{const Y=new Ll;return new Wa({clickTolerance:F,move:(K,re)=>({bearingDelta:(re.x-K.x)*j}),moveStateManager:Y,enable:L,assignEvents:$n})})({clickTolerance:w,enable:!0}),this.map=a,b&&(this.mousePitch=Ra({clickTolerance:I,enable:!0}),this.touchPitch=(({enable:L,clickTolerance:F,pitchDegreesPerPixelMoved:j=-.5})=>{const Y=new Ll;return new Wa({clickTolerance:F,move:(K,re)=>({pitchDelta:(re.y-K.y)*j}),moveStateManager:Y,enable:L,assignEvents:$n})})({clickTolerance:I,enable:!0})),m.addEventListener(d,"mousedown",this.mousedown),m.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),m.addEventListener(d,"touchcancel",this.reset)}startMouse(a,d){this.mouseRotate.dragStart(a,d),this.mousePitch&&this.mousePitch.dragStart(a,d),m.disableDrag()}startTouch(a,d){this.touchRotate.dragStart(a,d),this.touchPitch&&this.touchPitch.dragStart(a,d),m.disableDrag()}moveMouse(a,d){const b=this.map,{bearingDelta:w}=this.mouseRotate.dragMove(a,d)||{};if(w&&b.setBearing(b.getBearing()+w),this.mousePitch){const{pitchDelta:I}=this.mousePitch.dragMove(a,d)||{};I&&b.setPitch(b.getPitch()+I)}}moveTouch(a,d){const b=this.map,{bearingDelta:w}=this.touchRotate.dragMove(a,d)||{};if(w&&b.setBearing(b.getBearing()+w),this.touchPitch){const{pitchDelta:I}=this.touchPitch.dragMove(a,d)||{};I&&b.setPitch(b.getPitch()+I)}}off(){const a=this.element;m.removeEventListener(a,"mousedown",this.mousedown),m.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),m.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.removeEventListener(window,"touchend",this.touchend),m.removeEventListener(a,"touchcancel",this.reset),this.offTemp()}offTemp(){m.enableDrag(),m.removeEventListener(window,"mousemove",this.mousemove),m.removeEventListener(window,"mouseup",this.mouseup),m.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),m.removeEventListener(window,"touchend",this.touchend)}}let To;function Qa(x,a,d){if(x=new u.LngLat(x.lng,x.lat),a){const b=new u.LngLat(x.lng-360,x.lat),w=new u.LngLat(x.lng+360,x.lat),I=d.locationPoint(x).distSqr(a);d.locationPoint(b).distSqr(a)<I?x=b:d.locationPoint(w).distSqr(a)<I&&(x=w)}for(;Math.abs(x.lng-d.center.lng)>180;){const b=d.locationPoint(x);if(b.x>=0&&b.y>=0&&b.x<=d.width&&b.y<=d.height)break;x.lng>d.center.lng?x.lng-=360:x.lng+=360}return x}const lo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Fl(x,a,d){const b=x.classList;for(const w in lo)b.remove(`maplibregl-${d}-anchor-${w}`);b.add(`maplibregl-${d}-anchor-${a}`)}class co extends u.Evented{constructor(a){if(super(),this._onKeyPress=d=>{const b=d.code,w=d.charCode||d.keyCode;b!=="Space"&&b!=="Enter"&&w!==32&&w!==13||this.togglePopup()},this._onMapClick=d=>{const b=d.originalEvent.target,w=this._element;this._popup&&(b===w||w.contains(b))&&this.togglePopup()},this._update=d=>{if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Qa(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let b="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?b=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(b=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),m.setTransform(this._element,`${lo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${b}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const I=this._map.unproject(this._pos),L=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=I.distanceTo(this._lngLat)>20*L?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=d=>{if(!this._isDragging){const b=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=b}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment!=="auto"?a.pitchAlignment:this._rotationAlignment,a&&a.element)this._element=a.element,this._offset=u.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=m.create("div"),this._element.setAttribute("aria-label","Map marker");const d=m.createNS("http://www.w3.org/2000/svg","svg"),b=41,w=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${b}px`),d.setAttributeNS(null,"width",`${w}px`),d.setAttributeNS(null,"viewBox",`0 0 ${w} ${b}`);const I=m.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"stroke","none"),I.setAttributeNS(null,"stroke-width","1"),I.setAttributeNS(null,"fill","none"),I.setAttributeNS(null,"fill-rule","evenodd");const L=m.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");const F=m.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(3.0, 29.0)"),F.setAttributeNS(null,"fill","#000000");const j=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Je of j){const at=m.createNS("http://www.w3.org/2000/svg","ellipse");at.setAttributeNS(null,"opacity","0.04"),at.setAttributeNS(null,"cx","10.5"),at.setAttributeNS(null,"cy","5.80029008"),at.setAttributeNS(null,"rx",Je.rx),at.setAttributeNS(null,"ry",Je.ry),F.appendChild(at)}const Y=m.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"fill",this._color);const K=m.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Y.appendChild(K);const re=m.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"fill","#000000");const me=m.createNS("http://www.w3.org/2000/svg","path");me.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),re.appendChild(me);const Me=m.createNS("http://www.w3.org/2000/svg","g");Me.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Me.setAttributeNS(null,"fill","#FFFFFF");const Te=m.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Fe=m.createNS("http://www.w3.org/2000/svg","circle");Fe.setAttributeNS(null,"fill","#000000"),Fe.setAttributeNS(null,"opacity","0.25"),Fe.setAttributeNS(null,"cx","5.5"),Fe.setAttributeNS(null,"cy","5.5"),Fe.setAttributeNS(null,"r","5.4999962");const Ce=m.createNS("http://www.w3.org/2000/svg","circle");Ce.setAttributeNS(null,"fill","#FFFFFF"),Ce.setAttributeNS(null,"cx","5.5"),Ce.setAttributeNS(null,"cy","5.5"),Ce.setAttributeNS(null,"r","5.4999962"),Te.appendChild(Fe),Te.appendChild(Ce),L.appendChild(F),L.appendChild(Y),L.appendChild(re),L.appendChild(Me),L.appendChild(Te),d.appendChild(L),d.setAttributeNS(null,"height",b*this._scale+"px"),d.setAttributeNS(null,"width",w*this._scale+"px"),this._element.appendChild(d),this._offset=u.Point.convert(a&&a.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),Fl(this._element,this._anchor,"marker"),a&&a.className)for(const d of a.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),m.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=u.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const w=Math.abs(13.5)/Math.SQRT2;a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(a){return this._offset=u.Point.convert(a),this._update(),this}addClassName(a){this._element.classList.add(a)}removeClassName(a){this._element.classList.remove(a)}toggleClassName(a){return this._element.classList.toggle(a)}setDraggable(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a&&a!=="auto"?a:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const ti={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Fu=0,bs=!1;const o={maxWidth:100,unit:"metric"};function c(x,a,d){const b=d&&d.maxWidth||100,w=x._container.clientHeight/2,I=x.unproject([0,w]),L=x.unproject([b,w]),F=I.distanceTo(L);if(d&&d.unit==="imperial"){const j=3.2808*F;j>5280?g(a,b,j/5280,x._getUIString("ScaleControl.Miles")):g(a,b,j,x._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?g(a,b,F/1852,x._getUIString("ScaleControl.NauticalMiles")):F>=1e3?g(a,b,F/1e3,x._getUIString("ScaleControl.Kilometers")):g(a,b,F,x._getUIString("ScaleControl.Meters"))}function g(x,a,d,b){const w=function(I){const L=Math.pow(10,`${Math.floor(I)}`.length-1);let F=I/L;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(j){const Y=Math.pow(10,Math.ceil(-Math.log(j)/Math.LN10));return Math.round(j*Y)/Y}(F),L*F}(d);x.style.width=a*(w/d)+"px",x.innerHTML=`${w}&nbsp;${b}`}const v={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},A=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function N(x){if(x){if(typeof x=="number"){const a=Math.round(Math.abs(x)/Math.SQRT2);return{center:new u.Point(0,0),top:new u.Point(0,x),"top-left":new u.Point(a,a),"top-right":new u.Point(-a,a),bottom:new u.Point(0,-x),"bottom-left":new u.Point(a,-a),"bottom-right":new u.Point(-a,-a),left:new u.Point(x,0),right:new u.Point(-x,0)}}if(x instanceof u.Point||Array.isArray(x)){const a=u.Point.convert(x);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:u.Point.convert(x.center||[0,0]),top:u.Point.convert(x.top||[0,0]),"top-left":u.Point.convert(x["top-left"]||[0,0]),"top-right":u.Point.convert(x["top-right"]||[0,0]),bottom:u.Point.convert(x.bottom||[0,0]),"bottom-left":u.Point.convert(x["bottom-left"]||[0,0]),"bottom-right":u.Point.convert(x["bottom-right"]||[0,0]),left:u.Point.convert(x.left||[0,0]),right:u.Point.convert(x.right||[0,0])}}return N(new u.Point(0,0))}const G={extend:(x,...a)=>u.extend(x,...a),run(x){x()},logToElement(x,a=!1,d="log"){const b=window.document.getElementById(d);b&&(a&&(b.innerHTML=""),b.innerHTML+=`<br>${x}`)}},le=_;class xe{static get version(){return le}static get workerCount(){return ht.workerCount}static set workerCount(a){ht.workerCount=a}static get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(a){u.config.MAX_PARALLEL_IMAGE_REQUESTS=a}static get workerUrl(){return u.config.WORKER_URL}static set workerUrl(a){u.config.WORKER_URL=a}static addProtocol(a,d){u.config.REGISTERED_PROTOCOLS[a]=d}static removeProtocol(a){delete u.config.REGISTERED_PROTOCOLS[a]}}return xe.Map=class extends _s{constructor(x){if(u.PerformanceUtils.mark(u.PerformanceMarkers.create),(x=u.extend({},Us,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new zs(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies),{bearingSnap:x.bearingSnap}),this._cooperativeGesturesOnWheel=a=>{this._onCooperativeGesture(a,a[this._metaKey],1)},this._contextLost=a=>{a.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=x.interactive,this._cooperativeGestures=x.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=x.maxTileCacheSize,this._maxTileCacheZoomLevels=x.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._crossSourceCollisions=x.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=x.collectResourceTiming,this._renderTaskQueue=new fr,this._controls=[],this._mapId=u.uniqueId(),this._locale=u.extend({},Er,x.locale),this._clickTolerance=x.clickTolerance,this._overridePixelRatio=x.pixelRatio,this._maxCanvasSize=x.maxCanvasSize,this.transformCameraUpdate=x.transformCameraUpdate,this._imageQueueHandle=q.addThrottleControl(()=>this.isMoving()),this._requestManager=new R(x.transformRequest),typeof x.container=="string"){if(this._container=document.getElementById(x.container),!this._container)throw new Error(`Container '${x.container}' not found.`)}else{if(!(x.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const d=yo(b=>{this._trackResize&&!this._removed&&this.resize(b)._update()},50);this._resizeObserver=new ResizeObserver(b=>{a?d(b):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ch(this,x),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=x.hash&&new Vi(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,u.extend({},x.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=x.localIdeographFontFamily,this._validateStyle=x.validateStyle,x.style&&this.setStyle(x.style,{localIdeographFontFamily:x.localIdeographFontFamily}),x.attributionControl&&this.addControl(new Ja({customAttribution:x.customAttribution})),x.maplibreLogo&&this.addControl(new au,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new u.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new u.Event(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new u.Event("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(x,a){if(a===void 0&&(a=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=x.onAdd(this);this._controls.push(x);const b=this._controlPositions[a];return a.indexOf("bottom")!==-1?b.insertBefore(d,b.firstChild):b.appendChild(d),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(x);return a>-1&&this._controls.splice(a,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}calculateCameraOptionsFromTo(x,a,d,b){return b==null&&this.terrain&&(b=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(x,a,d,b)}resize(x){var a;const d=this._containerDimensions(),b=d[0],w=d[1],I=this._getClampedPixelRatio(b,w);if(this._resizeCanvas(b,w,I),this.painter.resize(b,w,I),this.painter.overLimit()){const F=this.painter.context.gl;this._maxCanvasSize=[F.drawingBufferWidth,F.drawingBufferHeight];const j=this._getClampedPixelRatio(b,w);this._resizeCanvas(b,w,j),this.painter.resize(b,w,j)}this.transform.resize(b,w),(a=this._requestedCameraState)===null||a===void 0||a.resize(b,w);const L=!this._moving;return L&&(this.stop(),this.fire(new u.Event("movestart",x)).fire(new u.Event("move",x))),this.fire(new u.Event("resize",x)),L&&this.fire(new u.Event("moveend",x)),this}_getClampedPixelRatio(x,a){const{0:d,1:b}=this._maxCanvasSize,w=this.getPixelRatio(),I=x*w,L=a*w;return Math.min(I>d?d/I:1,L>b?b/L:1)*w}getPixelRatio(){var x;return(x=this._overridePixelRatio)!==null&&x!==void 0?x:devicePixelRatio}setPixelRatio(x){this._overridePixelRatio=x,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(x){return this.transform.setMaxBounds(ke.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(x){return this._cooperativeGestures=x,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(x){return this.transform.locationPoint(u.LngLat.convert(x),this.style&&this.terrain)}unproject(x){return this.transform.pointLocation(u.Point.convert(x),this.terrain)}isMoving(){var x;return this._moving||((x=this.handlers)===null||x===void 0?void 0:x.isMoving())}isZooming(){var x;return this._zooming||((x=this.handlers)===null||x===void 0?void 0:x.isZooming())}isRotating(){var x;return this._rotating||((x=this.handlers)===null||x===void 0?void 0:x.isRotating())}_createDelegatedListener(x,a,d){if(x==="mouseenter"||x==="mouseover"){let b=!1;return{layer:a,listener:d,delegates:{mousemove:I=>{const L=this.getLayer(a)?this.queryRenderedFeatures(I.point,{layers:[a]}):[];L.length?b||(b=!0,d.call(this,new Kr(x,this,I.originalEvent,{features:L}))):b=!1},mouseout:()=>{b=!1}}}}if(x==="mouseleave"||x==="mouseout"){let b=!1;return{layer:a,listener:d,delegates:{mousemove:L=>{(this.getLayer(a)?this.queryRenderedFeatures(L.point,{layers:[a]}):[]).length?b=!0:b&&(b=!1,d.call(this,new Kr(x,this,L.originalEvent)))},mouseout:L=>{b&&(b=!1,d.call(this,new Kr(x,this,L.originalEvent)))}}}}{const b=w=>{const I=this.getLayer(a)?this.queryRenderedFeatures(w.point,{layers:[a]}):[];I.length&&(w.features=I,d.call(this,w),delete w.features)};return{layer:a,listener:d,delegates:{[x]:b}}}}on(x,a,d){if(d===void 0)return super.on(x,a);const b=this._createDelegatedListener(x,a,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(b);for(const w in b.delegates)this.on(w,b.delegates[w]);return this}once(x,a,d){if(d===void 0)return super.once(x,a);const b=this._createDelegatedListener(x,a,d);for(const w in b.delegates)this.once(w,b.delegates[w]);return this}off(x,a,d){return d===void 0?super.off(x,a):(this._delegatedListeners&&this._delegatedListeners[x]&&(b=>{const w=this._delegatedListeners[x];for(let I=0;I<w.length;I++){const L=w[I];if(L.layer===a&&L.listener===d){for(const F in L.delegates)this.off(F,L.delegates[F]);return w.splice(I,1),this}}})(),this)}queryRenderedFeatures(x,a){if(!this.style)return[];let d;const b=x instanceof u.Point||Array.isArray(x),w=b?x:[[0,0],[this.transform.width,this.transform.height]];if(a=a||(b?{}:x)||{},w instanceof u.Point||typeof w[0]=="number")d=[u.Point.convert(w)];else{const I=u.Point.convert(w[0]),L=u.Point.convert(w[1]);d=[I,new u.Point(L.x,I.y),L,new u.Point(I.x,L.y),I]}return this.style.queryRenderedFeatures(d,a,this.transform)}querySourceFeatures(x,a){return this.style.querySourceFeatures(x,a)}setStyle(x,a){return(a=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},a)).diff!==!1&&a.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._updateStyle(x,a))}setTransformRequest(x){return this._requestManager.setTransformRequest(x),this}_getUIString(x){const a=this._locale[x];if(a==null)throw new Error(`Missing UI string '${x}'`);return a}_updateStyle(x,a){if(a.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(x,a));const d=this.style&&a.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!x)),x?(this.style=new Ui(this,a||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x,a,d):this.style.loadJSON(x,a,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ui(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,a){if(typeof x=="string"){const d=this._requestManager.transformRequest(x,X.Style);u.getJSON(d,(b,w)=>{b?this.fire(new u.ErrorEvent(b)):w&&this._updateDiff(w,a)})}else typeof x=="object"&&this._updateDiff(x,a)}_updateDiff(x,a){try{this.style.setState(x,a)&&this._update(!0)}catch(d){u.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(x,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.warnOnce("There is no style added to the map.")}addSource(x,a){return this._lazyInitEmptyStyle(),this.style.addSource(x,a),this._update(!0)}isSourceLoaded(x){const a=this.style&&this.style.sourceCaches[x];if(a!==void 0)return a.loaded();this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${x}'`)))}setTerrain(x){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),x){const a=this.style.sourceCaches[x.source];if(!a)throw new Error(`cannot load terrain, because there exists no source with ID: ${x.source}`);for(const d in this.style._layers){const b=this.style._layers[d];b.type==="hillshade"&&b.source===x.source&&u.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Iu(this.painter,a,x),this.painter.renderToTexture=new Co(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==x.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.Event("terrain",{terrain:x})),this}getTerrain(){var x,a;return(a=(x=this.terrain)===null||x===void 0?void 0:x.options)!==null&&a!==void 0?a:null}areTilesLoaded(){const x=this.style&&this.style.sourceCaches;for(const a in x){const d=x[a]._tiles;for(const b in d){const w=d[b];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(x,a,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(x,a,d)}removeSource(x){return this.style.removeSource(x),this._update(!0)}getSource(x){return this.style.getSource(x)}addImage(x,a,d={}){const{pixelRatio:b=1,sdf:w=!1,stretchX:I,stretchY:L,content:F}=d;if(this._lazyInitEmptyStyle(),!(a instanceof HTMLImageElement||u.isImageBitmap(a))){if(a.width===void 0||a.height===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:Y,data:K}=a,re=a;return this.style.addImage(x,{data:new u.RGBAImage({width:j,height:Y},new Uint8Array(K)),pixelRatio:b,stretchX:I,stretchY:L,content:F,sdf:w,version:0,userImage:re}),re.onAdd&&re.onAdd(this,x),this}}{const{width:j,height:Y,data:K}=u.browser.getImageData(a);this.style.addImage(x,{data:new u.RGBAImage({width:j,height:Y},K),pixelRatio:b,stretchX:I,stretchY:L,content:F,sdf:w,version:0})}}updateImage(x,a){const d=this.style.getImage(x);if(!d)return this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=a instanceof HTMLImageElement||u.isImageBitmap(a)?u.browser.getImageData(a):a,{width:w,height:I,data:L}=b;if(w===void 0||I===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==d.data.width||I!==d.data.height)return this.fire(new u.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const F=!(a instanceof HTMLImageElement||u.isImageBitmap(a));return d.data.replace(L,F),this.style.updateImage(x,d),this}getImage(x){return this.style.getImage(x)}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x,a){q.getImage(this._requestManager.transformRequest(x,X.Image),a)}listImages(){return this.style.listImages()}addLayer(x,a){return this._lazyInitEmptyStyle(),this.style.addLayer(x,a),this._update(!0)}moveLayer(x,a){return this.style.moveLayer(x,a),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}setLayerZoomRange(x,a,d){return this.style.setLayerZoomRange(x,a,d),this._update(!0)}setFilter(x,a,d={}){return this.style.setFilter(x,a,d),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,a,d,b={}){return this.style.setPaintProperty(x,a,d,b),this._update(!0)}getPaintProperty(x,a){return this.style.getPaintProperty(x,a)}setLayoutProperty(x,a,d,b={}){return this.style.setLayoutProperty(x,a,d,b),this._update(!0)}getLayoutProperty(x,a){return this.style.getLayoutProperty(x,a)}setGlyphs(x,a={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(x,a),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(x,a,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(x,a,d,b=>{b||this._update(!0)}),this}removeSprite(x){return this._lazyInitEmptyStyle(),this.style.removeSprite(x),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(x,a={}){return this._lazyInitEmptyStyle(),this.style.setSprite(x,a,d=>{d||this._update(!0)}),this}setLight(x,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,a),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(x,a){return this.style.setFeatureState(x,a),this._update()}removeFeatureState(x,a){return this.style.removeFeatureState(x,a),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let x=0,a=0;return this._container&&(x=this._container.clientWidth||400,a=this._container.clientHeight||300),[x,a]}_setupContainer(){const x=this._container;x.classList.add("maplibregl-map");const a=this._canvasContainer=m.create("div","maplibregl-canvas-container",x);this._interactive&&a.classList.add("maplibregl-interactive"),this._canvas=m.create("canvas","maplibregl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),b=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],b);const w=this._controlContainer=m.create("div","maplibregl-control-container",x),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(L=>{I[L]=m.create("div",`maplibregl-ctrl-${L} `,w)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=m.create("div","maplibregl-cooperative-gesture-screen",this._container);let x=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(x=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${x}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){m.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(x,a,d){this._canvas.width=Math.floor(d*x),this._canvas.height=Math.floor(d*a),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${a}px`}_setupPainter(){const x={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let a=null;this._canvas.addEventListener("webglcontextcreationerror",b=>{a={requestedAttributes:x},b&&(a.statusMessage=b.statusMessage,a.type=b.type)},{once:!0});const d=this._canvas.getContext("webgl2",x)||this._canvas.getContext("webgl",x);if(!d){const b="Failed to initialize WebGL";throw a?(a.message=b,new Error(JSON.stringify(a))):new Error(b)}this.painter=new il(d,this.transform),S.testSupport(d)}_onCooperativeGesture(x,a,d){return!a&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_render(x){const a=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const w=this.transform.zoom,I=u.browser.now();this.style.zoomHistory.update(w,I);const L=new u.EvaluationParameters(w,{now:I,fadeDuration:a,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),F=L.crossFadingFactor();F===1&&F===this._crossFadingFactor||(d=!0,this._crossFadingFactor=F),this.style.update(L)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,showPadding:this.showPadding}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.load),this.fire(new u.Event("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const b=this._sourcesDirty||this._styleDirty||this._placementDirty;return b||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.Event("idle")),!this._loaded||this._fullyLoaded||b||(this._fullyLoaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var x;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),q.removeThrottleControl(this._imageQueueHandle),(x=this._resizeObserver)===null||x===void 0||x.disconnect();const a=this.painter.context.gl.getExtension("WEBGL_lose_context");a&&a.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),m.remove(this._canvasContainer),m.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),u.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.browser.frame(x=>{u.PerformanceUtils.frame(x),this._frame=null,this._render(x)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get version(){return Nl}getCameraTargetElevation(){return this.transform.elevation}},xe.NavigationControl=class{constructor(x){this._updateZoomButtons=()=>{const a=this._map.getZoom(),d=a===this._map.getMaxZoom(),b=a===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())},this._rotateCompassArrow=()=>{const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=a},this._setButtonTitle=(a,d)=>{const b=this._map._getUIString(`NavigationControl.${d}`);a.title=b,a.setAttribute("aria-label",b)},this.options=u.extend({},Kt,x),this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",a=>this._map.zoomIn({},{originalEvent:a})),m.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",a=>this._map.zoomOut({},{originalEvent:a})),m.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",a=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:a}):this._map.resetNorth({},{originalEvent:a})}),this._compassIcon=m.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $s(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){m.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,a){const d=m.create("button",x,this._container);return d.type="button",d.addEventListener("click",a),d}},xe.GeolocateControl=class extends u.Evented{constructor(x){super(),this._onSuccess=a=>{if(this._map){if(this._isOutOfMapMaxBounds(a))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",a)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(a),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(a),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.Event("geolocate",a)),this._finish()}},this._updateCamera=a=>{const d=new u.LngLat(a.coords.longitude,a.coords.latitude),b=a.coords.accuracy,w=this._map.getBearing(),I=u.extend({bearing:w},this.options.fitBoundsOptions),L=ke.fromLngLat(d,b);this._map.fitBounds(L,I,{geolocateSource:!0})},this._updateMarker=a=>{if(a){const d=new u.LngLat(a.coords.longitude,a.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=a.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=a=>{if(this._map){if(this.options.trackUserLocation)if(a.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(a.code===3&&bs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.Event("error",a)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=a=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=m.create("button","maplibregl-ctrl-geolocate",this._container),m.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",a===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=m.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new co({element:this._dotElement}),this._circleElement=m.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new co({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}},this.options=u.extend({},ti,x)}onAdd(x){return this._map=x,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(a,d=!1){To===void 0||d?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(b=>{To=b.state!=="denied",a(To)}).catch(()=>{To=!!window.navigator.geolocation,a(To)}):(To=!!window.navigator.geolocation,a(To)):a(To)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),m.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Fu=0,bs=!1}_isOutOfMapMaxBounds(x){const a=this._map.getMaxBounds(),d=x.coords;return a&&(d.longitude<a.getWest()||d.longitude>a.getEast()||d.latitude<a.getSouth()||d.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const x=this._map.getBounds(),a=x.getSouthEast(),d=x.getNorthEast(),b=a.distanceTo(d),w=Math.ceil(this._accuracy/(b/this._map._container.clientHeight)*2);this._circleElement.style.width=`${w}px`,this._circleElement.style.height=`${w}px`}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Fu--,bs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Fu++,Fu>1?(x={maximumAge:6e5,timeout:0},bs=!0):(x=this.options.positionOptions,bs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},xe.AttributionControl=Ja,xe.LogoControl=au,xe.ScaleControl=class{constructor(x){this._onMove=()=>{c(this._map,this._container,this.options)},this.setUnit=a=>{this.options.unit=a,c(this._map,this._container,this.options)},this.options=u.extend({},o,x)}getDefaultPosition(){return"bottom-left"}onAdd(x){return this._map=x,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){m.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},xe.FullscreenControl=class extends u.Evented{constructor(x={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){m.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const x=this._fullscreenButton=m.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);m.create("span","maplibregl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new u.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},xe.TerrainControl=class{constructor(x){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=x}onAdd(x){return this._map=x,this._container=m.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=m.create("button","maplibregl-ctrl-terrain",this._container),m.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){m.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},xe.Popup=class extends u.Evented{constructor(x){super(),this.remove=()=>(this._content&&m.remove(this._content),this._container&&(m.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.Event("close")),this),this._onMouseUp=a=>{this._update(a.point)},this._onMouseMove=a=>{this._update(a.point)},this._onDrag=a=>{this._update(a.point)},this._update=a=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=m.create("div","maplibregl-popup",this._map.getContainer()),this._tip=m.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const L of this.options.className.split(" "))this._container.classList.add(L);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qa(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!a)return;const d=this._pos=this._trackPointer&&a?a:this._map.project(this._lngLat);let b=this.options.anchor;const w=N(this.options.offset);if(!b){const L=this._container.offsetWidth,F=this._container.offsetHeight;let j;j=d.y+w.bottom.y<F?["top"]:d.y>this._map.transform.height-F?["bottom"]:[],d.x<L/2?j.push("left"):d.x>this._map.transform.width-L/2&&j.push("right"),b=j.length===0?"bottom":j.join("-")}const I=d.add(w[b]).round();m.setTransform(this._container,`${lo[b]} translate(${I.x}px,${I.y}px)`),Fl(this._container,b,"popup")},this._onClose=()=>{this.remove()},this.options=u.extend(Object.create(v),x)}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=u.LngLat.convert(x),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const a=document.createDocumentFragment(),d=document.createElement("body");let b;for(d.innerHTML=x;b=d.firstChild,b;)a.appendChild(b);return this.setDOMContent(a)}getMaxWidth(){var x;return(x=this._container)===null||x===void 0?void 0:x.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=m.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){this._container&&this._container.classList.add(x)}removeClassName(x){this._container&&this._container.classList.remove(x)}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){if(this._container)return this._container.classList.toggle(x)}_createCloseButton(){this.options.closeButton&&(this._closeButton=m.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(A);x&&x.focus()}},xe.Marker=co,xe.Style=Ui,xe.LngLat=u.LngLat,xe.LngLatBounds=ke,xe.Point=u.Point,xe.MercatorCoordinate=u.MercatorCoordinate,xe.Evented=u.Evented,xe.AJAXError=u.AJAXError,xe.config=u.config,xe.CanvasSource=Ye,xe.GeoJSONSource=Lt,xe.ImageSource=Ct,xe.RasterDEMTileSource=yt,xe.RasterTileSource=dt,xe.VectorTileSource=He,xe.VideoSource=mt,xe.setRTLTextPlugin=u.setRTLTextPlugin,xe.getRTLTextPluginStatus=u.getRTLTextPluginStatus,xe.prewarm=function(){ir().acquire($e)},xe.clearPrewarmedResources=function(){const x=Vt;x&&(x.isPreloaded()&&x.numActive()===1&&(x.release($e),Vt=null))},G.extend(xe,{isSafari:u.isSafari,getPerformanceMetrics:u.PerformanceUtils.getPerformanceMetrics}),xe});var p=i;return p})})(uM);var cM=uM.exports;const zce=N3(cM);var y1={},yc={},vv={},Xs={};Object.defineProperty(Xs,"__esModule",{value:!0});Xs.Serializable=void 0;var iz=Wu,oz=function(){function e(){}return Object.defineProperty(e.prototype,"json",{get:function(){return(0,iz.kebabize)(this)},enumerable:!1,configurable:!0}),e}();Xs.Serializable=oz;var az=function(){function e(r){this.id=r.id,this.type=r.type,this.source=r.source,this.sourceLayer=r["source-layer"],this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,this.filter=r.filter,this.metadata=r.metadata}return Object.defineProperty(e.prototype,"json",{get:function(){var r=this,t=r.id,n=r.type,i=r.source,l=r.sourceLayer,p=r.minzoom,u=r.maxzoom,_=r.filter,m=r.metadata,S={id:t,type:n};return i&&(S.source=i),l&&(S["source-layer"]=l),p&&(S.minzoom=p),u&&(S.maxzoom=u),_&&(S.filter=_),this.metadata&&(S.metadata=m),this.paint&&(S.paint=this.paint.json),this.layout&&(S.layout=this.layout.json),S},enumerable:!1,configurable:!0}),e.prototype.setFilterLevel=function(r){var t=this;this.filter.forEach(function(n,i){if(t.id==="proximiio-levelchangers"){var l="__level_".concat(r);i===3&&(n[1]=l),i===4&&(n[1][1]=l)}if(Array.isArray(n)){var p=!1;if(n[0]==="=="){var u=n[1];u[0]==="to-number"&&u[1][0]==="get"&&u[1][1]==="level"&&(n[2]=r,p=!0),u[0]==="get"&&u[1]==="level"&&(n[2]=r,p=!0)}if(n[0]==="<="){var u=n[1];u[0]==="to-number"&&u[1][0]==="get"&&u[1][1]==="level_min"&&(n[2]=r,p=!0),u[0]==="get"&&u[1]==="level_min"&&(n[2]=r,p=!0)}if(n[0]===">="){var u=n[1];u[0]==="to-number"&&u[1][0]==="get"&&u[1][1]==="level_max"&&(n[2]=r,p=!0),u[0]==="get"&&u[1]==="level_max"&&(n[2]=r,p=!0)}p&&(t.filter[i]=n)}})},e}();Xs.default=az;var Jc={},Dx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Jc,"__esModule",{value:!0});Jc.LayoutProperties=Jc.PaintProperties=void 0;var Nx=Xs,hM=function(e){Dx(r,e);function r(t){var n=e.call(this)||this;return n.backgroundColor=t["background-color"]||"#000000",n.backgroundPattern=t["background-pattern"],n.backgroundOpacity=t["background-opacity"]||1,n}return r}(Nx.Serializable);Jc.PaintProperties=hM;var fM=function(e){Dx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n}return r}(Nx.Serializable);Jc.LayoutProperties=fM;var sz=function(e){Dx(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new hM(t.paint||{}),n.layout=new fM(t.layout||{}),n}return r}(Nx.default);Jc.default=sz;var Kc={},Fx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Kc,"__esModule",{value:!0});Kc.LayoutProperties=Kc.PaintProperties=void 0;var kx=Xs,pM=function(e){Fx(r,e);function r(t){var n=e.call(this)||this;return n.rasterOpacity=t["raster-opacity"]||1,n.rasterHueRotate=t["raster-hue-rotate"]||0,n.rasterBrightnessMin=t["raster-brightness-min"]||0,n.rasterBrightnessMax=t["raster-brightness-max"]||1,n.rasterSaturation=t["raster-saturation"]||0,n.rasterContrast=t["raster-contrast"]||0,n.rasterResampling=t["raster-resampling"]||"linear",n.rasterFadeDuration=t["raster-fade-duration"]||300,n}return r}(kx.Serializable);Kc.PaintProperties=pM;var dM=function(e){Fx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n}return r}(kx.Serializable);Kc.LayoutProperties=dM;var uz=function(e){Fx(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new pM(t.paint||{}),n.layout=new dM(t.layout||{}),n}return r}(kx.default);Kc.default=uz;var Qc={},Bx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Qc,"__esModule",{value:!0});Qc.LayoutProperties=Qc.PaintProperties=void 0;var zx=Xs,gM=function(e){Bx(r,e);function r(t){var n=e.call(this)||this;return n.fillAntialias=t["fill-antialias"]||!0,n.fillOpacity=t["fill-opacity"]||1,n.fillColor=t["fill-color"]||"#000000",n.fillOutlineColor=t["fill-outline-color"],n.fillTranslate=t["fill-translate"]||[0,0],n.fillTranslateAnchor=t["fill-translate-anchor"]||"map",n.fillPattern=t["fill-pattern"],n}return r}(zx.Serializable);Qc.PaintProperties=gM;var mM=function(e){Bx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n}return r}(zx.Serializable);Qc.LayoutProperties=mM;var lz=function(e){Bx(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new gM(t.paint||{}),n.layout=new mM(t.layout||{}),n}return r}(zx.default);Qc.default=lz;var _c={},jx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(_c,"__esModule",{value:!0});_c.LayoutProperties=_c.PaintProperties=void 0;var Ux=Xs,vM=function(e){jx(r,e);function r(t){var n=e.call(this)||this;return n.lineColor=t["line-color"]||"#000000",n.lineOpacity=t["line-opacity"]||1,n.lineTranslate=t["line-translate"]||[0,0],n.lineTranslateAnchor=t["line-translate-anchor"]||"map",n.lineWidth=t["line-width"]||1,n.lineGapWidth=t["line-gap-width"]||0,n.lineOffset=t["line-offset"]||0,n.lineBlur=t["line-blur"]||0,n.lineDasharray=t["line-dasharray"],n.linePattern=t["line-pattern"],n.lineGradient=t["line-gradient"],n}return r}(Ux.Serializable);_c.PaintProperties=vM;var yM=function(e){jx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n.lineCap=t["line-cap"]||"butt",n.lineJoin=t["line-join"]||"miter",n.lineMiterLimit=t["line-miter-limit"]||2,n.lineRoundLimit=t["line-round-limit"]||1.05,n}return r}(Ux.Serializable);_c.LayoutProperties=yM;var cz=function(e){jx(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new vM(t.paint||{}),n.layout=new yM(t.layout||{}),n}return r}(Ux.default);_c.default=cz;var bc={},$x=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(bc,"__esModule",{value:!0});bc.LayoutProperties=bc.PaintProperties=void 0;var Gx=Xs,_M=function(e){$x(r,e);function r(t){var n=e.call(this)||this;return n.fillExtrusionColor=t["fill-extrusion-color"]||"#000000",n.fillExtrusionOpacity=t["fill-extrusion-opacity"]||1,n.fillExtrusionTranslate=t["fill-extrusion-translate"]||[0,0],n.fillExtrusionTranslateAnchor=t["fill-extrusion-translate-anchor"]||"map",n.fillExtrusionPattern=t["fill-extrusion-pattern"],n.fillExtrusionHeight=t["fill-extrusion-height"]||0,n.fillExtrusionBase=t["fill-extrusion-base"]||0,n.fillExtrusionVerticalGradient=t["fill-extrusion-vertical-gradient"]||!0,n}return r}(Gx.Serializable);bc.PaintProperties=_M;var bM=function(e){$x(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n}return r}(Gx.Serializable);bc.LayoutProperties=bM;var hz=function(e){$x(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new _M(t.paint||{}),n.layout=new bM(t.layout||{}),n}return r}(Gx.default);bc.default=hz;var xc={},qx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(xc,"__esModule",{value:!0});xc.LayoutProperties=xc.PaintProperties=void 0;var Vx=Xs,fz=Wu,xM=function(e){qx(r,e);function r(t){var n=e.call(this)||this;return n.iconColor=t["icon-color"]||"#000000",n.iconOpacity=t["icon-opacity"]||1,n.iconHaloColor=t["icon-halo-color"]||"rgba(0, 0, 0, 0)",n.iconHaloWidth=t["icon-halo-width"]||0,n.iconHaloBlur=t["icon-halo-blur"]||0,n.iconTranslate=t["icon-translate"]||[0,0],n.iconTranslateAnchor=t["icon-translate-anchor"]||"map",n.textOpacity=t["text-opacity"]||1,n.textColor=t["text-color"]||"#000000",n.textHaloColor=t["text-halo-color"]||"rgba(0, 0, 0, 0)",n.textHaloWidth=t["text-halo-width"]||0,n.textHaloBlur=t["text-halo-blur"]||0,n.textTranslate=t["text-translate"]||[0,0],n.textTranslateAnchor=t["text-translate-anchor"]||"map",n}return r}(Vx.Serializable);xc.PaintProperties=xM;var wM=function(e){qx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n.symbolPlacement=t["symbol-placement"]||"point",n.symbolSpacing=t["symbol-spacing"]||250,n.symbolAvoidEdges=t["symbol-avoid-edges"]||!1,n.symbolSortKey=t["symbol-sort-key"],n.symbolZOrder=t["symbol-z-order"]||"auto",n.iconAllowOverlap=t["icon-allow-overlap"]||!1,n.iconIgnorePlacement=t["icon-ignore-placement"]||!1,n.iconOptional=t["icon-optional"]||!1,n.iconRotationAlignment=t["icon-rotation-alignment"]||"auto",n.iconSize=t["icon-size"]||1,n.iconTextFit=t["icon-text-fit"]||"none",n.iconTextFitPadding=t["icon-text-fit-padding"]||[0,0,0,0],n.iconImage=t["icon-image"],n.iconRotate=t["icon-rotate"]||0,n.iconPadding=t["icon-padding"]||2,n.iconKeepUpright=t["icon-keep-upright"]||!1,n.iconOffset=t["icon-offset"]||[0,0],n.iconAnchor=t["icon-anchor"]||"center",n.iconPitchAlignment=t["icon-pitch-alignment"]||"auto",n.textPitchAlignment=t["text-pitch-alignment"]||"auto",n.textRotationAlignment=t["text-rotation-alignment"]||"auto",typeof t["text-font"]=="string"&&t["text-font"]==="{textFont}"||typeof t["text-font"]=="object"&&t["text-font"].property==="textFont"?n.textFont=["match",["string",["get","textFont"]],"Klokantech Noto Sans Bold",["literal",["Klokantech Noto Sans Bold"]],"Klokantech Noto Sans CJK Bold",["literal",["Klokantech Noto Sans CJK Bold"]],"Klokantech Noto Sans CJK Regular",["literal",["Klokantech Noto Sans CJK Regular"]],"Klokantech Noto Sans Italic",["literal",["Klokantech Noto Sans Italic"]],"Klokantech Noto Sans Regular",["literal",["Klokantech Noto Sans Regular"]],"Noto Sans Bold",["literal",["Noto Sans Bold"]],"Noto Sans Bold Italic",["literal",["Noto Sans Bold Italic"]],"Noto Sans Italic",["literal",["Noto Sans Italic"]],"Noto Sans Regular",["literal",["Noto Sans Regular"]],"Open Sans Bold",["literal",["Open Sans Bold"]],"Open Sans Italic",["literal",["Open Sans Italic"]],"Open Sans Regular",["literal",["Open Sans Regular"]],"Open Sans Semibold",["literal",["Open Sans Semibold"]],"Open Sans Semibold Italic",["literal",["Open Sans Semibold Italic"]],["literal",["Klokantech Noto Sans Bold"]]]:n.textFont=t["text-font"],n.textField=t["text-field"]||"",n.textSize=t["text-size"]||16,n.textMaxWidth=t["text-max-width"]||10,n.textLineHeight=t["text-line-height"]||1.2,n.textLetterSpacing=t["text-letter-spacing"]||0,n.textJustify=t["text-justify"]||"center",n.textRadialOffset=t["text-radial-offset"]||0,n.textVariableAnchor=t["text-variable-anchor"],n.textAnchor=t["text-anchor"]||"center",n.textMaxAngle=t["text-max-angle"]||45,n.textWritingMode=t["text-writing-mode"],n.textRotate=t["text-rotate"]||0,n.textPadding=t["text-padding"]||2,n.textKeepUpright=t["text-keep-upright"]||!0,n.textTransform=t["text-transform"]||"none",n.textOffset=t["text-offset"]||[0,0],n.textAllowOverlap=t["text-allow-overlap"]||!1,n.textIgnorePlacement=t["text-ignore-placement"]||!1,n.textOptional=t["text-optional"]||!1,n}return Object.defineProperty(r.prototype,"json",{get:function(){var t=(0,fz.kebabize)(this);return t["symbol-z-order"]=this.symbolZOrder,delete t["symbol-zorder"],t},enumerable:!1,configurable:!0}),r}(Vx.Serializable);xc.LayoutProperties=wM;var pz=function(e){qx(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new xM(t.paint||{}),n.layout=new wM(t.layout||{}),n}return r}(Vx.default);xc.default=pz;var eh={},Xx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(eh,"__esModule",{value:!0});eh.LayoutProperties=eh.PaintProperties=void 0;var Yx=Xs,EM=function(e){Xx(r,e);function r(t){var n=e.call(this)||this;return n.heatmapRadius=t["heatmap-radius"]||30,n.heatmapWeight=t["heatmap-weight"]||1,n.heatmapIntensity=t["heatmap-intensity"]||1,n.heatmapOpacity=t["heatmap-opacity"]||1,n.heatmapColor=t["heatmap-color"]||"",n}return r}(Yx.Serializable);eh.PaintProperties=EM;var SM=function(e){Xx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n}return r}(Yx.Serializable);eh.LayoutProperties=SM;var dz=function(e){Xx(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new EM(t.paint||{}),n.layout=new SM(t.layout||{}),n}return r}(Yx.default);eh.default=dz;var th={},Wx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(th,"__esModule",{value:!0});th.LayoutProperties=th.PaintProperties=void 0;var Zx=Xs,PM=function(e){Wx(r,e);function r(t){var n=e.call(this)||this;return n.circleRadius=t["circle-radius"]||5,n.circleColor=t["circle-color"]||"#000000",n.circleBlur=t["circle-blur"]||0,n.circleOpacity=t["circle-opacity"]||1,n.circleTranslate=t["circle-translate"]||[0,0],n.circleTranslateAnchor=t["circle-translate-anchor"]||"map",n.circlePitchScale=t["circle-pitch-scale"]||"map",n.circlePitchAlignment=t["circle-pitch-alignment"]||"viewport",n.circleStrokeWidth=t["circle-stroke-width"]||1,n.circleStrokeColor=t["circle-stroke-color"]||"#000000",n.circleStrokeOpacity=t["circle-stroke-opacity"]||1,n}return r}(Zx.Serializable);th.PaintProperties=PM;var AM=function(e){Wx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n.circleSortKey=t["circle-sort-key"]||0,n}return r}(Zx.Serializable);th.LayoutProperties=AM;var gz=function(e){Wx(r,e);function r(t){var n=e.call(this,t)||this;return n.type="circle",n.paint=new PM(t.paint||{}),n.layout=new AM(t.layout||{}),n}return r}(Zx.default);th.default=gz;var rh={},Hx=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(rh,"__esModule",{value:!0});rh.LayoutProperties=rh.PaintProperties=void 0;var Jx=Xs,IM=function(e){Hx(r,e);function r(t){var n=e.call(this)||this;return n.hillshadeIlluminationDirection=t["hillshade-illumination-direction"]||335,n.hillshadeIlluminationAnchor=t["hillshade-illumination-anchor"]||"viewport",n.hillshadeExaggeration=t["hillshade-exaggeration"]||.5,n.hillshadeShadowColor=t["hillshade-shadow-color"]||'#000000"',n.hillshadeHighlightColor=t["hillshade-highlight-color"]||"#ffffff",n.hillshadeAccentColor=t["hillshade-accent-color"]||"#000000",n}return r}(Jx.Serializable);rh.PaintProperties=IM;var OM=function(e){Hx(r,e);function r(t){var n=e.call(this)||this;return n.visibility=t.visibility||"visible",n}return r}(Jx.Serializable);rh.LayoutProperties=OM;var mz=function(e){Hx(r,e);function r(t){var n=e.call(this,t)||this;return n.paint=new IM(t.paint||{}),n.layout=new OM(t.layout||{}),n}return r}(Jx.default);rh.default=mz;var CM={exports:{}};(function(e,r){(function(t,n){var i=n(t);e.exports=i})(we,function(t){var n=["N","E","A","D"];function i(ee,W){ee.super_=W,ee.prototype=Object.create(W.prototype,{constructor:{value:ee,enumerable:!1,writable:!0,configurable:!0}})}function l(ee,W){Object.defineProperty(this,"kind",{value:ee,enumerable:!0}),W&&W.length&&Object.defineProperty(this,"path",{value:W,enumerable:!0})}function p(ee,W,J){p.super_.call(this,"E",ee),Object.defineProperty(this,"lhs",{value:W,enumerable:!0}),Object.defineProperty(this,"rhs",{value:J,enumerable:!0})}i(p,l);function u(ee,W){u.super_.call(this,"N",ee),Object.defineProperty(this,"rhs",{value:W,enumerable:!0})}i(u,l);function _(ee,W){_.super_.call(this,"D",ee),Object.defineProperty(this,"lhs",{value:W,enumerable:!0})}i(_,l);function m(ee,W,J){m.super_.call(this,"A",ee),Object.defineProperty(this,"index",{value:W,enumerable:!0}),Object.defineProperty(this,"item",{value:J,enumerable:!0})}i(m,l);function S(ee,W,J){var be=ee.slice((J||W)+1||ee.length);return ee.length=W<0?ee.length+W:W,ee.push.apply(ee,be),ee}function P(ee){var W=typeof ee;return W!=="object"?W:ee===Math?"math":ee===null?"null":Array.isArray(ee)?"array":Object.prototype.toString.call(ee)==="[object Date]"?"date":typeof ee.toString=="function"&&/^\/.*\//.test(ee.toString())?"regexp":"object"}function O(ee){var W=0;if(ee.length===0)return W;for(var J=0;J<ee.length;J++){var be=ee.charCodeAt(J);W=(W<<5)-W+be,W=W&W}return W}function M(ee){var W=0,J=P(ee);if(J==="array"){ee.forEach(function(ct){W+=M(ct)});var be="[type: array, hash: "+W+"]";return W+O(be)}if(J==="object"){for(var Oe in ee)if(ee.hasOwnProperty(Oe)){var Ae="[ type: object, key: "+Oe+", value hash: "+M(ee[Oe])+"]";W+=O(Ae)}return W}var ae="[ type: "+J+" ; value: "+ee+"]";return W+O(ae)}function B(ee,W,J,be,Oe,Ae,ae,ct){J=J||[],Oe=Oe||[],ae=ae||[];var Pe=Oe.slice(0);if(typeof Ae<"u"&&Ae!==null){if(be){if(typeof be=="function"&&be(Pe,Ae))return;if(typeof be=="object"){if(be.prefilter&&be.prefilter(Pe,Ae))return;if(be.normalize){var V=be.normalize(Pe,Ae,ee,W);V&&(ee=V[0],W=V[1])}}}Pe.push(Ae)}P(ee)==="regexp"&&P(W)==="regexp"&&(ee=ee.toString(),W=W.toString());var Q=typeof ee,he=typeof W,fe,ye,se,De,ke=Q!=="undefined"||ae&&ae.length>0&&ae[ae.length-1].lhs&&Object.getOwnPropertyDescriptor(ae[ae.length-1].lhs,Ae),We=he!=="undefined"||ae&&ae.length>0&&ae[ae.length-1].rhs&&Object.getOwnPropertyDescriptor(ae[ae.length-1].rhs,Ae);if(!ke&&We)J.push(new u(Pe,W));else if(!We&&ke)J.push(new _(Pe,ee));else if(P(ee)!==P(W))J.push(new p(Pe,ee,W));else if(P(ee)==="date"&&ee-W!==0)J.push(new p(Pe,ee,W));else if(Q==="object"&&ee!==null&&W!==null){for(fe=ae.length-1;fe>-1;--fe)if(ae[fe].lhs===ee){De=!0;break}if(De)ee!==W&&J.push(new p(Pe,ee,W));else{if(ae.push({lhs:ee,rhs:W}),Array.isArray(ee)){for(ct&&(ee.sort(function(yt,Lt){return M(yt)-M(Lt)}),W.sort(function(yt,Lt){return M(yt)-M(Lt)})),fe=W.length-1,ye=ee.length-1;fe>ye;)J.push(new m(Pe,fe,new u(void 0,W[fe--])));for(;ye>fe;)J.push(new m(Pe,ye,new _(void 0,ee[ye--])));for(;fe>=0;--fe)B(ee[fe],W[fe],J,be,Pe,fe,ae,ct)}else{var He=Object.keys(ee),dt=Object.keys(W);for(fe=0;fe<He.length;++fe)se=He[fe],De=dt.indexOf(se),De>=0?(B(ee[se],W[se],J,be,Pe,se,ae,ct),dt[De]=null):B(ee[se],void 0,J,be,Pe,se,ae,ct);for(fe=0;fe<dt.length;++fe)se=dt[fe],se&&B(void 0,W[se],J,be,Pe,se,ae,ct)}ae.length=ae.length-1}}else ee!==W&&(Q==="number"&&isNaN(ee)&&isNaN(W)||J.push(new p(Pe,ee,W)))}function $(ee,W,J,be,Oe){var Ae=[];if(B(ee,W,Ae,be,null,null,null,Oe),J)for(var ae=0;ae<Ae.length;++ae)J(Ae[ae]);return Ae}function q(ee,W,J,be,Oe,Ae,ae){return B(ee,W,J,be,Oe,Ae,ae,!0)}function X(ee,W,J,be){var Oe=be?function(ae){ae&&be.push(ae)}:void 0,Ae=$(ee,W,Oe,J);return be||(Ae.length?Ae:void 0)}function R(ee,W,J,be){var Oe=be?function(ae){ae&&be.push(ae)}:void 0,Ae=$(ee,W,Oe,J,!0);return be||(Ae.length?Ae:void 0)}function k(ee,W,J){if(J.path&&J.path.length){var be=ee[W],Oe,Ae=J.path.length-1;for(Oe=0;Oe<Ae;Oe++)be=be[J.path[Oe]];switch(J.kind){case"A":k(be[J.path[Oe]],J.index,J.item);break;case"D":delete be[J.path[Oe]];break;case"E":case"N":be[J.path[Oe]]=J.rhs;break}}else switch(J.kind){case"A":k(ee[W],J.index,J.item);break;case"D":ee=S(ee,W);break;case"E":case"N":ee[W]=J.rhs;break}return ee}function U(ee,W,J){if(typeof J>"u"&&W&&~n.indexOf(W.kind)&&(J=W),ee&&J&&J.kind){for(var be=ee,Oe=-1,Ae=J.path?J.path.length-1:0;++Oe<Ae;)typeof be[J.path[Oe]]>"u"&&(be[J.path[Oe]]=typeof J.path[Oe+1]<"u"&&typeof J.path[Oe+1]=="number"?[]:{}),be=be[J.path[Oe]];switch(J.kind){case"A":J.path&&typeof be[J.path[Oe]]>"u"&&(be[J.path[Oe]]=[]),k(J.path?be[J.path[Oe]]:be,J.index,J.item);break;case"D":delete be[J.path[Oe]];break;case"E":case"N":be[J.path[Oe]]=J.rhs;break}}}function H(ee,W,J){if(J.path&&J.path.length){var be=ee[W],Oe,Ae=J.path.length-1;for(Oe=0;Oe<Ae;Oe++)be=be[J.path[Oe]];switch(J.kind){case"A":H(be[J.path[Oe]],J.index,J.item);break;case"D":be[J.path[Oe]]=J.lhs;break;case"E":be[J.path[Oe]]=J.lhs;break;case"N":delete be[J.path[Oe]];break}}else switch(J.kind){case"A":H(ee[W],J.index,J.item);break;case"D":ee[W]=J.lhs;break;case"E":ee[W]=J.lhs;break;case"N":ee=S(ee,W);break}return ee}function ue(ee,W,J){if(ee&&W&&J&&J.kind){var be=ee,Oe,Ae;for(Ae=J.path.length-1,Oe=0;Oe<Ae;Oe++)typeof be[J.path[Oe]]>"u"&&(be[J.path[Oe]]={}),be=be[J.path[Oe]];switch(J.kind){case"A":H(be[J.path[Oe]],J.index,J.item);break;case"D":be[J.path[Oe]]=J.lhs;break;case"E":be[J.path[Oe]]=J.lhs;break;case"N":delete be[J.path[Oe]];break}}}function ie(ee,W,J){if(ee&&W){var be=function(Oe){(!J||J(ee,W,Oe))&&U(ee,W,Oe)};$(ee,W,be)}}return Object.defineProperties(X,{diff:{value:X,enumerable:!0},orderIndependentDiff:{value:R,enumerable:!0},observableDiff:{value:$,enumerable:!0},orderIndependentObservableDiff:{value:q,enumerable:!0},orderIndepHash:{value:M,enumerable:!0},applyDiff:{value:ie,enumerable:!0},applyChange:{value:U,enumerable:!0},revertChange:{value:ue,enumerable:!0},isConflict:{value:function(){return typeof $conflict<"u"},enumerable:!0}}),X.DeepDiff=X,t&&(t.DeepDiff=X),X})})(CM);var vz=CM.exports,gu={};Object.defineProperty(gu,"__esModule",{value:!0});gu.EDIT_FEATURE_DIALOG=gu.NEW_FEATURE_DIALOG=gu.METADATA_POLYGON_EDITING=gu.DEFAULT_FONT=gu.FONTS=void 0;gu.FONTS=["Klokantech Noto Sans Bold","Klokantech Noto Sans CJK Bold","Klokantech Noto Sans CJK Regular","Klokantech Noto Sans Italic","Klokantech Noto Sans Regular","Noto Sans Bold","Noto Sans Bold Italic","Noto Sans Italic","Noto Sans Regular","Open Sans Bold","Open Sans Italic","Open Sans Regular","Open Sans Semibold","Open Sans Semibold Italic"];gu.DEFAULT_FONT="Klokantech Noto Sans Regular";gu.METADATA_POLYGON_EDITING="proximiio:polygon-editing";var yz=function(e,r){return`
    <h1>Add New Feature</h1>
    <form name="form" id="modal-form" class="modal-form" autocomplete="off" role="main">
      <div>
        <label class="label-id">
          <input type="text" class="text" name="id" placeholder="ID" />
          <span>ID</span>
        </label>
      </div>
      
      <div>
        <label class="label-title">
          <input type="text" class="text" name="title" placeholder="Title" required />
          <span class="required">Title</span>
        </label>
      </div>
      
      <div>
        <label class="label-level">
          <input type="number" class="text" name="level" placeholder="Level" value='`.concat(r||0,`' required />
          <span class="required">Level</span>
        </label>
      </div>
  
      <div>
        <label class="label-lat">
          <input type="text" class="text" name="lat" placeholder="Latitude" value='`).concat(e.lngLat.lat,`' required />
          <span class="required">Latitude</span>
        </label>
      </div>
      
      <div>
        <label class="label-lng">
          <input type="text" class="text" name="lng" placeholder="Longitude" value='`).concat(e.lngLat.lng,`' required />
          <span class="required">Longitude</span>
        </label>
      </div>
      
      <div>
        <label class="label-icon">
          <input type="file" class="text" name="icon" placeholder="Icon" accept="image/*"/>
          <span>Icon</span>
        </label>
      </div>
    </form>
  `)};gu.NEW_FEATURE_DIALOG=yz;var _z=function(e,r){var t,n,i;return`
    <h1>Edit Feature</h1>
    <form name="form" id="modal-form" class="modal-form" autocomplete="off" role="main">
      <div>
        <label class="label-id">
          <input type="text" class="text" name="id" placeholder="ID" value='`.concat((t=r==null?void 0:r.properties)===null||t===void 0?void 0:t.id,`' readonly style="pointer-events: none;background-color: #E9ECEF"/>
          <span>ID</span>
        </label>
      </div>
      
      <div>
        <label class="label-title">
          <input type="text" class="text" name="title" placeholder="Title" value='`).concat((n=r==null?void 0:r.properties)===null||n===void 0?void 0:n.title,`' required />
          <span class="required">Title</span>
        </label>
      </div>
      
      <div>
        <label class="label-level">
          <input type="number" class="text" name="level" placeholder="Level" value='`).concat((i=r==null?void 0:r.properties)===null||i===void 0?void 0:i.level,`' required />
          <span class="required">Level</span>
        </label>
      </div>
  
      <div>
        <label class="label-lat">
          <input type="text" class="text" name="lat" placeholder="Latitude" value='`).concat(e.lngLat.lat,`' required />
          <span class="required">Latitude</span>
        </label>
      </div>
      
      <div>
        <label class="label-lng">
          <input type="text" class="text" name="lng" placeholder="Longitude" value='`).concat(e.lngLat.lng,`' required />
          <span class="required">Longitude</span>
        </label>
      </div>
      
      <div>
        <label class="label-icon">
          <input type="file" class="text" name="icon" placeholder="Icon" accept="image/*"/>
          <span>Icon</span>
        </label>
      </div>
    </form>
  `)};gu.EDIT_FEATURE_DIALOG=_z;var Kx={};Object.defineProperty(Kx,"__esModule",{value:!0});Kx.default={"proximiio:languages":{en:{title:"English",level:{zero:"levels",one:"level",two:"levels",few:"levels",many:"levels",other:"levels"},meter:{zero:"meters",one:"meter",two:"meters",few:"meters",many:"meters",other:"meters"},turn_before:"In %d %s %s.",turn_prepare:"Prepare to %s in %d %s.",turn_now:"%s.",continue:"Continue %d %s.",levelchange:"Use %s to get to %d %s.",turn_left_hard:"turn hard left",turn_left:"turn left",turn_left_slight:"turn slight left",turn_straight:"continue straight",turn_right_slight:"turn slight right",turn_right:"turn right",turn_right_hard:"turn right",turn_around:"turn around",destination_nearing:"In %d %s you will arrive at your destination.",destination_reached:"You have reached your destination",canceled:"Navigation was canceled.",calculating:"Calculating route...",recalculating:"Recalculating route...",path_not_found:"Unable to find path.",level_change_down:"go %d %s up to %s %d.",level_change_up:"go %d %s up to %s %d.",passing_poi:"Passing %s on your %s",left:"left",right:"right"},fi:{title:"English",level:{zero:"levels",one:"level",two:"levels",few:"levels",many:"levels",other:"levels"},meter:{zero:"meters",one:"meter",two:"meters",few:"meters",many:"meters",other:"meters"},turn_before:"In %d %s %s.",turn_prepare:"Prepare to %s in %d %s.",turn_now:"%s.",continue:"Continue %d %s.",levelchange:"Use %s to get to %d %s.",turn_left_hard:"turn hard left",turn_left:"turn left",turn_left_slight:"turn slight left",turn_straight:"continue straight",turn_right_slight:"turn slight right",turn_right:"turn right",turn_right_hard:"turn right",turn_around:"turn around",destination_nearing:"In %d %s you will arrive at your destination.",destination_reached:"You have reached your destination",canceled:"Navigation was canceled.",calculating:"Calculating route...",recalculating:"Recalculating route...",path_not_found:"Unable to find path.",level_change_down:"go %d %s up to %s %d.",level_change_up:"go %d %s up to %s %d.",passing_poi:"Passing %s on your %s",left:"left",right:"right"}},en:{title:"English",level:{zero:"levels",one:"level",two:"levels",few:"levels",many:"levels",other:"levels"},meter:{zero:"meters",one:"meter",two:"meters",few:"meters",many:"meters",other:"meters"},turn_before:"In %d %s %s.",turn_prepare:"Prepare to %s in %d %s.",turn_now:"%s.",continue:"Continue %d %s.",levelchange:"Use %s to get to %d %s.",turn_left_hard:"turn hard left",turn_left:"turn left",turn_left_slight:"turn slight left",turn_straight:"continue straight",turn_right_slight:"turn slight right",turn_right:"turn right",turn_right_hard:"turn right",turn_around:"turn around",destination_nearing:"In %d %s you will arrive at your destination.",destination_reached:"You have reached your destination",canceled:"Navigation was canceled.",calculating:"Calculating route...",recalculating:"Recalculating route...",path_not_found:"Unable to find path.",level_change_down:"go %d %s up to %s %d.",level_change_up:"go %d %s up to %s %d.",passing_poi:"Passing %s on your %s",left:"left",right:"right"}};var Sa=we&&we.__assign||function(){return Sa=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Sa.apply(this,arguments)},GA=we&&we.__spreadArray||function(e,r,t){if(t||arguments.length===2)for(var n=0,i=r.length,l;n<i;n++)(l||!(n in r))&&(l||(l=Array.prototype.slice.call(r,0,n)),l[n]=r[n]);return e.concat(l||Array.prototype.slice.call(r))};Object.defineProperty(vv,"__esModule",{value:!0});var bz=Xs,xz=Jc,wz=Kc,Gh=Qc,zc=_c,Ez=bc,Sz=xc,Pz=eh,Az=th,Iz=rh,Oz=vz,fp=gu,Cz=Kx,Tz=function(){function e(r){this._observers=[],this.overlay=!1,this.segments=!1,this.routable=!1,this.cluster=!0,this.rooms=!0,this.id=r.id,this.organization_id=r.organization_id,this.version=r.version||1,this.name=r.name||"New Style",this.metadata=Object.assign(Cz.default,r.metadata||{}),this.center=r.center||[18.555,48.4437],this.zoom=r.zoom||8,this.bearing=r.bearing||0,this.pitch=r.pitch||0,this.sources=r.sources||[],this.glyphs=r.glyphs||"",this.layers=(r.layers||[]).map(function(t){return t.type==="background"?new xz.default(t).json:t.type==="raster"?new wz.default(t).json:t.type==="fill"?new Gh.default(t).json:t.type==="line"?new zc.default(t).json:t.type==="fill-extrusion"?new Ez.default(t).json:t.type==="symbol"?new Sz.default(t).json:t.type==="heatmap"?new Pz.default(t).json:t.type==="circle"?new Az.default(t).json:t.type==="hillshade"?new Iz.default(t).json:new bz.default(t)}).concat(this.getUniversalLayers("main")).concat(this.getSyntheticLayers())}return e.prototype.on=function(r){this._observers&&this._observers.push(r)},e.prototype.off=function(r){var t=this._observers?this._observers.findIndex(function(n){return n===r}):0;t>=0&&this._observers&&this._observers.splice(t,1)},e.prototype.notify=function(r,t){var n=this;this._observers&&this._observers.forEach(function(i){return i(r,t,n)})},e.prototype.getUniversalLayers=function(r){var t=["all",["==",["geometry-type"],"Polygon"],["any",["==",["get","segment"],!1],["!",["has","segment"]]],["any",["==",["get","routable"],!1],["!",["has","routable"]]],["==",["get","level"],0]],n=["all",["==",["geometry-type"],"Polygon"],["has","segment"],["==",["get","segment"],!0],["==",["get","level"],0]],i=["all",["==",["geometry-type"],"Polygon"],["has","routable"],["==",["get","routable"],!0],["==",["get","level"],0]],l=["all",["==",["geometry-type"],"Polygon"],["has","room"],["==",["get","room"],!0],["==",["get","level"],0]],p={minzoom:1,maxzoom:24,source:r};return[new Gh.default(Sa(Sa({},p),{id:"".concat(r,"-polygon-fill"),type:"fill",filter:t,layout:{visibility:"none"},paint:{"fill-color":"#08c","fill-opacity":.3}})).json,new zc.default(Sa(Sa({},p),{id:"".concat(r,"-polygon-outline"),type:"line",filter:t,layout:{"line-join":"bevel",visibility:"none"},paint:{"line-color":"#08c","line-width":1,"line-opacity":1}})).json,new zc.default(Sa(Sa({},p),{id:"".concat(r,"-room-outline"),type:"line",roomFilter:l,layout:{"line-join":"bevel",visibility:"none"},paint:{"line-color":["get","color"],"line-width":1,"line-opacity":1}})).json,new Gh.default(Sa(Sa({},p),{id:"".concat(r,"-room-fill"),type:"fill",filter:l,layout:{visibility:"none"},paint:{"fill-color":["get","color"],"fill-opacity":.3}})).json,new Gh.default(Sa(Sa({},p),{id:"".concat(r,"-segment-fill"),type:"fill",filter:n,layout:{visibility:"none"},paint:{"fill-color":"#0c8","fill-opacity":.3}})).json,new zc.default(Sa(Sa({},p),{id:"".concat(r,"-segment-outline"),type:"line",filter:n,layout:{"line-join":"bevel",visibility:"none"},paint:{"line-color":"#0c8","line-width":1,"line-opacity":1}})).json,new Gh.default(Sa(Sa({},p),{id:"".concat(r,"-routable-fill"),type:"fill",filter:i,layout:{visibility:"none"},paint:{"fill-color":"#c80","fill-opacity":.3}})).json,new zc.default(Sa(Sa({},p),{id:"".concat(r,"-routable-outline"),type:"line",filter:i,layout:{"line-join":"bevel",visibility:"none"},paint:{"line-color":"#c80","line-width":1,"line-opacity":1}})).json]},e.prototype.getSyntheticLayers=function(){var r=new Gh.default({type:"fill",minzoom:1,maxzoom:24,source:"synthetic",id:"synthetic-polygon-fill",filter:["all",["==",["geometry-type"],"Polygon"]],layout:{visibility:"visible"},paint:{"fill-color":"#08c","fill-opacity":.3}}).json,t=new zc.default({type:"line",minzoom:1,maxzoom:24,source:"synthetic",id:"synthetic-polygon-outline",filter:["all",["==",["geometry-type"],"Polygon"]],layout:{"line-join":"bevel",visibility:"visible"},paint:{"line-color":"#08c","line-width":1,"line-opacity":1}}).json;return[r,t]},e.prototype.usesPrefixes=function(){return typeof this.layers.find(function(r){return r.id==="proximiio-paths"})<"u"},e.prototype.addLayer=function(r,t){t?this.layers.splice(this.getLayerIndex(t)+1,0,r):this.layers.push(r)},e.prototype.getLayer=function(r){return this.layers.find(function(t){return t.id===r})},e.prototype.getLayerIndex=function(r){return this.layers.findIndex(function(t){return t.id===r})},e.prototype.getLayers=function(r){return this.layers.filter(function(t){return t.source&&t.source===r})},e.prototype.addSource=function(r,t){this.sources[r]=t},e.prototype.removeLayer=function(r){this.layers=this.layers.filter(function(t){return t.id!==r})},e.prototype.getSources=function(){var r=this,t=[];return Object.keys(this.sources).forEach(function(n){var i=r.sources[n];i.id=n,t.push(i)}),t},e.prototype.setSource=function(r,t){this.sources[r]=t.source},e.prototype.getSource=function(r){return this.sources[r]},e.prototype.removeSource=function(r){this.sources[r]&&delete this.sources[r]},e.prototype.setLevel=function(r){GA(GA([],this.getLayers("main"),!0),this.getLayers("route"),!0).forEach(function(t){t.filter&&t.filter.forEach(function(n,i){if(t.id==="proximiio-levelchangers"){var l="__level_".concat(r);i===3&&(n[1]=l),i===4&&(n[1][1]=l)}if(Array.isArray(n)){var p=!1;if(n[0]==="=="){var u=n[1];u[0]==="to-number"&&u[1][0]==="get"&&u[1][1]==="level"&&(n[2]=r,p=!0),u[0]==="get"&&u[1]==="level"&&(n[2]=r,p=!0)}if(n[0]==="<="){var u=n[1];u[0]==="to-number"&&u[1][0]==="get"&&u[1][1]==="level_min"&&(n[2]=r,p=!0),u[0]==="get"&&u[1]==="level_min"&&(n[2]=r,p=!0)}if(n[0]===">="){var u=n[1];u[0]==="to-number"&&u[1][0]==="get"&&u[1][1]==="level_max"&&(n[2]=r,p=!0),u[0]==="get"&&u[1]==="level_max"&&(n[2]=r,p=!0)}p&&(t.filter[i]=n)}})}),this.notify("filter-change")},Object.defineProperty(e.prototype,"polygonEditing",{get:function(){return this.metadata[fp.METADATA_POLYGON_EDITING]||!1},enumerable:!1,configurable:!0}),e.prototype.toggleCluster=function(){this.cluster=!this.cluster,this.notify("cluster-toggled")},e.prototype.togglePolygonEditing=function(){this.metadata[fp.METADATA_POLYGON_EDITING]?this.metadata[fp.METADATA_POLYGON_EDITING]=!this.metadata[fp.METADATA_POLYGON_EDITING]:this.metadata[fp.METADATA_POLYGON_EDITING]=!0,this.notify("polygon-editing-toggled")},e.prototype.toggleRooms=function(){this.rooms=!this.rooms,this.notify("roomsss-toggled")},e.prototype.toggleOverlay=function(){this.overlay=!this.overlay,this.notify("overlay-toggled")},e.prototype.toggleSegments=function(){this.segments=!this.segments,this.notify("segments-toggled")},e.prototype.toggleRoutable=function(){this.routable=!this.routable,this.notify("routable-toggled")},e.prototype.togglePaths=function(r){var t=this.layers.find(function(i){return i.id==="proximiio-paths"||i.id==="paths"});if(t){var n=new zc.default(Object.assign({},t.json));n.layout.visibility=r?"visible":"none",this.updateLayer(n)}},e.prototype.updateLayer=function(r){var t=this.getLayerIndex(r.id),n=[];if(t>=0){var i=this.layers[t],l=(0,Oz.diff)(i.json,r.json);l&&(n.push(l),this.layers.splice(t,1,r),this.notify("layer-update",{layer:r,changes:n.length>0?n[0]:[]}))}},e.prototype.setMetadata=function(r,t,n){this.metadata["".concat(r,":").concat(t)]=n,this.notify("metadata-update")},Object.defineProperty(e.prototype,"namespaces",{get:function(){var r=Object.keys(this.metadata),t=r.filter(function(i){return i.indexOf(":")>0}),n=new Set(t.map(function(i){return i.split(":")[0]}));return Array.from(n).sort(function(i,l){return i.localeCompare(l)})},enumerable:!1,configurable:!0}),e.prototype.namespaceItems=function(r){return Object.keys(this.metadata).filter(function(t){return t.indexOf("".concat(r,":"))===0}).map(function(t){return t.split(":").slice(1).join(":")})},Object.defineProperty(e.prototype,"json",{get:function(){var r=Object.assign({},this);return delete r._observers,delete r.overlay,r.layers=this.layers.map(function(t){return t.json}),JSON.parse(JSON.stringify(r))},enumerable:!1,configurable:!0}),e}();vv.default=Tz;var TM=we&&we.__awaiter||function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(p){p(l)})}return new(t||(t=Promise))(function(l,p){function u(S){try{m(n.next(S))}catch(P){p(P)}}function _(S){try{m(n.throw(S))}catch(P){p(P)}}function m(S){S.done?l(S.value):i(S.value).then(u,_)}m((n=n.apply(e,r||[])).next())})},MM=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;p&&(p=0,m[0]&&(t=0)),t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(yc,"__esModule",{value:!0});yc.getStyleUrl=yc.getStyles=yc.getStyle=void 0;var Qx=Wu,LM=vv,Mz=function(e){return TM(void 0,void 0,void 0,function(){var r,t;return MM(this,function(n){switch(n.label){case 0:return r="/v5/geo/style",e&&(r+="s/".concat(e)),[4,Qx.axios.get(r)];case 1:return t=n.sent(),[2,new LM.default(t.data)]}})})};yc.getStyle=Mz;var Lz=function(){return TM(void 0,void 0,void 0,function(){var e,r;return MM(this,function(t){switch(t.label){case 0:return e="/v5/geo/styles",[4,Qx.axios.get(e)];case 1:return r=t.sent(),[2,r.data.map(function(n){return new LM.default(n)})]}})})};yc.getStyles=Lz;var Rz=function(){return"https://api.proximi.fi/v5/geo/style?token=".concat(Qx.axios.defaults.headers.common.Authorization)};yc.getStyleUrl=Rz;var _1={},Ts={},md={};Object.defineProperty(md,"__esModule",{value:!0});md.POI_TYPE=void 0;md.POI_TYPE={POI:"poi",HAZARD:"hazard",DOOR:"door",ENTRANCE:"entrance",TICKET_GATE:"ticket_gate",DECISION:"decision",LANDMARK:"landmark",ELEVATOR:"elevator",ESCALATOR:"escalator",STAIRCASE:"staircase",RAMP:"ramp",TEXT:"text"};var Dz=function(){function e(r,t,n){this.type=r,this.title=t,this.icon=n}return e}();md.default=Dz;var Nz=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Ts,"__esModule",{value:!0});Ts.FeatureCollection=Ts.Geometry=void 0;var Fz=Sf,pl=md,RM=function(){function e(r){this.type=r.type,this.coordinates=r.coordinates}return e}();Ts.Geometry=RM;var kz=function(){function e(r){this.type="FeatureCollection",this.features=(r.features||[]).map(function(t){return new DM(t).json})}return Object.defineProperty(e.prototype,"json",{get:function(){return{type:"FeatureCollection",features:this.features.map(function(r){return r.json})}},enumerable:!1,configurable:!0}),e}();Ts.FeatureCollection=kz;var DM=function(e){Nz(r,e);function r(t){var n=e.call(this,t)||this;return n.type="Feature",n.id=t.id,n.geometry=new RM(t.geometry),n.properties=t.properties||{},typeof n.properties.title_i18n=="string"&&(n.properties.title_i18n=JSON.parse(n.properties.title_i18n)),n.isPoint&&(n.properties.images||(n.properties.images=[]),n.properties.range||(n.properties.range=3)),typeof n.properties.images=="string"&&(n.properties.images=JSON.parse(n.properties.images)),n.isLevelChanger&&Array.isArray(n.properties.levels)&&n.properties.levels.forEach(function(i){return n.properties["__level_".concat(i)]=!0}),n.properties.type==="text"&&Array.isArray(n.properties.textFont)&&(n.properties.textFont=n.properties.textFont[0]),n}return Object.defineProperty(r.prototype,"isEditable",{get:function(){return this.isPoint||this.isLineString||this.isPolygon},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isPoint",{get:function(){return this.geometry.type==="Point"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isPolygon",{get:function(){return this.geometry.type==="Polygon"||this.geometry.type==="MultiPolygon"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isLineString",{get:function(){return this.geometry.type==="LineString"||this.geometry.type==="MultiLineString"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isHazard",{get:function(){return this.properties.type===pl.POI_TYPE.HAZARD},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isLandmark",{get:function(){return this.properties.type===pl.POI_TYPE.LANDMARK},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isDoor",{get:function(){return this.properties.type===pl.POI_TYPE.DOOR},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isEntrance",{get:function(){return this.properties.type===pl.POI_TYPE.ENTRANCE},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isDecisionPoint",{get:function(){return this.properties.type===pl.POI_TYPE.DECISION},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isTicketGate",{get:function(){return this.properties.type===pl.POI_TYPE.TICKET_GATE},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isElevator",{get:function(){return this.properties.type===pl.POI_TYPE.ELEVATOR},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isEscalator",{get:function(){return this.properties.type===pl.POI_TYPE.ESCALATOR},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isStairCase",{get:function(){return this.properties.type===pl.POI_TYPE.STAIRCASE},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isRamp",{get:function(){return this.properties.type===pl.POI_TYPE.RAMP},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isLevelChanger",{get:function(){return this.isElevator||this.isEscalator||this.isStairCase||this.isRamp},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isText",{get:function(){return this.properties.type==="text"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isSynthetic",{get:function(){var t=["id","place_id","floor_id","level"];return(this.geometry.type==="LineString"||this.geometry.type==="MultiLineString")&&t.push("class"),Object.keys(this.properties).map(function(n){return!t.includes(n)}).filter(function(n){return n}).length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isRoom",{get:function(){return this.properties.room},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isRouting",{get:function(){return this.properties.usecase==="routing"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"getTitle",{get:function(){return this.properties.title},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"getTitleWithLevel",{get:function(){return"".concat(this.properties.title," - Level: ").concat(this.properties.level)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"json",{get:function(){this.properties.cameFrom&&delete this.properties.cameFrom,this.properties.fixedPointMap&&delete this.properties.fixedPointMap;var t=JSON.parse(JSON.stringify(this));if(t.properties.metadata&&typeof t.properties.metadata!="object")try{t.properties.metadata=JSON.parse(t.properties.metadata)}catch{}return Object.keys(t.properties).forEach(function(n){n.match("__level")&&delete t.properties.key}),t},enumerable:!1,configurable:!0}),r.point=function(t,n,i,l){return new r({id:t,geometry:{type:"Point",coordinates:[i,n]},properties:l})},r.prototype.setTitle=function(t,n){n===void 0&&(n="en"),typeof this.properties.title_18n>"u"&&(this.properties.title_18n={}),this.properties.title_18n[n]=t},r.prototype.hasLevel=function(t){return this.isLevelChanger?this.properties.levels.includes(t):this.properties.level===t},r}(Fz.default);Ts.default=DM;var yv={},Bz=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(yv,"__esModule",{value:!0});yv.AmenityModel=void 0;var zz=Sf,jz=function(e){Bz(r,e);function r(t){var n=e.call(this,t)||this;return n.category=t.category,n.iconOffset=t.iconOffset,n.list=t.list,n.title=t.title,n.description=t.description,n.icon=t.icon,n}return Object.defineProperty(r.prototype,"hasIcon",{get:function(){return!!this.icon},enumerable:!1,configurable:!0}),r}(zz.default);yv.AmenityModel=jz;var vd={},ew={exports:{}},ja={},nr={},zt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=63710088e-1,e.factors={centimeters:e.earthRadius*100,centimetres:e.earthRadius*100,degrees:e.earthRadius/111325,feet:e.earthRadius*3.28084,inches:e.earthRadius*39.37,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:e.earthRadius*1e3,millimetres:e.earthRadius*1e3,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius*1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function r(be,Oe,Ae){Ae===void 0&&(Ae={});var ae={type:"Feature"};return(Ae.id===0||Ae.id)&&(ae.id=Ae.id),Ae.bbox&&(ae.bbox=Ae.bbox),ae.properties=Oe||{},ae.geometry=be,ae}e.feature=r;function t(be,Oe,Ae){switch(be){case"Point":return n(Oe).geometry;case"LineString":return u(Oe).geometry;case"Polygon":return l(Oe).geometry;case"MultiPoint":return P(Oe).geometry;case"MultiLineString":return S(Oe).geometry;case"MultiPolygon":return O(Oe).geometry;default:throw new Error(be+" is invalid")}}e.geometry=t;function n(be,Oe,Ae){if(Ae===void 0&&(Ae={}),!be)throw new Error("coordinates is required");if(!Array.isArray(be))throw new Error("coordinates must be an Array");if(be.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ie(be[0])||!ie(be[1]))throw new Error("coordinates must contain numbers");var ae={type:"Point",coordinates:be};return r(ae,Oe,Ae)}e.point=n;function i(be,Oe,Ae){return Ae===void 0&&(Ae={}),m(be.map(function(ae){return n(ae,Oe)}),Ae)}e.points=i;function l(be,Oe,Ae){Ae===void 0&&(Ae={});for(var ae=0,ct=be;ae<ct.length;ae++){var Pe=ct[ae];if(Pe.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var V=0;V<Pe[Pe.length-1].length;V++)if(Pe[Pe.length-1][V]!==Pe[0][V])throw new Error("First and last Position are not equivalent.")}var Q={type:"Polygon",coordinates:be};return r(Q,Oe,Ae)}e.polygon=l;function p(be,Oe,Ae){return Ae===void 0&&(Ae={}),m(be.map(function(ae){return l(ae,Oe)}),Ae)}e.polygons=p;function u(be,Oe,Ae){if(Ae===void 0&&(Ae={}),be.length<2)throw new Error("coordinates must be an array of two or more positions");var ae={type:"LineString",coordinates:be};return r(ae,Oe,Ae)}e.lineString=u;function _(be,Oe,Ae){return Ae===void 0&&(Ae={}),m(be.map(function(ae){return u(ae,Oe)}),Ae)}e.lineStrings=_;function m(be,Oe){Oe===void 0&&(Oe={});var Ae={type:"FeatureCollection"};return Oe.id&&(Ae.id=Oe.id),Oe.bbox&&(Ae.bbox=Oe.bbox),Ae.features=be,Ae}e.featureCollection=m;function S(be,Oe,Ae){Ae===void 0&&(Ae={});var ae={type:"MultiLineString",coordinates:be};return r(ae,Oe,Ae)}e.multiLineString=S;function P(be,Oe,Ae){Ae===void 0&&(Ae={});var ae={type:"MultiPoint",coordinates:be};return r(ae,Oe,Ae)}e.multiPoint=P;function O(be,Oe,Ae){Ae===void 0&&(Ae={});var ae={type:"MultiPolygon",coordinates:be};return r(ae,Oe,Ae)}e.multiPolygon=O;function M(be,Oe,Ae){Ae===void 0&&(Ae={});var ae={type:"GeometryCollection",geometries:be};return r(ae,Oe,Ae)}e.geometryCollection=M;function B(be,Oe){if(Oe===void 0&&(Oe=0),Oe&&!(Oe>=0))throw new Error("precision must be a positive number");var Ae=Math.pow(10,Oe||0);return Math.round(be*Ae)/Ae}e.round=B;function $(be,Oe){Oe===void 0&&(Oe="kilometers");var Ae=e.factors[Oe];if(!Ae)throw new Error(Oe+" units is invalid");return be*Ae}e.radiansToLength=$;function q(be,Oe){Oe===void 0&&(Oe="kilometers");var Ae=e.factors[Oe];if(!Ae)throw new Error(Oe+" units is invalid");return be/Ae}e.lengthToRadians=q;function X(be,Oe){return k(q(be,Oe))}e.lengthToDegrees=X;function R(be){var Oe=be%360;return Oe<0&&(Oe+=360),Oe}e.bearingToAzimuth=R;function k(be){var Oe=be%(2*Math.PI);return Oe*180/Math.PI}e.radiansToDegrees=k;function U(be){var Oe=be%360;return Oe*Math.PI/180}e.degreesToRadians=U;function H(be,Oe,Ae){if(Oe===void 0&&(Oe="kilometers"),Ae===void 0&&(Ae="kilometers"),!(be>=0))throw new Error("length must be a positive number");return $(q(be,Oe),Ae)}e.convertLength=H;function ue(be,Oe,Ae){if(Oe===void 0&&(Oe="meters"),Ae===void 0&&(Ae="kilometers"),!(be>=0))throw new Error("area must be a positive number");var ae=e.areaFactors[Oe];if(!ae)throw new Error("invalid original units");var ct=e.areaFactors[Ae];if(!ct)throw new Error("invalid final units");return be/ae*ct}e.convertArea=ue;function ie(be){return!isNaN(be)&&be!==null&&!Array.isArray(be)}e.isNumber=ie;function ee(be){return!!be&&be.constructor===Object}e.isObject=ee;function W(be){if(!be)throw new Error("bbox is required");if(!Array.isArray(be))throw new Error("bbox must be an Array");if(be.length!==4&&be.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");be.forEach(function(Oe){if(!ie(Oe))throw new Error("bbox must only contain numbers")})}e.validateBBox=W;function J(be){if(!be)throw new Error("id is required");if(["string","number"].indexOf(typeof be)===-1)throw new Error("id must be a number or a string")}e.validateId=J})(zt);Object.defineProperty(nr,"__esModule",{value:!0});var fs=zt;function yd(e,r,t){if(e!==null)for(var n,i,l,p,u,_,m,S=0,P=0,O,M=e.type,B=M==="FeatureCollection",$=M==="Feature",q=B?e.features.length:1,X=0;X<q;X++){m=B?e.features[X].geometry:$?e.geometry:e,O=m?m.type==="GeometryCollection":!1,u=O?m.geometries.length:1;for(var R=0;R<u;R++){var k=0,U=0;if(p=O?m.geometries[R]:m,p!==null){_=p.coordinates;var H=p.type;switch(S=t&&(H==="Polygon"||H==="MultiPolygon")?1:0,H){case null:break;case"Point":if(r(_,P,X,k,U)===!1)return!1;P++,k++;break;case"LineString":case"MultiPoint":for(n=0;n<_.length;n++){if(r(_[n],P,X,k,U)===!1)return!1;P++,H==="MultiPoint"&&k++}H==="LineString"&&k++;break;case"Polygon":case"MultiLineString":for(n=0;n<_.length;n++){for(i=0;i<_[n].length-S;i++){if(r(_[n][i],P,X,k,U)===!1)return!1;P++}H==="MultiLineString"&&k++,H==="Polygon"&&U++}H==="Polygon"&&k++;break;case"MultiPolygon":for(n=0;n<_.length;n++){for(U=0,i=0;i<_[n].length;i++){for(l=0;l<_[n][i].length-S;l++){if(r(_[n][i][l],P,X,k,U)===!1)return!1;P++}U++}k++}break;case"GeometryCollection":for(n=0;n<p.geometries.length;n++)if(yd(p.geometries[n],r,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Uz(e,r,t,n){var i=t;return yd(e,function(l,p,u,_,m){p===0&&t===void 0?i=l:i=r(i,l,p,u,_,m)},n),i}function NM(e,r){var t;switch(e.type){case"FeatureCollection":for(t=0;t<e.features.length&&r(e.features[t].properties,t)!==!1;t++);break;case"Feature":r(e.properties,0);break}}function $z(e,r,t){var n=t;return NM(e,function(i,l){l===0&&t===void 0?n=i:n=r(n,i,l)}),n}function FM(e,r){if(e.type==="Feature")r(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length&&r(e.features[t],t)!==!1;t++);}function Gz(e,r,t){var n=t;return FM(e,function(i,l){l===0&&t===void 0?n=i:n=r(n,i,l)}),n}function qz(e){var r=[];return yd(e,function(t){r.push(t)}),r}function tw(e,r){var t,n,i,l,p,u,_,m,S,P,O=0,M=e.type==="FeatureCollection",B=e.type==="Feature",$=M?e.features.length:1;for(t=0;t<$;t++){for(u=M?e.features[t].geometry:B?e.geometry:e,m=M?e.features[t].properties:B?e.properties:{},S=M?e.features[t].bbox:B?e.bbox:void 0,P=M?e.features[t].id:B?e.id:void 0,_=u?u.type==="GeometryCollection":!1,p=_?u.geometries.length:1,i=0;i<p;i++){if(l=_?u.geometries[i]:u,l===null){if(r(null,O,m,S,P)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(l,O,m,S,P)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<l.geometries.length;n++)if(r(l.geometries[n],O,m,S,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}O++}}function Vz(e,r,t){var n=t;return tw(e,function(i,l,p,u,_){l===0&&t===void 0?n=i:n=r(n,i,l,p,u,_)}),n}function _v(e,r){tw(e,function(t,n,i,l,p){var u=t===null?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return r(fs.feature(t,i,{bbox:l,id:p}),n,0)===!1?!1:void 0}var _;switch(u){case"MultiPoint":_="Point";break;case"MultiLineString":_="LineString";break;case"MultiPolygon":_="Polygon";break}for(var m=0;m<t.coordinates.length;m++){var S=t.coordinates[m],P={type:_,coordinates:S};if(r(fs.feature(P,i),n,m)===!1)return!1}})}function Xz(e,r,t){var n=t;return _v(e,function(i,l,p){l===0&&p===0&&t===void 0?n=i:n=r(n,i,l,p)}),n}function kM(e,r){_v(e,function(t,n,i){var l=0;if(t.geometry){var p=t.geometry.type;if(!(p==="Point"||p==="MultiPoint")){var u,_=0,m=0,S=0;if(yd(t,function(P,O,M,B,$){if(u===void 0||n>_||B>m||$>S){u=P,_=n,m=B,S=$,l=0;return}var q=fs.lineString([u,P],t.properties);if(r(q,n,i,$,l)===!1)return!1;l++,u=P})===!1)return!1}}})}function Yz(e,r,t){var n=t,i=!1;return kM(e,function(l,p,u,_,m){i===!1&&t===void 0?n=l:n=r(n,l,p,u,_,m),i=!0}),n}function BM(e,r){if(!e)throw new Error("geojson is required");_v(e,function(t,n,i){if(t.geometry!==null){var l=t.geometry.type,p=t.geometry.coordinates;switch(l){case"LineString":if(r(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var u=0;u<p.length;u++)if(r(fs.lineString(p[u],t.properties),n,i,u)===!1)return!1;break}}})}function Wz(e,r,t){var n=t;return BM(e,function(i,l,p,u){l===0&&t===void 0?n=i:n=r(n,i,l,p,u)}),n}function Zz(e,r){if(r=r||{},!fs.isObject(r))throw new Error("options is invalid");var t=r.featureIndex||0,n=r.multiFeatureIndex||0,i=r.geometryIndex||0,l=r.segmentIndex||0,p=r.properties,u;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),p=p||e.features[t].properties,u=e.features[t].geometry;break;case"Feature":p=p||e.properties,u=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=e;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var _=u.coordinates;switch(u.type){case"Point":case"MultiPoint":return null;case"LineString":return l<0&&(l=_.length+l-1),fs.lineString([_[l],_[l+1]],p,r);case"Polygon":return i<0&&(i=_.length+i),l<0&&(l=_[i].length+l-1),fs.lineString([_[i][l],_[i][l+1]],p,r);case"MultiLineString":return n<0&&(n=_.length+n),l<0&&(l=_[n].length+l-1),fs.lineString([_[n][l],_[n][l+1]],p,r);case"MultiPolygon":return n<0&&(n=_.length+n),i<0&&(i=_[n].length+i),l<0&&(l=_[n][i].length-l-1),fs.lineString([_[n][i][l],_[n][i][l+1]],p,r)}throw new Error("geojson is invalid")}function Hz(e,r){if(r=r||{},!fs.isObject(r))throw new Error("options is invalid");var t=r.featureIndex||0,n=r.multiFeatureIndex||0,i=r.geometryIndex||0,l=r.coordIndex||0,p=r.properties,u;switch(e.type){case"FeatureCollection":t<0&&(t=e.features.length+t),p=p||e.features[t].properties,u=e.features[t].geometry;break;case"Feature":p=p||e.properties,u=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=e;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var _=u.coordinates;switch(u.type){case"Point":return fs.point(_,p,r);case"MultiPoint":return n<0&&(n=_.length+n),fs.point(_[n],p,r);case"LineString":return l<0&&(l=_.length+l),fs.point(_[l],p,r);case"Polygon":return i<0&&(i=_.length+i),l<0&&(l=_[i].length+l),fs.point(_[i][l],p,r);case"MultiLineString":return n<0&&(n=_.length+n),l<0&&(l=_[n].length+l),fs.point(_[n][l],p,r);case"MultiPolygon":return n<0&&(n=_.length+n),i<0&&(i=_[n].length+i),l<0&&(l=_[n][i].length-l),fs.point(_[n][i][l],p,r)}throw new Error("geojson is invalid")}nr.coordAll=qz;nr.coordEach=yd;nr.coordReduce=Uz;nr.featureEach=FM;nr.featureReduce=Gz;nr.findPoint=Hz;nr.findSegment=Zz;nr.flattenEach=_v;nr.flattenReduce=Xz;nr.geomEach=tw;nr.geomReduce=Vz;nr.lineEach=BM;nr.lineReduce=Wz;nr.propEach=NM;nr.propReduce=$z;nr.segmentEach=kM;nr.segmentReduce=Yz;Object.defineProperty(ja,"__esModule",{value:!0});var Jz=nr;function Pb(e){var r=[1/0,1/0,-1/0,-1/0];return Jz.coordEach(e,function(t){r[0]>t[0]&&(r[0]=t[0]),r[1]>t[1]&&(r[1]=t[1]),r[2]<t[0]&&(r[2]=t[0]),r[3]<t[1]&&(r[3]=t[1])}),r}Pb.default=Pb;ja.default=Pb;var vr={};Object.defineProperty(vr,"__esModule",{value:!0});var qA=zt;function Kz(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}vr.getCoord=Kz;function Qz(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}vr.getCoords=Qz;function zM(e){if(e.length>1&&qA.isNumber(e[0])&&qA.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return zM(e[0]);throw new Error("coordinates must only contain numbers")}vr.containsNumber=zM;function e4(e,r,t){if(!r||!t)throw new Error("type and name required");if(!e||e.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+e.type)}vr.geojsonType=e4;function t4(e,r,t){if(!e)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!e.geometry||e.geometry.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+e.geometry.type)}vr.featureOf=t4;function r4(e,r,t){if(!e)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(var n=0,i=e.features;n<i.length;n++){var l=i[n];if(!l||l.type!=="Feature"||!l.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!l.geometry||l.geometry.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+l.geometry.type)}}vr.collectionOf=r4;function n4(e){return e.type==="Feature"?e.geometry:e}vr.getGeom=n4;function i4(e,r){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}vr.getType=i4;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var VA=Object.getOwnPropertySymbols,o4=Object.prototype.hasOwnProperty,a4=Object.prototype.propertyIsEnumerable;function s4(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function u4(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(r).map(function(l){return r[l]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(l){i[l]=l}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var rw=u4()?Object.assign:function(e,r){for(var t,n=s4(e),i,l=1;l<arguments.length;l++){t=Object(arguments[l]);for(var p in t)o4.call(t,p)&&(n[p]=t[p]);if(VA){i=VA(t);for(var u=0;u<i.length;u++)a4.call(t,i[u])&&(n[i[u]]=t[i[u]])}}return n},l4=ja,jM=nr,ql=vr,Up=zt,c4=rw;function UM(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var h4=UM(l4),f4=UM(c4);/**
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 *
 * MarchingSquaresJS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * MarchingSquaresJS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * As additional permission under GNU Affero General Public License version 3
 * section 7, third-party projects (personal or commercial) may distribute,
 * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 * requirement that said third-party project for that reason alone becomes
 * subject to any requirement of the GNU Affero General Public License version 3.
 * Any modifications to MarchingSquaresJS, however, must be shared with the public
 * and made available.
 *
 * In summary this:
 * - allows you to use MarchingSquaresJS at no cost
 * - allows you to use MarchingSquaresJS for both personal and commercial purposes
 * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
 *   license as long as this license notice is included
 * - enables you to keep the source code of your program that uses MarchingSquaresJS
 *   undisclosed
 * - forces you to share any modifications you have made to MarchingSquaresJS,
 *   e.g. bug-fixes
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 */var XA={successCallback:null,verbose:!1},$g={};function p4(e,r,t){t=t||{};for(var n=Object.keys(XA),i=0;i<n.length;i++){var l=n[i],p=t[l];p=typeof p<"u"&&p!==null?p:XA[l],$g[l]=p}$g.verbose;var u=m4(d4(e,r));return typeof $g.successCallback=="function"&&$g.successCallback(u),u}function ni(e,r,t){return(e-r)/(t-r)}function d4(e,r){for(var t=e.length-1,n=e[0].length-1,i={rows:t,cols:n,cells:[]},l=0;l<t;++l){i.cells[l]=[];for(var p=0;p<n;++p){var u=0,_=e[l+1][p],m=e[l+1][p+1],S=e[l][p+1],P=e[l][p];if(!(isNaN(_)||isNaN(m)||isNaN(S)||isNaN(P))){u|=_>=r?8:0,u|=m>=r?4:0,u|=S>=r?2:0,u|=P>=r?1:0;var O=!1;if(u===5||u===10){var M=(_+m+S+P)/4;u===5&&M<r?(u=10,O=!0):u===10&&M<r&&(u=5,O=!0)}if(u!==0&&u!==15){var B,$,q,X;B=$=q=X=.5,u===1?(q=1-ni(r,_,P),$=1-ni(r,S,P)):u===2?($=ni(r,P,S),X=1-ni(r,m,S)):u===3?(q=1-ni(r,_,P),X=1-ni(r,m,S)):u===4?(B=ni(r,_,m),X=ni(r,S,m)):u===5?(B=ni(r,_,m),X=ni(r,S,m),$=1-ni(r,S,P),q=1-ni(r,_,P)):u===6?($=ni(r,P,S),B=ni(r,_,m)):u===7?(q=1-ni(r,_,P),B=ni(r,_,m)):u===8?(q=ni(r,P,_),B=1-ni(r,m,_)):u===9?($=1-ni(r,S,P),B=1-ni(r,m,_)):u===10?(B=1-ni(r,m,_),X=1-ni(r,m,S),$=ni(r,P,S),q=ni(r,P,_)):u===11?(B=1-ni(r,m,_),X=1-ni(r,m,S)):u===12?(q=ni(r,P,_),X=ni(r,S,m)):u===13?($=1-ni(r,S,P),X=ni(r,S,m)):u===14&&(q=ni(r,P,_),$=ni(r,P,S)),i.cells[l][p]={cval:u,flipped:O,top:B,right:X,bottom:$,left:q}}}}}return i}function g4(e){return e.cval===5||e.cval===10}function $M(e){return e.cval===0||e.cval===15}function YA(e){!$M(e)&&e.cval!==5&&e.cval!==10&&(e.cval=15)}function b1(e,r){if(r==="top")return[e.top,1];if(r==="bottom")return[e.bottom,0];if(r==="right")return[1,e.right];if(r==="left")return[0,e.left]}function m4(e){var r=[],t=0,n=1e-7;return e.cells.forEach(function(i,l){i.forEach(function(p,u){if(typeof p<"u"&&!g4(p)&&!$M(p)){var _=v4(e.cells,l,u),m=!1;if(_.info==="mergeable"){for(var S=_.path[_.path.length-1][0],P=_.path[_.path.length-1][1],O=t-1;O>=0;O--)if(Math.abs(r[O][0][0]-S)<=n&&Math.abs(r[O][0][1]-P)<=n){for(var M=_.path.length-2;M>=0;--M)r[O].unshift(_.path[M]);m=!0;break}}m||(r[t++]=_.path)}})}),r}function v4(e,r,t){var n=e.length,i=[],l=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],p=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u,_,m=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],S=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],M,P=e[r][t],O=P.cval,M=m[O],B=b1(P,M);i.push([t+B[0],r+B[1]]),M=S[O],B=b1(P,M),i.push([t+B[0],r+B[1]]),YA(P);for(var $=t+l[O],q=r+p[O],X=O;$>=0&&q>=0&&q<n&&($!=t||q!=r)&&(P=e[q][$],!(typeof P>"u"));){if(O=P.cval,O===0||O===15)return{path:i,info:"mergeable"};M=S[O],u=l[O],_=p[O],(O===5||O===10)&&(O===5?P.flipped?p[X]===-1?(M="left",u=-1,_=0):(M="right",u=1,_=0):l[X]===-1&&(M="bottom",u=0,_=-1):O===10&&(P.flipped?l[X]===-1?(M="top",u=0,_=1):(M="bottom",u=0,_=-1):p[X]===1&&(M="left",u=-1,_=0))),B=b1(P,M),i.push([$+B[0],q+B[1]]),YA(P),$+=u,q+=_,X=O}return{path:i,info:"closed"}}function y4(e,r){if(r=r||{},!Up.isObject(r))throw new Error("options is invalid");var t=r.zProperty||"elevation",n=r.flip,i=r.flags;ql.collectionOf(e,"Point","input must contain Points");for(var l=_4(e,n),p=[],u=0;u<l.length;u++){for(var _=l[u],m=[],S=0;S<_.length;S++){var P=_[S];P.properties[t]?m.push(P.properties[t]):m.push(0),i===!0&&(P.properties.matrixPosition=[u,S])}p.push(m)}return p}function _4(e,r){var t={};jM.featureEach(e,function(l){var p=ql.getCoords(l)[1];t[p]||(t[p]=[]),t[p].push(l)});var n=Object.keys(t).map(function(l){var p=t[l],u=p.sort(function(_,m){return ql.getCoords(_)[0]-ql.getCoords(m)[0]});return u}),i=n.sort(function(l,p){return r?ql.getCoords(l[0])[1]-ql.getCoords(p[0])[1]:ql.getCoords(p[0])[1]-ql.getCoords(l[0])[1]});return i}function GM(e,r,t){if(t=t||{},!Up.isObject(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",i=t.commonProperties||{},l=t.breaksProperties||[];if(ql.collectionOf(e,"Point","Input must contain Points"),!r)throw new Error("breaks is required");if(!Array.isArray(r))throw new Error("breaks must be an Array");if(!Up.isObject(i))throw new Error("commonProperties must be an Object");if(!Array.isArray(l))throw new Error("breaksProperties must be an Array");var p=y4(e,{zProperty:n,flip:!0}),u=b4(p,r,n,i,l),_=x4(u,p,e);return Up.featureCollection(_)}function b4(e,r,t,n,i){for(var l=[],p=1;p<r.length;p++){var u=+r[p],_=f4.default({},n,i[p]);_[t]=u;var m=Up.multiLineString(p4(e,u),_);l.push(m)}return l}function x4(e,r,t){var n=h4.default(t),i=n[2]-n[0],l=n[3]-n[1],p=n[0],u=n[1],_=r[0].length-1,m=r.length-1,S=i/_,P=l/m,O=function(M){M[0]=M[0]*S+p,M[1]=M[1]*P+u};return e.forEach(function(M){jM.coordEach(M,O)}),e}ew.exports=GM;ew.exports.default=GM;var w4=ew.exports,bv={},nw={exports:{}},qM={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(we,function(){function t(R,k,U,H,ue){(function ie(ee,W,J,be,Oe){for(;be>J;){if(be-J>600){var Ae=be-J+1,ae=W-J+1,ct=Math.log(Ae),Pe=.5*Math.exp(2*ct/3),V=.5*Math.sqrt(ct*Pe*(Ae-Pe)/Ae)*(ae-Ae/2<0?-1:1),Q=Math.max(J,Math.floor(W-ae*Pe/Ae+V)),he=Math.min(be,Math.floor(W+(Ae-ae)*Pe/Ae+V));ie(ee,W,Q,he,Oe)}var fe=ee[W],ye=J,se=be;for(n(ee,J,W),Oe(ee[be],fe)>0&&n(ee,J,be);ye<se;){for(n(ee,ye,se),ye++,se--;Oe(ee[ye],fe)<0;)ye++;for(;Oe(ee[se],fe)>0;)se--}Oe(ee[J],fe)===0?n(ee,J,se):n(ee,++se,be),se<=W&&(J=se+1),W<=se&&(be=se-1)}})(R,k,U||0,H||R.length-1,ue||i)}function n(R,k,U){var H=R[k];R[k]=R[U],R[U]=H}function i(R,k){return R<k?-1:R>k?1:0}var l=function(R){R===void 0&&(R=9),this._maxEntries=Math.max(4,R),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function p(R,k,U){if(!U)return k.indexOf(R);for(var H=0;H<k.length;H++)if(U(R,k[H]))return H;return-1}function u(R,k){_(R,0,R.children.length,k,R)}function _(R,k,U,H,ue){ue||(ue=q(null)),ue.minX=1/0,ue.minY=1/0,ue.maxX=-1/0,ue.maxY=-1/0;for(var ie=k;ie<U;ie++){var ee=R.children[ie];m(ue,R.leaf?H(ee):ee)}return ue}function m(R,k){return R.minX=Math.min(R.minX,k.minX),R.minY=Math.min(R.minY,k.minY),R.maxX=Math.max(R.maxX,k.maxX),R.maxY=Math.max(R.maxY,k.maxY),R}function S(R,k){return R.minX-k.minX}function P(R,k){return R.minY-k.minY}function O(R){return(R.maxX-R.minX)*(R.maxY-R.minY)}function M(R){return R.maxX-R.minX+(R.maxY-R.minY)}function B(R,k){return R.minX<=k.minX&&R.minY<=k.minY&&k.maxX<=R.maxX&&k.maxY<=R.maxY}function $(R,k){return k.minX<=R.maxX&&k.minY<=R.maxY&&k.maxX>=R.minX&&k.maxY>=R.minY}function q(R){return{children:R,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function X(R,k,U,H,ue){for(var ie=[k,U];ie.length;)if(!((U=ie.pop())-(k=ie.pop())<=H)){var ee=k+Math.ceil((U-k)/H/2)*H;t(R,ee,k,U,ue),ie.push(k,ee,ee,U)}}return l.prototype.all=function(){return this._all(this.data,[])},l.prototype.search=function(R){var k=this.data,U=[];if(!$(R,k))return U;for(var H=this.toBBox,ue=[];k;){for(var ie=0;ie<k.children.length;ie++){var ee=k.children[ie],W=k.leaf?H(ee):ee;$(R,W)&&(k.leaf?U.push(ee):B(R,W)?this._all(ee,U):ue.push(ee))}k=ue.pop()}return U},l.prototype.collides=function(R){var k=this.data;if(!$(R,k))return!1;for(var U=[];k;){for(var H=0;H<k.children.length;H++){var ue=k.children[H],ie=k.leaf?this.toBBox(ue):ue;if($(R,ie)){if(k.leaf||B(R,ie))return!0;U.push(ue)}}k=U.pop()}return!1},l.prototype.load=function(R){if(!R||!R.length)return this;if(R.length<this._minEntries){for(var k=0;k<R.length;k++)this.insert(R[k]);return this}var U=this._build(R.slice(),0,R.length-1,0);if(this.data.children.length)if(this.data.height===U.height)this._splitRoot(this.data,U);else{if(this.data.height<U.height){var H=this.data;this.data=U,U=H}this._insert(U,this.data.height-U.height-1,!0)}else this.data=U;return this},l.prototype.insert=function(R){return R&&this._insert(R,this.data.height-1),this},l.prototype.clear=function(){return this.data=q([]),this},l.prototype.remove=function(R,k){if(!R)return this;for(var U,H,ue,ie=this.data,ee=this.toBBox(R),W=[],J=[];ie||W.length;){if(ie||(ie=W.pop(),H=W[W.length-1],U=J.pop(),ue=!0),ie.leaf){var be=p(R,ie.children,k);if(be!==-1)return ie.children.splice(be,1),W.push(ie),this._condense(W),this}ue||ie.leaf||!B(ie,ee)?H?(U++,ie=H.children[U],ue=!1):ie=null:(W.push(ie),J.push(U),U=0,H=ie,ie=ie.children[0])}return this},l.prototype.toBBox=function(R){return R},l.prototype.compareMinX=function(R,k){return R.minX-k.minX},l.prototype.compareMinY=function(R,k){return R.minY-k.minY},l.prototype.toJSON=function(){return this.data},l.prototype.fromJSON=function(R){return this.data=R,this},l.prototype._all=function(R,k){for(var U=[];R;)R.leaf?k.push.apply(k,R.children):U.push.apply(U,R.children),R=U.pop();return k},l.prototype._build=function(R,k,U,H){var ue,ie=U-k+1,ee=this._maxEntries;if(ie<=ee)return u(ue=q(R.slice(k,U+1)),this.toBBox),ue;H||(H=Math.ceil(Math.log(ie)/Math.log(ee)),ee=Math.ceil(ie/Math.pow(ee,H-1))),(ue=q([])).leaf=!1,ue.height=H;var W=Math.ceil(ie/ee),J=W*Math.ceil(Math.sqrt(ee));X(R,k,U,J,this.compareMinX);for(var be=k;be<=U;be+=J){var Oe=Math.min(be+J-1,U);X(R,be,Oe,W,this.compareMinY);for(var Ae=be;Ae<=Oe;Ae+=W){var ae=Math.min(Ae+W-1,Oe);ue.children.push(this._build(R,Ae,ae,H-1))}}return u(ue,this.toBBox),ue},l.prototype._chooseSubtree=function(R,k,U,H){for(;H.push(k),!k.leaf&&H.length-1!==U;){for(var ue=1/0,ie=1/0,ee=void 0,W=0;W<k.children.length;W++){var J=k.children[W],be=O(J),Oe=(Ae=R,ae=J,(Math.max(ae.maxX,Ae.maxX)-Math.min(ae.minX,Ae.minX))*(Math.max(ae.maxY,Ae.maxY)-Math.min(ae.minY,Ae.minY))-be);Oe<ie?(ie=Oe,ue=be<ue?be:ue,ee=J):Oe===ie&&be<ue&&(ue=be,ee=J)}k=ee||k.children[0]}var Ae,ae;return k},l.prototype._insert=function(R,k,U){var H=U?R:this.toBBox(R),ue=[],ie=this._chooseSubtree(H,this.data,k,ue);for(ie.children.push(R),m(ie,H);k>=0&&ue[k].children.length>this._maxEntries;)this._split(ue,k),k--;this._adjustParentBBoxes(H,ue,k)},l.prototype._split=function(R,k){var U=R[k],H=U.children.length,ue=this._minEntries;this._chooseSplitAxis(U,ue,H);var ie=this._chooseSplitIndex(U,ue,H),ee=q(U.children.splice(ie,U.children.length-ie));ee.height=U.height,ee.leaf=U.leaf,u(U,this.toBBox),u(ee,this.toBBox),k?R[k-1].children.push(ee):this._splitRoot(U,ee)},l.prototype._splitRoot=function(R,k){this.data=q([R,k]),this.data.height=R.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},l.prototype._chooseSplitIndex=function(R,k,U){for(var H,ue,ie,ee,W,J,be,Oe=1/0,Ae=1/0,ae=k;ae<=U-k;ae++){var ct=_(R,0,ae,this.toBBox),Pe=_(R,ae,U,this.toBBox),V=(ue=ct,ie=Pe,ee=void 0,W=void 0,J=void 0,be=void 0,ee=Math.max(ue.minX,ie.minX),W=Math.max(ue.minY,ie.minY),J=Math.min(ue.maxX,ie.maxX),be=Math.min(ue.maxY,ie.maxY),Math.max(0,J-ee)*Math.max(0,be-W)),Q=O(ct)+O(Pe);V<Oe?(Oe=V,H=ae,Ae=Q<Ae?Q:Ae):V===Oe&&Q<Ae&&(Ae=Q,H=ae)}return H||U-k},l.prototype._chooseSplitAxis=function(R,k,U){var H=R.leaf?this.compareMinX:S,ue=R.leaf?this.compareMinY:P;this._allDistMargin(R,k,U,H)<this._allDistMargin(R,k,U,ue)&&R.children.sort(H)},l.prototype._allDistMargin=function(R,k,U,H){R.children.sort(H);for(var ue=this.toBBox,ie=_(R,0,k,ue),ee=_(R,U-k,U,ue),W=M(ie)+M(ee),J=k;J<U-k;J++){var be=R.children[J];m(ie,R.leaf?ue(be):be),W+=M(ie)}for(var Oe=U-k-1;Oe>=k;Oe--){var Ae=R.children[Oe];m(ee,R.leaf?ue(Ae):Ae),W+=M(ee)}return W},l.prototype._adjustParentBBoxes=function(R,k,U){for(var H=U;H>=0;H--)m(k[H],R)},l.prototype._condense=function(R){for(var k=R.length-1,U=void 0;k>=0;k--)R[k].children.length===0?k>0?(U=R[k-1].children).splice(U.indexOf(R[k]),1):this.clear():u(R[k],this.toBBox)},l})})(qM);var E4=qM.exports;class S4{constructor(r=[],t=P4){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:n}=this,i=t[r];for(;r>0;){const l=r-1>>1,p=t[l];if(n(i,p)>=0)break;t[r]=p,r=l}t[r]=i}_down(r){const{data:t,compare:n}=this,i=this.length>>1,l=t[r];for(;r<i;){let p=(r<<1)+1,u=t[p];const _=p+1;if(_<this.length&&n(t[_],u)<0&&(p=_,u=t[_]),n(u,l)>=0)break;t[r]=u,r=p}t[r]=l}}function P4(e,r){return e<r?-1:e>r?1:0}const A4=Object.freeze(Object.defineProperty({__proto__:null,default:S4},Symbol.toStringTag,{value:"Module"})),I4=Ef(A4);var xv={exports:{}},O4=function(r,t,n,i){var l=r[0],p=r[1],u=!1;n===void 0&&(n=0),i===void 0&&(i=t.length);for(var _=(i-n)/2,m=0,S=_-1;m<_;S=m++){var P=t[n+m*2+0],O=t[n+m*2+1],M=t[n+S*2+0],B=t[n+S*2+1],$=O>p!=B>p&&l<(M-P)*(p-O)/(B-O)+P;$&&(u=!u)}return u},C4=function(r,t,n,i){var l=r[0],p=r[1],u=!1;n===void 0&&(n=0),i===void 0&&(i=t.length);for(var _=i-n,m=0,S=_-1;m<_;S=m++){var P=t[m+n][0],O=t[m+n][1],M=t[S+n][0],B=t[S+n][1],$=O>p!=B>p&&l<(M-P)*(p-O)/(B-O)+P;$&&(u=!u)}return u},VM=O4,XM=C4;xv.exports=function(r,t,n,i){return t.length>0&&Array.isArray(t[0])?XM(r,t,n,i):VM(r,t,n,i)};xv.exports.nested=XM;xv.exports.flat=VM;var T4=xv.exports,Ab={exports:{}};(function(e,r){(function(t,n){n(r)})(we,function(t){const i=33306690738754706e-32;function l($,q,X,R,k){let U,H,ue,ie,ee=q[0],W=R[0],J=0,be=0;W>ee==W>-ee?(U=ee,ee=q[++J]):(U=W,W=R[++be]);let Oe=0;if(J<$&&be<X)for(W>ee==W>-ee?(ue=U-((H=ee+U)-ee),ee=q[++J]):(ue=U-((H=W+U)-W),W=R[++be]),U=H,ue!==0&&(k[Oe++]=ue);J<$&&be<X;)W>ee==W>-ee?(ue=U-((H=U+ee)-(ie=H-U))+(ee-ie),ee=q[++J]):(ue=U-((H=U+W)-(ie=H-U))+(W-ie),W=R[++be]),U=H,ue!==0&&(k[Oe++]=ue);for(;J<$;)ue=U-((H=U+ee)-(ie=H-U))+(ee-ie),ee=q[++J],U=H,ue!==0&&(k[Oe++]=ue);for(;be<X;)ue=U-((H=U+W)-(ie=H-U))+(W-ie),W=R[++be],U=H,ue!==0&&(k[Oe++]=ue);return U===0&&Oe!==0||(k[Oe++]=U),Oe}function p($){return new Float64Array($)}const u=33306690738754716e-32,_=22204460492503146e-32,m=11093356479670487e-47,S=p(4),P=p(8),O=p(12),M=p(16),B=p(4);t.orient2d=function($,q,X,R,k,U){const H=(q-U)*(X-k),ue=($-k)*(R-U),ie=H-ue;if(H===0||ue===0||H>0!=ue>0)return ie;const ee=Math.abs(H+ue);return Math.abs(ie)>=u*ee?ie:-function(W,J,be,Oe,Ae,ae,ct){let Pe,V,Q,he,fe,ye,se,De,ke,We,He,dt,yt,Lt,pt,Ct,mt,Ye;const Zt=W-Ae,hr=be-Ae,$t=J-ae,yr=Oe-ae;fe=(pt=(De=Zt-(se=(ye=134217729*Zt)-(ye-Zt)))*(We=yr-(ke=(ye=134217729*yr)-(ye-yr)))-((Lt=Zt*yr)-se*ke-De*ke-se*We))-(He=pt-(mt=(De=$t-(se=(ye=134217729*$t)-(ye-$t)))*(We=hr-(ke=(ye=134217729*hr)-(ye-hr)))-((Ct=$t*hr)-se*ke-De*ke-se*We))),S[0]=pt-(He+fe)+(fe-mt),fe=(yt=Lt-((dt=Lt+He)-(fe=dt-Lt))+(He-fe))-(He=yt-Ct),S[1]=yt-(He+fe)+(fe-Ct),fe=(Ye=dt+He)-dt,S[2]=dt-(Ye-fe)+(He-fe),S[3]=Ye;let nn=function(Be,Xe){let $e=Xe[0];for(let ht=1;ht<Be;ht++)$e+=Xe[ht];return $e}(4,S),rt=_*ct;if(nn>=rt||-nn>=rt||(Pe=W-(Zt+(fe=W-Zt))+(fe-Ae),Q=be-(hr+(fe=be-hr))+(fe-Ae),V=J-($t+(fe=J-$t))+(fe-ae),he=Oe-(yr+(fe=Oe-yr))+(fe-ae),Pe===0&&V===0&&Q===0&&he===0)||(rt=m*ct+i*Math.abs(nn),(nn+=Zt*he+yr*Pe-($t*Q+hr*V))>=rt||-nn>=rt))return nn;fe=(pt=(De=Pe-(se=(ye=134217729*Pe)-(ye-Pe)))*(We=yr-(ke=(ye=134217729*yr)-(ye-yr)))-((Lt=Pe*yr)-se*ke-De*ke-se*We))-(He=pt-(mt=(De=V-(se=(ye=134217729*V)-(ye-V)))*(We=hr-(ke=(ye=134217729*hr)-(ye-hr)))-((Ct=V*hr)-se*ke-De*ke-se*We))),B[0]=pt-(He+fe)+(fe-mt),fe=(yt=Lt-((dt=Lt+He)-(fe=dt-Lt))+(He-fe))-(He=yt-Ct),B[1]=yt-(He+fe)+(fe-Ct),fe=(Ye=dt+He)-dt,B[2]=dt-(Ye-fe)+(He-fe),B[3]=Ye;const Se=l(4,S,4,B,P);fe=(pt=(De=Zt-(se=(ye=134217729*Zt)-(ye-Zt)))*(We=he-(ke=(ye=134217729*he)-(ye-he)))-((Lt=Zt*he)-se*ke-De*ke-se*We))-(He=pt-(mt=(De=$t-(se=(ye=134217729*$t)-(ye-$t)))*(We=Q-(ke=(ye=134217729*Q)-(ye-Q)))-((Ct=$t*Q)-se*ke-De*ke-se*We))),B[0]=pt-(He+fe)+(fe-mt),fe=(yt=Lt-((dt=Lt+He)-(fe=dt-Lt))+(He-fe))-(He=yt-Ct),B[1]=yt-(He+fe)+(fe-Ct),fe=(Ye=dt+He)-dt,B[2]=dt-(Ye-fe)+(He-fe),B[3]=Ye;const ce=l(Se,P,4,B,O);fe=(pt=(De=Pe-(se=(ye=134217729*Pe)-(ye-Pe)))*(We=he-(ke=(ye=134217729*he)-(ye-he)))-((Lt=Pe*he)-se*ke-De*ke-se*We))-(He=pt-(mt=(De=V-(se=(ye=134217729*V)-(ye-V)))*(We=Q-(ke=(ye=134217729*Q)-(ye-Q)))-((Ct=V*Q)-se*ke-De*ke-se*We))),B[0]=pt-(He+fe)+(fe-mt),fe=(yt=Lt-((dt=Lt+He)-(fe=dt-Lt))+(He-fe))-(He=yt-Ct),B[1]=yt-(He+fe)+(fe-Ct),fe=(Ye=dt+He)-dt,B[2]=dt-(Ye-fe)+(He-fe),B[3]=Ye;const ge=l(ce,O,4,B,M);return M[ge-1]}($,q,X,R,k,U,ee)},t.orient2dfast=function($,q,X,R,k,U){return(q-U)*(X-k)-($-k)*(R-U)},Object.defineProperty(t,"__esModule",{value:!0})})})(Ab,Ab.exports);var M4=Ab.exports,WA=E4,bm=I4,L4=T4,R4=M4.orient2d;bm.default&&(bm=bm.default);nw.exports=YM;nw.exports.default=YM;function YM(e,r,t){r=Math.max(0,r===void 0?2:r),t=t||0;var n=B4(e),i=new WA(16);i.toBBox=function(R){return{minX:R[0],minY:R[1],maxX:R[0],maxY:R[1]}},i.compareMinX=function(R,k){return R[0]-k[0]},i.compareMinY=function(R,k){return R[1]-k[1]},i.load(e);for(var l=[],p=0,u;p<n.length;p++){var _=n[p];i.remove(_),u=JA(_,u),l.push(u)}var m=new WA(16);for(p=0;p<l.length;p++)m.insert(x1(l[p]));for(var S=r*r,P=t*t;l.length;){var O=l.shift(),M=O.p,B=O.next.p,$=w1(M,B);if(!($<P)){var q=$/S;_=D4(i,O.prev.p,M,B,O.next.next.p,q,m),_&&Math.min(w1(_,M),w1(_,B))<=q&&(l.push(O),l.push(JA(_,O)),i.remove(_),m.remove(O),m.insert(x1(O)),m.insert(x1(O.next)))}}O=u;var X=[];do X.push(O.p),O=O.next;while(O!==u);return X.push(O.p),X}function D4(e,r,t,n,i,l,p){for(var u=new bm([],N4),_=e.data;_;){for(var m=0;m<_.children.length;m++){var S=_.children[m],P=_.leaf?E1(S,t,n):F4(t,n,S);P>l||u.push({node:S,dist:P})}for(;u.length&&!u.peek().node.children;){var O=u.pop(),M=O.node,B=E1(M,r,t),$=E1(M,n,i);if(O.dist<B&&O.dist<$&&HA(t,M,p)&&HA(n,M,p))return M}_=u.pop(),_&&(_=_.node)}return null}function N4(e,r){return e.dist-r.dist}function F4(e,r,t){if(ZA(e,t)||ZA(r,t))return 0;var n=Gg(e[0],e[1],r[0],r[1],t.minX,t.minY,t.maxX,t.minY);if(n===0)return 0;var i=Gg(e[0],e[1],r[0],r[1],t.minX,t.minY,t.minX,t.maxY);if(i===0)return 0;var l=Gg(e[0],e[1],r[0],r[1],t.maxX,t.minY,t.maxX,t.maxY);if(l===0)return 0;var p=Gg(e[0],e[1],r[0],r[1],t.minX,t.maxY,t.maxX,t.maxY);return p===0?0:Math.min(n,i,l,p)}function ZA(e,r){return e[0]>=r.minX&&e[0]<=r.maxX&&e[1]>=r.minY&&e[1]<=r.maxY}function HA(e,r,t){for(var n=Math.min(e[0],r[0]),i=Math.min(e[1],r[1]),l=Math.max(e[0],r[0]),p=Math.max(e[1],r[1]),u=t.search({minX:n,minY:i,maxX:l,maxY:p}),_=0;_<u.length;_++)if(k4(u[_].p,u[_].next.p,e,r))return!1;return!0}function ef(e,r,t){return R4(e[0],e[1],r[0],r[1],t[0],t[1])}function k4(e,r,t,n){return e!==n&&r!==t&&ef(e,r,t)>0!=ef(e,r,n)>0&&ef(t,n,e)>0!=ef(t,n,r)>0}function x1(e){var r=e.p,t=e.next.p;return e.minX=Math.min(r[0],t[0]),e.minY=Math.min(r[1],t[1]),e.maxX=Math.max(r[0],t[0]),e.maxY=Math.max(r[1],t[1]),e}function B4(e){for(var r=e[0],t=e[0],n=e[0],i=e[0],l=0;l<e.length;l++){var p=e[l];p[0]<r[0]&&(r=p),p[0]>n[0]&&(n=p),p[1]<t[1]&&(t=p),p[1]>i[1]&&(i=p)}var u=[r,t,n,i],_=u.slice();for(l=0;l<e.length;l++)L4(e[l],u)||_.push(e[l]);return j4(_)}function JA(e,r){var t={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return r?(t.next=r.next,t.prev=r,r.next.prev=t,r.next=t):(t.prev=t,t.next=t),t}function w1(e,r){var t=e[0]-r[0],n=e[1]-r[1];return t*t+n*n}function E1(e,r,t){var n=r[0],i=r[1],l=t[0]-n,p=t[1]-i;if(l!==0||p!==0){var u=((e[0]-n)*l+(e[1]-i)*p)/(l*l+p*p);u>1?(n=t[0],i=t[1]):u>0&&(n+=l*u,i+=p*u)}return l=e[0]-n,p=e[1]-i,l*l+p*p}function Gg(e,r,t,n,i,l,p,u){var _=t-e,m=n-r,S=p-i,P=u-l,O=e-i,M=r-l,B=_*_+m*m,$=_*S+m*P,q=S*S+P*P,X=_*O+m*M,R=S*O+P*M,k=B*q-$*$,U,H,ue,ie,ee=k,W=k;k===0?(H=0,ee=1,ie=R,W=q):(H=$*R-q*X,ie=B*R-$*X,H<0?(H=0,ie=R,W=q):H>ee&&(H=ee,ie=R+$,W=q)),ie<0?(ie=0,-X<0?H=0:-X>B?H=ee:(H=-X,ee=B)):ie>W&&(ie=W,-X+$<0?H=0:-X+$>B?H=ee:(H=-X+$,ee=B)),U=H===0?0:H/ee,ue=ie===0?0:ie/W;var J=(1-U)*e+U*t,be=(1-U)*r+U*n,Oe=(1-ue)*i+ue*p,Ae=(1-ue)*l+ue*u,ae=Oe-J,ct=Ae-be;return ae*ae+ct*ct}function z4(e,r){return e[0]===r[0]?e[1]-r[1]:e[0]-r[0]}function j4(e){e.sort(z4);for(var r=[],t=0;t<e.length;t++){for(;r.length>=2&&ef(r[r.length-2],r[r.length-1],e[t])<=0;)r.pop();r.push(e[t])}for(var n=[],i=e.length-1;i>=0;i--){for(;n.length>=2&&ef(n[n.length-2],n[n.length-1],e[i])<=0;)n.pop();n.push(e[i])}return n.pop(),r.pop(),r.concat(n)}var U4=nw.exports,$4=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bv,"__esModule",{value:!0});var G4=zt,q4=nr,V4=$4(U4);function X4(e,r){r===void 0&&(r={}),r.concavity=r.concavity||1/0;var t=[];if(q4.coordEach(e,function(i){t.push([i[0],i[1]])}),!t.length)return null;var n=V4.default(t,r.concavity);return n.length>3?G4.polygon([n]):null}bv.default=X4;var iw={exports:{}},ps={};Object.defineProperty(ps,"__esModule",{value:!0});var KA=vr;function Y4(e,r,t){if(t===void 0&&(t={}),!e)throw new Error("point is required");if(!r)throw new Error("polygon is required");var n=KA.getCoord(e),i=KA.getGeom(r),l=i.type,p=r.bbox,u=i.coordinates;if(p&&W4(n,p)===!1)return!1;l==="Polygon"&&(u=[u]);for(var _=!1,m=0;m<u.length&&!_;m++)if(QA(n,u[m][0],t.ignoreBoundary)){for(var S=!1,P=1;P<u[m].length&&!S;)QA(n,u[m][P],!t.ignoreBoundary)&&(S=!0),P++;S||(_=!0)}return _}ps.default=Y4;function QA(e,r,t){var n=!1;r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]&&(r=r.slice(0,r.length-1));for(var i=0,l=r.length-1;i<r.length;l=i++){var p=r[i][0],u=r[i][1],_=r[l][0],m=r[l][1],S=e[1]*(p-_)+u*(_-e[0])+m*(e[0]-p)===0&&(p-e[0])*(_-e[0])<=0&&(u-e[1])*(m-e[1])<=0;if(S)return!t;var P=u>e[1]!=m>e[1]&&e[0]<(_-p)*(e[1]-u)/(m-u)+p;P&&(n=!n)}return n}function W4(e,r){return r[0]<=e[0]&&r[1]<=e[1]&&r[2]>=e[0]&&r[3]>=e[1]}var Z4=ps,eI=zt,qg=nr;function H4(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var tI=H4(Z4);function WM(e,r){var t=[];return qg.featureEach(e,function(n){var i=!1;if(n.geometry.type==="Point")qg.geomEach(r,function(p){tI.default(n,p)&&(i=!0)}),i&&t.push(n);else if(n.geometry.type==="MultiPoint"){var l=[];qg.geomEach(r,function(p){qg.coordEach(n,function(u){tI.default(u,p)&&(i=!0,l.push(u))})}),i&&t.push(eI.multiPoint(l))}else throw new Error("Input geometry must be a Point or MultiPoint")}),eI.featureCollection(t)}iw.exports=WM;iw.exports.default=WM;var ZM=iw.exports,ow={},Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});var rI=vr,pp=zt;function J4(e,r,t){t===void 0&&(t={});var n=rI.getCoord(e),i=rI.getCoord(r),l=pp.degreesToRadians(i[1]-n[1]),p=pp.degreesToRadians(i[0]-n[0]),u=pp.degreesToRadians(n[1]),_=pp.degreesToRadians(i[1]),m=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(p/2),2)*Math.cos(u)*Math.cos(_);return pp.radiansToLength(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),t.units)}Vo.default=J4;var wv={};Object.defineProperty(wv,"__esModule",{value:!0});var nI=zt;function K4(e,r){var t=!1;return nI.featureCollection(t5(e.features.map(function(n){var i={x:n.geometry.coordinates[0],y:n.geometry.coordinates[1]};return r?i.z=n.properties[r]:n.geometry.coordinates.length===3&&(t=!0,i.z=n.geometry.coordinates[2]),i})).map(function(n){var i=[n.a.x,n.a.y],l=[n.b.x,n.b.y],p=[n.c.x,n.c.y],u={};return t?(i.push(n.a.z),l.push(n.b.z),p.push(n.c.z)):u={a:n.a.z,b:n.b.z,c:n.c.z},nI.polygon([[i,l,p,i]],u)}))}wv.default=K4;var iI=function(){function e(r,t,n){this.a=r,this.b=t,this.c=n;var i=t.x-r.x,l=t.y-r.y,p=n.x-r.x,u=n.y-r.y,_=i*(r.x+t.x)+l*(r.y+t.y),m=p*(r.x+n.x)+u*(r.y+n.y),S=2*(i*(n.y-t.y)-l*(n.x-t.x)),P,O;this.x=(u*_-l*m)/S,this.y=(i*m-p*_)/S,P=this.x-r.x,O=this.y-r.y,this.r=P*P+O*O}return e}();function Q4(e,r){return r.x-e.x}function e5(e){var r=e.length,t,n,i,l,p;e:for(;r;)for(n=e[--r],t=e[--r],i=r;i;)if(p=e[--i],l=e[--i],t===l&&n===p||t===p&&n===l){e.splice(r,2),e.splice(i,2),r-=2;continue e}}function t5(e){if(e.length<3)return[];e.sort(Q4);for(var r=e.length-1,t=e[r].x,n=e[0].x,i=e[r].y,l=i,p=1e-12,u,_,m,S,P,O;r--;)e[r].y<i&&(i=e[r].y),e[r].y>l&&(l=e[r].y);var M=n-t,B=l-i,$=M>B?M:B,q=(n+t)*.5,X=(l+i)*.5,R=[new iI({__sentinel:!0,x:q-20*$,y:X-$},{__sentinel:!0,x:q,y:X+20*$},{__sentinel:!0,x:q+20*$,y:X-$})],k=[],U=[],H;for(r=e.length;r--;){for(U.length=0,H=R.length;H--;){if(M=e[r].x-R[H].x,M>0&&M*M>R[H].r){k.push(R[H]),R.splice(H,1);continue}B=e[r].y-R[H].y,!(M*M+B*B>R[H].r)&&(U.push(R[H].a,R[H].b,R[H].b,R[H].c,R[H].c,R[H].a),R.splice(H,1))}for(e5(U),H=U.length;H;)_=U[--H],u=U[--H],m=e[r],S=_.x-u.x,P=_.y-u.y,O=2*(S*(m.y-_.y)-P*(m.x-_.x)),Math.abs(O)>p&&R.push(new iI(u,_,m))}for(Array.prototype.push.apply(k,R),r=k.length;r--;)(k[r].a.__sentinel||k[r].b.__sentinel||k[r].c.__sentinel)&&k.splice(r,1);return k}var aw={},ua={};Object.defineProperty(ua,"__esModule",{value:!0});function r5(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return HM(e);case"FeatureCollection":return n5(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return sw(e);default:throw new Error("unknown GeoJSON type")}}function HM(e){var r={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:r[t]=e[t]}}),r.properties=JM(e.properties),r.geometry=sw(e.geometry),r}function JM(e){var r={};return e&&Object.keys(e).forEach(function(t){var n=e[t];typeof n=="object"?n===null?r[t]=null:Array.isArray(n)?r[t]=n.map(function(i){return i}):r[t]=JM(n):r[t]=n}),r}function n5(e){var r={type:"FeatureCollection"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:r[t]=e[t]}}),r.features=e.features.map(function(t){return HM(t)}),r}function sw(e){var r={type:e.type};return e.bbox&&(r.bbox=e.bbox),e.type==="GeometryCollection"?(r.geometries=e.geometries.map(function(t){return sw(t)}),r):(r.coordinates=KM(e.coordinates),r)}function KM(e){var r=e;return typeof r[0]!="object"?r.slice():r.map(function(t){return KM(t)})}ua.default=r5;var uw={},i5=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(uw,"__esModule",{value:!0});var o5=i5(ua),Ib=zt,a5=vr,s5=nr;function u5(e,r){if(r===void 0&&(r={}),r=r||{},!Ib.isObject(r))throw new Error("options is invalid");var t=r.mutate;if(a5.getType(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(t===!1||t===void 0)&&(e=o5.default(e));var n=[],i=s5.lineReduce(e,function(l,p){var u=l5(l,p);return u||(n.push(l),p)});return i&&n.push(i),n.length?n.length===1?n[0]:Ib.multiLineString(n.map(function(l){return l.coordinates})):null}function Vg(e){return e[0].toString()+","+e[1].toString()}function l5(e,r){var t=e.geometry.coordinates,n=r.geometry.coordinates,i=Vg(t[0]),l=Vg(t[t.length-1]),p=Vg(n[0]),u=Vg(n[n.length-1]),_;if(i===u)_=n.concat(t.slice(1));else if(p===l)_=t.concat(n.slice(1));else if(i===p)_=t.slice(1).reverse().concat(n);else if(l===u)_=t.concat(n.reverse().slice(1));else return null;return Ib.lineString(_)}uw.default=u5;var lw={};function QM(e){return e}function cw(e){if(e==null)return QM;var r,t,n=e.scale[0],i=e.scale[1],l=e.translate[0],p=e.translate[1];return function(u,_){_||(r=t=0);var m=2,S=u.length,P=new Array(S);for(P[0]=(r+=u[0])*n+l,P[1]=(t+=u[1])*i+p;m<S;)P[m]=u[m],++m;return P}}function eL(e){var r=cw(e.transform),t,n=1/0,i=n,l=-n,p=-n;function u(m){m=r(m),m[0]<n&&(n=m[0]),m[0]>l&&(l=m[0]),m[1]<i&&(i=m[1]),m[1]>p&&(p=m[1])}function _(m){switch(m.type){case"GeometryCollection":m.geometries.forEach(_);break;case"Point":u(m.coordinates);break;case"MultiPoint":m.coordinates.forEach(u);break}}e.arcs.forEach(function(m){for(var S=-1,P=m.length,O;++S<P;)O=r(m[S],S),O[0]<n&&(n=O[0]),O[0]>l&&(l=O[0]),O[1]<i&&(i=O[1]),O[1]>p&&(p=O[1])});for(t in e.objects)_(e.objects[t]);return[n,i,l,p]}function c5(e,r){for(var t,n=e.length,i=n-r;i<--n;)t=e[i],e[i++]=e[n],e[n]=t}function h5(e,r){return typeof r=="string"&&(r=e.objects[r]),r.type==="GeometryCollection"?{type:"FeatureCollection",features:r.geometries.map(function(t){return oI(e,t)})}:oI(e,r)}function oI(e,r){var t=r.id,n=r.bbox,i=r.properties==null?{}:r.properties,l=Ev(e,r);return t==null&&n==null?{type:"Feature",properties:i,geometry:l}:n==null?{type:"Feature",id:t,properties:i,geometry:l}:{type:"Feature",id:t,bbox:n,properties:i,geometry:l}}function Ev(e,r){var t=cw(e.transform),n=e.arcs;function i(S,P){P.length&&P.pop();for(var O=n[S<0?~S:S],M=0,B=O.length;M<B;++M)P.push(t(O[M],M));S<0&&c5(P,B)}function l(S){return t(S)}function p(S){for(var P=[],O=0,M=S.length;O<M;++O)i(S[O],P);return P.length<2&&P.push(P[0]),P}function u(S){for(var P=p(S);P.length<4;)P.push(P[0]);return P}function _(S){return S.map(u)}function m(S){var P=S.type,O;switch(P){case"GeometryCollection":return{type:P,geometries:S.geometries.map(m)};case"Point":O=l(S.coordinates);break;case"MultiPoint":O=S.coordinates.map(l);break;case"LineString":O=p(S.arcs);break;case"MultiLineString":O=S.arcs.map(p);break;case"Polygon":O=_(S.arcs);break;case"MultiPolygon":O=S.arcs.map(_);break;default:return null}return{type:P,coordinates:O}}return m(r)}function tL(e,r){var t={},n={},i={},l=[],p=-1;r.forEach(function(m,S){var P=e.arcs[m<0?~m:m],O;P.length<3&&!P[1][0]&&!P[1][1]&&(O=r[++p],r[p]=m,r[S]=O)}),r.forEach(function(m){var S=u(m),P=S[0],O=S[1],M,B;if(M=i[P])if(delete i[M.end],M.push(m),M.end=O,B=n[O]){delete n[B.start];var $=B===M?M:M.concat(B);n[$.start=M.start]=i[$.end=B.end]=$}else n[M.start]=i[M.end]=M;else if(M=n[O])if(delete n[M.start],M.unshift(m),M.start=P,B=i[P]){delete i[B.end];var q=B===M?M:B.concat(M);n[q.start=B.start]=i[q.end=M.end]=q}else n[M.start]=i[M.end]=M;else M=[m],n[M.start=P]=i[M.end=O]=M});function u(m){var S=e.arcs[m<0?~m:m],P=S[0],O;return e.transform?(O=[0,0],S.forEach(function(M){O[0]+=M[0],O[1]+=M[1]})):O=S[S.length-1],m<0?[O,P]:[P,O]}function _(m,S){for(var P in m){var O=m[P];delete S[O.start],delete O.start,delete O.end,O.forEach(function(M){t[M<0?~M:M]=1}),l.push(O)}}return _(i,n),_(n,i),r.forEach(function(m){t[m<0?~m:m]||l.push([m])}),l}function f5(e){return Ev(e,rL.apply(this,arguments))}function rL(e,r,t){var n,i,l;if(arguments.length>1)n=p5(e,r,t);else for(i=0,n=new Array(l=e.arcs.length);i<l;++i)n[i]=i;return{type:"MultiLineString",arcs:tL(e,n)}}function p5(e,r,t){var n=[],i=[],l;function p(P){var O=P<0?~P:P;(i[O]||(i[O]=[])).push({i:P,g:l})}function u(P){P.forEach(p)}function _(P){P.forEach(u)}function m(P){P.forEach(_)}function S(P){switch(l=P,P.type){case"GeometryCollection":P.geometries.forEach(S);break;case"LineString":u(P.arcs);break;case"MultiLineString":case"Polygon":_(P.arcs);break;case"MultiPolygon":m(P.arcs);break}}return S(r),i.forEach(t==null?function(P){n.push(P[0].i)}:function(P){t(P[0].g,P[P.length-1].g)&&n.push(P[0].i)}),n}function d5(e){for(var r=-1,t=e.length,n,i=e[t-1],l=0;++r<t;)n=i,i=e[r],l+=n[0]*i[1]-n[1]*i[0];return Math.abs(l)}function g5(e){return Ev(e,nL.apply(this,arguments))}function nL(e,r){var t={},n=[],i=[];r.forEach(l);function l(_){switch(_.type){case"GeometryCollection":_.geometries.forEach(l);break;case"Polygon":p(_.arcs);break;case"MultiPolygon":_.arcs.forEach(p);break}}function p(_){_.forEach(function(m){m.forEach(function(S){(t[S=S<0?~S:S]||(t[S]=[])).push(_)})}),n.push(_)}function u(_){return d5(Ev(e,{type:"Polygon",arcs:[_]}).coordinates[0])}return n.forEach(function(_){if(!_._){var m=[],S=[_];for(_._=1,i.push(m);_=S.pop();)m.push(_),_.forEach(function(P){P.forEach(function(O){t[O<0?~O:O].forEach(function(M){M._||(M._=1,S.push(M))})})})}}),n.forEach(function(_){delete _._}),{type:"MultiPolygon",arcs:i.map(function(_){var m=[],S;if(_.forEach(function($){$.forEach(function(q){q.forEach(function(X){t[X<0?~X:X].length<2&&m.push(X)})})}),m=tL(e,m),(S=m.length)>1)for(var P=1,O=u(m[0]),M,B;P<S;++P)(M=u(m[P]))>O&&(B=m[0],m[0]=m[P],m[P]=B,O=M);return m}).filter(function(_){return _.length>0})}}function aI(e,r){for(var t=0,n=e.length;t<n;){var i=t+n>>>1;e[i]<r?t=i+1:n=i}return t}function m5(e){var r={},t=e.map(function(){return[]});function n($,q){$.forEach(function(X){X<0&&(X=~X);var R=r[X];R?R.push(q):r[X]=[q]})}function i($,q){$.forEach(function(X){n(X,q)})}function l($,q){$.type==="GeometryCollection"?$.geometries.forEach(function(X){l(X,q)}):$.type in p&&p[$.type]($.arcs,q)}var p={LineString:n,MultiLineString:i,Polygon:i,MultiPolygon:function($,q){$.forEach(function(X){i(X,q)})}};e.forEach(l);for(var u in r)for(var _=r[u],m=_.length,S=0;S<m;++S)for(var P=S+1;P<m;++P){var O=_[S],M=_[P],B;(B=t[O])[u=aI(B,M)]!==M&&B.splice(u,0,M),(B=t[M])[u=aI(B,O)]!==O&&B.splice(u,0,O)}return t}function iL(e){if(e==null)return QM;var r,t,n=e.scale[0],i=e.scale[1],l=e.translate[0],p=e.translate[1];return function(u,_){_||(r=t=0);var m=2,S=u.length,P=new Array(S),O=Math.round((u[0]-l)/n),M=Math.round((u[1]-p)/i);for(P[0]=O-r,r=O,P[1]=M-t,t=M;m<S;)P[m]=u[m],++m;return P}}function v5(e,r){if(e.transform)throw new Error("already quantized");if(!r||!r.scale){if(!((p=Math.floor(r))>=2))throw new Error("n must be ≥2");_=e.bbox||eL(e);var t=_[0],n=_[1],i=_[2],l=_[3],p;r={scale:[i-t?(i-t)/(p-1):1,l-n?(l-n)/(p-1):1],translate:[t,n]}}else _=e.bbox;var u=iL(r),_,m,S=e.objects,P={};function O($){return u($)}function M($){var q;switch($.type){case"GeometryCollection":q={type:"GeometryCollection",geometries:$.geometries.map(M)};break;case"Point":q={type:"Point",coordinates:O($.coordinates)};break;case"MultiPoint":q={type:"MultiPoint",coordinates:$.coordinates.map(O)};break;default:return $}return $.id!=null&&(q.id=$.id),$.bbox!=null&&(q.bbox=$.bbox),$.properties!=null&&(q.properties=$.properties),q}function B($){var q=0,X=1,R=$.length,k,U=new Array(R);for(U[0]=u($[0],0);++q<R;)((k=u($[q],q))[0]||k[1])&&(U[X++]=k);return X===1&&(U[X++]=[0,0]),U.length=X,U}for(m in S)P[m]=M(S[m]);return{type:"Topology",bbox:_,transform:r,objects:P,arcs:e.arcs.map(B)}}const y5=Object.freeze(Object.defineProperty({__proto__:null,bbox:eL,feature:h5,merge:g5,mergeArcs:nL,mesh:f5,meshArcs:rL,neighbors:m5,quantize:v5,transform:cw,untransform:iL},Symbol.toStringTag,{value:"Module"})),_5=Ef(y5);var Sv=Object.prototype.hasOwnProperty;function b5(e){var r=1/0,t=1/0,n=-1/0,i=-1/0;function l(P){P!=null&&Sv.call(p,P.type)&&p[P.type](P)}var p={GeometryCollection:function(P){P.geometries.forEach(l)},Point:function(P){u(P.coordinates)},MultiPoint:function(P){P.coordinates.forEach(u)},LineString:function(P){_(P.arcs)},MultiLineString:function(P){P.arcs.forEach(_)},Polygon:function(P){P.arcs.forEach(_)},MultiPolygon:function(P){P.arcs.forEach(m)}};function u(P){var O=P[0],M=P[1];O<r&&(r=O),O>n&&(n=O),M<t&&(t=M),M>i&&(i=M)}function _(P){P.forEach(u)}function m(P){P.forEach(_)}for(var S in e)l(e[S]);return n>=r&&i>=t?[r,t,n,i]:void 0}function x5(e,r,t,n,i){arguments.length===3&&(n=Array,i=null);for(var l=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),p=e-1,u=0;u<e;++u)l[u]=i;function _(P){for(var O=r(P)&p,M=l[O],B=0;M!=i;){if(t(M,P))return!0;if(++B>=e)throw new Error("full hashset");M=l[O=O+1&p]}return l[O]=P,!0}function m(P){for(var O=r(P)&p,M=l[O],B=0;M!=i;){if(t(M,P))return!0;if(++B>=e)break;M=l[O=O+1&p]}return!1}function S(){for(var P=[],O=0,M=l.length;O<M;++O){var B=l[O];B!=i&&P.push(B)}return P}return{add:_,has:m,values:S}}function hw(e,r,t,n,i,l){arguments.length===3&&(n=l=Array,i=null);for(var p=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),u=new l(e),_=e-1,m=0;m<e;++m)p[m]=i;function S(B,$){for(var q=r(B)&_,X=p[q],R=0;X!=i;){if(t(X,B))return u[q]=$;if(++R>=e)throw new Error("full hashmap");X=p[q=q+1&_]}return p[q]=B,u[q]=$,$}function P(B,$){for(var q=r(B)&_,X=p[q],R=0;X!=i;){if(t(X,B))return u[q];if(++R>=e)throw new Error("full hashmap");X=p[q=q+1&_]}return p[q]=B,u[q]=$,$}function O(B,$){for(var q=r(B)&_,X=p[q],R=0;X!=i;){if(t(X,B))return u[q];if(++R>=e)break;X=p[q=q+1&_]}return $}function M(){for(var B=[],$=0,q=p.length;$<q;++$){var X=p[$];X!=i&&B.push(X)}return B}return{set:S,maybeSet:P,get:O,keys:M}}function Gc(e,r){return e[0]===r[0]&&e[1]===r[1]}var oL=new ArrayBuffer(16),sI=new Float64Array(oL),Xg=new Uint32Array(oL);function Ob(e){sI[0]=e[0],sI[1]=e[1];var r=Xg[0]^Xg[1];return r=r<<5^r>>7^Xg[2]^Xg[3],r&2147483647}function w5(e){var r=e.coordinates,t=e.lines,n=e.rings,i=ue(),l=new Int32Array(r.length),p=new Int32Array(r.length),u=new Int32Array(r.length),_=new Int8Array(r.length),m=0,S,P,O,M,B;for(S=0,P=r.length;S<P;++S)l[S]=p[S]=u[S]=-1;for(S=0,P=t.length;S<P;++S){var $=t[S],q=$[0],X=$[1];for(M=i[q],B=i[++q],++m,_[M]=1;++q<=X;)H(S,O=M,M=B,B=i[q]);++m,_[B]=1}for(S=0,P=r.length;S<P;++S)l[S]=-1;for(S=0,P=n.length;S<P;++S){var R=n[S],k=R[0]+1,U=R[1];for(O=i[U-1],M=i[k-1],B=i[k],H(S,O,M,B);++k<=U;)H(S,O=M,M=B,B=i[k])}function H(be,Oe,Ae,ae){if(l[Ae]!==be){l[Ae]=be;var ct=p[Ae];if(ct>=0){var Pe=u[Ae];(ct!==Oe||Pe!==ae)&&(ct!==ae||Pe!==Oe)&&(++m,_[Ae]=1)}else p[Ae]=Oe,u[Ae]=ae}}function ue(){for(var be=hw(r.length*1.4,ie,ee,Int32Array,-1,Int32Array),Oe=new Int32Array(r.length),Ae=0,ae=r.length;Ae<ae;++Ae)Oe[Ae]=be.maybeSet(Ae,Ae);return Oe}function ie(be){return Ob(r[be])}function ee(be,Oe){return Gc(r[be],r[Oe])}l=p=u=null;var W=x5(m*1.4,Ob,Gc),J;for(S=0,P=r.length;S<P;++S)_[J=i[S]]&&W.add(r[J]);return W}function E5(e){var r=w5(e),t=e.coordinates,n=e.lines,i=e.rings,l,p,u;for(p=0,u=n.length;p<u;++p)for(var _=n[p],m=_[0],S=_[1];++m<S;)r.has(t[m])&&(l={0:m,1:_[1]},_[1]=m,_=_.next=l);for(p=0,u=i.length;p<u;++p)for(var P=i[p],O=P[0],M=O,B=P[1],$=r.has(t[O]);++M<B;)r.has(t[M])&&($?(l={0:M,1:P[1]},P[1]=M,P=P.next=l):(S5(t,O,B,B-M),t[B]=t[O],$=!0,M=O));return e}function S5(e,r,t,n){S1(e,r,t),S1(e,r,r+n),S1(e,r+n,t)}function S1(e,r,t){for(var n=r+(t---r>>1),i;r<n;++r,--t)i=e[r],e[r]=e[t],e[t]=i}function P5(e){var r=e.coordinates,t=e.lines,n,i=e.rings,l,p=t.length+i.length,u,_;for(delete e.lines,delete e.rings,u=0,_=t.length;u<_;++u)for(n=t[u];n=n.next;)++p;for(u=0,_=i.length;u<_;++u)for(l=i[u];l=l.next;)++p;var m=hw(p*2*1.4,Ob,Gc),S=e.arcs=[];for(u=0,_=t.length;u<_;++u){n=t[u];do P(n);while(n=n.next)}for(u=0,_=i.length;u<_;++u)if(l=i[u],l.next)do P(l);while(l=l.next);else O(l);function P(R){var k,U,H,ue,ie,ee,W,J;if(H=m.get(k=r[R[0]])){for(W=0,J=H.length;W<J;++W)if(ue=H[W],M(ue,R)){R[0]=ue[0],R[1]=ue[1];return}}if(ie=m.get(U=r[R[1]])){for(W=0,J=ie.length;W<J;++W)if(ee=ie[W],B(ee,R)){R[1]=ee[0],R[0]=ee[1];return}}H?H.push(R):m.set(k,[R]),ie?ie.push(R):m.set(U,[R]),S.push(R)}function O(R){var k,U,H,ue,ie;if(U=m.get(k=r[R[0]]))for(ue=0,ie=U.length;ue<ie;++ue){if(H=U[ue],$(H,R)){R[0]=H[0],R[1]=H[1];return}if(q(H,R)){R[0]=H[1],R[1]=H[0];return}}if(U=m.get(k=r[R[0]+X(R)]))for(ue=0,ie=U.length;ue<ie;++ue){if(H=U[ue],$(H,R)){R[0]=H[0],R[1]=H[1];return}if(q(H,R)){R[0]=H[1],R[1]=H[0];return}}U?U.push(R):m.set(k,[R]),S.push(R)}function M(R,k){var U=R[0],H=k[0],ue=R[1],ie=k[1];if(U-ue!==H-ie)return!1;for(;U<=ue;++U,++H)if(!Gc(r[U],r[H]))return!1;return!0}function B(R,k){var U=R[0],H=k[0],ue=R[1],ie=k[1];if(U-ue!==H-ie)return!1;for(;U<=ue;++U,--ie)if(!Gc(r[U],r[ie]))return!1;return!0}function $(R,k){var U=R[0],H=k[0],ue=R[1],ie=k[1],ee=ue-U;if(ee!==ie-H)return!1;for(var W=X(R),J=X(k),be=0;be<ee;++be)if(!Gc(r[U+(be+W)%ee],r[H+(be+J)%ee]))return!1;return!0}function q(R,k){var U=R[0],H=k[0],ue=R[1],ie=k[1],ee=ue-U;if(ee!==ie-H)return!1;for(var W=X(R),J=ee-X(k),be=0;be<ee;++be)if(!Gc(r[U+(be+W)%ee],r[ie-(be+J)%ee]))return!1;return!0}function X(R){for(var k=R[0],U=R[1],H=k,ue=H,ie=r[H];++H<U;){var ee=r[H];(ee[0]<ie[0]||ee[0]===ie[0]&&ee[1]<ie[1])&&(ue=H,ie=ee)}return ue-k}return e}function A5(e){for(var r=-1,t=e.length;++r<t;){for(var n=e[r],i=0,l=1,p=n.length,u=n[0],_=u[0],m=u[1],S,P;++i<p;)u=n[i],S=u[0],P=u[1],(S!==_||P!==m)&&(n[l++]=[S-_,P-m],_=S,m=P);l===1&&(n[l++]=[0,0]),n.length=l}return e}function I5(e){var r=-1,t=[],n=[],i=[];function l(P){P&&Sv.call(p,P.type)&&p[P.type](P)}var p={GeometryCollection:function(P){P.geometries.forEach(l)},LineString:function(P){P.arcs=u(P.arcs)},MultiLineString:function(P){P.arcs=P.arcs.map(u)},Polygon:function(P){P.arcs=P.arcs.map(_)},MultiPolygon:function(P){P.arcs=P.arcs.map(m)}};function u(P){for(var O=0,M=P.length;O<M;++O)i[++r]=P[O];var B={0:r-M+1,1:r};return t.push(B),B}function _(P){for(var O=0,M=P.length;O<M;++O)i[++r]=P[O];var B={0:r-M+1,1:r};return n.push(B),B}function m(P){return P.map(_)}for(var S in e)l(e[S]);return{type:"Topology",coordinates:i,lines:t,rings:n,objects:e}}function O5(e){var r={},t;for(t in e)r[t]=C5(e[t]);return r}function C5(e){return e==null?{type:null}:(e.type==="FeatureCollection"?T5:e.type==="Feature"?aL:fw)(e)}function T5(e){var r={type:"GeometryCollection",geometries:e.features.map(aL)};return e.bbox!=null&&(r.bbox=e.bbox),r}function aL(e){var r=fw(e.geometry),t;e.id!=null&&(r.id=e.id),e.bbox!=null&&(r.bbox=e.bbox);for(t in e.properties){r.properties=e.properties;break}return r}function fw(e){if(e==null)return{type:null};var r=e.type==="GeometryCollection"?{type:"GeometryCollection",geometries:e.geometries.map(fw)}:e.type==="Point"||e.type==="MultiPoint"?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return e.bbox!=null&&(r.bbox=e.bbox),r}function M5(e,r,t){var n=r[0],i=r[1],l=r[2],p=r[3],u=l-n?(t-1)/(l-n):1,_=p-i?(t-1)/(p-i):1;function m(X){return[Math.round((X[0]-n)*u),Math.round((X[1]-i)*_)]}function S(X,R){for(var k=-1,U=0,H=X.length,ue=new Array(H),ie,ee,W,J,be;++k<H;)ie=X[k],J=Math.round((ie[0]-n)*u),be=Math.round((ie[1]-i)*_),(J!==ee||be!==W)&&(ue[U++]=[ee=J,W=be]);for(ue.length=U;U<R;)U=ue.push([ue[0][0],ue[0][1]]);return ue}function P(X){return S(X,2)}function O(X){return S(X,4)}function M(X){return X.map(O)}function B(X){X!=null&&Sv.call($,X.type)&&$[X.type](X)}var $={GeometryCollection:function(X){X.geometries.forEach(B)},Point:function(X){X.coordinates=m(X.coordinates)},MultiPoint:function(X){X.coordinates=X.coordinates.map(m)},LineString:function(X){X.arcs=P(X.arcs)},MultiLineString:function(X){X.arcs=X.arcs.map(P)},Polygon:function(X){X.arcs=M(X.arcs)},MultiPolygon:function(X){X.arcs=X.arcs.map(M)}};for(var q in e)B(e[q]);return{scale:[1/u,1/_],translate:[n,i]}}function L5(e,r){var t=b5(e=O5(e)),n=r>0&&t&&M5(e,t,r),i=P5(E5(I5(e))),l=i.coordinates,p=hw(i.arcs.length*1.4,R5,D5);e=i.objects,i.bbox=t,i.arcs=i.arcs.map(function(O,M){return p.set(O,M),l.slice(O[0],O[1]+1)}),delete i.coordinates,l=null;function u(O){O&&Sv.call(_,O.type)&&_[O.type](O)}var _={GeometryCollection:function(O){O.geometries.forEach(u)},LineString:function(O){O.arcs=m(O.arcs)},MultiLineString:function(O){O.arcs=O.arcs.map(m)},Polygon:function(O){O.arcs=O.arcs.map(m)},MultiPolygon:function(O){O.arcs=O.arcs.map(S)}};function m(O){var M=[];do{var B=p.get(O);M.push(O[0]<O[1]?B:~B)}while(O=O.next);return M}function S(O){return O.map(m)}for(var P in e)u(e[P]);return n&&(i.transform=n,i.arcs=A5(i.arcs)),i}function R5(e){var r=e[0],t=e[1],n;return t<r&&(n=r,r=t,t=n),r+31*t}function D5(e,r){var t=e[0],n=e[1],i=r[0],l=r[1],p;return n<t&&(p=t,t=n,n=p),l<i&&(p=i,i=l,l=p),t===i&&n===l}const N5=Object.freeze(Object.defineProperty({__proto__:null,topology:L5},Symbol.toStringTag,{value:"Module"})),F5=Ef(N5);var k5=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lw,"__esModule",{value:!0});var B5=k5(ua),z5=zt,j5=vr,U5=nr,$5=_5,G5=F5;function q5(e,r){if(r===void 0&&(r={}),j5.getType(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(r.mutate===!1||r.mutate===void 0)&&(e=B5.default(e));var t=[];U5.flattenEach(e,function(l){t.push(l.geometry)});var n=G5.topology({geoms:z5.geometryCollection(t).geometry}),i=$5.merge(n,n.objects.geoms.geometries);return i}lw.default=q5;var pw=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(aw,"__esModule",{value:!0});var V5=pw(ua),X5=zt,Y5=vr,W5=nr,Z5=pw(uw),H5=pw(lw);function J5(e,r){if(r===void 0&&(r={}),r=r||{},!X5.isObject(r))throw new Error("options is invalid");var t=r.mutate;if(Y5.getType(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(t===!1||t===void 0)&&(e=V5.default(e));var n=K5(e);if(!n)throw new Error("geojson must be homogenous");var i=e;switch(n){case"LineString":return Z5.default(i,r);case"Polygon":return H5.default(i,r);default:throw new Error(n+" is not supported")}}function K5(e){var r={};W5.flattenEach(e,function(n){r[n.geometry.type]=!0});var t=Object.keys(r);return t.length===1?t[0]:null}aw.default=J5;var dw=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ow,"__esModule",{value:!0});var P1=dw(Vo),sL=zt,Q5=nr,ej=dw(wv),tj=dw(aw);function rj(e,r){r===void 0&&(r={});var t=r.maxEdge||1/0,n=nj(e),i=ej.default(n);if(i.features=i.features.filter(function(p){var u=p.geometry.coordinates[0][0],_=p.geometry.coordinates[0][1],m=p.geometry.coordinates[0][2],S=P1.default(u,_,r),P=P1.default(_,m,r),O=P1.default(u,m,r);return S<=t&&P<=t&&O<=t}),i.features.length<1)return null;var l=tj.default(i);return l.coordinates.length===1&&(l.coordinates=l.coordinates[0],l.type="Polygon"),sL.feature(l)}function nj(e){var r=[],t={};return Q5.featureEach(e,function(n){if(n.geometry){var i=n.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(t,i)||(r.push(n),t[i]=!0)}}),sL.featureCollection(r)}ow.default=rj;var gw={},mw={exports:{}},uL={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(we,function(){function t(p,u,_,m,S){n(p,u,_||0,m||p.length-1,S||l)}function n(p,u,_,m,S){for(;m>_;){if(m-_>600){var P=m-_+1,O=u-_+1,M=Math.log(P),B=.5*Math.exp(2*M/3),$=.5*Math.sqrt(M*B*(P-B)/P)*(O-P/2<0?-1:1),q=Math.max(_,Math.floor(u-O*B/P+$)),X=Math.min(m,Math.floor(u+(P-O)*B/P+$));n(p,u,q,X,S)}var R=p[u],k=_,U=m;for(i(p,_,u),S(p[m],R)>0&&i(p,_,m);k<U;){for(i(p,k,U),k++,U--;S(p[k],R)<0;)k++;for(;S(p[U],R)>0;)U--}S(p[_],R)===0?i(p,_,U):(U++,i(p,U,m)),U<=u&&(_=U+1),u<=U&&(m=U-1)}}function i(p,u,_){var m=p[u];p[u]=p[_],p[_]=m}function l(p,u){return p<u?-1:p>u?1:0}return t})})(uL);var ij=uL.exports;mw.exports=Kp;mw.exports.default=Kp;var oj=ij;function Kp(e,r){if(!(this instanceof Kp))return new Kp(e,r);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),r&&this._initFormat(r),this.clear()}Kp.prototype={all:function(){return this._all(this.data,[])},search:function(e){var r=this.data,t=[],n=this.toBBox;if(!Wg(e,r))return t;for(var i=[],l,p,u,_;r;){for(l=0,p=r.children.length;l<p;l++)u=r.children[l],_=r.leaf?n(u):u,Wg(e,_)&&(r.leaf?t.push(u):I1(e,_)?this._all(u,t):i.push(u));r=i.pop()}return t},collides:function(e){var r=this.data,t=this.toBBox;if(!Wg(e,r))return!1;for(var n=[],i,l,p,u;r;){for(i=0,l=r.children.length;i<l;i++)if(p=r.children[i],u=r.leaf?t(p):p,Wg(e,u)){if(r.leaf||I1(e,u))return!0;n.push(p)}r=n.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var r=0,t=e.length;r<t;r++)this.insert(e[r]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=Kh([]),this},remove:function(e,r){if(!e)return this;for(var t=this.data,n=this.toBBox(e),i=[],l=[],p,u,_,m;t||i.length;){if(t||(t=i.pop(),u=i[i.length-1],p=l.pop(),m=!0),t.leaf&&(_=aj(e,t.children,r),_!==-1))return t.children.splice(_,1),i.push(t),this._condense(i),this;!m&&!t.leaf&&I1(t,n)?(i.push(t),l.push(p),p=0,u=t,t=t.children[0]):u?(p++,t=u.children[p],m=!1):t=null}return this},toBBox:function(e){return e},compareMinX:uI,compareMinY:lI,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,r){for(var t=[];e;)e.leaf?r.push.apply(r,e.children):t.push.apply(t,e.children),e=t.pop();return r},_build:function(e,r,t,n){var i=t-r+1,l=this._maxEntries,p;if(i<=l)return p=Kh(e.slice(r,t+1)),qh(p,this.toBBox),p;n||(n=Math.ceil(Math.log(i)/Math.log(l)),l=Math.ceil(i/Math.pow(l,n-1))),p=Kh([]),p.leaf=!1,p.height=n;var u=Math.ceil(i/l),_=u*Math.ceil(Math.sqrt(l)),m,S,P,O;for(cI(e,r,t,_,this.compareMinX),m=r;m<=t;m+=_)for(P=Math.min(m+_-1,t),cI(e,m,P,u,this.compareMinY),S=m;S<=P;S+=u)O=Math.min(S+u-1,P),p.children.push(this._build(e,S,O,n-1));return qh(p,this.toBBox),p},_chooseSubtree:function(e,r,t,n){for(var i,l,p,u,_,m,S,P;n.push(r),!(r.leaf||n.length-1===t);){for(S=P=1/0,i=0,l=r.children.length;i<l;i++)p=r.children[i],_=A1(p),m=sj(e,p)-_,m<P?(P=m,S=_<S?_:S,u=p):m===P&&_<S&&(S=_,u=p);r=u||r.children[0]}return r},_insert:function(e,r,t){var n=this.toBBox,i=t?e:n(e),l=[],p=this._chooseSubtree(i,this.data,r,l);for(p.children.push(e),Ip(p,i);r>=0&&l[r].children.length>this._maxEntries;)this._split(l,r),r--;this._adjustParentBBoxes(i,l,r)},_split:function(e,r){var t=e[r],n=t.children.length,i=this._minEntries;this._chooseSplitAxis(t,i,n);var l=this._chooseSplitIndex(t,i,n),p=Kh(t.children.splice(l,t.children.length-l));p.height=t.height,p.leaf=t.leaf,qh(t,this.toBBox),qh(p,this.toBBox),r?e[r-1].children.push(p):this._splitRoot(t,p)},_splitRoot:function(e,r){this.data=Kh([e,r]),this.data.height=e.height+1,this.data.leaf=!1,qh(this.data,this.toBBox)},_chooseSplitIndex:function(e,r,t){var n,i,l,p,u,_,m,S;for(_=m=1/0,n=r;n<=t-r;n++)i=Ap(e,0,n,this.toBBox),l=Ap(e,n,t,this.toBBox),p=uj(i,l),u=A1(i)+A1(l),p<_?(_=p,S=n,m=u<m?u:m):p===_&&u<m&&(m=u,S=n);return S},_chooseSplitAxis:function(e,r,t){var n=e.leaf?this.compareMinX:uI,i=e.leaf?this.compareMinY:lI,l=this._allDistMargin(e,r,t,n),p=this._allDistMargin(e,r,t,i);l<p&&e.children.sort(n)},_allDistMargin:function(e,r,t,n){e.children.sort(n);var i=this.toBBox,l=Ap(e,0,r,i),p=Ap(e,t-r,t,i),u=Yg(l)+Yg(p),_,m;for(_=r;_<t-r;_++)m=e.children[_],Ip(l,e.leaf?i(m):m),u+=Yg(l);for(_=t-r-1;_>=r;_--)m=e.children[_],Ip(p,e.leaf?i(m):m),u+=Yg(p);return u},_adjustParentBBoxes:function(e,r,t){for(var n=t;n>=0;n--)Ip(r[n],e)},_condense:function(e){for(var r=e.length-1,t;r>=0;r--)e[r].children.length===0?r>0?(t=e[r-1].children,t.splice(t.indexOf(e[r]),1)):this.clear():qh(e[r],this.toBBox)},_initFormat:function(e){var r=["return a"," - b",";"];this.compareMinX=new Function("a","b",r.join(e[0])),this.compareMinY=new Function("a","b",r.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function aj(e,r,t){if(!t)return r.indexOf(e);for(var n=0;n<r.length;n++)if(t(e,r[n]))return n;return-1}function qh(e,r){Ap(e,0,e.children.length,r,e)}function Ap(e,r,t,n,i){i||(i=Kh(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var l=r,p;l<t;l++)p=e.children[l],Ip(i,e.leaf?n(p):p);return i}function Ip(e,r){return e.minX=Math.min(e.minX,r.minX),e.minY=Math.min(e.minY,r.minY),e.maxX=Math.max(e.maxX,r.maxX),e.maxY=Math.max(e.maxY,r.maxY),e}function uI(e,r){return e.minX-r.minX}function lI(e,r){return e.minY-r.minY}function A1(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Yg(e){return e.maxX-e.minX+(e.maxY-e.minY)}function sj(e,r){return(Math.max(r.maxX,e.maxX)-Math.min(r.minX,e.minX))*(Math.max(r.maxY,e.maxY)-Math.min(r.minY,e.minY))}function uj(e,r){var t=Math.max(e.minX,r.minX),n=Math.max(e.minY,r.minY),i=Math.min(e.maxX,r.maxX),l=Math.min(e.maxY,r.maxY);return Math.max(0,i-t)*Math.max(0,l-n)}function I1(e,r){return e.minX<=r.minX&&e.minY<=r.minY&&r.maxX<=e.maxX&&r.maxY<=e.maxY}function Wg(e,r){return r.minX<=e.maxX&&r.minY<=e.maxY&&r.maxX>=e.minX&&r.maxY>=e.minY}function Kh(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function cI(e,r,t,n,i){for(var l=[r,t],p;l.length;)t=l.pop(),r=l.pop(),!(t-r<=n)&&(p=r+Math.ceil((t-r)/n/2)*n,oj(e,p,r,t,i),l.push(r,p,p,t))}var lL=mw.exports,vw=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gw,"__esModule",{value:!0});var lj=vw(ja),cj=vw(ps),hj=vw(lL);function fj(e,r,t,n){var i=hj.default(6),l=r.features.map(function(p){var u;return{minX:p.geometry.coordinates[0],minY:p.geometry.coordinates[1],maxX:p.geometry.coordinates[0],maxY:p.geometry.coordinates[1],property:(u=p.properties)===null||u===void 0?void 0:u[t]}});return i.load(l),e.features.forEach(function(p){p.properties||(p.properties={});var u=lj.default(p),_=i.search({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3]}),m=[];_.forEach(function(S){cj.default([S.minX,S.minY],p)&&m.push(S.property)}),p.properties[n]=m}),e}gw.default=fj;var yw={exports:{}},pj=nr,dj=zt,gj=ua;function mj(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var vj=mj(gj);function cL(e,r){if(r=r||{},!dj.isObject(r))throw new Error("options is invalid");var t=r.mutate;if(!e)throw new Error("geojson is required");return(t===!1||t===void 0)&&(e=vj.default(e)),pj.coordEach(e,function(n){var i=n[0],l=n[1];n[0]=l,n[1]=i}),e}yw.exports=cL;yw.exports.default=cL;var yj=yw.exports,_w={exports:{}},hh={};Object.defineProperty(hh,"__esModule",{value:!0});var _j=zt,Op=vr;function bj(e,r){r===void 0&&(r={});var t=typeof r=="object"?r.mutate:r;if(!e)throw new Error("geojson is required");var n=Op.getType(e),i=[];switch(n){case"LineString":i=O1(e);break;case"MultiLineString":case"Polygon":Op.getCoords(e).forEach(function(p){i.push(O1(p))});break;case"MultiPolygon":Op.getCoords(e).forEach(function(p){var u=[];p.forEach(function(_){u.push(O1(_))}),i.push(u)});break;case"Point":return e;case"MultiPoint":var l={};Op.getCoords(e).forEach(function(p){var u=p.join("-");Object.prototype.hasOwnProperty.call(l,u)||(i.push(p),l[u]=!0)});break;default:throw new Error(n+" geometry not supported")}return e.coordinates?t===!0?(e.coordinates=i,e):{type:n,coordinates:i}:t===!0?(e.geometry.coordinates=i,e):_j.feature({type:n,coordinates:i},e.properties,{bbox:e.bbox,id:e.id})}function O1(e){var r=Op.getCoords(e);if(r.length===2&&!hI(r[0],r[1]))return r;var t=[],n=r.length-1,i=t.length;t.push(r[0]);for(var l=1;l<n;l++){var p=t[t.length-1];r[l][0]===p[0]&&r[l][1]===p[1]||(t.push(r[l]),i=t.length,i>2&&fI(t[i-3],t[i-1],t[i-2])&&t.splice(t.length-2,1))}if(t.push(r[r.length-1]),i=t.length,hI(r[0],r[r.length-1])&&i<4)throw new Error("invalid polygon");return fI(t[i-3],t[i-1],t[i-2])&&t.splice(t.length-2,1),t}function hI(e,r){return e[0]===r[0]&&e[1]===r[1]}function fI(e,r,t){var n=t[0],i=t[1],l=e[0],p=e[1],u=r[0],_=r[1],m=n-l,S=i-p,P=u-l,O=_-p,M=m*O-S*P;return M!==0?!1:Math.abs(P)>=Math.abs(O)?P>0?l<=n&&n<=u:u<=n&&n<=l:O>0?p<=i&&i<=_:_<=i&&i<=p}hh.default=bj;var xj=hh,wj=ua,Ej=nr,Sj=zt;function hL(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Pj=hL(xj),Aj=hL(wj);function Ij(e,r){var t=e.x-r.x,n=e.y-r.y;return t*t+n*n}function Oj(e,r,t){var n=r.x,i=r.y,l=t.x-n,p=t.y-i;if(l!==0||p!==0){var u=((e.x-n)*l+(e.y-i)*p)/(l*l+p*p);u>1?(n=t.x,i=t.y):u>0&&(n+=l*u,i+=p*u)}return l=e.x-n,p=e.y-i,l*l+p*p}function Cj(e,r){for(var t=e[0],n=[t],i,l=1,p=e.length;l<p;l++)i=e[l],Ij(i,t)>r&&(n.push(i),t=i);return t!==i&&n.push(i),n}function Cb(e,r,t,n,i){for(var l=n,p,u=r+1;u<t;u++){var _=Oj(e[u],e[r],e[t]);_>l&&(p=u,l=_)}l>n&&(p-r>1&&Cb(e,r,p,n,i),i.push(e[p]),t-p>1&&Cb(e,p,t,n,i))}function Tj(e,r){var t=e.length-1,n=[e[0]];return Cb(e,0,t,r,n),n.push(e[t]),n}function Tb(e,r,t){if(e.length<=2)return e;var n=r!==void 0?r*r:1;return e=t?e:Cj(e,n),e=Tj(e,n),e}function fL(e,r){if(r=r||{},!Sj.isObject(r))throw new Error("options is invalid");var t=r.tolerance!==void 0?r.tolerance:1,n=r.highQuality||!1,i=r.mutate||!1;if(!e)throw new Error("geojson is required");if(t&&t<0)throw new Error("invalid tolerance");return i!==!0&&(e=Aj.default(e)),Ej.geomEach(e,function(l){Mj(l,t,n)}),e}function Mj(e,r,t){var n=e.type;if(n==="Point"||n==="MultiPoint")return e;Pj.default(e,!0);var i=e.coordinates;switch(n){case"LineString":e.coordinates=pI(i,r,t);break;case"MultiLineString":e.coordinates=i.map(function(l){return pI(l,r,t)});break;case"Polygon":e.coordinates=dI(i,r,t);break;case"MultiPolygon":e.coordinates=i.map(function(l){return dI(l,r,t)})}return e}function pI(e,r,t){return Tb(e.map(function(n){return{x:n[0],y:n[1],z:n[2]}}),r,t).map(function(n){return n.z?[n.x,n.y,n.z]:[n.x,n.y]})}function dI(e,r,t){return e.map(function(n){var i=n.map(function(p){return{x:p[0],y:p[1]}});if(i.length<4)throw new Error("invalid polygon");for(var l=Tb(i,r,t).map(function(p){return[p.x,p.y]});!Lj(l);)r-=r*.01,l=Tb(i,r,t).map(function(p){return[p.x,p.y]});return(l[l.length-1][0]!==l[0][0]||l[l.length-1][1]!==l[0][1])&&l.push(l[0]),l})}function Lj(e){return e.length<3?!1:!(e.length===3&&e[2][0]===e[0][0]&&e[2][1]===e[0][1])}_w.exports=fL;_w.exports.default=fL;var Rj=_w.exports,bw={},xw={};Object.defineProperty(xw,"__esModule",{value:!0});var Dj=function(){function e(r){this.points=r.points||[],this.duration=r.duration||1e4,this.sharpness=r.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=r.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var n=this.points[t],i=this.points[t+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var l=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,p=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,u=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+l),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+p),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+u)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+l),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+p),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+u)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return e.prototype.cacheSteps=function(r){var t=[],n=this.pos(0);t.push(0);for(var i=0;i<this.duration;i+=10){var l=this.pos(i),p=Math.sqrt((l.x-n.x)*(l.x-n.x)+(l.y-n.y)*(l.y-n.y)+(l.z-n.z)*(l.z-n.z));p>r&&(t.push(i),n=l)}return t},e.prototype.vector=function(r){var t=this.pos(r+10),n=this.pos(r-10);return{angle:180*Math.atan2(t.y-n.y,t.x-n.x)/3.14,speed:Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)+(n.z-t.z)*(n.z-t.z))}},e.prototype.pos=function(r){var t=r-this.delay;t<0&&(t=0),t>this.duration&&(t=this.duration-1);var n=t/this.duration;if(n>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*n),l=(this.length-1)*n-i;return Nj(l,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])},e}();xw.default=Dj;function Nj(e,r,t,n,i){var l=Fj(e),p={x:i.x*l[0]+n.x*l[1]+t.x*l[2]+r.x*l[3],y:i.y*l[0]+n.y*l[1]+t.y*l[2]+r.y*l[3],z:i.z*l[0]+n.z*l[1]+t.z*l[2]+r.z*l[3]};return p}function Fj(e){var r=e*e,t=r*e;return[t,3*r*(1-e),3*e*(1-e)*(1-e),(1-e)*(1-e)*(1-e)]}var kj=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bw,"__esModule",{value:!0});var Bj=zt,zj=vr,jj=kj(xw);function Uj(e,r){r===void 0&&(r={});for(var t=r.resolution||1e4,n=r.sharpness||.85,i=[],l=zj.getGeom(e).coordinates.map(function(m){return{x:m[0],y:m[1]}}),p=new jj.default({duration:t,points:l,sharpness:n}),u=function(m){var S=p.pos(m);Math.floor(m/100)%2===0&&i.push([S.x,S.y])},_=0;_<p.duration;_+=10)u(_);return u(p.duration),Bj.lineString(i,r.properties)}bw.default=Uj;var ww={exports:{}},$j=ps,Gj=ua,gI=nr;function pL(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var qj=pL($j),mI=pL(Gj);function dL(e,r,t,n){return e=mI.default(e),r=mI.default(r),gI.featureEach(e,function(i){i.properties||(i.properties={}),gI.featureEach(r,function(l){i.properties[n]===void 0&&qj.default(i,l)&&(i.properties[n]=l.properties[t])})}),e}ww.exports=dL;ww.exports.default=dL;var Vj=ww.exports,Ew={exports:{}},Xj=zt;function gL(e,r){if(!e)throw new Error("featurecollection is required");if(r==null)throw new Error("num is required");if(typeof r!="number")throw new Error("num must be a number");var t=Xj.featureCollection(Yj(e.features,r));return t}function Yj(e,r){for(var t=e.slice(0),n=e.length,i=n-r,l,p;n-- >i;)p=Math.floor((n+1)*Math.random()),l=t[p],t[p]=t[n],t[n]=l;return t.slice(i)}Ew.exports=gL;Ew.exports.default=gL;var Wj=Ew.exports,Sw={exports:{}},_d={};Object.defineProperty(_d,"__esModule",{value:!0});var Zj=zt;function Hj(e,r){r===void 0&&(r={});var t=Number(e[0]),n=Number(e[1]),i=Number(e[2]),l=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var p=[t,n],u=[t,l],_=[i,l],m=[i,n];return Zj.polygon([[p,m,_,u,p]],r.properties,{bbox:e,id:r.id})}_d.default=Hj;var Jj=ja,Kj=_d;function mL(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Qj=mL(Jj),e6=mL(Kj);function vL(e){return e6.default(Qj.default(e))}Sw.exports=vL;Sw.exports.default=vL;var yL=Sw.exports,Pw={exports:{}},t6=Vo;function r6(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var vI=r6(t6);function _L(e){var r=e[0],t=e[1],n=e[2],i=e[3],l=vI.default(e.slice(0,2),[n,t]),p=vI.default(e.slice(0,2),[r,i]);if(l>=p){var u=(t+i)/2;return[r,u-(n-r)/2,n,u+(n-r)/2]}else{var _=(r+n)/2;return[_-(i-t)/2,t,_+(i-t)/2,i]}}Pw.exports=_L;Pw.exports.default=_L;var bL=Pw.exports,bd={},Jl={};Object.defineProperty(Jl,"__esModule",{value:!0});var jc=zt,n6=vr;function i6(e,r,t,n){n===void 0&&(n={});var i=n6.getCoord(e),l=jc.degreesToRadians(i[0]),p=jc.degreesToRadians(i[1]),u=jc.degreesToRadians(t),_=jc.lengthToRadians(r,n.units),m=Math.asin(Math.sin(p)*Math.cos(_)+Math.cos(p)*Math.sin(_)*Math.cos(u)),S=l+Math.atan2(Math.sin(u)*Math.sin(_)*Math.cos(p),Math.cos(_)-Math.sin(p)*Math.sin(m)),P=jc.radiansToDegrees(S),O=jc.radiansToDegrees(m);return jc.point([P,O],n.properties)}Jl.default=i6;var o6=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bd,"__esModule",{value:!0});var a6=o6(Jl),s6=zt;function u6(e,r,t){t===void 0&&(t={});for(var n=t.steps||64,i=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},l=[],p=0;p<n;p++)l.push(a6.default(e,r,p*-360/n,t).geometry.coordinates);return l.push(l[0]),s6.polygon([l],i)}bd.default=u6;var Aw={exports:{}},Pc={};Object.defineProperty(Pc,"__esModule",{value:!0});var dp=zt,yI=vr;function xL(e,r,t){if(t===void 0&&(t={}),t.final===!0)return l6(e,r);var n=yI.getCoord(e),i=yI.getCoord(r),l=dp.degreesToRadians(n[0]),p=dp.degreesToRadians(i[0]),u=dp.degreesToRadians(n[1]),_=dp.degreesToRadians(i[1]),m=Math.sin(p-l)*Math.cos(_),S=Math.cos(u)*Math.sin(_)-Math.sin(u)*Math.cos(_)*Math.cos(p-l);return dp.radiansToDegrees(Math.atan2(m,S))}Pc.default=xL;function l6(e,r){var t=xL(r,e);return t=(t+180)%360,t}var c6=Pc,h6=Jl,f6=Vo;function Iw(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var p6=Iw(c6),d6=Iw(h6),g6=Iw(f6);function wL(e,r){var t=g6.default(e,r),n=p6.default(e,r),i=d6.default(e,t/2,n);return i}Aw.exports=wL;Aw.exports.default=wL;var m6=Aw.exports,Af={},v6=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Af,"__esModule",{value:!0});var y6=v6(ja),_6=zt;function b6(e,r){r===void 0&&(r={});var t=y6.default(e),n=(t[0]+t[2])/2,i=(t[1]+t[3])/2;return _6.point([n,i],r.properties,r)}Af.default=b6;var Ow={},Kl={};Object.defineProperty(Kl,"__esModule",{value:!0});var x6=nr,w6=zt;function E6(e,r){r===void 0&&(r={});var t=0,n=0,i=0;return x6.coordEach(e,function(l){t+=l[0],n+=l[1],i++},!0),w6.point([t/i,n/i],r.properties)}Kl.default=E6;var EL=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ow,"__esModule",{value:!0});var S6=EL(bv),_I=EL(Kl),bI=zt,xI=vr,P6=nr;function SL(e,r){switch(r===void 0&&(r={}),xI.getType(e)){case"Point":return bI.point(xI.getCoord(e),r.properties);case"Polygon":var t=[];P6.coordEach(e,function(U){t.push(U)});var n=_I.default(e,{properties:r.properties}),i=n.geometry.coordinates,l=0,p=0,u=0,_,m,S,P,O,M,B,$,q=t.map(function(U){return[U[0]-i[0],U[1]-i[1]]});for(_=0;_<t.length-1;_++)m=q[_],P=m[0],M=m[1],S=q[_+1],O=S[0],B=S[1],$=P*B-O*M,u+=$,l+=(P+O)*$,p+=(M+B)*$;if(u===0)return n;var X=u*.5,R=1/(6*X);return bI.point([i[0]+R*l,i[1]+R*p],r.properties);default:var k=S6.default(e);return k?SL(k,{properties:r.properties}):_I.default(e,{properties:r.properties})}}Ow.default=SL;var Cw={};Object.defineProperty(Cw,"__esModule",{value:!0});var wI=zt,A6=nr;function I6(e){var r={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return A6.featureEach(e,function(t){var n,i,l,p;switch((p=t.geometry)===null||p===void 0?void 0:p.type){case"Point":r.MultiPoint.coordinates.push(t.geometry.coordinates),r.MultiPoint.properties.push(t.properties);break;case"MultiPoint":(n=r.MultiPoint.coordinates).push.apply(n,t.geometry.coordinates),r.MultiPoint.properties.push(t.properties);break;case"LineString":r.MultiLineString.coordinates.push(t.geometry.coordinates),r.MultiLineString.properties.push(t.properties);break;case"MultiLineString":(i=r.MultiLineString.coordinates).push.apply(i,t.geometry.coordinates),r.MultiLineString.properties.push(t.properties);break;case"Polygon":r.MultiPolygon.coordinates.push(t.geometry.coordinates),r.MultiPolygon.properties.push(t.properties);break;case"MultiPolygon":(l=r.MultiPolygon.coordinates).push.apply(l,t.geometry.coordinates),r.MultiPolygon.properties.push(t.properties);break}}),wI.featureCollection(Object.keys(r).filter(function(t){return r[t].coordinates.length}).sort().map(function(t){var n={type:t,coordinates:r[t].coordinates},i={collectedProperties:r[t].properties};return wI.feature(n,i)}))}Cw.default=I6;var Tw={exports:{}},C1=nr,T1=zt;function PL(e){var r=[];return e.type==="FeatureCollection"?C1.featureEach(e,function(t){C1.coordEach(t,function(n){r.push(T1.point(n,t.properties))})}):C1.coordEach(e,function(t){r.push(T1.point(t,e.properties))}),T1.featureCollection(r)}Tw.exports=PL;Tw.exports.default=PL;var Pv=Tw.exports,Mw={exports:{}},Lw={exports:{}};Lw.exports=Av;Lw.exports.default=Av;function Av(e,r,t){t=t||2;var n=r&&r.length,i=n?r[0]*t:e.length,l=AL(e,0,i,t,!0),p=[];if(!l||l.next===l.prev)return p;var u,_,m,S,P,O,M;if(n&&(l=L6(e,r,l,t)),e.length>80*t){u=m=e[0],_=S=e[1];for(var B=t;B<i;B+=t)P=e[B],O=e[B+1],P<u&&(u=P),O<_&&(_=O),P>m&&(m=P),O>S&&(S=O);M=Math.max(m-u,S-_),M=M!==0?32767/M:0}return Qp(l,p,t,u,_,M,0),p}function AL(e,r,t,n,i){var l,p;if(i===Rb(e,r,t,n)>0)for(l=r;l<t;l+=n)p=EI(l,e[l],e[l+1],p);else for(l=t-n;l>=r;l-=n)p=EI(l,e[l],e[l+1],p);return p&&Iv(p,p.next)&&(td(p),p=p.next),p}function nh(e,r){if(!e)return e;r||(r=e);var t=e,n;do if(n=!1,!t.steiner&&(Iv(t,t.next)||po(t.prev,t,t.next)===0)){if(td(t),t=r=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==r);return r}function Qp(e,r,t,n,i,l,p){if(e){!p&&l&&k6(e,n,i,l);for(var u=e,_,m;e.prev!==e.next;){if(_=e.prev,m=e.next,l?C6(e,n,i,l):O6(e)){r.push(_.i/t|0),r.push(e.i/t|0),r.push(m.i/t|0),td(e),e=m.next,u=m.next;continue}if(e=m,e===u){p?p===1?(e=T6(nh(e),r,t),Qp(e,r,t,n,i,l,2)):p===2&&M6(e,r,t,n,i,l):Qp(nh(e),r,t,n,i,l,1);break}}}}function O6(e){var r=e.prev,t=e,n=e.next;if(po(r,t,n)>=0)return!1;for(var i=r.x,l=t.x,p=n.x,u=r.y,_=t.y,m=n.y,S=i<l?i<p?i:p:l<p?l:p,P=u<_?u<m?u:m:_<m?_:m,O=i>l?i>p?i:p:l>p?l:p,M=u>_?u>m?u:m:_>m?_:m,B=n.next;B!==r;){if(B.x>=S&&B.x<=O&&B.y>=P&&B.y<=M&&tf(i,u,l,_,p,m,B.x,B.y)&&po(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function C6(e,r,t,n){var i=e.prev,l=e,p=e.next;if(po(i,l,p)>=0)return!1;for(var u=i.x,_=l.x,m=p.x,S=i.y,P=l.y,O=p.y,M=u<_?u<m?u:m:_<m?_:m,B=S<P?S<O?S:O:P<O?P:O,$=u>_?u>m?u:m:_>m?_:m,q=S>P?S>O?S:O:P>O?P:O,X=Mb(M,B,r,t,n),R=Mb($,q,r,t,n),k=e.prevZ,U=e.nextZ;k&&k.z>=X&&U&&U.z<=R;){if(k.x>=M&&k.x<=$&&k.y>=B&&k.y<=q&&k!==i&&k!==p&&tf(u,S,_,P,m,O,k.x,k.y)&&po(k.prev,k,k.next)>=0||(k=k.prevZ,U.x>=M&&U.x<=$&&U.y>=B&&U.y<=q&&U!==i&&U!==p&&tf(u,S,_,P,m,O,U.x,U.y)&&po(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;k&&k.z>=X;){if(k.x>=M&&k.x<=$&&k.y>=B&&k.y<=q&&k!==i&&k!==p&&tf(u,S,_,P,m,O,k.x,k.y)&&po(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;U&&U.z<=R;){if(U.x>=M&&U.x<=$&&U.y>=B&&U.y<=q&&U!==i&&U!==p&&tf(u,S,_,P,m,O,U.x,U.y)&&po(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function T6(e,r,t){var n=e;do{var i=n.prev,l=n.next.next;!Iv(i,l)&&IL(i,n,n.next,l)&&ed(i,l)&&ed(l,i)&&(r.push(i.i/t|0),r.push(n.i/t|0),r.push(l.i/t|0),td(n),td(n.next),n=e=l),n=n.next}while(n!==e);return nh(n)}function M6(e,r,t,n,i,l){var p=e;do{for(var u=p.next.next;u!==p.prev;){if(p.i!==u.i&&j6(p,u)){var _=OL(p,u);p=nh(p,p.next),_=nh(_,_.next),Qp(p,r,t,n,i,l,0),Qp(_,r,t,n,i,l,0);return}u=u.next}p=p.next}while(p!==e)}function L6(e,r,t,n){var i=[],l,p,u,_,m;for(l=0,p=r.length;l<p;l++)u=r[l]*n,_=l<p-1?r[l+1]*n:e.length,m=AL(e,u,_,n,!1),m===m.next&&(m.steiner=!0),i.push(z6(m));for(i.sort(R6),l=0;l<i.length;l++)t=D6(i[l],t);return t}function R6(e,r){return e.x-r.x}function D6(e,r){var t=N6(e,r);if(!t)return r;var n=OL(t,e);return nh(n,n.next),nh(t,t.next)}function N6(e,r){var t=r,n=e.x,i=e.y,l=-1/0,p;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){var u=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(u<=n&&u>l&&(l=u,p=t.x<t.next.x?t:t.next,u===n))return p}t=t.next}while(t!==r);if(!p)return null;var _=p,m=p.x,S=p.y,P=1/0,O;t=p;do n>=t.x&&t.x>=m&&n!==t.x&&tf(i<S?n:l,i,m,S,i<S?l:n,i,t.x,t.y)&&(O=Math.abs(i-t.y)/(n-t.x),ed(t,e)&&(O<P||O===P&&(t.x>p.x||t.x===p.x&&F6(p,t)))&&(p=t,P=O)),t=t.next;while(t!==_);return p}function F6(e,r){return po(e.prev,e,r.prev)<0&&po(r.next,e,e.next)<0}function k6(e,r,t,n){var i=e;do i.z===0&&(i.z=Mb(i.x,i.y,r,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,B6(i)}function B6(e){var r,t,n,i,l,p,u,_,m=1;do{for(t=e,e=null,l=null,p=0;t;){for(p++,n=t,u=0,r=0;r<m&&(u++,n=n.nextZ,!!n);r++);for(_=m;u>0||_>0&&n;)u!==0&&(_===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,u--):(i=n,n=n.nextZ,_--),l?l.nextZ=i:e=i,i.prevZ=l,l=i;t=n}l.nextZ=null,m*=2}while(p>1);return e}function Mb(e,r,t,n,i){return e=(e-t)*i|0,r=(r-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e|r<<1}function z6(e){var r=e,t=e;do(r.x<t.x||r.x===t.x&&r.y<t.y)&&(t=r),r=r.next;while(r!==e);return t}function tf(e,r,t,n,i,l,p,u){return(i-p)*(r-u)>=(e-p)*(l-u)&&(e-p)*(n-u)>=(t-p)*(r-u)&&(t-p)*(l-u)>=(i-p)*(n-u)}function j6(e,r){return e.next.i!==r.i&&e.prev.i!==r.i&&!U6(e,r)&&(ed(e,r)&&ed(r,e)&&$6(e,r)&&(po(e.prev,e,r.prev)||po(e,r.prev,r))||Iv(e,r)&&po(e.prev,e,e.next)>0&&po(r.prev,r,r.next)>0)}function po(e,r,t){return(r.y-e.y)*(t.x-r.x)-(r.x-e.x)*(t.y-r.y)}function Iv(e,r){return e.x===r.x&&e.y===r.y}function IL(e,r,t,n){var i=Hg(po(e,r,t)),l=Hg(po(e,r,n)),p=Hg(po(t,n,e)),u=Hg(po(t,n,r));return!!(i!==l&&p!==u||i===0&&Zg(e,t,r)||l===0&&Zg(e,n,r)||p===0&&Zg(t,e,n)||u===0&&Zg(t,r,n))}function Zg(e,r,t){return r.x<=Math.max(e.x,t.x)&&r.x>=Math.min(e.x,t.x)&&r.y<=Math.max(e.y,t.y)&&r.y>=Math.min(e.y,t.y)}function Hg(e){return e>0?1:e<0?-1:0}function U6(e,r){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==r.i&&t.next.i!==r.i&&IL(t,t.next,e,r))return!0;t=t.next}while(t!==e);return!1}function ed(e,r){return po(e.prev,e,e.next)<0?po(e,r,e.next)>=0&&po(e,e.prev,r)>=0:po(e,r,e.prev)<0||po(e,e.next,r)<0}function $6(e,r){var t=e,n=!1,i=(e.x+r.x)/2,l=(e.y+r.y)/2;do t.y>l!=t.next.y>l&&t.next.y!==t.y&&i<(t.next.x-t.x)*(l-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==e);return n}function OL(e,r){var t=new Lb(e.i,e.x,e.y),n=new Lb(r.i,r.x,r.y),i=e.next,l=r.prev;return e.next=r,r.prev=e,t.next=i,i.prev=t,n.next=t,t.prev=n,l.next=n,n.prev=l,n}function EI(e,r,t,n){var i=new Lb(e,r,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function td(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Lb(e,r,t){this.i=e,this.x=r,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Av.deviation=function(e,r,t,n){var i=r&&r.length,l=i?r[0]*t:e.length,p=Math.abs(Rb(e,0,l,t));if(i)for(var u=0,_=r.length;u<_;u++){var m=r[u]*t,S=u<_-1?r[u+1]*t:e.length;p-=Math.abs(Rb(e,m,S,t))}var P=0;for(u=0;u<n.length;u+=3){var O=n[u]*t,M=n[u+1]*t,B=n[u+2]*t;P+=Math.abs((e[O]-e[B])*(e[M+1]-e[O+1])-(e[O]-e[M])*(e[B+1]-e[O+1]))}return p===0&&P===0?0:Math.abs((P-p)/p)};function Rb(e,r,t,n){for(var i=0,l=r,p=t-n;l<t;l+=n)i+=(e[p]-e[l])*(e[l+1]+e[p+1]),p=l;return i}Av.flatten=function(e){for(var r=e[0][0].length,t={vertices:[],holes:[],dimensions:r},n=0,i=0;i<e.length;i++){for(var l=0;l<e[i].length;l++)for(var p=0;p<r;p++)t.vertices.push(e[i][l][p]);i>0&&(n+=e[i-1].length,t.holes.push(n))}return t};var G6=Lw.exports,q6=G6,V6=zt;function X6(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Y6=X6(q6);function CL(e){if(!e.geometry||e.geometry.type!=="Polygon"&&e.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var r={type:"FeatureCollection",features:[]};return e.geometry.type==="Polygon"?r.features=SI(e.geometry.coordinates):e.geometry.coordinates.forEach(function(t){r.features=r.features.concat(SI(t))}),r}function SI(e){var r=W6(e),t=2,n=Y6.default(r.vertices,r.holes,t),i=[],l=[];n.forEach(function(_,m){var S=n[m];l.push([r.vertices[S*t],r.vertices[S*t+1]])});for(var p=0;p<l.length;p+=3){var u=l.slice(p,p+3);u.push(l[p]),i.push(V6.polygon([u]))}return i}function W6(e){for(var r=e[0][0].length,t={vertices:[],holes:[],dimensions:r},n=0,i=0;i<e.length;i++){for(var l=0;l<e[i].length;l++)for(var p=0;p<r;p++)t.vertices.push(e[i][l][p]);i>0&&(n+=e[i-1].length,t.holes.push(n))}return t}Mw.exports=CL;Mw.exports.default=CL;var Z6=Mw.exports,xd={},TL=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xd,"__esModule",{value:!0});var H6=TL(ua),J6=TL(Vo),K6=nr;function Q6(e,r){if(!e)throw new Error("targetPoint is required");if(!r)throw new Error("points is required");var t,n=1/0,i=0;return K6.featureEach(r,function(l,p){var u=J6.default(e,l);u<n&&(i=p,n=u)}),t=H6.default(r.features[i]),t.properties.featureIndex=i,t.properties.distanceToPoint=n,t}xd.default=Q6;var If={},Ac={},fh={};Object.defineProperty(fh,"__esModule",{value:!0});var ML=zt,PI=vr,eU=nr;function tU(e){if(!e)throw new Error("geojson is required");var r=[];return eU.flattenEach(e,function(t){rU(t,r)}),ML.featureCollection(r)}function rU(e,r){var t=[],n=e.geometry;if(n!==null){switch(n.type){case"Polygon":t=PI.getCoords(n);break;case"LineString":t=[PI.getCoords(n)]}t.forEach(function(i){var l=nU(i,e.properties);l.forEach(function(p){p.id=r.length,r.push(p)})})}}function nU(e,r){var t=[];return e.reduce(function(n,i){var l=ML.lineString([n,i],r);return l.bbox=iU(n,i),t.push(l),i}),t}function iU(e,r){var t=e[0],n=e[1],i=r[0],l=r[1],p=t<i?t:i,u=n<l?n:l,_=t>i?t:i,m=n>l?n:l;return[p,u,_,m]}fh.default=tU;var Rw={exports:{}},LL={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(we,function(){function t(R,k,U,H,ue){(function ie(ee,W,J,be,Oe){for(;be>J;){if(be-J>600){var Ae=be-J+1,ae=W-J+1,ct=Math.log(Ae),Pe=.5*Math.exp(2*ct/3),V=.5*Math.sqrt(ct*Pe*(Ae-Pe)/Ae)*(ae-Ae/2<0?-1:1),Q=Math.max(J,Math.floor(W-ae*Pe/Ae+V)),he=Math.min(be,Math.floor(W+(Ae-ae)*Pe/Ae+V));ie(ee,W,Q,he,Oe)}var fe=ee[W],ye=J,se=be;for(n(ee,J,W),Oe(ee[be],fe)>0&&n(ee,J,be);ye<se;){for(n(ee,ye,se),ye++,se--;Oe(ee[ye],fe)<0;)ye++;for(;Oe(ee[se],fe)>0;)se--}Oe(ee[J],fe)===0?n(ee,J,se):n(ee,++se,be),se<=W&&(J=se+1),W<=se&&(be=se-1)}})(R,k,U||0,H||R.length-1,ue||i)}function n(R,k,U){var H=R[k];R[k]=R[U],R[U]=H}function i(R,k){return R<k?-1:R>k?1:0}var l=function(R){R===void 0&&(R=9),this._maxEntries=Math.max(4,R),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function p(R,k,U){if(!U)return k.indexOf(R);for(var H=0;H<k.length;H++)if(U(R,k[H]))return H;return-1}function u(R,k){_(R,0,R.children.length,k,R)}function _(R,k,U,H,ue){ue||(ue=q(null)),ue.minX=1/0,ue.minY=1/0,ue.maxX=-1/0,ue.maxY=-1/0;for(var ie=k;ie<U;ie++){var ee=R.children[ie];m(ue,R.leaf?H(ee):ee)}return ue}function m(R,k){return R.minX=Math.min(R.minX,k.minX),R.minY=Math.min(R.minY,k.minY),R.maxX=Math.max(R.maxX,k.maxX),R.maxY=Math.max(R.maxY,k.maxY),R}function S(R,k){return R.minX-k.minX}function P(R,k){return R.minY-k.minY}function O(R){return(R.maxX-R.minX)*(R.maxY-R.minY)}function M(R){return R.maxX-R.minX+(R.maxY-R.minY)}function B(R,k){return R.minX<=k.minX&&R.minY<=k.minY&&k.maxX<=R.maxX&&k.maxY<=R.maxY}function $(R,k){return k.minX<=R.maxX&&k.minY<=R.maxY&&k.maxX>=R.minX&&k.maxY>=R.minY}function q(R){return{children:R,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function X(R,k,U,H,ue){for(var ie=[k,U];ie.length;)if(!((U=ie.pop())-(k=ie.pop())<=H)){var ee=k+Math.ceil((U-k)/H/2)*H;t(R,ee,k,U,ue),ie.push(k,ee,ee,U)}}return l.prototype.all=function(){return this._all(this.data,[])},l.prototype.search=function(R){var k=this.data,U=[];if(!$(R,k))return U;for(var H=this.toBBox,ue=[];k;){for(var ie=0;ie<k.children.length;ie++){var ee=k.children[ie],W=k.leaf?H(ee):ee;$(R,W)&&(k.leaf?U.push(ee):B(R,W)?this._all(ee,U):ue.push(ee))}k=ue.pop()}return U},l.prototype.collides=function(R){var k=this.data;if(!$(R,k))return!1;for(var U=[];k;){for(var H=0;H<k.children.length;H++){var ue=k.children[H],ie=k.leaf?this.toBBox(ue):ue;if($(R,ie)){if(k.leaf||B(R,ie))return!0;U.push(ue)}}k=U.pop()}return!1},l.prototype.load=function(R){if(!R||!R.length)return this;if(R.length<this._minEntries){for(var k=0;k<R.length;k++)this.insert(R[k]);return this}var U=this._build(R.slice(),0,R.length-1,0);if(this.data.children.length)if(this.data.height===U.height)this._splitRoot(this.data,U);else{if(this.data.height<U.height){var H=this.data;this.data=U,U=H}this._insert(U,this.data.height-U.height-1,!0)}else this.data=U;return this},l.prototype.insert=function(R){return R&&this._insert(R,this.data.height-1),this},l.prototype.clear=function(){return this.data=q([]),this},l.prototype.remove=function(R,k){if(!R)return this;for(var U,H,ue,ie=this.data,ee=this.toBBox(R),W=[],J=[];ie||W.length;){if(ie||(ie=W.pop(),H=W[W.length-1],U=J.pop(),ue=!0),ie.leaf){var be=p(R,ie.children,k);if(be!==-1)return ie.children.splice(be,1),W.push(ie),this._condense(W),this}ue||ie.leaf||!B(ie,ee)?H?(U++,ie=H.children[U],ue=!1):ie=null:(W.push(ie),J.push(U),U=0,H=ie,ie=ie.children[0])}return this},l.prototype.toBBox=function(R){return R},l.prototype.compareMinX=function(R,k){return R.minX-k.minX},l.prototype.compareMinY=function(R,k){return R.minY-k.minY},l.prototype.toJSON=function(){return this.data},l.prototype.fromJSON=function(R){return this.data=R,this},l.prototype._all=function(R,k){for(var U=[];R;)R.leaf?k.push.apply(k,R.children):U.push.apply(U,R.children),R=U.pop();return k},l.prototype._build=function(R,k,U,H){var ue,ie=U-k+1,ee=this._maxEntries;if(ie<=ee)return u(ue=q(R.slice(k,U+1)),this.toBBox),ue;H||(H=Math.ceil(Math.log(ie)/Math.log(ee)),ee=Math.ceil(ie/Math.pow(ee,H-1))),(ue=q([])).leaf=!1,ue.height=H;var W=Math.ceil(ie/ee),J=W*Math.ceil(Math.sqrt(ee));X(R,k,U,J,this.compareMinX);for(var be=k;be<=U;be+=J){var Oe=Math.min(be+J-1,U);X(R,be,Oe,W,this.compareMinY);for(var Ae=be;Ae<=Oe;Ae+=W){var ae=Math.min(Ae+W-1,Oe);ue.children.push(this._build(R,Ae,ae,H-1))}}return u(ue,this.toBBox),ue},l.prototype._chooseSubtree=function(R,k,U,H){for(;H.push(k),!k.leaf&&H.length-1!==U;){for(var ue=1/0,ie=1/0,ee=void 0,W=0;W<k.children.length;W++){var J=k.children[W],be=O(J),Oe=(Ae=R,ae=J,(Math.max(ae.maxX,Ae.maxX)-Math.min(ae.minX,Ae.minX))*(Math.max(ae.maxY,Ae.maxY)-Math.min(ae.minY,Ae.minY))-be);Oe<ie?(ie=Oe,ue=be<ue?be:ue,ee=J):Oe===ie&&be<ue&&(ue=be,ee=J)}k=ee||k.children[0]}var Ae,ae;return k},l.prototype._insert=function(R,k,U){var H=U?R:this.toBBox(R),ue=[],ie=this._chooseSubtree(H,this.data,k,ue);for(ie.children.push(R),m(ie,H);k>=0&&ue[k].children.length>this._maxEntries;)this._split(ue,k),k--;this._adjustParentBBoxes(H,ue,k)},l.prototype._split=function(R,k){var U=R[k],H=U.children.length,ue=this._minEntries;this._chooseSplitAxis(U,ue,H);var ie=this._chooseSplitIndex(U,ue,H),ee=q(U.children.splice(ie,U.children.length-ie));ee.height=U.height,ee.leaf=U.leaf,u(U,this.toBBox),u(ee,this.toBBox),k?R[k-1].children.push(ee):this._splitRoot(U,ee)},l.prototype._splitRoot=function(R,k){this.data=q([R,k]),this.data.height=R.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},l.prototype._chooseSplitIndex=function(R,k,U){for(var H,ue,ie,ee,W,J,be,Oe=1/0,Ae=1/0,ae=k;ae<=U-k;ae++){var ct=_(R,0,ae,this.toBBox),Pe=_(R,ae,U,this.toBBox),V=(ue=ct,ie=Pe,ee=void 0,W=void 0,J=void 0,be=void 0,ee=Math.max(ue.minX,ie.minX),W=Math.max(ue.minY,ie.minY),J=Math.min(ue.maxX,ie.maxX),be=Math.min(ue.maxY,ie.maxY),Math.max(0,J-ee)*Math.max(0,be-W)),Q=O(ct)+O(Pe);V<Oe?(Oe=V,H=ae,Ae=Q<Ae?Q:Ae):V===Oe&&Q<Ae&&(Ae=Q,H=ae)}return H||U-k},l.prototype._chooseSplitAxis=function(R,k,U){var H=R.leaf?this.compareMinX:S,ue=R.leaf?this.compareMinY:P;this._allDistMargin(R,k,U,H)<this._allDistMargin(R,k,U,ue)&&R.children.sort(H)},l.prototype._allDistMargin=function(R,k,U,H){R.children.sort(H);for(var ue=this.toBBox,ie=_(R,0,k,ue),ee=_(R,U-k,U,ue),W=M(ie)+M(ee),J=k;J<U-k;J++){var be=R.children[J];m(ie,R.leaf?ue(be):be),W+=M(ie)}for(var Oe=U-k-1;Oe>=k;Oe--){var Ae=R.children[Oe];m(ee,R.leaf?ue(Ae):Ae),W+=M(ee)}return W},l.prototype._adjustParentBBoxes=function(R,k,U){for(var H=U;H>=0;H--)m(k[H],R)},l.prototype._condense=function(R){for(var k=R.length-1,U=void 0;k>=0;k--)R[k].children.length===0?k>0?(U=R[k-1].children).splice(U.indexOf(R[k]),1):this.clear():u(R[k],this.toBBox)},l})})(LL);var oU=LL.exports,dl=oU,RL=zt,DL=nr,Vh=ja.default,aU=DL.featureEach;DL.coordEach;RL.polygon;var AI=RL.featureCollection;function NL(e){var r=new dl(e);return r.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Vh(t),dl.prototype.insert.call(this,t)},r.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Vh(i),n.push(i)}):aU(t,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Vh(i),n.push(i)}),dl.prototype.load.call(this,n)},r.remove=function(t,n){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Vh(t),dl.prototype.remove.call(this,t,n)},r.clear=function(){return dl.prototype.clear.call(this)},r.search=function(t){var n=dl.prototype.search.call(this,this.toBBox(t));return AI(n)},r.collides=function(t){return dl.prototype.collides.call(this,this.toBBox(t))},r.all=function(){var t=dl.prototype.all.call(this);return AI(t)},r.toJSON=function(){return dl.prototype.toJSON.call(this)},r.fromJSON=function(t){return dl.prototype.fromJSON.call(this,t)},r.toBBox=function(t){var n;if(t.bbox)n=t.bbox;else if(Array.isArray(t)&&t.length===4)n=t;else if(Array.isArray(t)&&t.length===6)n=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")n=Vh(t);else if(t.type==="FeatureCollection")n=Vh(t);else throw new Error("invalid geojson");return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]}},r}Rw.exports=NL;Rw.exports.default=NL;var Dw=Rw.exports,FL=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ac,"__esModule",{value:!0});var Cp=zt,Db=vr,II=FL(fh),OI=nr,sU=FL(Dw);function uU(e,r){var t={},n=[];if(e.type==="LineString"&&(e=Cp.feature(e)),r.type==="LineString"&&(r=Cp.feature(r)),e.type==="Feature"&&r.type==="Feature"&&e.geometry!==null&&r.geometry!==null&&e.geometry.type==="LineString"&&r.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&r.geometry.coordinates.length===2){var i=CI(e,r);return i&&n.push(i),Cp.featureCollection(n)}var l=sU.default();return l.load(II.default(r)),OI.featureEach(II.default(e),function(p){OI.featureEach(l.search(p),function(u){var _=CI(p,u);if(_){var m=Db.getCoords(_).join(",");t[m]||(t[m]=!0,n.push(_))}})}),Cp.featureCollection(n)}function CI(e,r){var t=Db.getCoords(e),n=Db.getCoords(r);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=t[0][0],l=t[0][1],p=t[1][0],u=t[1][1],_=n[0][0],m=n[0][1],S=n[1][0],P=n[1][1],O=(P-m)*(p-i)-(S-_)*(u-l),M=(S-_)*(l-m)-(P-m)*(i-_),B=(p-i)*(l-m)-(u-l)*(i-_);if(O===0)return null;var $=M/O,q=B/O;if($>=0&&$<=1&&q>=0&&q<=1){var X=i+$*(p-i),R=l+$*(u-l);return Cp.point([X,R])}return null}Ac.default=uU;var Ov=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(If,"__esModule",{value:!0});var lU=Ov(Pc),gp=Ov(Vo),TI=Ov(Jl),cU=Ov(Ac),hU=nr,mp=zt,fU=vr;function pU(e,r,t){t===void 0&&(t={});var n=mp.point([1/0,1/0],{dist:1/0}),i=0;return hU.flattenEach(e,function(l){for(var p=fU.getCoords(l),u=0;u<p.length-1;u++){var _=mp.point(p[u]);_.properties.dist=gp.default(r,_,t);var m=mp.point(p[u+1]);m.properties.dist=gp.default(r,m,t);var S=gp.default(_,m,t),P=Math.max(_.properties.dist,m.properties.dist),O=lU.default(_,m),M=TI.default(r,P,O+90,t),B=TI.default(r,P,O-90,t),$=cU.default(mp.lineString([M.geometry.coordinates,B.geometry.coordinates]),mp.lineString([_.geometry.coordinates,m.geometry.coordinates])),q=null;$.features.length>0&&(q=$.features[0],q.properties.dist=gp.default(r,q,t),q.properties.location=i+gp.default(_,q,t)),_.properties.dist<n.properties.dist&&(n=_,n.properties.index=u,n.properties.location=i),m.properties.dist<n.properties.dist&&(n=m,n.properties.index=u+1,n.properties.location=i+S),q&&q.properties.dist<n.properties.dist&&(n=q,n.properties.index=u),i+=S}}),n}If.default=pU;var Nw={},Cv={},Of={};Object.defineProperty(Of,"__esModule",{value:!0});var kL=zt,MI=vr;function dU(e,r,t){t===void 0&&(t={});var n=MI.getCoord(e),i=MI.getCoord(r);i[0]+=i[0]-n[0]>180?-360:n[0]-i[0]>180?360:0;var l=gU(n,i),p=kL.convertLength(l,"meters",t.units);return p}function gU(e,r,t){t=t===void 0?kL.earthRadius:Number(t);var n=t,i=e[1]*Math.PI/180,l=r[1]*Math.PI/180,p=l-i,u=Math.abs(r[0]-e[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var _=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),m=Math.abs(_)>1e-11?p/_:Math.cos(i),S=Math.sqrt(p*p+m*m*u*u),P=S*n;return P}Of.default=dU;var BL=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cv,"__esModule",{value:!0});var mU=BL(Vo),vp=zt,LI=vr,vU=nr,yU=BL(Of);function _U(e,r,t){if(t===void 0&&(t={}),t.method||(t.method="geodesic"),t.units||(t.units="kilometers"),!e)throw new Error("pt is required");if(Array.isArray(e)?e=vp.point(e):e.type==="Point"?e=vp.feature(e):LI.featureOf(e,"Point","point"),!r)throw new Error("line is required");Array.isArray(r)?r=vp.lineString(r):r.type==="LineString"?r=vp.feature(r):LI.featureOf(r,"LineString","line");var n=1/0,i=e.geometry.coordinates;return vU.segmentEach(r,function(l){var p=l.geometry.coordinates[0],u=l.geometry.coordinates[1],_=bU(i,p,u,t);_<n&&(n=_)}),vp.convertLength(n,"degrees",t.units)}function bU(e,r,t,n){var i=[t[0]-r[0],t[1]-r[1]],l=[e[0]-r[0],e[1]-r[1]],p=RI(l,i);if(p<=0)return M1(e,r,{method:n.method,units:"degrees"});var u=RI(i,i);if(u<=p)return M1(e,t,{method:n.method,units:"degrees"});var _=p/u,m=[r[0]+_*i[0],r[1]+_*i[1]];return M1(e,m,{method:n.method,units:"degrees"})}function RI(e,r){return e[0]*r[0]+e[1]*r[1]}function M1(e,r,t){return t.method==="planar"?yU.default(e,r,t):mU.default(e,r,t)}Cv.default=_U;var zL=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nw,"__esModule",{value:!0});var xU=vr,jL=nr,wU=zL(Cv),EU=zL(rw);function SU(e,r,t){t===void 0&&(t={});var n=t.units,i=t.properties||{},l=PU(e);if(!l.features.length)throw new Error("points must contain features");if(!r)throw new Error("line is required");if(xU.getType(r)!=="LineString")throw new Error("line must be a LineString");var p=1/0,u=null;return jL.featureEach(l,function(_){var m=wU.default(_,r,{units:n});m<p&&(p=m,u=_)}),u&&(u.properties=EU.default({dist:p},u.properties,i)),u}function PU(e){var r=[],t=e.geometry?e.geometry.type:e.type;switch(t){case"GeometryCollection":return jL.geomEach(e,function(n){n.type==="Point"&&r.push({type:"Feature",properties:{},geometry:n})}),{type:"FeatureCollection",features:r};case"FeatureCollection":return e.features=e.features.filter(function(n){return n.geometry.type==="Point"}),e;default:throw new Error("points must be a Point Collection")}}Nw.default=SU;var Fw={exports:{}},DI=vr;function UL(e,r){var t=DI.getCoord(e),n=DI.getGeom(r),i=n.coordinates,l=i[0];if(l.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var p=r.properties||{},u=p.a,_=p.b,m=p.c,S=t[0],P=t[1],O=l[0][0],M=l[0][1],B=u!==void 0?u:l[0][2],$=l[1][0],q=l[1][1],X=_!==void 0?_:l[1][2],R=l[2][0],k=l[2][1],U=m!==void 0?m:l[2][2],H=(U*(S-O)*(P-q)+B*(S-$)*(P-k)+X*(S-R)*(P-M)-X*(S-O)*(P-k)-U*(S-$)*(P-M)-B*(S-R)*(P-q))/((S-O)*(P-q)+(S-$)*(P-k)+(S-R)*(P-M)-(S-O)*(P-k)-(S-$)*(P-M)-(S-R)*(P-q));return H}Fw.exports=UL;Fw.exports.default=UL;var AU=Fw.exports,kw={};Object.defineProperty(kw,"__esModule",{value:!0});var IU=zt;function OU(e){var r,t,n={type:"FeatureCollection",features:[]};if(e.type==="Feature"?t=e.geometry:t=e,t.type==="LineString")r=[t.coordinates];else if(t.type==="MultiLineString")r=t.coordinates;else if(t.type==="MultiPolygon")r=[].concat.apply([],t.coordinates);else if(t.type==="Polygon")r=t.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return r.forEach(function(i){r.forEach(function(l){for(var p=0;p<i.length-1;p++)for(var u=p;u<l.length-1;u++)if(!(i===l&&(Math.abs(p-u)===1||p===0&&u===i.length-2&&i[p][0]===i[i.length-1][0]&&i[p][1]===i[i.length-1][1]))){var _=CU(i[p][0],i[p][1],i[p+1][0],i[p+1][1],l[u][0],l[u][1],l[u+1][0],l[u+1][1]);_&&n.features.push(IU.point([_[0],_[1]]))}})}),n}kw.default=OU;function CU(e,r,t,n,i,l,p,u){var _,m,S,P,O,M={x:null,y:null,onLine1:!1,onLine2:!1};return _=(u-l)*(t-e)-(p-i)*(n-r),_===0?M.x!==null&&M.y!==null?M:!1:(m=r-l,S=e-i,P=(p-i)*m-(u-l)*S,O=(t-e)*m-(n-r)*S,m=P/_,S=O/_,M.x=e+m*(t-e),M.y=r+m*(n-r),m>=0&&m<=1&&(M.onLine1=!0),S>=0&&S<=1&&(M.onLine2=!0),M.onLine1&&M.onLine2?[M.x,M.y]:!1)}var Bw={exports:{}},TU=Pv,MU=Af,LU=xd,RU=ps,$p=zt;function Tv(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var DU=Tv(TU),NU=Tv(MU),FU=Tv(LU),kU=Tv(RU);function $L(e){for(var r=BU(e),t=NU.default(r),n=!1,i=0;!n&&i<r.features.length;){var l=r.features[i].geometry,p,u,_,m,S,P,O,M=!1;if(l.type==="Point")t.geometry.coordinates[0]===l.coordinates[0]&&t.geometry.coordinates[1]===l.coordinates[1]&&(n=!0);else if(l.type==="MultiPoint"){var B=!1;for(O=0;!B&&O<l.coordinates.length;)t.geometry.coordinates[0]===l.coordinates[O][0]&&t.geometry.coordinates[1]===l.coordinates[O][1]&&(n=!0,B=!0),O++}else if(l.type==="LineString")for(O=0;!M&&O<l.coordinates.length-1;)p=t.geometry.coordinates[0],u=t.geometry.coordinates[1],_=l.coordinates[O][0],m=l.coordinates[O][1],S=l.coordinates[O+1][0],P=l.coordinates[O+1][1],NI(p,u,_,m,S,P)&&(M=!0,n=!0),O++;else if(l.type==="MultiLineString")for(var $=0;$<l.coordinates.length;){M=!1,O=0;for(var q=l.coordinates[$];!M&&O<q.length-1;)p=t.geometry.coordinates[0],u=t.geometry.coordinates[1],_=q[O][0],m=q[O][1],S=q[O+1][0],P=q[O+1][1],NI(p,u,_,m,S,P)&&(M=!0,n=!0),O++;$++}else(l.type==="Polygon"||l.type==="MultiPolygon")&&kU.default(t,l)&&(n=!0);i++}if(n)return t;var X=$p.featureCollection([]);for(i=0;i<r.features.length;i++)X.features=X.features.concat(DU.default(r.features[i]).features);return $p.point(FU.default(t,X).geometry.coordinates)}function BU(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?$p.featureCollection([$p.feature(e)]):$p.featureCollection([e]):e}function NI(e,r,t,n,i,l){var p=Math.sqrt((i-t)*(i-t)+(l-n)*(l-n)),u=Math.sqrt((e-t)*(e-t)+(r-n)*(r-n)),_=Math.sqrt((i-e)*(i-e)+(l-r)*(l-r));return p===u+_}Bw.exports=$L;Bw.exports.default=$L;var zU=Bw.exports,wd={};Object.defineProperty(wd,"__esModule",{value:!0});var jU=nr,FI=6378137;function UU(e){return jU.geomReduce(e,function(r,t){return r+$U(t)},0)}wd.default=UU;function $U(e){var r=0,t;switch(e.type){case"Polygon":return kI(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)r+=kI(e.coordinates[t]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function kI(e){var r=0;if(e&&e.length>0){r+=Math.abs(BI(e[0]));for(var t=1;t<e.length;t++)r-=Math.abs(BI(e[t]))}return r}function BI(e){var r,t,n,i,l,p,u,_=0,m=e.length;if(m>2){for(u=0;u<m;u++)u===m-2?(i=m-2,l=m-1,p=0):u===m-1?(i=m-1,l=0,p=1):(i=u,l=u+1,p=u+2),r=e[i],t=e[l],n=e[p],_+=(L1(n[0])-L1(r[0]))*Math.sin(L1(t[1]));_=_*FI*FI/2}return _}function L1(e){return e*Math.PI/180}var zw={},jw=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zw,"__esModule",{value:!0});var GU=jw(Pc),qU=jw(Jl),VU=jw(Vo),zI=zt,XU=vr;function YU(e,r,t){t===void 0&&(t={});for(var n=XU.getGeom(e),i=n.coordinates,l=0,p=0;p<i.length&&!(r>=l&&p===i.length-1);p++)if(l>=r){var u=r-l;if(u){var _=GU.default(i[p],i[p-1])-180,m=qU.default(i[p],u,_,t);return m}else return zI.point(i[p])}else l+=VU.default(i[p],i[p+1],t);return zI.point(i[i.length-1])}zw.default=YU;var Mv={},WU=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mv,"__esModule",{value:!0});var ZU=WU(Vo),HU=nr;function JU(e,r){return r===void 0&&(r={}),HU.segmentReduce(e,function(t,n){var i=n.geometry.coordinates;return t+ZU.default(i[0],i[1],r)},0)}Mv.default=JU;var Uw={exports:{}},jI=vr,KU=zt,QU=If;function e$(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var UI=e$(QU);function GL(e,r,t){var n=jI.getCoords(t);if(jI.getType(t)!=="LineString")throw new Error("line must be a LineString");var i=UI.default(t,e),l=UI.default(t,r),p;i.properties.index<=l.properties.index?p=[i,l]:p=[l,i];for(var u=[p[0].geometry.coordinates],_=p[0].properties.index+1;_<p[1].properties.index+1;_++)u.push(n[_]);return u.push(p[1].geometry.coordinates),KU.lineString(u,t.properties)}Uw.exports=GL;Uw.exports.default=GL;var t$=Uw.exports,$w={exports:{}},r$=Pc,n$=Vo,i$=Jl,Xh=zt;function Gw(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var $I=Gw(r$),o$=Gw(n$),GI=Gw(i$);function qL(e,r,t,n){if(n=n||{},!Xh.isObject(n))throw new Error("options is invalid");var i,l=[];if(e.type==="Feature")i=e.geometry.coordinates;else if(e.type==="LineString")i=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var p=i.length,u=0,_,m,S,P=0;P<i.length&&!(r>=u&&P===i.length-1);P++){if(u>r&&l.length===0){if(_=r-u,!_)return l.push(i[P]),Xh.lineString(l);m=$I.default(i[P],i[P-1])-180,S=GI.default(i[P],_,m,n),l.push(S.geometry.coordinates)}if(u>=t)return _=t-u,_?(m=$I.default(i[P],i[P-1])-180,S=GI.default(i[P],_,m,n),l.push(S.geometry.coordinates),Xh.lineString(l)):(l.push(i[P]),Xh.lineString(l));if(u>=r&&l.push(i[P]),P===i.length-1)return Xh.lineString(l);u+=o$.default(i[P],i[P+1],n)}if(u<r&&i.length===p)throw new Error("Start position is beyond line");var O=i[i.length-1];return Xh.lineString([O,O])}$w.exports=qL;$w.exports.default=qL;var VL=$w.exports,Lv={},Rv={},Cf={};Object.defineProperty(Cf,"__esModule",{value:!0});var qI=vr;function a$(e,r,t){t===void 0&&(t={});for(var n=qI.getCoord(e),i=qI.getCoords(r),l=0;l<i.length-1;l++){var p=!1;if(t.ignoreEndVertices&&(l===0&&(p="start"),l===i.length-2&&(p="end"),l===0&&l+1===i.length-1&&(p="both")),s$(i[l],i[l+1],n,p,typeof t.epsilon>"u"?null:t.epsilon))return!0}return!1}function s$(e,r,t,n,i){var l=t[0],p=t[1],u=e[0],_=e[1],m=r[0],S=r[1],P=t[0]-u,O=t[1]-_,M=m-u,B=S-_,$=P*B-O*M;if(i!==null){if(Math.abs($)>i)return!1}else if($!==0)return!1;if(n){if(n==="start")return Math.abs(M)>=Math.abs(B)?M>0?u<l&&l<=m:m<=l&&l<u:B>0?_<p&&p<=S:S<=p&&p<_;if(n==="end")return Math.abs(M)>=Math.abs(B)?M>0?u<=l&&l<m:m<l&&l<=u:B>0?_<=p&&p<S:S<p&&p<=_;if(n==="both")return Math.abs(M)>=Math.abs(B)?M>0?u<l&&l<m:m<l&&l<u:B>0?_<p&&p<S:S<p&&p<_}else return Math.abs(M)>=Math.abs(B)?M>0?u<=l&&l<=m:m<=l&&l<=u:B>0?_<=p&&p<=S:S<=p&&p<=_;return!1}Cf.default=a$;var qw=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rv,"__esModule",{value:!0});var Rm=qw(ja),Dm=qw(Cf),Yc=qw(ps),VI=vr;function u$(e,r){var t=VI.getGeom(e),n=VI.getGeom(r),i=t.type,l=n.type;switch(i){case"Point":switch(l){case"MultiPoint":return l$(t,n);case"LineString":return Dm.default(t,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return Yc.default(t,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+l+" geometry not supported")}case"MultiPoint":switch(l){case"MultiPoint":return c$(t,n);case"LineString":return h$(t,n);case"Polygon":case"MultiPolygon":return f$(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}case"LineString":switch(l){case"LineString":return p$(t,n);case"Polygon":case"MultiPolygon":return d$(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}case"Polygon":switch(l){case"Polygon":case"MultiPolygon":return g$(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function l$(e,r){var t,n=!1;for(t=0;t<r.coordinates.length;t++)if(YL(r.coordinates[t],e.coordinates)){n=!0;break}return n}function c$(e,r){for(var t=0;t<e.coordinates.length;t++){for(var n=!1,i=0;i<r.coordinates.length;i++)YL(e.coordinates[t],r.coordinates[i])&&(n=!0);if(!n)return!1}return!0}function h$(e,r){for(var t=!1,n=0;n<e.coordinates.length;n++){if(!Dm.default(e.coordinates[n],r))return!1;t||(t=Dm.default(e.coordinates[n],r,{ignoreEndVertices:!0}))}return t}function f$(e,r){for(var t=!0,n=!1,i=0;i<e.coordinates.length;i++){if(n=Yc.default(e.coordinates[1],r),!n){t=!1;break}n=Yc.default(e.coordinates[1],r,{ignoreBoundary:!0})}return t&&n}function p$(e,r){for(var t=0;t<e.coordinates.length;t++)if(!Dm.default(e.coordinates[t],r))return!1;return!0}function d$(e,r){var t=Rm.default(r),n=Rm.default(e);if(!XL(t,n))return!1;for(var i=!1,l=0;l<e.coordinates.length-1;l++){if(!Yc.default(e.coordinates[l],r))return!1;if(i||(i=Yc.default(e.coordinates[l],r,{ignoreBoundary:!0})),!i){var p=m$(e.coordinates[l],e.coordinates[l+1]);i=Yc.default(p,r,{ignoreBoundary:!0})}}return i}function g$(e,r){var t=Rm.default(e),n=Rm.default(r);if(!XL(n,t))return!1;for(var i=0;i<e.coordinates[0].length;i++)if(!Yc.default(e.coordinates[0][i],r))return!1;return!0}function XL(e,r){return!(e[0]>r[0]||e[2]<r[2]||e[1]>r[1]||e[3]<r[3])}function YL(e,r){return e[0]===r[0]&&e[1]===r[1]}function m$(e,r){return[(e[0]+r[0])/2,(e[1]+r[1])/2]}Rv.default=u$;var WL=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lv,"__esModule",{value:!0});var v$=WL(Rv),XI=WL(Vo),YI=zt;function y$(e,r,t){t===void 0&&(t={}),t.mask&&!t.units&&(t.units="kilometers");for(var n=[],i=e[0],l=e[1],p=e[2],u=e[3],_=r/XI.default([i,l],[p,l],t),m=_*(p-i),S=r/XI.default([i,l],[i,u],t),P=S*(u-l),O=p-i,M=u-l,B=Math.floor(O/m),$=Math.floor(M/P),q=(O-B*m)/2,X=(M-$*P)/2,R=i+q;R<=p;){for(var k=l+X;k<=u;){var U=YI.point([R,k],t.properties);t.mask?v$.default(U,t.mask)&&n.push(U):n.push(U),k+=P}R+=m}return YI.featureCollection(n)}Lv.default=y$;var Dv={};Object.defineProperty(Dv,"__esModule",{value:!0});var _$=nr;function b$(e,r){r===void 0&&(r={});var t=r.precision,n=r.coordinates,i=r.mutate;if(t=t==null||isNaN(t)?6:t,n=n==null||isNaN(n)?3:n,!e)throw new Error("<geojson> is required");if(typeof t!="number")throw new Error("<precision> must be a number");if(typeof n!="number")throw new Error("<coordinates> must be a number");(i===!1||i===void 0)&&(e=JSON.parse(JSON.stringify(e)));var l=Math.pow(10,t);return _$.coordEach(e,function(p){x$(p,l,n)}),e}function x$(e,r,t){e.length>t&&e.splice(t,e.length);for(var n=0;n<e.length;n++)e[n]=Math.round(e[n]*r)/r;return e}Dv.default=b$;var Vw={exports:{}},w$=nr,E$=zt;function ZL(e){if(!e)throw new Error("geojson is required");var r=[];return w$.flattenEach(e,function(t){r.push(t)}),E$.featureCollection(r)}Vw.exports=ZL;Vw.exports.default=ZL;var HL=Vw.exports,Xw={exports:{}},S$=Mv,P$=VL,A$=nr,WI=zt;function JL(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var I$=JL(S$),O$=JL(P$);function KL(e,r,t){if(t=t||{},!WI.isObject(t))throw new Error("options is invalid");var n=t.units,i=t.reverse;if(!e)throw new Error("geojson is required");if(r<=0)throw new Error("segmentLength must be greater than 0");var l=[];return A$.flattenEach(e,function(p){i&&(p.geometry.coordinates=p.geometry.coordinates.reverse()),C$(p,r,n,function(u){l.push(u)})}),WI.featureCollection(l)}function C$(e,r,t,n){var i=I$.default(e,{units:t});if(i<=r)return n(e);var l=i/r;Number.isInteger(l)||(l=Math.floor(l)+1);for(var p=0;p<l;p++){var u=O$.default(e,r*p,r*(p+1),{units:t});n(u,p)}}Xw.exports=KL;Xw.exports.default=KL;var T$=Xw.exports,Yw={exports:{}},ZI=nr,rf=zt,M$=lL,L$=wd,R$=ps;function Ww(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var QL=Ww(M$),D$=Ww(L$),N$=Ww(R$);function F$(e,r,t){if(e.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");t===void 0&&(t=1);var n=e.geometry.coordinates,i=[],l={};if(t){for(var p=[],u=0;u<n.length;u++)for(var _=0;_<n[u].length-1;_++)p.push(q(u,_));var m=QL.default();m.load(p)}for(var S=0;S<n.length;S++)for(var P=0;P<n[S].length-1;P++)if(t){var O=m.search(q(S,P));O.forEach(function(X){var R=X.ring,k=X.edge;$(S,P,R,k)})}else for(var M=0;M<n.length;M++)for(var B=0;B<n[M].length-1;B++)$(S,P,M,B);return r||(i={type:"Feature",geometry:{type:"MultiPoint",coordinates:i}}),i;function $(X,R,k,U){var H=n[X][R],ue=n[X][R+1],ie=n[k][U],ee=n[k][U+1],W=k$(H,ue,ie,ee);if(W!==null){var J,be;if(ue[0]!==H[0]?J=(W[0]-H[0])/(ue[0]-H[0]):J=(W[1]-H[1])/(ue[1]-H[1]),ee[0]!==ie[0]?be=(W[0]-ie[0])/(ee[0]-ie[0]):be=(W[1]-ie[1])/(ee[1]-ie[1]),!(J>=1||J<=0||be>=1||be<=0)){var Oe=W,Ae=!l[Oe];Ae&&(l[Oe]=!0),r?i.push(r(W,X,R,H,ue,J,k,U,ie,ee,be,Ae)):i.push(W)}}}function q(X,R){var k=n[X][R],U=n[X][R+1],H,ue,ie,ee;return k[0]<U[0]?(H=k[0],ue=U[0]):(H=U[0],ue=k[0]),k[1]<U[1]?(ie=k[1],ee=U[1]):(ie=U[1],ee=k[1]),{minX:H,minY:ie,maxX:ue,maxY:ee,ring:X,edge:R}}}function k$(e,r,t,n){if(Tp(e,t)||Tp(e,n)||Tp(r,t)||Tp(n,t))return null;var i=e[0],l=e[1],p=r[0],u=r[1],_=t[0],m=t[1],S=n[0],P=n[1],O=(i-p)*(m-P)-(l-u)*(_-S);if(O===0)return null;var M=((i*u-l*p)*(_-S)-(i-p)*(_*P-m*S))/O,B=((i*u-l*p)*(m-P)-(l-u)*(_*P-m*S))/O;return[M,B]}function Tp(e,r){if(!e||!r||e.length!==r.length)return!1;for(var t=0,n=e.length;t<n;t++)if(e[t]instanceof Array&&r[t]instanceof Array){if(!Tp(e[t],r[t]))return!1}else if(e[t]!==r[t])return!1;return!0}function B$(e){if(e.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(e.geometry===void 0||e.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(e.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var r=e.geometry.coordinates.length,t=[],R=0;R<r;R++){var n=e.geometry.coordinates[R];Mp(n[0],n[n.length-1])||n.push(n[0]),t.push.apply(t,n.slice(0,n.length-1))}if(!j$(t))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var i=t.length,l=F$(e,function(ke,We,He,dt,yt,Lt,pt,Ct,mt,Ye,Zt,hr){return[ke,We,He,dt,yt,Lt,pt,Ct,mt,Ye,Zt,hr]}),p=l.length;if(p==0){for(var ie=[],R=0;R<r;R++)ie.push(rf.polygon([e.geometry.coordinates[R]],{parent:-1,winding:z$(e.geometry.coordinates[R])}));var he=rf.featureCollection(ie);return fe(),ye(),he}for(var u=[],_=[],R=0;R<r;R++){u.push([]);for(var m=0;m<e.geometry.coordinates[R].length-1;m++)u[R].push([new HI(e.geometry.coordinates[R][nf(m+1,e.geometry.coordinates[R].length-1)],1,[R,m],[R,nf(m+1,e.geometry.coordinates[R].length-1)],void 0)]),_.push(new JI(e.geometry.coordinates[R][m],[R,nf(m-1,e.geometry.coordinates[R].length-1)],[R,m],void 0,void 0,!1,!0))}for(var R=0;R<p;R++)u[l[R][1]][l[R][2]].push(new HI(l[R][0],l[R][5],[l[R][1],l[R][2]],[l[R][6],l[R][7]],void 0)),l[R][11]&&_.push(new JI(l[R][0],[l[R][1],l[R][2]],[l[R][6],l[R][7]],void 0,void 0,!0,!0));for(var S=_.length,R=0;R<u.length;R++)for(var m=0;m<u[R].length;m++)u[R][m].sort(function(We,He){return We.param<He.param?-1:1});for(var P=[],R=0;R<S;R++)P.push({minX:_[R].coord[0],minY:_[R].coord[1],maxX:_[R].coord[0],maxY:_[R].coord[1],index:R});var O=QL.default();O.load(P);for(var R=0;R<u.length;R++)for(var m=0;m<u[R].length;m++)for(var M=0;M<u[R][m].length;M++){var B;M==u[R][m].length-1?B=u[R][nf(m+1,e.geometry.coordinates[R].length-1)][0].coord:B=u[R][m][M+1].coord;var $=O.search({minX:B[0],minY:B[1],maxX:B[0],maxY:B[1]})[0];u[R][m][M].nxtIsectAlongEdgeIn=$.index}for(var R=0;R<u.length;R++)for(var m=0;m<u[R].length;m++)for(var M=0;M<u[R][m].length;M++){var B=u[R][m][M].coord,$=O.search({minX:B[0],minY:B[1],maxX:B[0],maxY:B[1]})[0],q=$.index;q<i?_[q].nxtIsectAlongRingAndEdge2=u[R][m][M].nxtIsectAlongEdgeIn:Mp(_[q].ringAndEdge1,u[R][m][M].ringAndEdgeIn)?_[q].nxtIsectAlongRingAndEdge1=u[R][m][M].nxtIsectAlongEdgeIn:_[q].nxtIsectAlongRingAndEdge2=u[R][m][M].nxtIsectAlongEdgeIn}for(var X=[],R=0,m=0;m<r;m++){for(var k=R,M=0;M<e.geometry.coordinates[m].length-1;M++)_[R].coord[0]<_[k].coord[0]&&(k=R),R++;for(var U=_[k].nxtIsectAlongRingAndEdge2,M=0;M<_.length;M++)if(_[M].nxtIsectAlongRingAndEdge1==k||_[M].nxtIsectAlongRingAndEdge2==k){var H=M;break}var ue=xm([_[H].coord,_[k].coord,_[U].coord],!0)?1:-1;X.push({isect:k,parent:-1,winding:ue})}X.sort(function(De,ke){return _[De.isect].coord>_[ke.isect].coord?-1:1});for(var ie=[];X.length>0;){var ee=X.pop(),W=ee.isect,J=ee.parent,be=ee.winding,Oe=ie.length,Ae=[_[W].coord],ae=W;if(_[W].ringAndEdge1Walkable)var ct=_[W].ringAndEdge1,Pe=_[W].nxtIsectAlongRingAndEdge1;else var ct=_[W].ringAndEdge2,Pe=_[W].nxtIsectAlongRingAndEdge2;for(;!Mp(_[W].coord,_[Pe].coord);){Ae.push(_[Pe].coord);for(var V=void 0,R=0;R<X.length;R++)if(X[R].isect==Pe){V=R;break}if(V!=null&&X.splice(V,1),Mp(ct,_[Pe].ringAndEdge1)){if(ct=_[Pe].ringAndEdge2,_[Pe].ringAndEdge2Walkable=!1,_[Pe].ringAndEdge1Walkable){var Q={isect:Pe};xm([_[ae].coord,_[Pe].coord,_[_[Pe].nxtIsectAlongRingAndEdge2].coord],be==1)?(Q.parent=J,Q.winding=-be):(Q.parent=Oe,Q.winding=be),X.push(Q)}ae=Pe,Pe=_[Pe].nxtIsectAlongRingAndEdge2}else{if(ct=_[Pe].ringAndEdge1,_[Pe].ringAndEdge1Walkable=!1,_[Pe].ringAndEdge2Walkable){var Q={isect:Pe};xm([_[ae].coord,_[Pe].coord,_[_[Pe].nxtIsectAlongRingAndEdge1].coord],be==1)?(Q.parent=J,Q.winding=-be):(Q.parent=Oe,Q.winding=be),X.push(Q)}ae=Pe,Pe=_[Pe].nxtIsectAlongRingAndEdge1}}Ae.push(_[Pe].coord),ie.push(rf.polygon([Ae],{index:Oe,parent:J,winding:be,netWinding:void 0}))}var he=rf.featureCollection(ie);fe(),ye();function fe(){for(var De=[],ke=0;ke<he.features.length;ke++)he.features[ke].properties.parent==-1&&De.push(ke);if(De.length>1)for(var ke=0;ke<De.length;ke++){for(var We=-1,He=1/0,dt=0;dt<he.features.length;dt++)De[ke]!=dt&&N$.default(he.features[De[ke]].geometry.coordinates[0][0],he.features[dt],{ignoreBoundary:!0})&&D$.default(he.features[dt])<He&&(We=dt);he.features[De[ke]].properties.parent=We}}function ye(){for(var De=0;De<he.features.length;De++)if(he.features[De].properties.parent==-1){var ke=he.features[De].properties.winding;he.features[De].properties.netWinding=ke,se(De,ke)}}function se(De,ke){for(var We=0;We<he.features.length;We++)if(he.features[We].properties.parent==De){var He=ke+he.features[We].properties.winding;he.features[We].properties.netWinding=He,se(We,He)}}return he}var HI=function(e,r,t,n,i){this.coord=e,this.param=r,this.ringAndEdgeIn=t,this.ringAndEdgeOut=n,this.nxtIsectAlongEdgeIn=i},JI=function(e,r,t,n,i,l,p){this.coord=e,this.ringAndEdge1=r,this.ringAndEdge2=t,this.nxtIsectAlongRingAndEdge1=n,this.nxtIsectAlongRingAndEdge2=i,this.ringAndEdge1Walkable=l,this.ringAndEdge2Walkable=p};function xm(e,r){if(typeof r>"u"&&(r=!0),e.length!=3)throw new Error("This function requires an array of three points [x,y]");var t=(e[1][0]-e[0][0])*(e[2][1]-e[0][1])-(e[1][1]-e[0][1])*(e[2][0]-e[0][0]);return t>=0==r}function z$(e){for(var r=0,t=0;t<e.length-1;t++)e[t][0]<e[r][0]&&(r=t);if(xm([e[nf(r-1,e.length-1)],e[r],e[nf(r+1,e.length-1)]],!0))var n=1;else var n=-1;return n}function Mp(e,r){if(!e||!r||e.length!=r.length)return!1;for(var t=0,n=e.length;t<n;t++)if(e[t]instanceof Array&&r[t]instanceof Array){if(!Mp(e[t],r[t]))return!1}else if(e[t]!=r[t])return!1;return!0}function nf(e,r){return(e%r+r)%r}function j$(e){for(var r={},t=1,n=0,i=e.length;n<i;++n){if(Object.prototype.hasOwnProperty.call(r,e[n])){t=0;break}r[e[n]]=1}return t}function eR(e){var r=[];return ZI.flattenEach(e,function(t){t.geometry.type==="Polygon"&&ZI.featureEach(B$(t),function(n){r.push(rf.polygon(n.geometry.coordinates,t.properties))})}),rf.featureCollection(r)}Yw.exports=eR;Yw.exports.default=eR;var U$=Yw.exports,Zw={exports:{}},KI=vr,QI=Math.PI/180,e2=180/Math.PI,rd=function(e,r){this.lon=e,this.lat=r,this.x=QI*e,this.y=QI*r};rd.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};rd.prototype.antipode=function(){var e=-1*this.lat,r=this.lon<0?180+this.lon:(180-this.lon)*-1;return new rd(r,e)};var tR=function(){this.coords=[],this.length=0};tR.prototype.move_to=function(e){this.length++,this.coords.push(e)};var Hw=function(e){this.properties=e||{},this.geometries=[]};Hw.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],r=0;r<this.geometries.length;r++)e.push(this.geometries[r].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}};Hw.prototype.wkt=function(){for(var e="",r="LINESTRING(",t=function(l){r+=l[0]+" "+l[1]+","},n=0;n<this.geometries.length;n++){if(this.geometries[n].coords.length===0)return"LINESTRING(empty)";var i=this.geometries[n].coords;i.forEach(t),e+=r.substring(0,r.length-1)+")"}return e};var Jw=function(e,r,t){if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!r||r.x===void 0||r.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new rd(e.x,e.y),this.end=new rd(r.x,r.y),this.properties=t||{};var n=this.start.x-this.end.x,i=this.start.y-this.end.y,l=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(n/2),2);if(this.g=2*Math.asin(Math.sqrt(l)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+r.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+r)};Jw.prototype.interpolate=function(e){var r=Math.sin((1-e)*this.g)/Math.sin(this.g),t=Math.sin(e*this.g)/Math.sin(this.g),n=r*Math.cos(this.start.y)*Math.cos(this.start.x)+t*Math.cos(this.end.y)*Math.cos(this.end.x),i=r*Math.cos(this.start.y)*Math.sin(this.start.x)+t*Math.cos(this.end.y)*Math.sin(this.end.x),l=r*Math.sin(this.start.y)+t*Math.sin(this.end.y),p=e2*Math.atan2(l,Math.sqrt(Math.pow(n,2)+Math.pow(i,2))),u=e2*Math.atan2(i,n);return[u,p]};Jw.prototype.Arc=function(e,r){var t=[];if(!e||e<=2)t.push([this.start.lon,this.start.lat]),t.push([this.end.lon,this.end.lat]);else for(var n=1/(e-1),i=0;i<e;++i){var l=n*i,p=this.interpolate(l);t.push(p)}for(var u=!1,_=0,m=r&&r.offset?r.offset:10,S=180-m,P=-180+m,O=360-m,M=1;M<t.length;++M){var B=t[M-1][0],$=t[M][0],q=Math.abs($-B);q>O&&($>S&&B<P||B>S&&$<P)?u=!0:q>_&&(_=q)}var X=[];if(u&&_<m){var R=[];X.push(R);for(var k=0;k<t.length;++k){var U=parseFloat(t[k][0]);if(k>0&&Math.abs(U-t[k-1][0])>O){var H=parseFloat(t[k-1][0]),ue=parseFloat(t[k-1][1]),ie=parseFloat(t[k][0]),ee=parseFloat(t[k][1]);if(H>-180&&H<P&&ie===180&&k+1<t.length&&t[k-1][0]>-180&&t[k-1][0]<P){R.push([-180,t[k][1]]),k++,R.push([t[k][0],t[k][1]]);continue}else if(H>S&&H<180&&ie===-180&&k+1<t.length&&t[k-1][0]>S&&t[k-1][0]<180){R.push([180,t[k][1]]),k++,R.push([t[k][0],t[k][1]]);continue}if(H<P&&ie>S){var W=H;H=ie,ie=W;var J=ue;ue=ee,ee=J}if(H>S&&ie<P&&(ie+=360),H<=180&&ie>=180&&H<ie){var be=(180-H)/(ie-H),Oe=be*ee+(1-be)*ue;R.push([t[k-1][0]>S?180:-180,Oe]),R=[],R.push([t[k-1][0]>S?-180:180,Oe]),X.push(R)}else R=[],X.push(R);R.push([U,t[k][1]])}else R.push([t[k][0],t[k][1]])}}else{var Ae=[];X.push(Ae);for(var ae=0;ae<t.length;++ae)Ae.push([t[ae][0],t[ae][1]])}for(var ct=new Hw(this.properties),Pe=0;Pe<X.length;++Pe){var V=new tR;ct.geometries.push(V);for(var Q=X[Pe],he=0;he<Q.length;++he)V.move_to(Q[he])}return ct};function rR(e,r,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.properties,i=t.npoints,l=t.offset;e=KI.getCoord(e),r=KI.getCoord(r),n=n||{},i=i||100,l=l||10;var p=new Jw({x:e[0],y:e[1]},{x:r[0],y:r[1]},n),u=p.Arc(i,{offset:l});return u.json()}Zw.exports=rR;Zw.exports.default=rR;var $$=Zw.exports,Kw={exports:{}},G$=Dw,q$=bL,V$=ja,X$=Dv,Y$=fh,W$=Ac,Z$=If,gc=vr,Nm=nr,qc=zt;function ph(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var nR=ph(G$),H$=ph(q$),J$=ph(V$),K$=ph(X$),Q$=ph(Y$),e8=ph(W$),t8=ph(Z$);function iR(e,r){if(!e)throw new Error("line is required");if(!r)throw new Error("splitter is required");var t=gc.getType(e),n=gc.getType(r);if(t!=="LineString")throw new Error("line must be LineString");if(n==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(n==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var i=K$.default(r,{precision:7});switch(n){case"Point":return Nb(e,i);case"MultiPoint":return t2(e,i);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return t2(e,e8.default(e,i))}}function t2(e,r){var t=[],n=nR.default();return Nm.flattenEach(r,function(i){if(t.forEach(function(u,_){u.id=_}),!t.length)t=Nb(e,i).features,t.forEach(function(u){u.bbox||(u.bbox=H$.default(J$.default(u)))}),n.load(qc.featureCollection(t));else{var l=n.search(i);if(l.features.length){var p=oR(i,l);t=t.filter(function(u){return u.id!==p.id}),n.remove(p),Nm.featureEach(Nb(p,i),function(u){t.push(u),n.insert(u)})}}}),qc.featureCollection(t)}function Nb(e,r){var t=[],n=gc.getCoords(e)[0],i=gc.getCoords(e)[e.geometry.coordinates.length-1];if(R1(n,gc.getCoord(r))||R1(i,gc.getCoord(r)))return qc.featureCollection([e]);var l=nR.default(),p=Q$.default(e);l.load(p);var u=l.search(r);if(!u.features.length)return qc.featureCollection([e]);var _=oR(r,u),m=[n],S=Nm.featureReduce(p,function(P,O,M){var B=gc.getCoords(O)[1],$=gc.getCoord(r);return M===_.id?(P.push($),t.push(qc.lineString(P)),R1($,B)?[$]:[$,B]):(P.push(B),P)},m);return S.length>1&&t.push(qc.lineString(S)),qc.featureCollection(t)}function oR(e,r){if(!r.features.length)throw new Error("lines must contain features");if(r.features.length===1)return r.features[0];var t,n=1/0;return Nm.featureEach(r,function(i){var l=t8.default(i,e),p=l.properties.dist;p<n&&(t=i,n=p)}),t}function R1(e,r){return e[0]===r[0]&&e[1]===r[1]}Kw.exports=iR;Kw.exports.default=iR;var r8=Kw.exports,Nv={},aR=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nv,"__esModule",{value:!0});var n8=aR(bd),r2=aR(Jl),n2=zt;function i8(e,r,t,n,i){i===void 0&&(i={});var l=i.steps||64,p=i2(t),u=i2(n),_=!Array.isArray(e)&&e.type==="Feature"?e.properties:{};if(p===u)return n2.lineString(n8.default(e,r,i).geometry.coordinates[0],_);for(var m=p,S=p<u?u:u+360,P=m,O=[],M=0;P<S;)O.push(r2.default(e,r,P,i).geometry.coordinates),M++,P=m+M*360/l;return P>S&&O.push(r2.default(e,r,S,i).geometry.coordinates),n2.lineString(O,_)}Nv.default=i8;function i2(e){var r=e%360;return r<0&&(r+=360),r}var Ic={};Object.defineProperty(Ic,"__esModule",{value:!0});var Fb=zt,Qw=vr;function o8(e,r){r===void 0&&(r={});var t=Qw.getGeom(e);switch(!r.properties&&e.type==="Feature"&&(r.properties=e.properties),t.type){case"Polygon":return sR(t,r);case"MultiPolygon":return uR(t,r);default:throw new Error("invalid poly")}}Ic.default=o8;function sR(e,r){r===void 0&&(r={});var t=Qw.getGeom(e),n=t.coordinates,i=r.properties?r.properties:e.type==="Feature"?e.properties:{};return eE(n,i)}Ic.polygonToLine=sR;function uR(e,r){r===void 0&&(r={});var t=Qw.getGeom(e),n=t.coordinates,i=r.properties?r.properties:e.type==="Feature"?e.properties:{},l=[];return n.forEach(function(p){l.push(eE(p,i))}),Fb.featureCollection(l)}Ic.multiPolygonToLine=uR;function eE(e,r){return e.length>1?Fb.multiLineString(e,r):Fb.lineString(e[0],r)}Ic.coordsToLine=eE;var tE={},lR=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tE,"__esModule",{value:!0});var a8=lR(ja),cR=vr,wm=zt,s8=lR(ua);function u8(e,r){r===void 0&&(r={});var t,n,i,l=r.properties,p=(t=r.autoComplete)!==null&&t!==void 0?t:!0,u=(n=r.orderCoords)!==null&&n!==void 0?n:!0,_=(i=r.mutate)!==null&&i!==void 0?i:!1;switch(_||(e=s8.default(e)),e.type){case"FeatureCollection":var m=[];return e.features.forEach(function(S){m.push(cR.getCoords(o2(S,{},p,u)))}),wm.multiPolygon(m,l);default:return o2(e,l,p,u)}}function o2(e,r,t,n){r=r||(e.type==="Feature"?e.properties:{});var i=cR.getGeom(e),l=i.coordinates,p=i.type;if(!l.length)throw new Error("line must contain coordinates");switch(p){case"LineString":return t&&(l=a2(l)),wm.polygon([l],r);case"MultiLineString":var u=[],_=0;return l.forEach(function(m){if(t&&(m=a2(m)),n){var S=l8(a8.default(wm.lineString(m)));S>_?(u.unshift(m),_=S):u.push(m)}else u.push(m)}),wm.polygon(u,r);default:throw new Error("geometry type "+p+" is not supported")}}function a2(e){var r=e[0],t=r[0],n=r[1],i=e[e.length-1],l=i[0],p=i[1];return(t!==l||n!==p)&&e.push(r),e}function l8(e){var r=e[0],t=e[1],n=e[2],i=e[3];return Math.abs(r-n)*Math.abs(t-i)}tE.default=u8;var rE={},Fv={};Object.defineProperty(Fv,"__esModule",{value:!0});function c8(e,r,t){var n=e.length,i=of(e[0],r),l=[],p,u,_,m,S;for(t||(t=[]),p=1;p<n;p++){for(m=e[p-1],S=e[p],u=_=of(S,r);;)if(i|u){if(i&u)break;i?(m=kb(m,S,i,r),i=of(m,r)):(S=kb(m,S,u,r),u=of(S,r))}else{l.push(m),u!==_?(l.push(S),p<n-1&&(t.push(l),l=[])):p===n-1&&l.push(S);break}i=_}return l.length&&t.push(l),t}Fv.lineclip=c8;function h8(e,r){var t,n,i,l,p,u,_;for(n=1;n<=8;n*=2){for(t=[],i=e[e.length-1],l=!(of(i,r)&n),p=0;p<e.length;p++)u=e[p],_=!(of(u,r)&n),_!==l&&t.push(kb(i,u,n,r)),_&&t.push(u),i=u,l=_;if(e=t,!e.length)break}return t}Fv.polygonclip=h8;function kb(e,r,t,n){return t&8?[e[0]+(r[0]-e[0])*(n[3]-e[1])/(r[1]-e[1]),n[3]]:t&4?[e[0]+(r[0]-e[0])*(n[1]-e[1])/(r[1]-e[1]),n[1]]:t&2?[n[2],e[1]+(r[1]-e[1])*(n[2]-e[0])/(r[0]-e[0])]:t&1?[n[0],e[1]+(r[1]-e[1])*(n[0]-e[0])/(r[0]-e[0])]:null}function of(e,r){var t=0;return e[0]<r[0]?t|=1:e[0]>r[2]&&(t|=2),e[1]<r[1]?t|=4:e[1]>r[3]&&(t|=8),t}Object.defineProperty(rE,"__esModule",{value:!0});var Jg=zt,f8=vr,hR=Fv;function p8(e,r){var t=f8.getGeom(e),n=t.type,i=e.type==="Feature"?e.properties:{},l=t.coordinates;switch(n){case"LineString":case"MultiLineString":{var p=[];return n==="LineString"&&(l=[l]),l.forEach(function(u){hR.lineclip(u,r,p)}),p.length===1?Jg.lineString(p[0],i):Jg.multiLineString(p,i)}case"Polygon":return Jg.polygon(s2(l,r),i);case"MultiPolygon":return Jg.multiPolygon(l.map(function(u){return s2(u,r)}),i);default:throw new Error("geometry "+n+" not supported")}}rE.default=p8;function s2(e,r){for(var t=[],n=0,i=e;n<i.length;n++){var l=i[n],p=hR.polygonclip(l,r);p.length>0&&((p[0][0]!==p[p.length-1][0]||p[0][1]!==p[p.length-1][1])&&p.push(p[0]),p.length>=4&&t.push(p))}return t}var kv={},u2=Object.prototype.toString,fR=function(r){var t=u2.call(r),n=t==="[object Arguments]";return n||(n=t!=="[object Array]"&&r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&u2.call(r.callee)==="[object Function]"),n},D1,l2;function d8(){if(l2)return D1;l2=1;var e;if(!Object.keys){var r=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=fR,i=Object.prototype.propertyIsEnumerable,l=!i.call({toString:null},"toString"),p=i.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_=function(O){var M=O.constructor;return M&&M.prototype===O},m={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},S=function(){if(typeof window>"u")return!1;for(var O in window)try{if(!m["$"+O]&&r.call(window,O)&&window[O]!==null&&typeof window[O]=="object")try{_(window[O])}catch{return!0}}catch{return!0}return!1}(),P=function(O){if(typeof window>"u"||!S)return _(O);try{return _(O)}catch{return!1}};e=function(M){var B=M!==null&&typeof M=="object",$=t.call(M)==="[object Function]",q=n(M),X=B&&t.call(M)==="[object String]",R=[];if(!B&&!$&&!q)throw new TypeError("Object.keys called on a non-object");var k=p&&$;if(X&&M.length>0&&!r.call(M,0))for(var U=0;U<M.length;++U)R.push(String(U));if(q&&M.length>0)for(var H=0;H<M.length;++H)R.push(String(H));else for(var ue in M)!(k&&ue==="prototype")&&r.call(M,ue)&&R.push(String(ue));if(l)for(var ie=P(M),ee=0;ee<u.length;++ee)!(ie&&u[ee]==="constructor")&&r.call(M,u[ee])&&R.push(u[ee]);return R}}return D1=e,D1}var g8=Array.prototype.slice,m8=fR,c2=Object.keys,Em=c2?function(r){return c2(r)}:d8(),h2=Object.keys;Em.shim=function(){if(Object.keys){var r=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);r||(Object.keys=function(n){return m8(n)?h2(g8.call(n)):h2(n)})}else Object.keys=Em;return Object.keys||Em};var pR=Em,dR=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var r={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;r[t]=i;for(t in r)return!1;if(typeof Object.keys=="function"&&Object.keys(r).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(r).length!==0)return!1;var l=Object.getOwnPropertySymbols(r);if(l.length!==1||l[0]!==t||!Object.prototype.propertyIsEnumerable.call(r,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var p=Object.getOwnPropertyDescriptor(r,t);if(p.value!==i||p.enumerable!==!0)return!1}return!0},v8=dR,nE=function(){return v8()&&!!Symbol.toStringTag},f2=typeof Symbol<"u"&&Symbol,y8=dR,_8=function(){return typeof f2!="function"||typeof Symbol!="function"||typeof f2("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:y8()},p2={foo:{}},b8=Object,x8=function(){return{__proto__:p2}.foo===p2.foo&&!({__proto__:null}instanceof b8)},w8="Function.prototype.bind called on incompatible ",E8=Object.prototype.toString,S8=Math.max,P8="[object Function]",d2=function(r,t){for(var n=[],i=0;i<r.length;i+=1)n[i]=r[i];for(var l=0;l<t.length;l+=1)n[l+r.length]=t[l];return n},A8=function(r,t){for(var n=[],i=t||0,l=0;i<r.length;i+=1,l+=1)n[l]=r[i];return n},I8=function(e,r){for(var t="",n=0;n<e.length;n+=1)t+=e[n],n+1<e.length&&(t+=r);return t},O8=function(r){var t=this;if(typeof t!="function"||E8.apply(t)!==P8)throw new TypeError(w8+t);for(var n=A8(arguments,1),i,l=function(){if(this instanceof i){var S=t.apply(this,d2(n,arguments));return Object(S)===S?S:this}return t.apply(r,d2(n,arguments))},p=S8(0,t.length-n.length),u=[],_=0;_<p;_++)u[_]="$"+_;if(i=Function("binder","return function ("+I8(u,",")+"){ return binder.apply(this,arguments); }")(l),t.prototype){var m=function(){};m.prototype=t.prototype,i.prototype=new m,m.prototype=null}return i},C8=O8,iE=Function.prototype.bind||C8,T8=Function.prototype.call,M8=Object.prototype.hasOwnProperty,L8=iE,R8=L8.call(T8,M8),jn,df=SyntaxError,gR=Function,lf=TypeError,N1=function(e){try{return gR('"use strict"; return ('+e+").constructor;")()}catch{}},Wc=Object.getOwnPropertyDescriptor;if(Wc)try{Wc({},"")}catch{Wc=null}var F1=function(){throw new lf},D8=Wc?function(){try{return arguments.callee,F1}catch{try{return Wc(arguments,"callee").get}catch{return F1}}}():F1,Yh=_8(),N8=x8(),Aa=Object.getPrototypeOf||(N8?function(e){return e.__proto__}:null),Qh={},F8=typeof Uint8Array>"u"||!Aa?jn:Aa(Uint8Array),Zc={"%AggregateError%":typeof AggregateError>"u"?jn:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?jn:ArrayBuffer,"%ArrayIteratorPrototype%":Yh&&Aa?Aa([][Symbol.iterator]()):jn,"%AsyncFromSyncIteratorPrototype%":jn,"%AsyncFunction%":Qh,"%AsyncGenerator%":Qh,"%AsyncGeneratorFunction%":Qh,"%AsyncIteratorPrototype%":Qh,"%Atomics%":typeof Atomics>"u"?jn:Atomics,"%BigInt%":typeof BigInt>"u"?jn:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?jn:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?jn:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?jn:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?jn:Float32Array,"%Float64Array%":typeof Float64Array>"u"?jn:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?jn:FinalizationRegistry,"%Function%":gR,"%GeneratorFunction%":Qh,"%Int8Array%":typeof Int8Array>"u"?jn:Int8Array,"%Int16Array%":typeof Int16Array>"u"?jn:Int16Array,"%Int32Array%":typeof Int32Array>"u"?jn:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Yh&&Aa?Aa(Aa([][Symbol.iterator]())):jn,"%JSON%":typeof JSON=="object"?JSON:jn,"%Map%":typeof Map>"u"?jn:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Yh||!Aa?jn:Aa(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?jn:Promise,"%Proxy%":typeof Proxy>"u"?jn:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?jn:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?jn:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Yh||!Aa?jn:Aa(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?jn:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Yh&&Aa?Aa(""[Symbol.iterator]()):jn,"%Symbol%":Yh?Symbol:jn,"%SyntaxError%":df,"%ThrowTypeError%":D8,"%TypedArray%":F8,"%TypeError%":lf,"%Uint8Array%":typeof Uint8Array>"u"?jn:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?jn:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?jn:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?jn:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?jn:WeakMap,"%WeakRef%":typeof WeakRef>"u"?jn:WeakRef,"%WeakSet%":typeof WeakSet>"u"?jn:WeakSet};if(Aa)try{null.error}catch(e){var k8=Aa(Aa(e));Zc["%Error.prototype%"]=k8}var B8=function e(r){var t;if(r==="%AsyncFunction%")t=N1("async function () {}");else if(r==="%GeneratorFunction%")t=N1("function* () {}");else if(r==="%AsyncGeneratorFunction%")t=N1("async function* () {}");else if(r==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if(r==="%AsyncIteratorPrototype%"){var i=e("%AsyncGenerator%");i&&Aa&&(t=Aa(i.prototype))}return Zc[r]=t,t},g2={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ed=iE,Fm=R8,z8=Ed.call(Function.call,Array.prototype.concat),j8=Ed.call(Function.apply,Array.prototype.splice),m2=Ed.call(Function.call,String.prototype.replace),km=Ed.call(Function.call,String.prototype.slice),U8=Ed.call(Function.call,RegExp.prototype.exec),$8=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,G8=/\\(\\)?/g,q8=function(r){var t=km(r,0,1),n=km(r,-1);if(t==="%"&&n!=="%")throw new df("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&t!=="%")throw new df("invalid intrinsic syntax, expected opening `%`");var i=[];return m2(r,$8,function(l,p,u,_){i[i.length]=u?m2(_,G8,"$1"):p||l}),i},V8=function(r,t){var n=r,i;if(Fm(g2,n)&&(i=g2[n],n="%"+i[0]+"%"),Fm(Zc,n)){var l=Zc[n];if(l===Qh&&(l=B8(n)),typeof l>"u"&&!t)throw new lf("intrinsic "+r+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:l}}throw new df("intrinsic "+r+" does not exist!")},Tf=function(r,t){if(typeof r!="string"||r.length===0)throw new lf("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new lf('"allowMissing" argument must be a boolean');if(U8(/^%?[^%]*%?$/,r)===null)throw new df("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=q8(r),i=n.length>0?n[0]:"",l=V8("%"+i+"%",t),p=l.name,u=l.value,_=!1,m=l.alias;m&&(i=m[0],j8(n,z8([0,1],m)));for(var S=1,P=!0;S<n.length;S+=1){var O=n[S],M=km(O,0,1),B=km(O,-1);if((M==='"'||M==="'"||M==="`"||B==='"'||B==="'"||B==="`")&&M!==B)throw new df("property names with quotes must have matching quotes");if((O==="constructor"||!P)&&(_=!0),i+="."+O,p="%"+i+"%",Fm(Zc,p))u=Zc[p];else if(u!=null){if(!(O in u)){if(!t)throw new lf("base intrinsic for "+r+" exists, but the property is not available.");return}if(Wc&&S+1>=n.length){var $=Wc(u,O);P=!!$,P&&"get"in $&&!("originalValue"in $.get)?u=$.get:u=u[O]}else P=Fm(u,O),u=u[O];P&&!_&&(Zc[p]=u)}}return u},mR={exports:{}},X8=Tf,Bb=X8("%Object.defineProperty%",!0),zb=function(){if(Bb)try{return Bb({},"a",{value:1}),!0}catch{return!1}return!1};zb.hasArrayLengthDefineBug=function(){if(!zb())return null;try{return Bb([],"length",{value:1}).length!==1}catch{return!0}};var Bv=zb,Y8=Tf,Sm=Y8("%Object.getOwnPropertyDescriptor%",!0);if(Sm)try{Sm([],"length")}catch{Sm=null}var vR=Sm,W8=Bv(),oE=Tf,Gp=W8&&oE("%Object.defineProperty%",!0);if(Gp)try{Gp({},"a",{value:1})}catch{Gp=!1}var Z8=oE("%SyntaxError%"),Wh=oE("%TypeError%"),v2=vR,aE=function(r,t,n){if(!r||typeof r!="object"&&typeof r!="function")throw new Wh("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Wh("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Wh("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Wh("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Wh("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Wh("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,p=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:!1,_=!!v2&&v2(r,t);if(Gp)Gp(r,t,{configurable:p===null&&_?_.configurable:!p,enumerable:i===null&&_?_.enumerable:!i,value:n,writable:l===null&&_?_.writable:!l});else if(u||!i&&!l&&!p)r[t]=n;else throw new Z8("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},yR=Tf,y2=aE,H8=Bv(),_2=vR,b2=yR("%TypeError%"),J8=yR("%Math.floor%"),K8=function(r,t){if(typeof r!="function")throw new b2("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||J8(t)!==t)throw new b2("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],i=!0,l=!0;if("length"in r&&_2){var p=_2(r,"length");p&&!p.configurable&&(i=!1),p&&!p.writable&&(l=!1)}return(i||l||!n)&&(H8?y2(r,"length",t,!0,!0):y2(r,"length",t)),r};(function(e){var r=iE,t=Tf,n=K8,i=t("%TypeError%"),l=t("%Function.prototype.apply%"),p=t("%Function.prototype.call%"),u=t("%Reflect.apply%",!0)||r.call(p,l),_=t("%Object.defineProperty%",!0),m=t("%Math.max%");if(_)try{_({},"a",{value:1})}catch{_=null}e.exports=function(O){if(typeof O!="function")throw new i("a function is required");var M=u(r,p,arguments);return n(M,1+m(0,O.length-(arguments.length-1)),!0)};var S=function(){return u(r,l,arguments)};_?_(e.exports,"apply",{value:S}):e.exports.apply=S})(mR);var sE=mR.exports,_R=Tf,bR=sE,Q8=bR(_R("String.prototype.indexOf")),xR=function(r,t){var n=_R(r,!!t);return typeof n=="function"&&Q8(r,".prototype.")>-1?bR(n):n},eG=nE(),tG=xR,jb=tG("Object.prototype.toString"),zv=function(r){return eG&&r&&typeof r=="object"&&Symbol.toStringTag in r?!1:jb(r)==="[object Arguments]"},wR=function(r){return zv(r)?!0:r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&jb(r)!=="[object Array]"&&jb(r.callee)==="[object Function]"},rG=function(){return zv(arguments)}();zv.isLegacyArguments=wR;var nG=rG?zv:wR,iG=pR,oG=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",aG=Object.prototype.toString,sG=Array.prototype.concat,x2=aE,uG=function(e){return typeof e=="function"&&aG.call(e)==="[object Function]"},ER=Bv(),lG=function(e,r,t,n){if(r in e){if(n===!0){if(e[r]===t)return}else if(!uG(n)||!n())return}ER?x2(e,r,t,!0):x2(e,r,t)},SR=function(e,r){var t=arguments.length>2?arguments[2]:{},n=iG(r);oG&&(n=sG.call(n,Object.getOwnPropertySymbols(r)));for(var i=0;i<n.length;i+=1)lG(e,n[i],r[n[i]],t[n[i]])};SR.supportsDescriptors=!!ER;var Sd=SR,w2=function(e){return e!==e},PR=function(r,t){return r===0&&t===0?1/r===1/t:!!(r===t||w2(r)&&w2(t))},cG=PR,AR=function(){return typeof Object.is=="function"?Object.is:cG},hG=AR,fG=Sd,pG=function(){var r=hG();return fG(Object,{is:r},{is:function(){return Object.is!==r}}),r},dG=Sd,gG=sE,mG=PR,IR=AR,vG=pG,OR=gG(IR(),Object);dG(OR,{getPolyfill:IR,implementation:mG,shim:vG});var yG=OR,Ub=xR,CR=nE(),TR,MR,$b,Gb;if(CR){TR=Ub("Object.prototype.hasOwnProperty"),MR=Ub("RegExp.prototype.exec"),$b={};var k1=function(){throw $b};Gb={toString:k1,valueOf:k1},typeof Symbol.toPrimitive=="symbol"&&(Gb[Symbol.toPrimitive]=k1)}var _G=Ub("Object.prototype.toString"),bG=Object.getOwnPropertyDescriptor,xG="[object RegExp]",wG=CR?function(r){if(!r||typeof r!="object")return!1;var t=bG(r,"lastIndex"),n=t&&TR(t,"value");if(!n)return!1;try{MR(r,Gb)}catch(i){return i===$b}}:function(r){return!r||typeof r!="object"&&typeof r!="function"?!1:_G(r)===xG},nd=function(){return typeof(function(){}).name=="string"},qp=Object.getOwnPropertyDescriptor;if(qp)try{qp([],"length")}catch{qp=null}nd.functionsHaveConfigurableNames=function(){if(!nd()||!qp)return!1;var r=qp(function(){},"name");return!!r&&!!r.configurable};var EG=Function.prototype.bind;nd.boundFunctionsHaveNames=function(){return nd()&&typeof EG=="function"&&(function(){}).bind().name!==""};var SG=nd,E2=aE,PG=Bv(),AG=SG.functionsHaveConfigurableNames(),IG=TypeError,OG=function(r,t){if(typeof r!="function")throw new IG("`fn` is not a function");var n=arguments.length>2&&!!arguments[2];return(!n||AG)&&(PG?E2(r,"name",t,!0,!0):E2(r,"name",t)),r},CG=OG,TG=Object,MG=TypeError,LR=CG(function(){if(this!=null&&this!==TG(this))throw new MG("RegExp.prototype.flags getter called on non-object");var r="";return this.hasIndices&&(r+="d"),this.global&&(r+="g"),this.ignoreCase&&(r+="i"),this.multiline&&(r+="m"),this.dotAll&&(r+="s"),this.unicode&&(r+="u"),this.unicodeSets&&(r+="v"),this.sticky&&(r+="y"),r},"get flags",!0),LG=LR,RG=Sd.supportsDescriptors,DG=Object.getOwnPropertyDescriptor,RR=function(){if(RG&&/a/mig.flags==="gim"){var r=DG(RegExp.prototype,"flags");if(r&&typeof r.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var t="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(n,"sticky",{get:function(){t+="y"}}),t==="dy")return r.get}}return LG},NG=Sd.supportsDescriptors,FG=RR,kG=Object.getOwnPropertyDescriptor,BG=Object.defineProperty,zG=TypeError,S2=Object.getPrototypeOf,jG=/a/,UG=function(){if(!NG||!S2)throw new zG("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var r=FG(),t=S2(jG),n=kG(t,"flags");return(!n||n.get!==r)&&BG(t,"flags",{configurable:!0,enumerable:!1,get:r}),r},$G=Sd,GG=sE,qG=LR,DR=RR,VG=UG,NR=GG(DR());$G(NR,{getPolyfill:DR,implementation:qG,shim:VG});var XG=NR,YG=Date.prototype.getDay,WG=function(r){try{return YG.call(r),!0}catch{return!1}},ZG=Object.prototype.toString,HG="[object Date]",JG=nE(),KG=function(r){return typeof r!="object"||r===null?!1:JG?WG(r):ZG.call(r)===HG},P2=pR,A2=nG,I2=yG,O2=wG,C2=XG,T2=KG,M2=Date.prototype.getTime;function FR(e,r,t){var n=t||{};return(n.strict?I2(e,r):e===r)?!0:!e||!r||typeof e!="object"&&typeof r!="object"?n.strict?I2(e,r):e==r:QG(e,r,n)}function L2(e){return e==null}function R2(e){return!(!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number")}function QG(e,r,t){var n,i;if(typeof e!=typeof r||L2(e)||L2(r)||e.prototype!==r.prototype||A2(e)!==A2(r))return!1;var l=O2(e),p=O2(r);if(l!==p)return!1;if(l||p)return e.source===r.source&&C2(e)===C2(r);if(T2(e)&&T2(r))return M2.call(e)===M2.call(r);var u=R2(e),_=R2(r);if(u!==_)return!1;if(u||_){if(e.length!==r.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==r[n])return!1;return!0}if(typeof e!=typeof r)return!1;try{var m=P2(e),S=P2(r)}catch{return!1}if(m.length!==S.length)return!1;for(m.sort(),S.sort(),n=m.length-1;n>=0;n--)if(m[n]!=S[n])return!1;for(n=m.length-1;n>=0;n--)if(i=m[n],!FR(e[i],r[i],t))return!1;return!0}var kR=FR,Pd=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kv,"__esModule",{value:!0});var eq=Pd(Dw),tq=Pd(fh),Kg=Pd(If),Qg=Pd(Cf),Bm=vr,D2=nr,N2=zt,Lp=Pd(kR);function rq(e,r,t){if(t===void 0&&(t={}),t=t||{},!N2.isObject(t))throw new Error("options is invalid");var n=t.tolerance||0,i=[],l=eq.default(),p=tq.default(e);l.load(p);var u;return D2.segmentEach(r,function(_){var m=!1;_&&(D2.featureEach(l.search(_),function(S){if(m===!1){var P=Bm.getCoords(_).sort(),O=Bm.getCoords(S).sort();Lp.default(P,O)||(n===0?Qg.default(P[0],S)&&Qg.default(P[1],S):Kg.default(S,P[0]).properties.dist<=n&&Kg.default(S,P[1]).properties.dist<=n)?(m=!0,u?u=B1(u,_):u=_):(n===0?Qg.default(O[0],_)&&Qg.default(O[1],_):Kg.default(_,O[0]).properties.dist<=n&&Kg.default(_,O[1]).properties.dist<=n)&&(u?u=B1(u,S):u=S)}}),m===!1&&u&&(i.push(u),u=void 0))}),u&&i.push(u),N2.featureCollection(i)}function B1(e,r){var t=Bm.getCoords(r),n=Bm.getCoords(e),i=n[0],l=n[n.length-1],p=e.geometry.coordinates;return Lp.default(t[0],i)?p.unshift(t[1]):Lp.default(t[0],l)?p.push(t[1]):Lp.default(t[1],i)?p.unshift(t[0]):Lp.default(t[1],l)&&p.push(t[0]),e}kv.default=rq;var uE={exports:{}},nq=bd,iq=Nv,oq=nr,F2=zt,aq=vr;function BR(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var sq=BR(nq),uq=BR(iq);function zR(e,r,t,n,i){if(i=i||{},!F2.isObject(i))throw new Error("options is invalid");var l=i.properties;if(!e)throw new Error("center is required");if(t==null)throw new Error("bearing1 is required");if(n==null)throw new Error("bearing2 is required");if(!r)throw new Error("radius is required");if(typeof i!="object")throw new Error("options must be an object");if(k2(t)===k2(n))return sq.default(e,r,i);var p=aq.getCoords(e),u=uq.default(e,r,t,n,i),_=[[p]];return oq.coordEach(u,function(m){_[0].push(m)}),_[0].push(p),F2.polygon(_,l)}function k2(e){var r=e%360;return r<0&&(r+=360),r}uE.exports=zR;uE.exports.default=zR;var lq=uE.exports,dh={};Object.defineProperty(dh,"__esModule",{value:!0});var em=zt,tm=vr;function cq(e,r,t){t===void 0&&(t={});var n;t.final?n=B2(tm.getCoord(r),tm.getCoord(e)):n=B2(tm.getCoord(e),tm.getCoord(r));var i=n>180?-(360-n):n;return i}function B2(e,r){var t=em.degreesToRadians(e[1]),n=em.degreesToRadians(r[1]),i=em.degreesToRadians(r[0]-e[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var l=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(t/2+Math.PI/4)),p=Math.atan2(i,l);return(em.radiansToDegrees(p)+360)%360}dh.default=cq;var gh={};Object.defineProperty(gh,"__esModule",{value:!0});var Vp=zt,hq=vr;function fq(e,r,t,n){n===void 0&&(n={});var i=r<0,l=Vp.convertLength(Math.abs(r),n.units,"meters");i&&(l=-Math.abs(l));var p=hq.getCoord(e),u=pq(p,l,t);return u[0]+=u[0]-p[0]>180?-360:p[0]-u[0]>180?360:0,Vp.point(u,n.properties)}function pq(e,r,t,n){n=n===void 0?Vp.earthRadius:Number(n);var i=r/n,l=e[0]*Math.PI/180,p=Vp.degreesToRadians(e[1]),u=Vp.degreesToRadians(t),_=i*Math.cos(u),m=p+_;Math.abs(m)>Math.PI/2&&(m=m>0?Math.PI-m:-Math.PI-m);var S=Math.log(Math.tan(m/2+Math.PI/4)/Math.tan(p/2+Math.PI/4)),P=Math.abs(S)>1e-11?_/S:Math.cos(p),O=i*Math.sin(u)/P,M=l+O;return[(M*180/Math.PI+540)%360-180,m*180/Math.PI]}gh.default=fq;var lE={exports:{}},z1=vr,j1=zt,dq=ja,gq=Pv,mq=xd;function cE(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var vq=cE(dq),yq=cE(gq),_q=cE(mq);function jR(e,r){var t=z1.getCoords(e),n=z1.getCoords(r),i,l,p,u,_=vq.default(r),m=0,S=null;t[0]>_[0]&&t[0]<_[2]&&t[1]>_[1]&&t[1]<_[3]&&(S=_q.default(e,yq.default(r)),m=S.properties.featureIndex);var P=z1.getType(r);switch(P){case"Polygon":i=n[0][m],l=n[0][0],S!==null&&S.geometry.coordinates[1]<t[1]&&(l=n[0][m]),u=id(n[0][0],n[0][n[0].length-1],t);var O=z2(n[0],t,u,p,i,l);i=O[0],l=O[1];break;case"MultiPolygon":for(var M=0,B=0,$=0,q=0;q<n[0].length;q++){M=q;for(var X=!1,R=0;R<n[0][q].length;R++){if(B=R,$===m){X=!0;break}$++}if(X)break}i=n[0][M][B],l=n[0][M][B],u=id(n[0][0][0],n[0][0][n[0][0].length-1],t),n.forEach(function(k){var U=z2(k[0],t,u,p,i,l);i=U[0],l=U[1]});break}return j1.featureCollection([j1.point(i),j1.point(l)])}function z2(e,r,t,n,i,l){for(var p=0;p<e.length;p++){var u=e[p],_=e[p+1];p===e.length-1&&(_=e[0]),n=id(u,_,r),t<=0&&n>0?xq(r,u,i)||(i=u):t>0&&n<=0&&(bq(r,u,l)||(l=u)),t=n}return[i,l]}function bq(e,r,t){return id(e,r,t)>0}function xq(e,r,t){return id(e,r,t)<0}function id(e,r,t){return(r[0]-e[0])*(t[1]-e[1])-(t[0]-e[0])*(r[1]-e[1])}lE.exports=jR;lE.exports.default=jR;var wq=lE.exports,hE={exports:{}},jv={};Object.defineProperty(jv,"__esModule",{value:!0});var Eq=vr;function Sq(e){for(var r=Eq.getCoords(e),t=0,n=1,i,l;n<r.length;)i=l||r[0],l=r[n],t+=(l[0]-i[0])*(l[1]+i[1]),n++;return t>0}jv.default=Sq;var Pq=ua,Aq=jv,Pm=nr,rm=vr,j2=zt;function UR(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Iq=UR(Pq),qb=UR(Aq);function $R(e,r){if(r=r||{},!j2.isObject(r))throw new Error("options is invalid");var t=r.reverse||!1,n=r.mutate||!1;if(!e)throw new Error("<geojson> is required");if(typeof t!="boolean")throw new Error("<reverse> must be a boolean");if(typeof n!="boolean")throw new Error("<mutate> must be a boolean");n===!1&&(e=Iq.default(e));var i=[];switch(e.type){case"GeometryCollection":return Pm.geomEach(e,function(l){Am(l,t)}),e;case"FeatureCollection":return Pm.featureEach(e,function(l){Pm.featureEach(Am(l,t),function(p){i.push(p)})}),j2.featureCollection(i)}return Am(e,t)}function Am(e,r){var t=e.type==="Feature"?e.geometry.type:e.type;switch(t){case"GeometryCollection":return Pm.geomEach(e,function(n){Am(n,r)}),e;case"LineString":return U2(rm.getCoords(e),r),e;case"Polygon":return $2(rm.getCoords(e),r),e;case"MultiLineString":return rm.getCoords(e).forEach(function(n){U2(n,r)}),e;case"MultiPolygon":return rm.getCoords(e).forEach(function(n){$2(n,r)}),e;case"Point":case"MultiPoint":return e}}function U2(e,r){qb.default(e)===r&&e.reverse()}function $2(e,r){qb.default(e[0])!==r&&e[0].reverse();for(var t=1;t<e.length;t++)qb.default(e[t])===r&&e[t].reverse()}hE.exports=$R;hE.exports.default=$R;var Oq=hE.exports,fE={exports:{}},Cq=ja,Tq=wd,Mq=ps,Lq=Pv,Vl=vr,Yl=zt,Rq=rw,Dq=nr;function Ad(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Nq=Ad(Cq),Fq=Ad(Tq),kq=Ad(Mq),Bq=Ad(Lq),zq=Ad(Rq);function jq(e,r){if(r=r||{},!Yl.isObject(r))throw new Error("options is invalid");var t=r.zProperty||"elevation",n=r.flip,i=r.flags;Vl.collectionOf(e,"Point","input must contain Points");for(var l=Uq(e,n),p=[],u=0;u<l.length;u++){for(var _=l[u],m=[],S=0;S<_.length;S++){var P=_[S];P.properties[t]?m.push(P.properties[t]):m.push(0),i===!0&&(P.properties.matrixPosition=[u,S])}p.push(m)}return p}function Uq(e,r){var t={};Dq.featureEach(e,function(l){var p=Vl.getCoords(l)[1];t[p]||(t[p]=[]),t[p].push(l)});var n=Object.keys(t).map(function(l){var p=t[l],u=p.sort(function(_,m){return Vl.getCoords(_)[0]-Vl.getCoords(m)[0]});return u}),i=n.sort(function(l,p){return r?Vl.getCoords(l[0])[1]-Vl.getCoords(p[0])[1]:Vl.getCoords(p[0])[1]-Vl.getCoords(l[0])[1]});return i}/*!
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 *
 * MarchingSquaresJS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * MarchingSquaresJS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * As additional permission under GNU Affero General Public License version 3
 * section 7, third-party projects (personal or commercial) may distribute,
 * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 * requirement that said third-party project for that reason alone becomes
 * subject to any requirement of the GNU Affero General Public License version 3.
 * Any modifications to MarchingSquaresJS, however, must be shared with the public
 * and made available.
 *
 * In summary this:
 * - allows you to use MarchingSquaresJS at no cost
 * - allows you to use MarchingSquaresJS for both personal and commercial purposes
 * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
 *   license as long as this license notice is included
 * - enables you to keep the source code of your program that uses MarchingSquaresJS
 *   undisclosed
 * - forces you to share any modifications you have made to MarchingSquaresJS,
 *   e.g. bug-fixes
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 */var G2={successCallback:null,verbose:!1,polygons:!1},Uc={};function $q(e,r,t,n){n=n||{};for(var i=Object.keys(G2),l=0;l<i.length;l++){var p=i[l],u=n[p];u=typeof u<"u"&&u!==null?u:G2[p],Uc[p]=u}Uc.verbose;var _=xV(e,r,t),m;return Uc.polygons?(Uc.verbose,m=IV(_)):(Uc.verbose,m=wV(_)),typeof Uc.successCallback=="function"&&Uc.successCallback(m),m}var za=64,Nu=16,oa=4,Ia=1,cn=[],hn=[],fn=[],pn=[],dn=[],gn=[],mn=[],vn=[],yn=[],_n=[],bn=[],xn=[],wn=[],En=[],Sn=[],Pn=[],An=[],In=[],On=[],Cn=[],Tn=[],Mn=[],Ln=[],Rn=[];mn[85]=_n[85]=-1;vn[85]=bn[85]=0;yn[85]=xn[85]=1;On[85]=Mn[85]=1;Cn[85]=Ln[85]=0;Tn[85]=Rn[85]=1;cn[85]=pn[85]=0;hn[85]=dn[85]=-1;fn[85]=Sn[85]=0;Pn[85]=wn[85]=0;An[85]=En[85]=1;gn[85]=In[85]=1;Mn[1]=Mn[169]=0;Ln[1]=Ln[169]=-1;Rn[1]=Rn[169]=0;wn[1]=wn[169]=-1;En[1]=En[169]=0;Sn[1]=Sn[169]=0;_n[4]=_n[166]=0;bn[4]=bn[166]=-1;xn[4]=xn[166]=1;Pn[4]=Pn[166]=1;An[4]=An[166]=0;In[4]=In[166]=0;mn[16]=mn[154]=0;vn[16]=vn[154]=1;yn[16]=yn[154]=1;pn[16]=pn[154]=1;dn[16]=dn[154]=0;gn[16]=gn[154]=1;On[64]=On[106]=0;Cn[64]=Cn[106]=1;Tn[64]=Tn[106]=0;cn[64]=cn[106]=-1;hn[64]=hn[106]=0;fn[64]=fn[106]=1;On[2]=On[168]=0;Cn[2]=Cn[168]=-1;Tn[2]=Tn[168]=1;Mn[2]=Mn[168]=0;Ln[2]=Ln[168]=-1;Rn[2]=Rn[168]=0;wn[2]=wn[168]=-1;En[2]=En[168]=0;Sn[2]=Sn[168]=0;Pn[2]=Pn[168]=-1;An[2]=An[168]=0;In[2]=In[168]=1;mn[8]=mn[162]=0;vn[8]=vn[162]=-1;yn[8]=yn[162]=0;_n[8]=_n[162]=0;bn[8]=bn[162]=-1;xn[8]=xn[162]=1;wn[8]=wn[162]=1;En[8]=En[162]=0;Sn[8]=Sn[162]=1;Pn[8]=Pn[162]=1;An[8]=An[162]=0;In[8]=In[162]=0;mn[32]=mn[138]=0;vn[32]=vn[138]=1;yn[32]=yn[138]=1;_n[32]=_n[138]=0;bn[32]=bn[138]=1;xn[32]=xn[138]=0;cn[32]=cn[138]=1;hn[32]=hn[138]=0;fn[32]=fn[138]=0;pn[32]=pn[138]=1;dn[32]=dn[138]=0;gn[32]=gn[138]=1;Mn[128]=Mn[42]=0;Ln[128]=Ln[42]=1;Rn[128]=Rn[42]=1;On[128]=On[42]=0;Cn[128]=Cn[42]=1;Tn[128]=Tn[42]=0;cn[128]=cn[42]=-1;hn[128]=hn[42]=0;fn[128]=fn[42]=1;pn[128]=pn[42]=-1;dn[128]=dn[42]=0;gn[128]=gn[42]=0;_n[5]=_n[165]=-1;bn[5]=bn[165]=0;xn[5]=xn[165]=0;Mn[5]=Mn[165]=1;Ln[5]=Ln[165]=0;Rn[5]=Rn[165]=0;Pn[20]=Pn[150]=0;An[20]=An[150]=1;In[20]=In[150]=1;pn[20]=pn[150]=0;dn[20]=dn[150]=-1;gn[20]=gn[150]=1;mn[80]=mn[90]=-1;vn[80]=vn[90]=0;yn[80]=yn[90]=1;On[80]=On[90]=1;Cn[80]=Cn[90]=0;Tn[80]=Tn[90]=1;wn[65]=wn[105]=0;En[65]=En[105]=1;Sn[65]=Sn[105]=0;cn[65]=cn[105]=0;hn[65]=hn[105]=-1;fn[65]=fn[105]=0;mn[160]=mn[10]=-1;vn[160]=vn[10]=0;yn[160]=yn[10]=1;_n[160]=_n[10]=-1;bn[160]=bn[10]=0;xn[160]=xn[10]=0;Mn[160]=Mn[10]=1;Ln[160]=Ln[10]=0;Rn[160]=Rn[10]=0;On[160]=On[10]=1;Cn[160]=Cn[10]=0;Tn[160]=Tn[10]=1;Pn[130]=Pn[40]=0;An[130]=An[40]=1;In[130]=In[40]=1;wn[130]=wn[40]=0;En[130]=En[40]=1;Sn[130]=Sn[40]=0;cn[130]=cn[40]=0;hn[130]=hn[40]=-1;fn[130]=fn[40]=0;pn[130]=pn[40]=0;dn[130]=dn[40]=-1;gn[130]=gn[40]=1;_n[37]=_n[133]=0;bn[37]=bn[133]=1;xn[37]=xn[133]=1;Mn[37]=Mn[133]=0;Ln[37]=Ln[133]=1;Rn[37]=Rn[133]=0;cn[37]=cn[133]=-1;hn[37]=hn[133]=0;fn[37]=fn[133]=0;pn[37]=pn[133]=1;dn[37]=dn[133]=0;gn[37]=gn[133]=0;Pn[148]=Pn[22]=-1;An[148]=An[22]=0;In[148]=In[22]=0;Mn[148]=Mn[22]=0;Ln[148]=Ln[22]=-1;Rn[148]=Rn[22]=1;On[148]=On[22]=0;Cn[148]=Cn[22]=1;Tn[148]=Tn[22]=1;pn[148]=pn[22]=-1;dn[148]=dn[22]=0;gn[148]=gn[22]=1;mn[82]=mn[88]=0;vn[82]=vn[88]=-1;yn[82]=yn[88]=1;Pn[82]=Pn[88]=1;An[82]=An[88]=0;In[82]=In[88]=1;wn[82]=wn[88]=-1;En[82]=En[88]=0;Sn[82]=Sn[88]=1;On[82]=On[88]=0;Cn[82]=Cn[88]=-1;Tn[82]=Tn[88]=0;mn[73]=mn[97]=0;vn[73]=vn[97]=1;yn[73]=yn[97]=0;_n[73]=_n[97]=0;bn[73]=bn[97]=-1;xn[73]=xn[97]=0;wn[73]=wn[97]=1;En[73]=En[97]=0;Sn[73]=Sn[97]=0;cn[73]=cn[97]=1;hn[73]=hn[97]=0;fn[73]=fn[97]=1;mn[145]=mn[25]=0;vn[145]=vn[25]=-1;yn[145]=yn[25]=0;wn[145]=wn[25]=1;En[145]=En[25]=0;Sn[145]=Sn[25]=1;Mn[145]=Mn[25]=0;Ln[145]=Ln[25]=1;Rn[145]=Rn[25]=1;pn[145]=pn[25]=-1;dn[145]=dn[25]=0;gn[145]=gn[25]=0;_n[70]=_n[100]=0;bn[70]=bn[100]=1;xn[70]=xn[100]=0;Pn[70]=Pn[100]=-1;An[70]=An[100]=0;In[70]=In[100]=1;On[70]=On[100]=0;Cn[70]=Cn[100]=-1;Tn[70]=Tn[100]=1;cn[70]=cn[100]=1;hn[70]=hn[100]=0;fn[70]=fn[100]=0;_n[101]=_n[69]=0;bn[101]=bn[69]=1;xn[101]=xn[69]=0;cn[101]=cn[69]=1;hn[101]=hn[69]=0;fn[101]=fn[69]=0;Mn[149]=Mn[21]=0;Ln[149]=Ln[21]=1;Rn[149]=Rn[21]=1;pn[149]=pn[21]=-1;dn[149]=dn[21]=0;gn[149]=gn[21]=0;Pn[86]=Pn[84]=-1;An[86]=An[84]=0;In[86]=In[84]=1;On[86]=On[84]=0;Cn[86]=Cn[84]=-1;Tn[86]=Tn[84]=1;mn[89]=mn[81]=0;vn[89]=vn[81]=-1;yn[89]=yn[81]=0;wn[89]=wn[81]=1;En[89]=En[81]=0;Sn[89]=Sn[81]=1;mn[96]=mn[74]=0;vn[96]=vn[74]=1;yn[96]=yn[74]=0;_n[96]=_n[74]=-1;bn[96]=bn[74]=0;xn[96]=xn[74]=1;On[96]=On[74]=1;Cn[96]=Cn[74]=0;Tn[96]=Tn[74]=0;cn[96]=cn[74]=1;hn[96]=hn[74]=0;fn[96]=fn[74]=1;mn[24]=mn[146]=0;vn[24]=vn[146]=-1;yn[24]=yn[146]=1;Pn[24]=Pn[146]=1;An[24]=An[146]=0;In[24]=In[146]=1;wn[24]=wn[146]=0;En[24]=En[146]=1;Sn[24]=Sn[146]=1;pn[24]=pn[146]=0;dn[24]=dn[146]=-1;gn[24]=gn[146]=0;_n[6]=_n[164]=-1;bn[6]=bn[164]=0;xn[6]=xn[164]=1;Pn[6]=Pn[164]=-1;An[6]=An[164]=0;In[6]=In[164]=0;Mn[6]=Mn[164]=0;Ln[6]=Ln[164]=-1;Rn[6]=Rn[164]=1;On[6]=On[164]=1;Cn[6]=Cn[164]=0;Tn[6]=Tn[164]=0;wn[129]=wn[41]=0;En[129]=En[41]=1;Sn[129]=Sn[41]=1;Mn[129]=Mn[41]=0;Ln[129]=Ln[41]=1;Rn[129]=Rn[41]=0;cn[129]=cn[41]=-1;hn[129]=hn[41]=0;fn[129]=fn[41]=0;pn[129]=pn[41]=0;dn[129]=dn[41]=-1;gn[129]=gn[41]=0;Pn[66]=Pn[104]=0;An[66]=An[104]=1;In[66]=In[104]=0;wn[66]=wn[104]=-1;En[66]=En[104]=0;Sn[66]=Sn[104]=1;On[66]=On[104]=0;Cn[66]=Cn[104]=-1;Tn[66]=Tn[104]=0;cn[66]=cn[104]=0;hn[66]=hn[104]=-1;fn[66]=fn[104]=1;mn[144]=mn[26]=-1;vn[144]=vn[26]=0;yn[144]=yn[26]=0;Mn[144]=Mn[26]=1;Ln[144]=Ln[26]=0;Rn[144]=Rn[26]=1;On[144]=On[26]=0;Cn[144]=Cn[26]=1;Tn[144]=Tn[26]=1;pn[144]=pn[26]=-1;dn[144]=dn[26]=0;gn[144]=gn[26]=1;_n[36]=_n[134]=0;bn[36]=bn[134]=1;xn[36]=xn[134]=1;Pn[36]=Pn[134]=0;An[36]=An[134]=1;In[36]=In[134]=0;cn[36]=cn[134]=0;hn[36]=hn[134]=-1;fn[36]=fn[134]=1;pn[36]=pn[134]=1;dn[36]=dn[134]=0;gn[36]=gn[134]=0;mn[9]=mn[161]=-1;vn[9]=vn[161]=0;yn[9]=yn[161]=0;_n[9]=_n[161]=0;bn[9]=bn[161]=-1;xn[9]=xn[161]=0;wn[9]=wn[161]=1;En[9]=En[161]=0;Sn[9]=Sn[161]=0;Mn[9]=Mn[161]=1;Ln[9]=Ln[161]=0;Rn[9]=Rn[161]=1;mn[136]=0;vn[136]=1;yn[136]=1;_n[136]=0;bn[136]=1;xn[136]=0;Pn[136]=-1;An[136]=0;In[136]=1;wn[136]=-1;En[136]=0;Sn[136]=0;Mn[136]=0;Ln[136]=-1;Rn[136]=0;On[136]=0;Cn[136]=-1;Tn[136]=1;cn[136]=1;hn[136]=0;fn[136]=0;pn[136]=1;dn[136]=0;gn[136]=1;mn[34]=0;vn[34]=-1;yn[34]=0;_n[34]=0;bn[34]=-1;xn[34]=1;Pn[34]=1;An[34]=0;In[34]=0;wn[34]=1;En[34]=0;Sn[34]=1;Mn[34]=0;Ln[34]=1;Rn[34]=1;On[34]=0;Cn[34]=1;Tn[34]=0;cn[34]=-1;hn[34]=0;fn[34]=1;pn[34]=-1;dn[34]=0;gn[34]=0;mn[35]=0;vn[35]=1;yn[35]=1;_n[35]=0;bn[35]=-1;xn[35]=1;Pn[35]=1;An[35]=0;In[35]=0;wn[35]=-1;En[35]=0;Sn[35]=0;Mn[35]=0;Ln[35]=-1;Rn[35]=0;On[35]=0;Cn[35]=1;Tn[35]=0;cn[35]=-1;hn[35]=0;fn[35]=1;pn[35]=1;dn[35]=0;gn[35]=1;mn[153]=0;vn[153]=1;yn[153]=1;wn[153]=-1;En[153]=0;Sn[153]=0;Mn[153]=0;Ln[153]=-1;Rn[153]=0;pn[153]=1;dn[153]=0;gn[153]=1;_n[102]=0;bn[102]=-1;xn[102]=1;Pn[102]=1;An[102]=0;In[102]=0;On[102]=0;Cn[102]=1;Tn[102]=0;cn[102]=-1;hn[102]=0;fn[102]=1;mn[155]=0;vn[155]=-1;yn[155]=0;wn[155]=1;En[155]=0;Sn[155]=1;Mn[155]=0;Ln[155]=1;Rn[155]=1;pn[155]=-1;dn[155]=0;gn[155]=0;_n[103]=0;bn[103]=1;xn[103]=0;Pn[103]=-1;An[103]=0;In[103]=1;On[103]=0;Cn[103]=-1;Tn[103]=1;cn[103]=1;hn[103]=0;fn[103]=0;mn[152]=0;vn[152]=1;yn[152]=1;Pn[152]=-1;An[152]=0;In[152]=1;wn[152]=-1;En[152]=0;Sn[152]=0;Mn[152]=0;Ln[152]=-1;Rn[152]=0;On[152]=0;Cn[152]=-1;Tn[152]=1;pn[152]=1;dn[152]=0;gn[152]=1;mn[156]=0;vn[156]=-1;yn[156]=1;Pn[156]=1;An[156]=0;In[156]=1;wn[156]=-1;En[156]=0;Sn[156]=0;Mn[156]=0;Ln[156]=-1;Rn[156]=0;On[156]=0;Cn[156]=1;Tn[156]=1;pn[156]=-1;dn[156]=0;gn[156]=1;mn[137]=0;vn[137]=1;yn[137]=1;_n[137]=0;bn[137]=1;xn[137]=0;wn[137]=-1;En[137]=0;Sn[137]=0;Mn[137]=0;Ln[137]=-1;Rn[137]=0;cn[137]=1;hn[137]=0;fn[137]=0;pn[137]=1;dn[137]=0;gn[137]=1;mn[139]=0;vn[139]=1;yn[139]=1;_n[139]=0;bn[139]=-1;xn[139]=0;wn[139]=1;En[139]=0;Sn[139]=0;Mn[139]=0;Ln[139]=1;Rn[139]=0;cn[139]=-1;hn[139]=0;fn[139]=0;pn[139]=1;dn[139]=0;gn[139]=1;mn[98]=0;vn[98]=-1;yn[98]=0;_n[98]=0;bn[98]=-1;xn[98]=1;Pn[98]=1;An[98]=0;In[98]=0;wn[98]=1;En[98]=0;Sn[98]=1;On[98]=0;Cn[98]=1;Tn[98]=0;cn[98]=-1;hn[98]=0;fn[98]=1;mn[99]=0;vn[99]=1;yn[99]=0;_n[99]=0;bn[99]=-1;xn[99]=1;Pn[99]=1;An[99]=0;In[99]=0;wn[99]=-1;En[99]=0;Sn[99]=1;On[99]=0;Cn[99]=-1;Tn[99]=0;cn[99]=1;hn[99]=0;fn[99]=1;_n[38]=0;bn[38]=-1;xn[38]=1;Pn[38]=1;An[38]=0;In[38]=0;Mn[38]=0;Ln[38]=1;Rn[38]=1;On[38]=0;Cn[38]=1;Tn[38]=0;cn[38]=-1;hn[38]=0;fn[38]=1;pn[38]=-1;dn[38]=0;gn[38]=0;_n[39]=0;bn[39]=1;xn[39]=1;Pn[39]=-1;An[39]=0;In[39]=0;Mn[39]=0;Ln[39]=-1;Rn[39]=1;On[39]=0;Cn[39]=1;Tn[39]=0;cn[39]=-1;hn[39]=0;fn[39]=1;pn[39]=1;dn[39]=0;gn[39]=0;var pE=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},dE=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},gE=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},mE=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},vE=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},yE=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},_E=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},bE=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},Gq=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},qq=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},Vq=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},Xq=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},Yq=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},Wq=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},Zq=function(){return[[0,0],[0,1],[1,1],[1,0]]},Hq=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},Jq=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},Kq=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},Qq=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},eV=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},tV=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},rV=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},nV=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},iV=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},oV=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},aV=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},sV=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},uV=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},lV=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},cV=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},hV=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},fV=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},pV=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},dV=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},gV=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},mV=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},vV=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},yV=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},_V=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},bV=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},sr=[],rr=[],Pr=[],xr=[],kr=[],Nr=[],Dn=[],Nn=[];xr[1]=kr[1]=18;xr[169]=kr[169]=18;Pr[4]=rr[4]=12;Pr[166]=rr[166]=12;sr[16]=Nn[16]=4;sr[154]=Nn[154]=4;Nr[64]=Dn[64]=22;Nr[106]=Dn[106]=22;Pr[2]=Nr[2]=17;xr[2]=kr[2]=18;Pr[168]=Nr[168]=17;xr[168]=kr[168]=18;sr[8]=xr[8]=9;rr[8]=Pr[8]=12;sr[162]=xr[162]=9;rr[162]=Pr[162]=12;sr[32]=Nn[32]=4;rr[32]=Dn[32]=1;sr[138]=Nn[138]=4;rr[138]=Dn[138]=1;kr[128]=Nn[128]=21;Nr[128]=Dn[128]=22;kr[42]=Nn[42]=21;Nr[42]=Dn[42]=22;rr[5]=kr[5]=14;rr[165]=kr[165]=14;Pr[20]=Nn[20]=6;Pr[150]=Nn[150]=6;sr[80]=Nr[80]=11;sr[90]=Nr[90]=11;xr[65]=Dn[65]=3;xr[105]=Dn[105]=3;sr[160]=Nr[160]=11;rr[160]=kr[160]=14;sr[10]=Nr[10]=11;rr[10]=kr[10]=14;Pr[130]=Nn[130]=6;xr[130]=Dn[130]=3;Pr[40]=Nn[40]=6;xr[40]=Dn[40]=3;rr[101]=Dn[101]=1;rr[69]=Dn[69]=1;kr[149]=Nn[149]=21;kr[21]=Nn[21]=21;Pr[86]=Nr[86]=17;Pr[84]=Nr[84]=17;sr[89]=xr[89]=9;sr[81]=xr[81]=9;sr[96]=Dn[96]=0;rr[96]=Nr[96]=15;sr[74]=Dn[74]=0;rr[74]=Nr[74]=15;sr[24]=Pr[24]=8;xr[24]=Nn[24]=7;sr[146]=Pr[146]=8;xr[146]=Nn[146]=7;rr[6]=Nr[6]=15;Pr[6]=kr[6]=16;rr[164]=Nr[164]=15;Pr[164]=kr[164]=16;xr[129]=Nn[129]=7;kr[129]=Dn[129]=20;xr[41]=Nn[41]=7;kr[41]=Dn[41]=20;Pr[66]=Dn[66]=2;xr[66]=Nr[66]=19;Pr[104]=Dn[104]=2;xr[104]=Nr[104]=19;sr[144]=kr[144]=10;Nr[144]=Nn[144]=23;sr[26]=kr[26]=10;Nr[26]=Nn[26]=23;rr[36]=Nn[36]=5;Pr[36]=Dn[36]=2;rr[134]=Nn[134]=5;Pr[134]=Dn[134]=2;sr[9]=kr[9]=10;rr[9]=xr[9]=13;sr[161]=kr[161]=10;rr[161]=xr[161]=13;rr[37]=Nn[37]=5;kr[37]=Dn[37]=20;rr[133]=Nn[133]=5;kr[133]=Dn[133]=20;Pr[148]=kr[148]=16;Nr[148]=Nn[148]=23;Pr[22]=kr[22]=16;Nr[22]=Nn[22]=23;sr[82]=Pr[82]=8;xr[82]=Nr[82]=19;sr[88]=Pr[88]=8;xr[88]=Nr[88]=19;sr[73]=Dn[73]=0;rr[73]=xr[73]=13;sr[97]=Dn[97]=0;rr[97]=xr[97]=13;sr[145]=xr[145]=9;kr[145]=Nn[145]=21;sr[25]=xr[25]=9;kr[25]=Nn[25]=21;rr[70]=Dn[70]=1;Pr[70]=Nr[70]=17;rr[100]=Dn[100]=1;Pr[100]=Nr[100]=17;sr[34]=xr[34]=9;rr[34]=Pr[34]=12;kr[34]=Nn[34]=21;Nr[34]=Dn[34]=22;sr[136]=Nn[136]=4;rr[136]=Dn[136]=1;Pr[136]=Nr[136]=17;xr[136]=kr[136]=18;sr[35]=Nn[35]=4;rr[35]=Pr[35]=12;xr[35]=kr[35]=18;Nr[35]=Dn[35]=22;sr[153]=Nn[153]=4;xr[153]=kr[153]=18;rr[102]=Pr[102]=12;Nr[102]=Dn[102]=22;sr[155]=xr[155]=9;kr[155]=Nn[155]=23;rr[103]=Dn[103]=1;Pr[103]=Nr[103]=17;sr[152]=Nn[152]=4;Pr[152]=Nr[152]=17;xr[152]=kr[152]=18;sr[156]=Pr[156]=8;xr[156]=kr[156]=18;Nr[156]=Nn[156]=23;sr[137]=Nn[137]=4;rr[137]=Dn[137]=1;xr[137]=kr[137]=18;sr[139]=Nn[139]=4;rr[139]=xr[139]=13;kr[139]=Dn[139]=20;sr[98]=xr[98]=9;rr[98]=Pr[98]=12;Nr[98]=Dn[98]=22;sr[99]=Dn[99]=0;rr[99]=Pr[99]=12;xr[99]=Nr[99]=19;rr[38]=Pr[38]=12;kr[38]=Nn[38]=21;Nr[38]=Dn[38]=22;rr[39]=Nn[39]=5;Pr[39]=kr[39]=16;Nr[39]=Dn[39]=22;var Wt=[];Wt[1]=Wt[169]=pE;Wt[4]=Wt[166]=dE;Wt[16]=Wt[154]=gE;Wt[64]=Wt[106]=mE;Wt[168]=Wt[2]=vE;Wt[162]=Wt[8]=yE;Wt[138]=Wt[32]=_E;Wt[42]=Wt[128]=bE;Wt[5]=Wt[165]=Gq;Wt[20]=Wt[150]=qq;Wt[80]=Wt[90]=Vq;Wt[65]=Wt[105]=Xq;Wt[160]=Wt[10]=Yq;Wt[130]=Wt[40]=Wq;Wt[85]=Zq;Wt[101]=Wt[69]=Hq;Wt[149]=Wt[21]=Jq;Wt[86]=Wt[84]=Kq;Wt[89]=Wt[81]=Qq;Wt[96]=Wt[74]=eV;Wt[24]=Wt[146]=tV;Wt[6]=Wt[164]=rV;Wt[129]=Wt[41]=nV;Wt[66]=Wt[104]=iV;Wt[144]=Wt[26]=oV;Wt[36]=Wt[134]=aV;Wt[9]=Wt[161]=sV;Wt[37]=Wt[133]=uV;Wt[148]=Wt[22]=lV;Wt[82]=Wt[88]=cV;Wt[73]=Wt[97]=hV;Wt[145]=Wt[25]=fV;Wt[70]=Wt[100]=pV;Wt[34]=function(e){return[bE(e),yE(e)]};Wt[35]=dV;Wt[136]=function(e){return[_E(e),vE(e)]};Wt[153]=function(e){return[gE(e),pE(e)]};Wt[102]=function(e){return[dE(e),mE(e)]};Wt[155]=gV;Wt[103]=mV;Wt[152]=function(e){return[gE(e),vE(e)]};Wt[156]=vV;Wt[137]=function(e){return[_E(e),pE(e)]};Wt[139]=yV;Wt[98]=function(e){return[yE(e),mE(e)]};Wt[99]=_V;Wt[38]=function(e){return[dE(e),bE(e)]};Wt[39]=bV;function ve(e,r,t){return(e-r)/(t-r)}function U1(e){return e.constructor.toString().indexOf("Array")>-1}function xV(e,r,t){for(var n=e.length-1,i=e[0].length-1,l={rows:n,cols:i,cells:[]},p=r+Math.abs(t),u=0;u<n;++u){l.cells[u]=[];for(var _=0;_<i;++_){var m=0,S=e[u+1][_],P=e[u+1][_+1],O=e[u][_+1],M=e[u][_];if(!(isNaN(S)||isNaN(P)||isNaN(O)||isNaN(M))){m|=S<r?0:S>p?128:64,m|=P<r?0:P>p?32:16,m|=O<r?0:O>p?8:4,m|=M<r?0:M>p?2:1;var B=+m,$=0;if(m===17||m===18||m===33||m===34||m===38||m===68||m===72||m===98||m===102||m===132||m===136||m===137||m===152||m===153){var q=(S+P+O+M)/4;$=q>p?2:q<r?0:1,m===34?$===1?m=35:$===0&&(m=136):m===136?$===1?(m=35,$=4):$===0&&(m=34):m===17?$===1?(m=155,$=4):$===0&&(m=153):m===68?$===1?(m=103,$=4):$===0&&(m=102):m===153?$===1&&(m=155):m===102?$===1&&(m=103):m===152?$<2&&(m=156,$=1):m===137?$<2&&(m=139,$=1):m===98?$<2&&(m=99,$=1):m===38?$<2&&(m=39,$=1):m===18?$>0?(m=156,$=4):m=152:m===33?$>0?(m=139,$=4):m=137:m===72?$>0?(m=99,$=4):m=98:m===132&&($>0?(m=39,$=4):m=38)}if(m!=0&&m!=170){var X,R,k,U,H,ue,ie,ee;X=R=k=U=H=ue=ie=ee=.5;var W=[];m===1?(k=1-ve(r,O,M),ee=1-ve(r,S,M),W.push(xr[m])):m===169?(k=ve(p,M,O),ee=ve(p,M,S),W.push(xr[m])):m===4?(ue=1-ve(r,P,O),U=ve(r,M,O),W.push(rr[m])):m===166?(ue=ve(p,O,P),U=1-ve(p,O,M),W.push(rr[m])):m===16?(H=ve(r,O,P),R=ve(r,S,P),W.push(sr[m])):m===154?(H=1-ve(p,P,O),R=1-ve(p,P,S),W.push(sr[m])):m===64?(ie=ve(r,M,S),X=1-ve(r,P,S),W.push(Nr[m])):m===106?(ie=1-ve(p,S,M),X=ve(p,S,P),W.push(Nr[m])):m===168?(U=ve(p,M,O),k=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),W.push(Pr[m]),W.push(xr[m])):m===2?(U=1-ve(r,O,M),k=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),W.push(Pr[m]),W.push(xr[m])):m===162?(H=ve(p,O,P),ue=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),W.push(Pr[m]),W.push(xr[m])):m===8?(H=1-ve(r,P,O),ue=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),W.push(sr[m]),W.push(rr[m])):m===138?(H=1-ve(r,P,O),ue=1-ve(p,P,O),X=1-ve(p,P,S),R=1-ve(r,P,S),W.push(sr[m]),W.push(rr[m])):m===32?(H=ve(p,O,P),ue=ve(r,O,P),X=ve(r,S,P),R=ve(p,S,P),W.push(sr[m]),W.push(rr[m])):m===42?(ee=1-ve(p,S,M),ie=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P),W.push(kr[m]),W.push(Nr[m])):m===128&&(ee=ve(r,M,S),ie=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S),W.push(kr[m]),W.push(Nr[m])),m===5?(ue=1-ve(r,P,O),ee=1-ve(r,S,M),W.push(rr[m])):m===165?(ue=ve(p,O,P),ee=ve(p,M,S),W.push(rr[m])):m===20?(U=ve(r,M,O),R=ve(r,S,P),W.push(Pr[m])):m===150?(U=1-ve(p,O,M),R=1-ve(p,P,S),W.push(Pr[m])):m===80?(H=ve(r,O,P),ie=ve(r,M,S),W.push(sr[m])):m===90?(H=1-ve(p,P,O),ie=1-ve(p,S,M),W.push(sr[m])):m===65?(k=1-ve(r,O,M),X=1-ve(r,P,S),W.push(xr[m])):m===105?(k=ve(p,M,O),X=ve(p,S,P),W.push(xr[m])):m===160?(H=ve(p,O,P),ue=ve(r,O,P),ee=ve(r,M,S),ie=ve(p,M,S),W.push(sr[m]),W.push(rr[m])):m===10?(H=1-ve(r,P,O),ue=1-ve(p,P,O),ee=1-ve(p,S,M),ie=1-ve(r,S,M),W.push(sr[m]),W.push(rr[m])):m===130?(U=1-ve(r,O,M),k=1-ve(p,O,M),X=1-ve(p,P,S),R=1-ve(r,P,S),W.push(Pr[m]),W.push(xr[m])):m===40?(U=ve(p,M,O),k=ve(r,M,O),X=ve(r,S,P),R=ve(p,S,P),W.push(Pr[m]),W.push(xr[m])):m===101?(ue=ve(p,O,P),X=ve(p,S,P),W.push(rr[m])):m===69?(ue=1-ve(r,P,O),X=1-ve(r,P,S),W.push(rr[m])):m===149?(ee=ve(p,M,S),R=1-ve(p,P,S),W.push(kr[m])):m===21?(ee=1-ve(r,S,M),R=ve(r,S,P),W.push(kr[m])):m===86?(U=1-ve(p,O,M),ie=1-ve(p,S,M),W.push(Pr[m])):m===84?(U=ve(r,M,O),ie=ve(r,M,S),W.push(Pr[m])):m===89?(H=1-ve(p,P,O),k=ve(p,M,O),W.push(xr[m])):m===81?(H=ve(r,O,P),k=1-ve(r,O,M),W.push(xr[m])):m===96?(H=ve(p,O,P),ue=ve(r,O,P),ie=ve(r,M,S),X=ve(p,S,P),W.push(sr[m]),W.push(rr[m])):m===74?(H=1-ve(r,P,O),ue=1-ve(p,P,O),ie=1-ve(p,S,M),X=1-ve(r,P,S),W.push(sr[m]),W.push(rr[m])):m===24?(H=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),R=ve(r,S,P),W.push(sr[m]),W.push(xr[m])):m===146?(H=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),R=1-ve(p,P,S),W.push(sr[m]),W.push(xr[m])):m===6?(ue=1-ve(r,P,O),U=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),W.push(rr[m]),W.push(Pr[m])):m===164?(ue=ve(p,O,P),U=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),W.push(rr[m]),W.push(Pr[m])):m===129?(k=1-ve(r,O,M),ee=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S),W.push(xr[m]),W.push(kr[m])):m===41?(k=ve(p,M,O),ee=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P),W.push(xr[m]),W.push(kr[m])):m===66?(U=1-ve(r,O,M),k=1-ve(p,O,M),ie=1-ve(p,S,M),X=1-ve(r,P,S),W.push(Pr[m]),W.push(xr[m])):m===104?(U=ve(p,M,O),k=ve(r,M,O),ie=ve(r,M,S),X=ve(p,S,P),W.push(xr[m]),W.push(Dn[m])):m===144?(H=ve(r,O,P),ee=ve(r,M,S),ie=ve(p,M,S),R=1-ve(p,P,S),W.push(sr[m]),W.push(Nr[m])):m===26?(H=1-ve(p,P,O),ee=1-ve(p,S,M),ie=1-ve(r,S,M),R=ve(r,S,P),W.push(sr[m]),W.push(Nr[m])):m===36?(ue=ve(p,O,P),U=ve(r,M,O),X=ve(r,S,P),R=ve(p,S,P),W.push(rr[m]),W.push(Pr[m])):m===134?(ue=1-ve(r,P,O),U=1-ve(p,O,M),X=1-ve(p,P,S),R=1-ve(r,P,S),W.push(rr[m]),W.push(Pr[m])):m===9?(H=1-ve(r,P,O),ue=1-ve(p,P,O),k=ve(p,M,O),ee=1-ve(r,S,M),W.push(sr[m]),W.push(rr[m])):m===161?(H=ve(p,O,P),ue=ve(r,O,P),k=1-ve(r,O,M),ee=ve(p,M,S),W.push(sr[m]),W.push(rr[m])):m===37?(ue=ve(p,O,P),ee=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P),W.push(rr[m]),W.push(kr[m])):m===133?(ue=1-ve(r,P,O),ee=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S),W.push(rr[m]),W.push(kr[m])):m===148?(U=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),R=1-ve(p,P,S),W.push(Pr[m]),W.push(Nr[m])):m===22?(U=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),R=ve(r,S,P),W.push(Pr[m]),W.push(Nr[m])):m===82?(H=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ie=1-ve(p,S,M),W.push(sr[m]),W.push(xr[m])):m===88?(H=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ie=ve(r,M,S),W.push(sr[m]),W.push(xr[m])):m===73?(H=1-ve(r,P,O),ue=1-ve(p,P,O),k=ve(p,M,O),X=1-ve(r,P,S),W.push(sr[m]),W.push(rr[m])):m===97?(H=ve(p,O,P),ue=ve(r,O,P),k=1-ve(r,O,M),X=ve(p,S,P),W.push(sr[m]),W.push(rr[m])):m===145?(H=ve(r,O,P),k=1-ve(r,O,M),ee=ve(p,M,S),R=1-ve(p,P,S),W.push(sr[m]),W.push(kr[m])):m===25?(H=1-ve(p,P,O),k=ve(p,M,O),ee=1-ve(r,S,M),R=ve(r,S,P),W.push(sr[m]),W.push(kr[m])):m===70?(ue=1-ve(r,P,O),U=1-ve(p,O,M),ie=1-ve(p,S,M),X=1-ve(r,P,S),W.push(rr[m]),W.push(Pr[m])):m===100?(ue=ve(p,O,P),U=ve(r,M,O),ie=ve(r,M,S),X=ve(p,S,P),W.push(rr[m]),W.push(Pr[m])):m===34?($===0?(H=1-ve(r,P,O),ue=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S)):(H=ve(p,O,P),ue=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P)),W.push(sr[m]),W.push(rr[m]),W.push(kr[m]),W.push(Nr[m])):m===35?($===4?(H=1-ve(r,P,O),ue=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S)):(H=ve(p,O,P),ue=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P)),W.push(sr[m]),W.push(rr[m]),W.push(xr[m]),W.push(Nr[m])):m===136?($===0?(H=ve(p,O,P),ue=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P)):(H=1-ve(r,P,O),ue=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S)),W.push(sr[m]),W.push(rr[m]),W.push(kr[m]),W.push(Nr[m])):m===153?($===0?(H=ve(r,O,P),k=1-ve(r,O,M),ee=1-ve(r,S,M),R=ve(r,S,P)):(H=1-ve(p,P,O),k=ve(p,M,O),ee=ve(p,M,S),R=1-ve(p,P,S)),W.push(sr[m]),W.push(xr[m])):m===102?($===0?(ue=1-ve(r,P,O),U=ve(r,M,O),ie=ve(r,M,S),X=1-ve(r,P,S)):(ue=ve(p,O,P),U=1-ve(p,O,M),ie=1-ve(p,S,M),X=ve(p,S,P)),W.push(rr[m]),W.push(Nr[m])):m===155?($===4?(H=ve(r,O,P),k=1-ve(r,O,M),ee=1-ve(r,S,M),R=ve(r,S,P)):(H=1-ve(p,P,O),k=ve(p,M,O),ee=ve(p,M,S),R=1-ve(p,P,S)),W.push(sr[m]),W.push(kr[m])):m===103?($===4?(ue=1-ve(r,P,O),U=ve(r,M,O),ie=ve(r,M,S),X=1-ve(r,P,S)):(ue=ve(p,O,P),U=1-ve(p,O,M),ie=1-ve(p,S,M),X=ve(p,S,P)),W.push(rr[m]),W.push(Pr[m])):m===152?($===0?(H=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),R=ve(r,S,P)):(H=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),R=1-ve(p,P,S)),W.push(sr[m]),W.push(Pr[m]),W.push(xr[m])):m===156?($===4?(H=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),R=ve(r,S,P)):(H=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),R=1-ve(p,P,S)),W.push(sr[m]),W.push(xr[m]),W.push(Nr[m])):m===137?($===0?(H=ve(p,O,P),ue=ve(r,O,P),k=1-ve(r,O,M),ee=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P)):(H=1-ve(r,P,O),ue=1-ve(p,P,O),k=ve(p,M,O),ee=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S)),W.push(sr[m]),W.push(rr[m]),W.push(xr[m])):m===139?($===4?(H=ve(p,O,P),ue=ve(r,O,P),k=1-ve(r,O,M),ee=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P)):(H=1-ve(r,P,O),ue=1-ve(p,P,O),k=ve(p,M,O),ee=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S)),W.push(sr[m]),W.push(rr[m]),W.push(kr[m])):m===98?($===0?(H=1-ve(r,P,O),ue=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ie=ve(r,M,S),X=1-ve(r,P,S)):(H=ve(p,O,P),ue=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ie=1-ve(p,S,M),X=ve(p,S,P)),W.push(sr[m]),W.push(rr[m]),W.push(Nr[m])):m===99?($===4?(H=1-ve(r,P,O),ue=1-ve(p,P,O),U=ve(p,M,O),k=ve(r,M,O),ie=ve(r,M,S),X=1-ve(r,P,S)):(H=ve(p,O,P),ue=ve(r,O,P),U=1-ve(r,O,M),k=1-ve(p,O,M),ie=1-ve(p,S,M),X=ve(p,S,P)),W.push(sr[m]),W.push(rr[m]),W.push(xr[m])):m===38?($===0?(ue=1-ve(r,P,O),U=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S)):(ue=ve(p,O,P),U=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P)),W.push(rr[m]),W.push(kr[m]),W.push(Nr[m])):m===39?($===4?(ue=1-ve(r,P,O),U=ve(r,M,O),ee=ve(r,M,S),ie=ve(p,M,S),X=1-ve(p,P,S),R=1-ve(r,P,S)):(ue=ve(p,O,P),U=1-ve(p,O,M),ee=1-ve(p,S,M),ie=1-ve(r,S,M),X=ve(r,S,P),R=ve(p,S,P)),W.push(rr[m]),W.push(Pr[m]),W.push(Nr[m])):m===85&&(H=1,ue=0,U=1,k=0,ee=0,ie=1,X=0,R=1),X<0||X>1||R<0||R>1||H<0||H>1||U<0||U>1||ee<0||ee>1||ie<0||ie>1,l.cells[u][_]={cval:m,cval_real:B,flipped:$,topleft:X,topright:R,righttop:H,rightbottom:ue,bottomright:U,bottomleft:k,leftbottom:ee,lefttop:ie,edges:W}}}}}return l}function wV(e){for(var r=[],t=e.rows,n=e.cols,i=[],l=0;l<t;l++)for(var p=0;p<n;p++)if(typeof e.cells[l][p]<"u"&&e.cells[l][p].edges.length>0){var u=e.cells[l][p],_=PV(u),m=null,S=p,P=l;_!==null&&i.push([_.p[0]+S,_.p[1]+P]);do{if(m=AV(e.cells[P][S],_.x,_.y,_.o),m!==null)i.push([m.p[0]+S,m.p[1]+P]),S+=m.x,P+=m.y,_=m;else break;if(P<0||P>=t||S<0||S>=n||typeof e.cells[P][S]>"u"){S-=m.x,P-=m.y;var O=EV(e,S,P,m.x,m.y,m.o);if(O!==null)O.path.forEach(function(M){i.push(M)}),S=O.i,P=O.j,_=O;else break}}while(typeof e.cells[P][S]<"u"&&e.cells[P][S].edges.length>0);r.push(i),i=[],e.cells[l][p].edges.length>0&&p--}return r}function EV(e,r,t,n,i,l){for(var p=e.cells[t][r],u=p.cval_real,_=r+n,m=t+i,S=[],P=!1;!P;){if(typeof e.cells[m]>"u"||typeof e.cells[m][_]>"u")if(m-=i,_-=n,p=e.cells[m][_],u=p.cval_real,i===-1)if(l===0)if(u&Ia)S.push([_,m]),n=-1,i=0,l=0;else if(u&oa)S.push([_+1,m]),n=1,i=0,l=0;else{S.push([_+p.bottomright,m]),n=0,i=1,l=1,P=!0;break}else if(u&Ia)S.push([_,m]),n=-1,i=0,l=0;else if(u&oa){S.push([_+p.bottomright,m]),n=0,i=1,l=1,P=!0;break}else{S.push([_+p.bottomleft,m]),n=0,i=1,l=0,P=!0;break}else if(i===1)if(l===0)if(u&Nu)S.push([_+1,m+1]),n=1,i=0,l=1;else if(u&za){S.push([_+p.topleft,m+1]),n=0,i=-1,l=0,P=!0;break}else{S.push([_+p.topright,m+1]),n=0,i=-1,l=1,P=!0;break}else u&Nu?(S.push([_+1,m+1]),n=1,i=0,l=1):(S.push([_+1,m+1]),n=1,i=0,l=1);else if(n===-1)if(l===0)if(u&za)S.push([_,m+1]),n=0,i=1,l=0;else if(u&Ia){S.push([_,m+p.leftbottom]),n=1,i=0,l=0,P=!0;break}else{S.push([_,m+p.lefttop]),n=1,i=0,l=1,P=!0;break}else if(u&za)S.push([_,m+1]),n=0,i=1,l=0;else break;else if(n===1)if(l===0)if(u&oa)S.push([_+1,m]),n=0,i=-1,l=1;else{S.push([_+1,m+p.rightbottom]),n=-1,i=0,l=0,P=!0;break}else if(u&oa)S.push([_+1,m]),n=0,i=-1,l=1;else if(u&Nu){S.push([_+1,m+p.righttop]),n=-1,i=0,l=1;break}else{S.push([_+1,m+p.rightbottom]),n=-1,i=0,l=0,P=!0;break}else break;else if(p=e.cells[m][_],u=p.cval_real,n===-1){if(l===0)if(typeof e.cells[m-1]<"u"&&typeof e.cells[m-1][_]<"u")n=0,i=-1,l=1;else if(u&Ia)S.push([_,m]);else{S.push([_+p.bottomright,m]),n=0,i=1,l=1,P=!0;break}else if(!(u&za))break}else if(n===1){if(l===0)break;if(typeof e.cells[m+1]<"u"&&typeof e.cells[m+1][_]<"u")n=0,i=1,l=0;else if(u&Nu)S.push([_+1,m+1]),n=1,i=0,l=1;else{S.push([_+p.topleft,m+1]),n=0,i=-1,l=0,P=!0;break}}else if(i===-1)if(l===1)if(typeof e.cells[m][_+1]<"u")n=1,i=0,l=1;else if(u&oa)S.push([_+1,m]),n=0,i=-1,l=1;else{S.push([_+1,m+p.righttop]),n=-1,i=0,l=1,P=!0;break}else break;else if(i===1)if(l===0)if(typeof e.cells[m][_-1]<"u")n=-1,i=0,l=0;else if(u&za)S.push([_,m+1]),n=0,i=1,l=0;else{S.push([_,m+p.leftbottom]),n=1,i=0,l=0,P=!0;break}else break;else break;if(_+=n,m+=i,_===r&&m===t)break}return{path:S,i:_,j:m,x:n,y:i,o:l}}function SV(e,r){delete e.edges[r];for(var t=r+1;t<e.edges.length;t++)e.edges[t-1]=e.edges[t];e.edges.pop()}function PV(e){if(e.edges.length>0){var r=e.edges[e.edges.length-1],t=e.cval_real;switch(r){case 0:return t&Nu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 1:return t&oa?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 2:return t&oa?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 3:return t&Ia?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 4:return t&Nu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 5:return t&oa?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 6:return t&oa?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 7:return t&Ia?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 8:return t&oa?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.righttop],x:-1,y:0,o:1};case 9:return t&Ia?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 10:return t&Ia?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.righttop],x:-1,y:0,o:1};case 11:return t&za?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 12:return t&oa?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 13:return t&Ia?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 14:return t&Ia?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 15:return t&za?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 16:return t&oa?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 17:return t&za?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 18:return t&Ia?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 19:return t&za?{p:[e.bottomleft,0],x:0,y:1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 20:return t&za?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 21:return t&Nu?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.topright,1],x:0,y:-1,o:1};case 22:return t&za?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 23:return t&Nu?{p:[0,e.lefttop],x:1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};default:break}}return null}function AV(e,r,t,n){var i,l,p,u,_=e.cval,m;switch(r){case-1:switch(n){case 0:i=rr[_],p=_n[_],u=bn[_],m=xn[_];break;default:i=sr[_],p=mn[_],u=vn[_],m=yn[_];break}break;case 1:switch(n){case 0:i=kr[_],p=Mn[_],u=Ln[_],m=Rn[_];break;default:i=Nr[_],p=On[_],u=Cn[_],m=Tn[_];break}break;default:switch(t){case-1:switch(n){case 0:i=Dn[_],p=cn[_],u=hn[_],m=fn[_];break;default:i=Nn[_],p=pn[_],u=dn[_],m=gn[_];break}break;case 1:switch(n){case 0:i=xr[_],p=wn[_],u=En[_],m=Sn[_];break;default:i=Pr[_],p=Pn[_],u=An[_],m=In[_];break}break}break}if(l=e.edges.indexOf(i),typeof e.edges[l]<"u")SV(e,l);else return null;switch(_=e.cval_real,i){case 0:_&Nu?(r=e.topleft,t=1):(r=1,t=e.righttop);break;case 1:_&oa?(r=1,t=e.rightbottom):(r=e.topleft,t=1);break;case 2:_&oa?(r=e.topleft,t=1):(r=e.bottomright,t=0);break;case 3:_&Ia?(r=e.bottomleft,t=0):(r=e.topleft,t=1);break;case 4:_&Nu?(r=e.topright,t=1):(r=1,t=e.righttop);break;case 5:_&oa?(r=1,t=e.rightbottom):(r=e.topright,t=1);break;case 6:_&oa?(r=e.topright,t=1):(r=e.bottomright,t=0);break;case 7:_&Ia?(r=e.bottomleft,t=0):(r=e.topright,t=1);break;case 8:_&oa?(r=1,t=e.righttop):(r=e.bottomright,t=0);break;case 9:_&Ia?(r=e.bottomleft,t=0):(r=1,t=e.righttop);break;case 10:_&Ia?(r=1,t=e.righttop):(r=0,t=e.leftbottom);break;case 11:_&za?(r=0,t=e.lefttop):(r=1,t=e.righttop);break;case 12:_&oa?(r=1,t=e.rightbottom):(r=e.bottomright,t=0);break;case 13:_&Ia?(r=e.bottomleft,t=0):(r=1,t=e.rightbottom);break;case 14:_&Ia?(r=1,t=e.rightbottom):(r=0,t=e.leftbottom);break;case 15:_&za?(r=0,t=e.lefttop):(r=1,t=e.rightbottom);break;case 16:_&oa?(r=0,t=e.leftbottom):(r=e.bottomright,t=0);break;case 17:_&za?(r=0,t=e.lefttop):(r=e.bottomright,t=0);break;case 18:_&Ia?(r=e.bottomleft,t=0):(r=0,t=e.leftbottom);break;case 19:_&za?(r=0,t=e.lefttop):(r=e.bottomleft,t=0);break;case 20:_&za?(r=0,t=e.leftbottom):(r=e.topleft,t=1);break;case 21:_&Nu?(r=e.topright,t=1):(r=0,t=e.leftbottom);break;case 22:_&za?(r=0,t=e.lefttop):(r=e.topleft,t=1);break;case 23:_&Nu?(r=e.topright,t=1):(r=0,t=e.lefttop);break;default:return null}return{p:[r,t],x:p,y:u,o:m}}function IV(e){var r=[],t=0;return e.cells.forEach(function(n,i){n.forEach(function(l,p){if(typeof l<"u"){var u=Wt[l.cval](l);typeof u=="object"&&U1(u)&&typeof u[0]=="object"&&U1(u[0])&&(typeof u[0][0]=="object"&&U1(u[0][0])?u.forEach(function(_){_.forEach(function(m){m[0]+=p,m[1]+=i}),r[t++]=_}):(u.forEach(function(_){_[0]+=p,_[1]+=i}),r[t++]=u))}})}),r}function GR(e,r,t){if(t=t||{},!Yl.isObject(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",i=t.commonProperties||{},l=t.breaksProperties||[];if(Vl.collectionOf(e,"Point","Input must contain Points"),!r)throw new Error("breaks is required");if(!Array.isArray(r))throw new Error("breaks is not an Array");if(!Yl.isObject(i))throw new Error("commonProperties is not an Object");if(!Array.isArray(l))throw new Error("breaksProperties is not an Array");var p=jq(e,{zProperty:n,flip:!0}),u=OV(p,r,n);u=CV(u,p,e);var _=u.map(function(m,S){if(l[S]&&!Yl.isObject(l[S]))throw new Error("Each mappedProperty is required to be an Object");var P=zq.default({},i,l[S]);P[n]=m[n];var O=Yl.multiPolygon(m.groupedRings,P);return O});return Yl.featureCollection(_)}function OV(e,r,t){for(var n=[],i=1;i<r.length;i++){var l=+r[i-1],p=+r[i],u=$q(e,l,p-l),_=TV(u),m=MV(_),S={};S.groupedRings=m,S[t]=l+"-"+p,n.push(S)}return n}function CV(e,r,t){var n=Nq.default(t),i=n[2]-n[0],l=n[3]-n[1],p=n[0],u=n[1],_=r[0].length-1,m=r.length-1,S=i/_,P=l/m,O=function(M){M[0]=M[0]*S+p,M[1]=M[1]*P+u};return e.forEach(function(M){M.groupedRings.forEach(function(B){B.forEach(function($){$.forEach(O)})})}),e}function TV(e){var r=[],t=[];e.forEach(function(i){var l=Fq.default(Yl.polygon([i]));t.push(l),r.push({ring:i,area:l})}),t.sort(function(i,l){return l-i});var n=[];return t.forEach(function(i){for(var l=0;l<r.length;l++)if(r[l].area===i){n.push(r[l].ring),r.splice(l,1);break}}),n}function MV(e){for(var r=e.map(function(_){return{lrCoordinates:_,grouped:!1}}),t=[];!RV(r);)for(var n=0;n<r.length;n++)if(!r[n].grouped){var i=[];i.push(r[n].lrCoordinates),r[n].grouped=!0;for(var l=Yl.polygon([r[n].lrCoordinates]),p=n+1;p<r.length;p++)if(!r[p].grouped){var u=Yl.polygon([r[p].lrCoordinates]);LV(u,l)&&(i.push(r[p].lrCoordinates),r[p].grouped=!0)}t.push(i)}return t}function LV(e,r){for(var t=Bq.default(e),n=0;n<t.features.length;n++)if(!kq.default(t.features[n],r))return!1;return!0}function RV(e){for(var r=0;r<e.length;r++)if(e[r].grouped===!1)return!1;return!0}fE.exports=GR;fE.exports.default=GR;var DV=fE.exports,xE={exports:{}},NV=Kl,FV=dh,kV=Of,BV=gh,zV=ua,jV=nr,UV=vr,$V=zt;function Id(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var GV=Id(NV),qV=Id(FV),VV=Id(kV),XV=Id(BV),YV=Id(zV);function qR(e,r,t){if(t=t||{},!$V.isObject(t))throw new Error("options is invalid");var n=t.pivot,i=t.mutate;if(!e)throw new Error("geojson is required");if(r==null||isNaN(r))throw new Error("angle is required");return r===0||(n||(n=GV.default(e)),(i===!1||i===void 0)&&(e=YV.default(e)),jV.coordEach(e,function(l){var p=qV.default(n,l),u=p+r,_=VV.default(n,l),m=UV.getCoords(XV.default(n,_,u));l[0]=m[0],l[1]=m[1]})),e}xE.exports=qR;xE.exports.default=qR;var VR=xE.exports,wE={exports:{}},WV=ua,ZV=Af,HV=Kl,JV=ja,KV=dh,QV=Of,e9=gh,XR=nr,Rp=zt,Vb=vr;function mh(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var t9=mh(WV),r9=mh(ZV),n9=mh(HV),i9=mh(JV),o9=mh(KV),a9=mh(QV),s9=mh(e9);function YR(e,r,t){if(t=t||{},!Rp.isObject(t))throw new Error("options is invalid");var n=t.origin,i=t.mutate;if(!e)throw new Error("geojson required");if(typeof r!="number"||r===0)throw new Error("invalid factor");var l=Array.isArray(n)||typeof n=="object";return i!==!0&&(e=t9.default(e)),e.type==="FeatureCollection"&&!l?(XR.featureEach(e,function(p,u){e.features[u]=q2(p,r,n)}),e):q2(e,r,n)}function q2(e,r,t){var n=Vb.getType(e)==="Point";return t=u9(e,t),r===1||n||XR.coordEach(e,function(i){var l=a9.default(t,i),p=o9.default(t,i),u=l*r,_=Vb.getCoords(s9.default(t,u,p));i[0]=_[0],i[1]=_[1],i.length===3&&(i[2]*=r)}),e}function u9(e,r){if(r==null&&(r="centroid"),Array.isArray(r)||typeof r=="object")return Vb.getCoord(r);var t=e.bbox?e.bbox:i9.default(e),n=t[0],i=t[1],l=t[2],p=t[3];switch(r){case"sw":case"southwest":case"westsouth":case"bottomleft":return Rp.point([n,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return Rp.point([l,i]);case"nw":case"northwest":case"westnorth":case"topleft":return Rp.point([n,p]);case"ne":case"northeast":case"eastnorth":case"topright":return Rp.point([l,p]);case"center":return r9.default(e);case void 0:case null:case"centroid":return n9.default(e);default:throw new Error("invalid origin")}}wE.exports=YR;wE.exports.default=YR;var WR=wE.exports,EE={exports:{}},l9=nr,c9=zt,h9=vr,f9=ua,p9=gh;function ZR(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var d9=ZR(f9),g9=ZR(p9);function HR(e,r,t,n){if(n=n||{},!c9.isObject(n))throw new Error("options is invalid");var i=n.units,l=n.zTranslation,p=n.mutate;if(!e)throw new Error("geojson is required");if(r==null||isNaN(r))throw new Error("distance is required");if(l&&typeof l!="number"&&isNaN(l))throw new Error("zTranslation is not a number");if(l=l!==void 0?l:0,r===0&&l===0)return e;if(t==null||isNaN(t))throw new Error("direction is required");return r<0&&(r=-r,t=t+180),(p===!1||p===void 0)&&(e=d9.default(e)),l9.coordEach(e,function(u){var _=h9.getCoords(g9.default(u,r,t,{units:i}));u[0]=_[0],u[1]=_[1],l&&u.length===3&&(u[2]+=l)}),e}EE.exports=HR;EE.exports.default=HR;var m9=EE.exports,SE={exports:{}},v9=nr,JR=vr,zm=zt;function jm(e){var r=e[0],t=e[1];return[t[0]-r[0],t[1]-r[1]]}function Xb(e,r){return e[0]*r[1]-r[0]*e[1]}function y9(e,r){return[e[0]+r[0],e[1]+r[1]]}function _9(e,r){return[e[0]-r[0],e[1]-r[1]]}function b9(e,r){return[e*r[0],e*r[1]]}function x9(e,r){var t=e[0],n=jm(e),i=r[0],l=jm(r),p=Xb(n,l),u=_9(i,t),_=Xb(u,l),m=_/p,S=y9(t,b9(m,n));return S}function w9(e,r){var t=jm(e),n=jm(r);return Xb(t,n)===0}function E9(e,r){return w9(e,r)?!1:x9(e,r)}function KR(e,r,t){if(t=t||{},!zm.isObject(t))throw new Error("options is invalid");var n=t.units;if(!e)throw new Error("geojson is required");if(r==null||isNaN(r))throw new Error("distance is required");var i=JR.getType(e),l=e.properties;switch(i){case"LineString":return V2(e,r,n);case"MultiLineString":var p=[];return v9.flattenEach(e,function(u){p.push(V2(u,r,n).geometry.coordinates)}),zm.multiLineString(p,l);default:throw new Error("geometry "+i+" is not supported")}}function V2(e,r,t){var n=[],i=zm.lengthToDegrees(r,t),l=JR.getCoords(e),p=[];return l.forEach(function(u,_){if(_!==l.length-1){var m=S9(u,l[_+1],i);if(n.push(m),_>0){var S=n[_-1],P=E9(m,S);P!==!1&&(S[1]=P,m[0]=P),p.push(S[0]),_===l.length-2&&(p.push(m[0]),p.push(m[1]))}l.length===2&&(p.push(m[0]),p.push(m[1]))}}),zm.lineString(p,e.properties)}function S9(e,r,t){var n=Math.sqrt((e[0]-r[0])*(e[0]-r[0])+(e[1]-r[1])*(e[1]-r[1])),i=e[0]+t*(r[1]-e[1])/n,l=r[0]+t*(r[1]-e[1])/n,p=e[1]+t*(e[0]-r[0])/n,u=r[1]+t*(e[0]-r[0])/n;return[[i,p],[l,u]]}SE.exports=KR;SE.exports.default=KR;var P9=SE.exports,PE={},AE={},IE={},Oc={},A9=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Oc,"__esModule",{value:!0});var I9=A9(ps),O9=zt;function C9(e){return(e>0)-(e<0)||+e}function T9(e,r,t){var n=r[0]-e[0],i=r[1]-e[1],l=t[0]-r[0],p=t[1]-r[1];return C9(n*p-l*i)}Oc.orientationIndex=T9;function M9(e,r){var t=e.geometry.coordinates[0].map(function(p){return p[0]}),n=e.geometry.coordinates[0].map(function(p){return p[1]}),i=r.geometry.coordinates[0].map(function(p){return p[0]}),l=r.geometry.coordinates[0].map(function(p){return p[1]});return Math.max.apply(null,t)===Math.max.apply(null,i)&&Math.max.apply(null,n)===Math.max.apply(null,l)&&Math.min.apply(null,t)===Math.min.apply(null,i)&&Math.min.apply(null,n)===Math.min.apply(null,l)}Oc.envelopeIsEqual=M9;function L9(e,r){return r.geometry.coordinates[0].every(function(t){return I9.default(O9.point(t),e)})}Oc.envelopeContains=L9;function R9(e,r){return e[0]===r[0]&&e[1]===r[1]}Oc.coordinatesEqual=R9;Object.defineProperty(IE,"__esModule",{value:!0});var D9=Oc,N9=function(){function e(r){this.id=e.buildId(r),this.coordinates=r,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return e.buildId=function(r){return r.join(",")},e.prototype.removeInnerEdge=function(r){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==r.from.id})},e.prototype.removeOuterEdge=function(r){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==r.to.id})},e.prototype.addOuterEdge=function(r){this.outerEdges.push(r),this.outerEdgesSorted=!1},e.prototype.sortOuterEdges=function(){var r=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,n){var i=t.to,l=n.to;if(i.coordinates[0]-r.coordinates[0]>=0&&l.coordinates[0]-r.coordinates[0]<0)return 1;if(i.coordinates[0]-r.coordinates[0]<0&&l.coordinates[0]-r.coordinates[0]>=0)return-1;if(i.coordinates[0]-r.coordinates[0]===0&&l.coordinates[0]-r.coordinates[0]===0)return i.coordinates[1]-r.coordinates[1]>=0||l.coordinates[1]-r.coordinates[1]>=0?i.coordinates[1]-l.coordinates[1]:l.coordinates[1]-i.coordinates[1];var p=D9.orientationIndex(r.coordinates,i.coordinates,l.coordinates);if(p<0)return 1;if(p>0)return-1;var u=Math.pow(i.coordinates[0]-r.coordinates[0],2)+Math.pow(i.coordinates[1]-r.coordinates[1],2),_=Math.pow(l.coordinates[0]-r.coordinates[0],2)+Math.pow(l.coordinates[1]-r.coordinates[1],2);return u-_}),this.outerEdgesSorted=!0)},e.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},e.prototype.getOuterEdge=function(r){return this.sortOuterEdges(),this.outerEdges[r]},e.prototype.addInnerEdge=function(r){this.innerEdges.push(r)},e}();IE.default=N9;var OE={};Object.defineProperty(OE,"__esModule",{value:!0});var F9=zt,k9=Oc,B9=function(){function e(r,t){this.from=r,this.to=t,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return e.prototype.getSymetric=function(){return this.symetric||(this.symetric=new e(this.to,this.from),this.symetric.symetric=this),this.symetric},e.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},e.prototype.isEqual=function(r){return this.from.id===r.from.id&&this.to.id===r.to.id},e.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},e.prototype.toLineString=function(){return F9.lineString([this.from.coordinates,this.to.coordinates])},e.prototype.compareTo=function(r){return k9.orientationIndex(r.from.coordinates,r.to.coordinates,this.to.coordinates)},e}();OE.default=B9;var Uv={},QR=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Uv,"__esModule",{value:!0});var yp=Oc,$1=zt,z9=QR(yL),j9=QR(ps),U9=function(){function e(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return e.prototype.push=function(r){this.edges.push(r),this.polygon=this.envelope=void 0},e.prototype.get=function(r){return this.edges[r]},Object.defineProperty(e.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),e.prototype.forEach=function(r){this.edges.forEach(r)},e.prototype.map=function(r){return this.edges.map(r)},e.prototype.some=function(r){return this.edges.some(r)},e.prototype.isValid=function(){return!0},e.prototype.isHole=function(){var r=this,t=this.edges.reduce(function(p,u,_){return u.from.coordinates[1]>r.edges[p].from.coordinates[1]&&(p=_),p},0),n=(t===0?this.length:t)-1,i=(t+1)%this.length,l=yp.orientationIndex(this.edges[n].from.coordinates,this.edges[t].from.coordinates,this.edges[i].from.coordinates);return l===0?this.edges[n].from.coordinates[0]>this.edges[i].from.coordinates[0]:l>0},e.prototype.toMultiPoint=function(){return $1.multiPoint(this.edges.map(function(r){return r.from.coordinates}))},e.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var r=this.edges.map(function(t){return t.from.coordinates});return r.push(this.edges[0].from.coordinates),this.polygon=$1.polygon([r])},e.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=z9.default(this.toPolygon())},e.findEdgeRingContaining=function(r,t){var n=r.getEnvelope(),i,l;return t.forEach(function(p){var u=p.getEnvelope();if(l&&(i=l.getEnvelope()),!yp.envelopeIsEqual(u,n)&&yp.envelopeContains(u,n)){for(var _=r.map(function(B){return B.from.coordinates}),m=void 0,S=function(B){p.some(function($){return yp.coordinatesEqual(B,$.from.coordinates)})||(m=B)},P=0,O=_;P<O.length;P++){var M=O[P];S(M)}m&&p.inside($1.point(m))&&(!l||yp.envelopeContains(i,u))&&(l=p)}}),l},e.prototype.inside=function(r){return j9.default(r,this.toPolygon())},e}();Uv.default=U9;var CE=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(AE,"__esModule",{value:!0});var X2=CE(IE),$9=CE(OE),G9=CE(Uv),Y2=nr,q9=vr;function V9(e){if(!e)throw new Error("No geojson passed");if(e.type!=="FeatureCollection"&&e.type!=="GeometryCollection"&&e.type!=="MultiLineString"&&e.type!=="LineString"&&e.type!=="Feature")throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var X9=function(){function e(){this.edges=[],this.nodes={}}return e.fromGeoJson=function(r){V9(r);var t=new e;return Y2.flattenEach(r,function(n){q9.featureOf(n,"LineString","Graph::fromGeoJson"),Y2.coordReduce(n,function(i,l){if(i){var p=t.getNode(i),u=t.getNode(l);t.addEdge(p,u)}return l})}),t},e.prototype.getNode=function(r){var t=X2.default.buildId(r),n=this.nodes[t];return n||(n=this.nodes[t]=new X2.default(r)),n},e.prototype.addEdge=function(r,t){var n=new $9.default(r,t),i=n.getSymetric();this.edges.push(n),this.edges.push(i)},e.prototype.deleteDangles=function(){var r=this;Object.keys(this.nodes).map(function(t){return r.nodes[t]}).forEach(function(t){return r._removeIfDangle(t)})},e.prototype._removeIfDangle=function(r){var t=this;if(r.innerEdges.length<=1){var n=r.getOuterEdges().map(function(i){return i.to});this.removeNode(r),n.forEach(function(i){return t._removeIfDangle(i)})}},e.prototype.deleteCutEdges=function(){var r=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(r.removeEdge(t.symetric),r.removeEdge(t))})},e.prototype._computeNextCWEdges=function(r){var t=this;typeof r>"u"?Object.keys(this.nodes).forEach(function(n){return t._computeNextCWEdges(t.nodes[n])}):r.getOuterEdges().forEach(function(n,i){r.getOuterEdge((i===0?r.getOuterEdges().length:i)-1).symetric.next=n})},e.prototype._computeNextCCWEdges=function(r,t){for(var n=r.getOuterEdges(),i,l,p=n.length-1;p>=0;--p){var u=n[p],_=u.symetric,m=void 0,S=void 0;u.label===t&&(m=u),_.label===t&&(S=_),!(!m||!S)&&(S&&(l=S),m&&(l&&(l.next=m,l=void 0),i||(i=m)))}l&&(l.next=i)},e.prototype._findLabeledEdgeRings=function(){var r=[],t=0;return this.edges.forEach(function(n){if(!(n.label>=0)){r.push(n);var i=n;do i.label=t,i=i.next;while(!n.isEqual(i));t++}}),r},e.prototype.getEdgeRings=function(){var r=this;this._computeNextCWEdges(),this.edges.forEach(function(n){n.label=void 0}),this._findLabeledEdgeRings().forEach(function(n){r._findIntersectionNodes(n).forEach(function(i){r._computeNextCCWEdges(i,n.label)})});var t=[];return this.edges.forEach(function(n){n.ring||t.push(r._findEdgeRing(n))}),t},e.prototype._findIntersectionNodes=function(r){var t=[],n=r,i=function(){var l=0;n.from.getOuterEdges().forEach(function(p){p.label===r.label&&++l}),l>1&&t.push(n.from),n=n.next};do i();while(!r.isEqual(n));return t},e.prototype._findEdgeRing=function(r){var t=r,n=new G9.default;do n.push(t),t.ring=n,t=t.next;while(!r.isEqual(t));return n},e.prototype.removeNode=function(r){var t=this;r.getOuterEdges().forEach(function(n){return t.removeEdge(n)}),r.innerEdges.forEach(function(n){return t.removeEdge(n)}),delete this.nodes[r.id]},e.prototype.removeEdge=function(r){this.edges=this.edges.filter(function(t){return!t.isEqual(r)}),r.deleteEdge()},e}();AE.default=X9;var eD=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PE,"__esModule",{value:!0});var Y9=zt,W9=eD(AE),Z9=eD(Uv);function H9(e){var r=W9.default.fromGeoJson(e);r.deleteDangles(),r.deleteCutEdges();var t=[],n=[];return r.getEdgeRings().filter(function(i){return i.isValid()}).forEach(function(i){i.isHole()?t.push(i):n.push(i)}),t.forEach(function(i){Z9.default.findEdgeRingContaining(i,n)&&n.push(i)}),Y9.featureCollection(n.map(function(i){return i.toPolygon()}))}PE.default=H9;var $v={},TE=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($v,"__esModule",{value:!0});var od=TE(ps),ME=TE(Ac),W2=nr,Yb=TE(Ic);function J9(e,r){var t=!0;return W2.flattenEach(e,function(n){W2.flattenEach(r,function(i){if(t===!1)return!1;t=K9(n.geometry,i.geometry)})}),t}function K9(e,r){switch(e.type){case"Point":switch(r.type){case"Point":return!r7(e.coordinates,r.coordinates);case"LineString":return!Z2(r,e);case"Polygon":return!od.default(e,r)}break;case"LineString":switch(r.type){case"Point":return!Z2(e,r);case"LineString":return!Q9(e,r);case"Polygon":return!H2(r,e)}break;case"Polygon":switch(r.type){case"Point":return!od.default(r,e);case"LineString":return!H2(e,r);case"Polygon":return!e7(r,e)}}return!1}function Z2(e,r){for(var t=0;t<e.coordinates.length-1;t++)if(t7(e.coordinates[t],e.coordinates[t+1],r.coordinates))return!0;return!1}function Q9(e,r){var t=ME.default(e,r);return t.features.length>0}function H2(e,r){for(var t=0,n=r.coordinates;t<n.length;t++){var i=n[t];if(od.default(i,e))return!0}var l=ME.default(r,Yb.default(e));return l.features.length>0}function e7(e,r){for(var t=0,n=e.coordinates[0];t<n.length;t++){var i=n[t];if(od.default(i,r))return!0}for(var l=0,p=r.coordinates[0];l<p.length;l++){var u=p[l];if(od.default(u,e))return!0}var _=ME.default(Yb.default(e),Yb.default(r));return _.features.length>0}function t7(e,r,t){var n=t[0]-e[0],i=t[1]-e[1],l=r[0]-e[0],p=r[1]-e[1],u=n*p-i*l;return u!==0?!1:Math.abs(l)>=Math.abs(p)?l>0?e[0]<=t[0]&&t[0]<=r[0]:r[0]<=t[0]&&t[0]<=e[0]:p>0?e[1]<=t[1]&&t[1]<=r[1]:r[1]<=t[1]&&t[1]<=e[1]}function r7(e,r){return e[0]===r[0]&&e[1]===r[1]}$v.default=J9;var _u={},LE=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_u,"__esModule",{value:!0});var Um=LE(ja),Gv=LE(ps),ad=LE(Cf),Wb=vr;function n7(e,r){var t=Wb.getGeom(e),n=Wb.getGeom(r),i=t.type,l=n.type,p=t.coordinates,u=n.coordinates;switch(i){case"Point":switch(l){case"Point":return qv(p,u);default:throw new Error("feature2 "+l+" geometry not supported")}case"MultiPoint":switch(l){case"Point":return tD(t,n);case"MultiPoint":return rD(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}case"LineString":switch(l){case"Point":return ad.default(n,t,{ignoreEndVertices:!0});case"LineString":return oD(t,n);case"MultiPoint":return nD(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}case"Polygon":switch(l){case"Point":return Gv.default(n,t,{ignoreBoundary:!0});case"LineString":return aD(t,n);case"Polygon":return sD(t,n);case"MultiPoint":return iD(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}_u.default=n7;function tD(e,r){var t,n=!1;for(t=0;t<e.coordinates.length;t++)if(qv(e.coordinates[t],r.coordinates)){n=!0;break}return n}_u.isPointInMultiPoint=tD;function rD(e,r){for(var t=0,n=r.coordinates;t<n.length;t++){for(var i=n[t],l=!1,p=0,u=e.coordinates;p<u.length;p++){var _=u[p];if(qv(i,_)){l=!0;break}}if(!l)return!1}return!0}_u.isMultiPointInMultiPoint=rD;function nD(e,r){for(var t=!1,n=0,i=r.coordinates;n<i.length;n++){var l=i[n];if(ad.default(l,e,{ignoreEndVertices:!0})&&(t=!0),!ad.default(l,e))return!1}return!!t}_u.isMultiPointOnLine=nD;function iD(e,r){for(var t=0,n=r.coordinates;t<n.length;t++){var i=n[t];if(!Gv.default(i,e,{ignoreBoundary:!0}))return!1}return!0}_u.isMultiPointInPoly=iD;function oD(e,r){for(var t=!1,n=0,i=r.coordinates;n<i.length;n++){var l=i[n];if(ad.default({type:"Point",coordinates:l},e,{ignoreEndVertices:!0})&&(t=!0),!ad.default({type:"Point",coordinates:l},e,{ignoreEndVertices:!1}))return!1}return t}_u.isLineOnLine=oD;function aD(e,r){var t=!1,n=0,i=Um.default(e),l=Um.default(r);if(!RE(i,l))return!1;for(n;n<r.coordinates.length-1;n++){var p=uD(r.coordinates[n],r.coordinates[n+1]);if(Gv.default({type:"Point",coordinates:p},e,{ignoreBoundary:!0})){t=!0;break}}return t}_u.isLineInPoly=aD;function sD(e,r){if(e.type==="Feature"&&e.geometry===null||r.type==="Feature"&&r.geometry===null)return!1;var t=Um.default(e),n=Um.default(r);if(!RE(t,n))return!1;for(var i=Wb.getGeom(r).coordinates,l=0,p=i;l<p.length;l++)for(var u=p[l],_=0,m=u;_<m.length;_++){var S=m[_];if(!Gv.default(S,e))return!1}return!0}_u.isPolyInPoly=sD;function RE(e,r){return!(e[0]>r[0]||e[2]<r[2]||e[1]>r[1]||e[3]<r[3])}_u.doBBoxOverlap=RE;function qv(e,r){return e[0]===r[0]&&e[1]===r[1]}_u.compareCoords=qv;function uD(e,r){return[(e[0]+r[0])/2,(e[1]+r[1])/2]}_u.getMidpoint=uD;var DE={},lD=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(DE,"__esModule",{value:!0});var cD=lD(Ac),i7=Ic,o7=lD(ps),J2=vr,a7=zt;function s7(e,r){var t=J2.getGeom(e),n=J2.getGeom(r),i=t.type,l=n.type;switch(i){case"MultiPoint":switch(l){case"LineString":return K2(t,n);case"Polygon":return eO(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}case"LineString":switch(l){case"MultiPoint":return K2(n,t);case"LineString":return u7(t,n);case"Polygon":return Q2(t,n);default:throw new Error("feature2 "+l+" geometry not supported")}case"Polygon":switch(l){case"MultiPoint":return eO(n,t);case"LineString":return Q2(n,t);default:throw new Error("feature2 "+l+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function K2(e,r){for(var t=!1,n=!1,i=e.coordinates.length,l=0;l<i&&!t&&!n;){for(var p=0;p<r.coordinates.length-1;p++){var u=!0;(p===0||p===r.coordinates.length-2)&&(u=!1),hD(r.coordinates[p],r.coordinates[p+1],e.coordinates[l],u)?t=!0:n=!0}l++}return t&&n}function u7(e,r){var t=cD.default(e,r);if(t.features.length>0)for(var n=0;n<e.coordinates.length-1;n++)for(var i=0;i<r.coordinates.length-1;i++){var l=!0;if((i===0||i===r.coordinates.length-2)&&(l=!1),hD(e.coordinates[n],e.coordinates[n+1],r.coordinates[i],l))return!0}return!1}function Q2(e,r){var t=i7.polygonToLine(r),n=cD.default(e,t);return n.features.length>0}function eO(e,r){for(var t=!1,n=!1,i=e.coordinates.length,l=0;l<i&&(!t||!n);l++)o7.default(a7.point(e.coordinates[l]),r)?t=!0:n=!0;return n&&t}function hD(e,r,t,n){var i=t[0]-e[0],l=t[1]-e[1],p=r[0]-e[0],u=r[1]-e[1],_=i*u-l*p;return _!==0?!1:n?Math.abs(p)>=Math.abs(u)?p>0?e[0]<=t[0]&&t[0]<=r[0]:r[0]<=t[0]&&t[0]<=e[0]:u>0?e[1]<=t[1]&&t[1]<=r[1]:r[1]<=t[1]&&t[1]<=e[1]:Math.abs(p)>=Math.abs(u)?p>0?e[0]<t[0]&&t[0]<r[0]:r[0]<t[0]&&t[0]<e[0]:u>0?e[1]<t[1]&&t[1]<r[1]:r[1]<t[1]&&t[1]<e[1]}DE.default=s7;var NE={},l7=kR,xl=function(e){this.precision=e&&e.precision?e.precision:17,this.direction=e&&e.direction?e.direction:!1,this.pseudoNode=e&&e.pseudoNode?e.pseudoNode:!1,this.objectComparator=e&&e.objectComparator?e.objectComparator:c7};xl.prototype.compare=function(e,r){if(e.type!==r.type||!fD(e,r))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,r.coordinates);case"LineString":return this.compareLine(e.coordinates,r.coordinates,0,!1);case"Polygon":return this.comparePolygon(e,r);case"Feature":return this.compareFeature(e,r);default:if(e.type.indexOf("Multi")===0){var t=this,n=tO(e),i=tO(r);return n.every(function(l){return this.some(function(p){return t.compare(l,p)})},i)}}return!1};function tO(e){return e.coordinates.map(function(r){return{type:e.type.replace("Multi",""),coordinates:r}})}function fD(e,r){return e.hasOwnProperty("coordinates")?e.coordinates.length===r.coordinates.length:e.length===r.length}xl.prototype.compareCoord=function(e,r){if(e.length!==r.length)return!1;for(var t=0;t<e.length;t++)if(e[t].toFixed(this.precision)!==r[t].toFixed(this.precision))return!1;return!0};xl.prototype.compareLine=function(e,r,t,n){if(!fD(e,r))return!1;var i=this.pseudoNode?e:this.removePseudo(e),l=this.pseudoNode?r:this.removePseudo(r);if(!(n&&!this.compareCoord(i[0],l[0])&&(l=this.fixStartIndex(l,i),!l))){var p=this.compareCoord(i[t],l[t]);return this.direction||p?this.comparePath(i,l):this.compareCoord(i[t],l[l.length-(1+t)])?this.comparePath(i.slice().reverse(),l):!1}};xl.prototype.fixStartIndex=function(e,r){for(var t,n=-1,i=0;i<e.length;i++)if(this.compareCoord(e[i],r[0])){n=i;break}return n>=0&&(t=[].concat(e.slice(n,e.length),e.slice(1,n+1))),t};xl.prototype.comparePath=function(e,r){var t=this;return e.every(function(n,i){return t.compareCoord(n,this[i])},r)};xl.prototype.comparePolygon=function(e,r){if(this.compareLine(e.coordinates[0],r.coordinates[0],1,!0)){var t=e.coordinates.slice(1,e.coordinates.length),n=r.coordinates.slice(1,r.coordinates.length),i=this;return t.every(function(l){return this.some(function(p){return i.compareLine(l,p,1,!0)})},n)}else return!1};xl.prototype.compareFeature=function(e,r){return e.id!==r.id||!this.objectComparator(e.properties,r.properties)||!this.compareBBox(e,r)?!1:this.compare(e.geometry,r.geometry)};xl.prototype.compareBBox=function(e,r){return!!(!e.bbox&&!r.bbox||e.bbox&&r.bbox&&this.compareCoord(e.bbox,r.bbox))};xl.prototype.removePseudo=function(e){return e};function c7(e,r){return l7(e,r,{strict:!0})}var pD=xl,FE=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(NE,"__esModule",{value:!0});var nm=nr,rO=vr,h7=FE(kv),f7=FE(Ac),p7=FE(pD);function d7(e,r){var t=rO.getGeom(e),n=rO.getGeom(r),i=t.type,l=n.type;if(i==="MultiPoint"&&l!=="MultiPoint"||(i==="LineString"||i==="MultiLineString")&&l!=="LineString"&&l!=="MultiLineString"||(i==="Polygon"||i==="MultiPolygon")&&l!=="Polygon"&&l!=="MultiPolygon")throw new Error("features must be of the same type");if(i==="Point")throw new Error("Point geometry not supported");var p=new p7.default({precision:6});if(p.compare(e,r))return!1;var u=0;switch(i){case"MultiPoint":for(var _=0;_<t.coordinates.length;_++)for(var m=0;m<n.coordinates.length;m++){var S=t.coordinates[_],P=n.coordinates[m];if(S[0]===P[0]&&S[1]===P[1])return!0}return!1;case"LineString":case"MultiLineString":nm.segmentEach(e,function(O){nm.segmentEach(r,function(M){h7.default(O,M).features.length&&u++})});break;case"Polygon":case"MultiPolygon":nm.segmentEach(e,function(O){nm.segmentEach(r,function(M){f7.default(O,M).features.length&&u++})});break}return u>0}NE.default=d7;var kE={},dD=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kE,"__esModule",{value:!0});var g7=dD(pD),nO=dD(hh),iO=vr;function m7(e,r){var t=iO.getGeom(e).type,n=iO.getGeom(r).type;if(t!==n)return!1;var i=new g7.default({precision:6});return i.compare(nO.default(e),nO.default(r))}kE.default=m7;var Vv={},v7=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vv,"__esModule",{value:!0});var y7=v7($v),oO=nr;function _7(e,r){var t=!1;return oO.flattenEach(e,function(n){oO.flattenEach(r,function(i){if(t===!0)return!0;t=!y7.default(n.geometry,i.geometry)})}),t}Vv.default=_7;var BE={},gD={exports:{}},G1={exports:{}},aO;function b7(){return aO||(aO=1,function(e){function r(t,n,i,l){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,n,i,l)}r.prototype.run=function(t,n,i,l){this._init(t,n,i,l);for(var p=0;p<this._datasetLength;p++)if(this._visited[p]!==1){this._visited[p]=1;var u=this._regionQuery(p);if(u.length<this.minPts)this.noise.push(p);else{var _=this.clusters.length;this.clusters.push([]),this._addToCluster(p,_),this._expandCluster(_,u)}}return this.clusters},r.prototype._init=function(t,n,i,l){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}n&&(this.epsilon=n),i&&(this.minPts=i),l&&(this.distance=l)},r.prototype._expandCluster=function(t,n){for(var i=0;i<n.length;i++){var l=n[i];if(this._visited[l]!==1){this._visited[l]=1;var p=this._regionQuery(l);p.length>=this.minPts&&(n=this._mergeArrays(n,p))}this._assigned[l]!==1&&this._addToCluster(l,t)}},r.prototype._addToCluster=function(t,n){this.clusters[n].push(t),this._assigned[t]=1},r.prototype._regionQuery=function(t){for(var n=[],i=0;i<this._datasetLength;i++){var l=this.distance(this.dataset[t],this.dataset[i]);l<this.epsilon&&n.push(i)}return n},r.prototype._mergeArrays=function(t,n){for(var i=n.length,l=0;l<i;l++){var p=n[l];t.indexOf(p)<0&&t.push(p)}return t},r.prototype._euclideanDistance=function(t,n){for(var i=0,l=Math.min(t.length,n.length);l--;)i+=(t[l]-n[l])*(t[l]-n[l]);return Math.sqrt(i)},e.exports&&(e.exports=r)}(G1)),G1.exports}var q1={exports:{}},sO;function x7(){return sO||(sO=1,function(e){function r(t,n,i){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,n,i)}r.prototype.init=function(t,n,i){this.assignments=[],this.centroids=[],typeof t<"u"&&(this.dataset=t),typeof n<"u"&&(this.k=n),typeof i<"u"&&(this.distance=i)},r.prototype.run=function(t,n){this.init(t,n);for(var i=this.dataset.length,l=0;l<this.k;l++)this.centroids[l]=this.randomCentroid();for(var p=!0;p;){p=this.assign();for(var u=0;u<this.k;u++){for(var _=new Array(O),m=0,S=0;S<O;S++)_[S]=0;for(var P=0;P<i;P++){var O=this.dataset[P].length;if(u===this.assignments[P]){for(var S=0;S<O;S++)_[S]+=this.dataset[P][S];m++}}if(m>0){for(var S=0;S<O;S++)_[S]/=m;this.centroids[u]=_}else this.centroids[u]=this.randomCentroid(),p=!0}}return this.getClusters()},r.prototype.randomCentroid=function(){var t=this.dataset.length-1,n,i;do i=Math.round(Math.random()*t),n=this.dataset[i];while(this.centroids.indexOf(n)>=0);return n},r.prototype.assign=function(){for(var t=!1,n=this.dataset.length,i,l=0;l<n;l++)i=this.argmin(this.dataset[l],this.centroids,this.distance),i!=this.assignments[l]&&(this.assignments[l]=i,t=!0);return t},r.prototype.getClusters=function(){for(var t=new Array(this.k),n,i=0;i<this.assignments.length;i++)n=this.assignments[i],typeof t[n]>"u"&&(t[n]=[]),t[n].push(i);return t},r.prototype.argmin=function(t,n,i){for(var l=Number.MAX_VALUE,p=0,u=n.length,_,m=0;m<u;m++)_=i(t,n[m]),_<l&&(l=_,p=m);return p},r.prototype.distance=function(t,n){for(var i=0,l=Math.min(t.length,n.length);l--;){var p=t[l]-n[l];i+=p*p}return Math.sqrt(i)},e.exports&&(e.exports=r)}(q1)),q1.exports}var V1={exports:{}},X1={exports:{}},uO;function mD(){return uO||(uO=1,function(e){function r(t,n,i){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,n,i)}r.prototype.insert=function(t,n){for(var i=this._queue.length,l=i;l--;){var p=this._priorities[l];this._sorting==="desc"?n>p&&(i=l):n<p&&(i=l)}this._insertAt(t,n,i)},r.prototype.remove=function(t){for(var n=this._queue.length;n--;){var i=this._queue[n];if(t===i){this._queue.splice(n,1),this._priorities.splice(n,1);break}}},r.prototype.forEach=function(t){this._queue.forEach(t)},r.prototype.getElements=function(){return this._queue},r.prototype.getElementPriority=function(t){return this._priorities[t]},r.prototype.getPriorities=function(){return this._priorities},r.prototype.getElementsWithPriorities=function(){for(var t=[],n=0,i=this._queue.length;n<i;n++)t.push([this._queue[n],this._priorities[n]]);return t},r.prototype._init=function(t,n,i){if(t&&n){if(this._queue=[],this._priorities=[],t.length!==n.length)throw new Error("Arrays must have the same length");for(var l=0;l<t.length;l++)this.insert(t[l],n[l])}i&&(this._sorting=i)},r.prototype._insertAt=function(t,n,i){this._queue.length===i?(this._queue.push(t),this._priorities.push(n)):(this._queue.splice(i,0,t),this._priorities.splice(i,0,n))},e.exports&&(e.exports=r)}(X1)),X1.exports}var lO;function w7(){return lO||(lO=1,function(e){if(e.exports)var r=mD();function t(n,i,l,p){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(n,i,l,p)}t.prototype.run=function(n,i,l,p){this._init(n,i,l,p);for(var u=0,_=this.dataset.length;u<_;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var m=this.clusters.length-1;this._orderedList.push(u);var S=new r(null,null,"asc"),P=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,P,S),this._expandCluster(m,S))}return this.clusters},t.prototype.getReachabilityPlot=function(){for(var n=[],i=0,l=this._orderedList.length;i<l;i++){var p=this._orderedList[i],u=this._reachability[p];n.push([p,u])}return n},t.prototype._init=function(n,i,l,p){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}i&&(this.epsilon=i),l&&(this.minPts=l),p&&(this.distance=p)},t.prototype._updateQueue=function(n,i,l){var p=this;this._coreDistance=this._distanceToCore(n),i.forEach(function(u){if(p._processed[u]===void 0){var _=p.distance(p.dataset[n],p.dataset[u]),m=Math.max(p._coreDistance,_);p._reachability[u]===void 0?(p._reachability[u]=m,l.insert(u,m)):m<p._reachability[u]&&(p._reachability[u]=m,l.remove(u),l.insert(u,m))}})},t.prototype._expandCluster=function(n,i){for(var l=i.getElements(),p=0,u=l.length;p<u;p++){var _=l[p];if(this._processed[_]===void 0){var m=this._regionQuery(_);this._processed[_]=1,this.clusters[n].push(_),this._orderedList.push(_),this._distanceToCore(_)!==void 0&&(this._updateQueue(_,m,i),this._expandCluster(n,i))}}},t.prototype._distanceToCore=function(n){for(var i=this.epsilon,l=0;l<i;l++){var p=this._regionQuery(n,l);if(p.length>=this.minPts)return l}},t.prototype._regionQuery=function(n,i){i=i||this.epsilon;for(var l=[],p=0,u=this.dataset.length;p<u;p++)this.distance(this.dataset[n],this.dataset[p])<i&&l.push(p);return l},t.prototype._euclideanDistance=function(n,i){for(var l=0,p=Math.min(n.length,i.length);p--;)l+=(n[p]-i[p])*(n[p]-i[p]);return Math.sqrt(l)},e.exports&&(e.exports=t)}(V1)),V1.exports}(function(e){e.exports&&(e.exports={DBSCAN:b7(),KMEANS:x7(),OPTICS:w7(),PriorityQueue:mD()})})(gD);var E7=gD.exports,zE=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(BE,"__esModule",{value:!0});var S7=zE(ua),P7=zE(Vo),A7=nr,I7=zt,O7=zE(E7);function C7(e,r,t){t===void 0&&(t={}),t.mutate!==!0&&(e=S7.default(e)),t.minPoints=t.minPoints||3;var n=new O7.default.DBSCAN,i=n.run(A7.coordAll(e),I7.convertLength(r,t.units),t.minPoints,P7.default),l=-1;return i.forEach(function(p){l++,p.forEach(function(u){var _=e.features[u];_.properties||(_.properties={}),_.properties.cluster=l,_.properties.dbscan="core"})}),n.noise.forEach(function(p){var u=e.features[p];u.properties||(u.properties={}),u.properties.cluster?u.properties.dbscan="edge":u.properties.dbscan="noise"}),e}BE.default=C7;var jE={},vD={eudist:function(r,t,n){for(var i=r.length,l=0,p=0;p<i;p++){var u=(r[p]||0)-(t[p]||0);l+=u*u}return n?Math.sqrt(l):l},mandist:function(r,t,n){for(var i=r.length,l=0,p=0;p<i;p++)l+=Math.abs((r[p]||0)-(t[p]||0));return n?Math.sqrt(l):l},dist:function(r,t,n){var i=Math.abs(r-t);return n?i:i*i}},yD=vD,T7=yD.eudist,M7=yD.dist,L7={kmrand:function(r,t){for(var n={},i=[],l=t<<2,p=r.length,u=r[0].length>0;i.length<t&&l-- >0;){var _=r[Math.floor(Math.random()*p)],m=u?_.join("_"):""+_;n[m]||(n[m]=!0,i.push(_))}if(i.length<t)throw new Error("Error initializating clusters");return i},kmpp:function(r,t){var n=r[0].length?T7:M7,i=[],l=r.length,p=r[0].length>0,u=r[Math.floor(Math.random()*l)];for(p?u.join("_"):""+u,i.push(u);i.length<t;){for(var _=[],m=i.length,S=0,P=[],O=0;O<l;O++){for(var M=1/0,B=0;B<m;B++){var $=n(r[O],i[B]);$<=M&&(M=$)}_[O]=M}for(var q=0;q<l;q++)S+=_[q];for(var X=0;X<l;X++)P[X]={i:X,v:r[X],pr:_[X]/S,cs:0};P.sort(function(H,ue){return H.pr-ue.pr}),P[0].cs=P[0].pr;for(var R=1;R<l;R++)P[R].cs=P[R-1].cs+P[R].pr;for(var k=Math.random(),U=0;U<l-1&&P[U++].cs<k;);i.push(P[U-1].v)}return i}},UE=vD,_D=L7,R7=UE.eudist;UE.mandist;UE.dist;var D7=_D.kmrand,N7=_D.kmpp,cO=1e4;function hO(e,r,t){t=t||[];for(var n=0;n<e;n++)t[n]=r;return t}function F7(e,r,t,n){var i=[],l=[],p=[],u=[],_=!1,m=n||cO,S=e.length,P=e[0].length,O=P>0,M=[];if(t)t=="kmrand"?i=D7(e,r):t=="kmpp"?i=N7(e,r):i=t;else for(var B={};i.length<r;){var $=Math.floor(Math.random()*S);B[$]||(B[$]=!0,i.push(e[$]))}do{hO(r,0,M);for(var q=0;q<S;q++){for(var X=1/0,R=0,k=0;k<r;k++){var u=O?R7(e[q],i[k]):Math.abs(e[q]-i[k]);u<=X&&(X=u,R=k)}p[q]=R,M[R]++}for(var U=[],l=[],H=0;H<r;H++)U[H]=O?hO(P,0,U[H]):0,l[H]=i[H];if(O){for(var ue=0;ue<r;ue++)i[ue]=[];for(var ie=0;ie<S;ie++)for(var ee=p[ie],W=U[ee],J=e[ie],be=0;be<P;be++)W[be]+=J[be];_=!0;for(var Oe=0;Oe<r;Oe++){for(var Ae=i[Oe],ae=U[Oe],ct=l[Oe],Pe=M[Oe],V=0;V<P;V++)Ae[V]=ae[V]/Pe||0;if(_){for(var Q=0;Q<P;Q++)if(ct[Q]!=Ae[Q]){_=!1;break}}}}else{for(var he=0;he<S;he++){var fe=p[he];U[fe]+=e[he]}for(var ye=0;ye<r;ye++)i[ye]=U[ye]/M[ye]||0;_=!0;for(var se=0;se<r;se++)if(l[se]!=i[se]){_=!1;break}}_=_||--m<=0}while(!_);return{it:cO-m,k:r,idxs:p,centroids:i}}var k7=F7,bD=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jE,"__esModule",{value:!0});var B7=bD(ua),fO=nr,z7=bD(k7);function j7(e,r){r===void 0&&(r={});var t=e.features.length;r.numberOfClusters=r.numberOfClusters||Math.round(Math.sqrt(t/2)),r.numberOfClusters>t&&(r.numberOfClusters=t),r.mutate!==!0&&(e=B7.default(e));var n=fO.coordAll(e),i=n.slice(0,r.numberOfClusters),l=z7.default(n,r.numberOfClusters,i),p={};return l.centroids.forEach(function(u,_){p[_]=u}),fO.featureEach(e,function(u,_){var m=l.idxs[_];u.properties.cluster=m,u.properties.centroid=p[m]}),e}jE.default=j7;var $E={},GE=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($E,"__esModule",{value:!0});var pO=GE(hh),dO=GE(fh),gO=GE(dh),mO=zt;function U7(e,r){if(!e)throw new Error("line1 is required");if(!r)throw new Error("line2 is required");var t=vO(e,"line1");if(t!=="LineString")throw new Error("line1 must be a LineString");var n=vO(r,"line2");if(n!=="LineString")throw new Error("line2 must be a LineString");for(var i=dO.default(pO.default(e)).features,l=dO.default(pO.default(r)).features,p=0;p<i.length;p++){var u=i[p].geometry.coordinates;if(!l[p])break;var _=l[p].geometry.coordinates;if(!$7(u,_))return!1}return!0}function $7(e,r){var t=mO.bearingToAzimuth(gO.default(e[0],e[1])),n=mO.bearingToAzimuth(gO.default(r[0],r[1]));return t===n}function vO(e,r){if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error("Invalid GeoJSON object for "+r)}$E.default=U7;var qE={exports:{}},G7=ja,q7=ps,V7=Vo,X7=WR,Y7=hh,W7=_d,im=vr,gl=zt;function Mf(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var yO=Mf(G7),Z7=Mf(q7),_p=Mf(V7),H7=Mf(X7),J7=Mf(Y7),K7=Mf(W7);function _O(e){for(var r=e,t=[];r.parent;)t.unshift(r),r=r.parent;return t}function Q7(){return new xD(function(e){return e.f})}var Xv={search:function(e,r,t,n){e.cleanDirty(),n=n||{};var i=n.heuristic||Xv.heuristics.manhattan,l=n.closest||!1,p=Q7(),u=r;for(r.h=i(r,t),p.push(r);p.size()>0;){var _=p.pop();if(_===t)return _O(_);_.closed=!0;for(var m=e.neighbors(_),S=0,P=m.length;S<P;++S){var O=m[S];if(!(O.closed||O.isWall())){var M=_.g+O.getCost(_),B=O.visited;(!B||M<O.g)&&(O.visited=!0,O.parent=_,O.h=O.h||i(O,t),O.g=M,O.f=O.g+O.h,e.markDirty(O),l&&(O.h<u.h||O.h===u.h&&O.g<u.g)&&(u=O),B?p.rescoreElement(O):p.push(O))}}}return l?_O(u):[]},heuristics:{manhattan:function(e,r){var t=Math.abs(r.x-e.x),n=Math.abs(r.y-e.y);return t+n},diagonal:function(e,r){var t=1,n=Math.sqrt(2),i=Math.abs(r.x-e.x),l=Math.abs(r.y-e.y);return t*(i+l)+(n-2*t)*Math.min(i,l)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function Lf(e,r){r=r||{},this.nodes=[],this.diagonal=!!r.diagonal,this.grid=[];for(var t=0;t<e.length;t++){this.grid[t]=[];for(var n=0,i=e[t];n<i.length;n++){var l=new Yv(t,n,i[n]);this.grid[t][n]=l,this.nodes.push(l)}}this.init()}Lf.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)Xv.cleanNode(this.nodes[e])};Lf.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)Xv.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]};Lf.prototype.markDirty=function(e){this.dirtyNodes.push(e)};Lf.prototype.neighbors=function(e){var r=[],t=e.x,n=e.y,i=this.grid;return i[t-1]&&i[t-1][n]&&r.push(i[t-1][n]),i[t+1]&&i[t+1][n]&&r.push(i[t+1][n]),i[t]&&i[t][n-1]&&r.push(i[t][n-1]),i[t]&&i[t][n+1]&&r.push(i[t][n+1]),this.diagonal&&(i[t-1]&&i[t-1][n-1]&&r.push(i[t-1][n-1]),i[t+1]&&i[t+1][n-1]&&r.push(i[t+1][n-1]),i[t-1]&&i[t-1][n+1]&&r.push(i[t-1][n+1]),i[t+1]&&i[t+1][n+1]&&r.push(i[t+1][n+1])),r};Lf.prototype.toString=function(){for(var e=[],r=this.grid,t,n,i,l,p=0,u=r.length;p<u;p++){for(t=[],n=r[p],i=0,l=n.length;i<l;i++)t.push(n[i].weight);e.push(t.join(" "))}return e.join(`
`)};function Yv(e,r,t){this.x=e,this.y=r,this.weight=t}Yv.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};Yv.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?this.weight*1.41421:this.weight};Yv.prototype.isWall=function(){return this.weight===0};function xD(e){this.content=[],this.scoreFunction=e}xD.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],r=this.content.pop();return this.content.length>0&&(this.content[0]=r,this.bubbleUp(0)),e},remove:function(e){var r=this.content.indexOf(e),t=this.content.pop();r!==this.content.length-1&&(this.content[r]=t,this.scoreFunction(t)<this.scoreFunction(e)?this.sinkDown(r):this.bubbleUp(r))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var r=this.content[e];e>0;){var t=(e+1>>1)-1,n=this.content[t];if(this.scoreFunction(r)<this.scoreFunction(n))this.content[t]=r,this.content[e]=n,e=t;else break}},bubbleUp:function(e){for(var r=this.content.length,t=this.content[e],n=this.scoreFunction(t);;){var i=e+1<<1,l=i-1,p=null,u;if(l<r){var _=this.content[l];u=this.scoreFunction(_),u<n&&(p=l)}if(i<r){var m=this.content[i],S=this.scoreFunction(m);S<(p===null?n:u)&&(p=i)}if(p!==null)this.content[e]=this.content[p],this.content[p]=t,e=p;else break}}};function wD(e,r,t){if(t=t||{},!gl.isObject(t))throw new Error("options is invalid");var n=t.resolution,i=t.minDistance,l=t.obstacles||gl.featureCollection([]);if(!e)throw new Error("start is required");if(!r)throw new Error("end is required");if(n&&!gl.isNumber(n)||n<=0)throw new Error("options.resolution must be a number, greater than 0");if(i)throw new Error("options.minDistance is not yet implemented");var p=im.getCoord(e),u=im.getCoord(r);switch(e=gl.point(p),r=gl.point(u),im.getType(l)){case"FeatureCollection":if(l.features.length===0)return gl.lineString([p,u]);break;case"Polygon":l=gl.featureCollection([gl.feature(im.getGeom(l))]);break;default:throw new Error("invalid obstacles")}var _=l;_.features.push(e),_.features.push(r);var m=yO.default(H7.default(K7.default(yO.default(_)),1.15));if(!n){var S=_p.default([m[0],m[1]],[m[2],m[1]],t);n=S/100}_.features.pop(),_.features.pop();for(var P=m[0],O=m[1],M=m[2],B=m[3],$=n/_p.default([P,O],[M,O],t),q=$*(M-P),X=n/_p.default([P,O],[P,B],t),R=X*(B-O),k=M-P,U=B-O,H=Math.floor(k/q),ue=Math.floor(U/R),ie=(k-H*q)/2,ee=(U-ue*R)/2,W=[],J=[],be=[],Oe=[],Ae=1/0,ae=1/0,ct=B-ee,Pe=0;ct>=O;){for(var V=[],Q=[],he=P+ie,fe=0;he<=M;){var ye=gl.point([he,ct]),se=eX(ye,l);V.push(se?0:1),Q.push(he+"|"+ct);var De=_p.default(ye,e);!se&&De<Ae&&(Ae=De,be={x:fe,y:Pe});var ke=_p.default(ye,r);!se&&ke<ae&&(ae=ke,Oe={x:fe,y:Pe}),he+=q,fe++}J.push(V),W.push(Q),ct-=R,Pe++}var We=new Lf(J,{diagonal:!0}),He=We.grid[be.y][be.x],dt=We.grid[Oe.y][Oe.x],yt=Xv.search(We,He,dt),Lt=[p];return yt.forEach(function(pt){var Ct=W[pt.x][pt.y].split("|");Lt.push([+Ct[0],+Ct[1]])}),Lt.push(u),J7.default(gl.lineString(Lt))}function eX(e,r){for(var t=0;t<r.features.length;t++)if(Z7.default(e,r.features[t]))return!0;return!1}qE.exports=wD;qE.exports.default=wD;var tX=qE.exports,VE={exports:{}};function bO(e){return function(){return e}}function rX(e){return e[0]}function nX(e){return e[1]}function $m(){this._=null}function Wv(e){e.U=e.C=e.L=e.R=e.P=e.N=null}$m.prototype={constructor:$m,insert:function(e,r){var t,n,i;if(e){if(r.P=e,r.N=e.N,e.N&&(e.N.P=r),e.N=r,e.R){for(e=e.R;e.L;)e=e.L;e.L=r}else e.R=r;t=e}else this._?(e=xO(this._),r.P=null,r.N=e,e.P=e.L=r,t=e):(r.P=r.N=null,this._=r,t=null);for(r.L=r.R=null,r.U=t,r.C=!0,e=r;t&&t.C;)n=t.U,t===n.L?(i=n.R,i&&i.C?(t.C=i.C=!1,n.C=!0,e=n):(e===t.R&&(bp(this,t),e=t,t=e.U),t.C=!1,n.C=!0,xp(this,n))):(i=n.L,i&&i.C?(t.C=i.C=!1,n.C=!0,e=n):(e===t.L&&(xp(this,t),e=t,t=e.U),t.C=!1,n.C=!0,bp(this,n))),t=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var r=e.U,t,n=e.L,i=e.R,l,p;if(n?i?l=xO(i):l=n:l=i,r?r.L===e?r.L=l:r.R=l:this._=l,n&&i?(p=l.C,l.C=e.C,l.L=n,n.U=l,l!==i?(r=l.U,l.U=e.U,e=l.R,r.L=e,l.R=i,i.U=l):(l.U=r,r=l,e=l.R)):(p=e.C,e=l),e&&(e.U=r),!p){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===r.L){if(t=r.R,t.C&&(t.C=!1,r.C=!0,bp(this,r),t=r.R),t.L&&t.L.C||t.R&&t.R.C){(!t.R||!t.R.C)&&(t.L.C=!1,t.C=!0,xp(this,t),t=r.R),t.C=r.C,r.C=t.R.C=!1,bp(this,r),e=this._;break}}else if(t=r.L,t.C&&(t.C=!1,r.C=!0,xp(this,r),t=r.L),t.L&&t.L.C||t.R&&t.R.C){(!t.L||!t.L.C)&&(t.R.C=!1,t.C=!0,bp(this,t),t=r.L),t.C=r.C,r.C=t.L.C=!1,xp(this,r),e=this._;break}t.C=!0,e=r,r=r.U}while(!e.C);e&&(e.C=!1)}}};function bp(e,r){var t=r,n=r.R,i=t.U;i?i.L===t?i.L=n:i.R=n:e._=n,n.U=i,t.U=n,t.R=n.L,t.R&&(t.R.U=t),n.L=t}function xp(e,r){var t=r,n=r.L,i=t.U;i?i.L===t?i.L=n:i.R=n:e._=n,n.U=i,t.U=n,t.L=n.R,t.L&&(t.L.U=t),n.R=t}function xO(e){for(;e.L;)e=e.L;return e}function Dp(e,r,t,n){var i=[null,null],l=hs.push(i)-1;return i.left=e,i.right=r,t&&Gm(i,e,r,t),n&&Gm(i,r,e,n),mu[e.index].halfedges.push(l),mu[r.index].halfedges.push(l),i}function wp(e,r,t){var n=[r,t];return n.left=e,n}function Gm(e,r,t,n){!e[0]&&!e[1]?(e[0]=n,e.left=r,e.right=t):e.left===t?e[1]=n:e[0]=n}function iX(e,r,t,n,i){var l=e[0],p=e[1],u=l[0],_=l[1],m=p[0],S=p[1],P=0,O=1,M=m-u,B=S-_,$;if($=r-u,!(!M&&$>0)){if($/=M,M<0){if($<P)return;$<O&&(O=$)}else if(M>0){if($>O)return;$>P&&(P=$)}if($=n-u,!(!M&&$<0)){if($/=M,M<0){if($>O)return;$>P&&(P=$)}else if(M>0){if($<P)return;$<O&&(O=$)}if($=t-_,!(!B&&$>0)){if($/=B,B<0){if($<P)return;$<O&&(O=$)}else if(B>0){if($>O)return;$>P&&(P=$)}if($=i-_,!(!B&&$<0)){if($/=B,B<0){if($>O)return;$>P&&(P=$)}else if(B>0){if($<P)return;$<O&&(O=$)}return!(P>0)&&!(O<1)||(P>0&&(e[0]=[u+P*M,_+P*B]),O<1&&(e[1]=[u+O*M,_+O*B])),!0}}}}}function oX(e,r,t,n,i){var l=e[1];if(l)return!0;var p=e[0],u=e.left,_=e.right,m=u[0],S=u[1],P=_[0],O=_[1],M=(m+P)/2,B=(S+O)/2,$,q;if(O===S){if(M<r||M>=n)return;if(m>P){if(!p)p=[M,t];else if(p[1]>=i)return;l=[M,i]}else{if(!p)p=[M,i];else if(p[1]<t)return;l=[M,t]}}else if($=(m-P)/(O-S),q=B-$*M,$<-1||$>1)if(m>P){if(!p)p=[(t-q)/$,t];else if(p[1]>=i)return;l=[(i-q)/$,i]}else{if(!p)p=[(i-q)/$,i];else if(p[1]<t)return;l=[(t-q)/$,t]}else if(S<O){if(!p)p=[r,$*r+q];else if(p[0]>=n)return;l=[n,$*n+q]}else{if(!p)p=[n,$*n+q];else if(p[0]<r)return;l=[r,$*r+q]}return e[0]=p,e[1]=l,!0}function aX(e,r,t,n){for(var i=hs.length,l;i--;)(!oX(l=hs[i],e,r,t,n)||!iX(l,e,r,t,n)||!(Math.abs(l[0][0]-l[1][0])>xi||Math.abs(l[0][1]-l[1][1])>xi))&&delete hs[i]}function sX(e){return mu[e.index]={site:e,halfedges:[]}}function uX(e,r){var t=e.site,n=r.left,i=r.right;return t===i&&(i=n,n=t),i?Math.atan2(i[1]-n[1],i[0]-n[0]):(t===n?(n=r[1],i=r[0]):(n=r[0],i=r[1]),Math.atan2(n[0]-i[0],i[1]-n[1]))}function ED(e,r){return r[+(r.left!==e.site)]}function lX(e,r){return r[+(r.left===e.site)]}function cX(){for(var e=0,r=mu.length,t,n,i,l;e<r;++e)if((t=mu[e])&&(l=(n=t.halfedges).length)){var p=new Array(l),u=new Array(l);for(i=0;i<l;++i)p[i]=i,u[i]=uX(t,hs[n[i]]);for(p.sort(function(_,m){return u[m]-u[_]}),i=0;i<l;++i)u[i]=n[p[i]];for(i=0;i<l;++i)n[i]=u[i]}}function hX(e,r,t,n){var i=mu.length,l,p,u,_,m,S,P,O,M,B,$,q,X=!0;for(l=0;l<i;++l)if(p=mu[l]){for(u=p.site,m=p.halfedges,_=m.length;_--;)hs[m[_]]||m.splice(_,1);for(_=0,S=m.length;_<S;)B=lX(p,hs[m[_]]),$=B[0],q=B[1],P=ED(p,hs[m[++_%S]]),O=P[0],M=P[1],(Math.abs($-O)>xi||Math.abs(q-M)>xi)&&(m.splice(_,0,hs.push(wp(u,B,Math.abs($-e)<xi&&n-q>xi?[e,Math.abs(O-e)<xi?M:n]:Math.abs(q-n)<xi&&t-$>xi?[Math.abs(M-n)<xi?O:t,n]:Math.abs($-t)<xi&&q-r>xi?[t,Math.abs(O-t)<xi?M:r]:Math.abs(q-r)<xi&&$-e>xi?[Math.abs(M-r)<xi?O:e,r]:null))-1),++S);S&&(X=!1)}if(X){var R,k,U,H=1/0;for(l=0,X=null;l<i;++l)(p=mu[l])&&(u=p.site,R=u[0]-e,k=u[1]-r,U=R*R+k*k,U<H&&(H=U,X=p));if(X){var ue=[e,r],ie=[e,n],ee=[t,n],W=[t,r];X.halfedges.push(hs.push(wp(u=X.site,ue,ie))-1,hs.push(wp(u,ie,ee))-1,hs.push(wp(u,ee,W))-1,hs.push(wp(u,W,ue))-1)}}for(l=0;l<i;++l)(p=mu[l])&&(p.halfedges.length||delete mu[l])}var SD=[],XE;function fX(){Wv(this),this.x=this.y=this.arc=this.site=this.cy=null}function af(e){var r=e.P,t=e.N;if(!(!r||!t)){var n=r.site,i=e.site,l=t.site;if(n!==l){var p=i[0],u=i[1],_=n[0]-p,m=n[1]-u,S=l[0]-p,P=l[1]-u,O=2*(_*P-m*S);if(!(O>=-vX)){var M=_*_+m*m,B=S*S+P*P,$=(P*M-m*B)/O,q=(_*B-S*M)/O,X=SD.pop()||new fX;X.arc=e,X.site=i,X.x=$+p,X.y=(X.cy=q+u)+Math.sqrt($*$+q*q),e.circle=X;for(var R=null,k=sd._;k;)if(X.y<k.y||X.y===k.y&&X.x<=k.x)if(k.L)k=k.L;else{R=k.P;break}else if(k.R)k=k.R;else{R=k;break}sd.insert(R,X),R||(XE=X)}}}}function cf(e){var r=e.circle;r&&(r.P||(XE=r.N),sd.remove(r),SD.push(r),Wv(r),e.circle=null)}var PD=[];function pX(){Wv(this),this.edge=this.site=this.circle=null}function wO(e){var r=PD.pop()||new pX;return r.site=e,r}function Y1(e){cf(e),hf.remove(e),PD.push(e),Wv(e)}function dX(e){var r=e.circle,t=r.x,n=r.cy,i=[t,n],l=e.P,p=e.N,u=[e];Y1(e);for(var _=l;_.circle&&Math.abs(t-_.circle.x)<xi&&Math.abs(n-_.circle.cy)<xi;)l=_.P,u.unshift(_),Y1(_),_=l;u.unshift(_),cf(_);for(var m=p;m.circle&&Math.abs(t-m.circle.x)<xi&&Math.abs(n-m.circle.cy)<xi;)p=m.N,u.push(m),Y1(m),m=p;u.push(m),cf(m);var S=u.length,P;for(P=1;P<S;++P)m=u[P],_=u[P-1],Gm(m.edge,_.site,m.site,i);_=u[0],m=u[S-1],m.edge=Dp(_.site,m.site,null,i),af(_),af(m)}function gX(e){for(var r=e[0],t=e[1],n,i,l,p,u=hf._;u;)if(l=AD(u,t)-r,l>xi)u=u.L;else if(p=r-mX(u,t),p>xi){if(!u.R){n=u;break}u=u.R}else{l>-xi?(n=u.P,i=u):p>-xi?(n=u,i=u.N):n=i=u;break}sX(e);var _=wO(e);if(hf.insert(n,_),!(!n&&!i)){if(n===i){cf(n),i=wO(n.site),hf.insert(_,i),_.edge=i.edge=Dp(n.site,_.site),af(n),af(i);return}if(!i){_.edge=Dp(n.site,_.site);return}cf(n),cf(i);var m=n.site,S=m[0],P=m[1],O=e[0]-S,M=e[1]-P,B=i.site,$=B[0]-S,q=B[1]-P,X=2*(O*q-M*$),R=O*O+M*M,k=$*$+q*q,U=[(q*R-M*k)/X+S,(O*k-$*R)/X+P];Gm(i.edge,m,B,U),_.edge=Dp(m,e,null,U),i.edge=Dp(e,B,null,U),af(n),af(i)}}function AD(e,r){var t=e.site,n=t[0],i=t[1],l=i-r;if(!l)return n;var p=e.P;if(!p)return-1/0;t=p.site;var u=t[0],_=t[1],m=_-r;if(!m)return u;var S=u-n,P=1/l-1/m,O=S/m;return P?(-O+Math.sqrt(O*O-2*P*(S*S/(-2*m)-_+m/2+i-l/2)))/P+n:(n+u)/2}function mX(e,r){var t=e.N;if(t)return AD(t,r);var n=e.site;return n[1]===r?n[0]:1/0}var xi=1e-6,vX=1e-12,hf,mu,sd,hs;function yX(e,r,t){return(e[0]-t[0])*(r[1]-e[1])-(e[0]-r[0])*(t[1]-e[1])}function _X(e,r){return r[1]-e[1]||r[0]-e[0]}function Zb(e,r){var t=e.sort(_X).pop(),n,i,l;for(hs=[],mu=new Array(e.length),hf=new $m,sd=new $m;;)if(l=XE,t&&(!l||t[1]<l.y||t[1]===l.y&&t[0]<l.x))(t[0]!==n||t[1]!==i)&&(gX(t),n=t[0],i=t[1]),t=e.pop();else if(l)dX(l.arc);else break;if(cX(),r){var p=+r[0][0],u=+r[0][1],_=+r[1][0],m=+r[1][1];aX(p,u,_,m),hX(p,u,_,m)}this.edges=hs,this.cells=mu,hf=sd=hs=mu=null}Zb.prototype={constructor:Zb,polygons:function(){var e=this.edges;return this.cells.map(function(r){var t=r.halfedges.map(function(n){return ED(r,e[n])});return t.data=r.site.data,t})},triangles:function(){var e=[],r=this.edges;return this.cells.forEach(function(t,n){if(u=(l=t.halfedges).length)for(var i=t.site,l,p=-1,u,_,m=r[l[u-1]],S=m.left===i?m.right:m.left;++p<u;)_=S,m=r[l[p]],S=m.left===i?m.right:m.left,_&&S&&n<_.index&&n<S.index&&yX(i,_,S)<0&&e.push([i.data,_.data,S.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,r,t){for(var n=this,i,l=n._found||0,p=n.cells.length,u;!(u=n.cells[l]);)if(++l>=p)return null;var _=e-u.site[0],m=r-u.site[1],S=_*_+m*m;do u=n.cells[i=l],l=null,u.halfedges.forEach(function(P){var O=n.edges[P],M=O.left;if(!((M===u.site||!M)&&!(M=O.right))){var B=e-M[0],$=r-M[1],q=B*B+$*$;q<S&&(S=q,l=M.index)}});while(l!==null);return n._found=i,t==null||S<=t*t?u.site:null}};function bX(){var e=rX,r=nX,t=null;function n(i){return new Zb(i.map(function(l,p){var u=[Math.round(e(l,p,i)/xi)*xi,Math.round(r(l,p,i)/xi)*xi];return u.index=p,u.data=l,u}),t)}return n.polygons=function(i){return n(i).polygons()},n.links=function(i){return n(i).links()},n.triangles=function(i){return n(i).triangles()},n.x=function(i){return arguments.length?(e=typeof i=="function"?i:bO(+i),n):e},n.y=function(i){return arguments.length?(r=typeof i=="function"?i:bO(+i),n):r},n.extent=function(i){return arguments.length?(t=i==null?null:[[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]],n):t&&[[t[0][0],t[0][1]],[t[1][0],t[1][1]]]},n.size=function(i){return arguments.length?(t=i==null?null:[[0,0],[+i[0],+i[1]]],n):t&&[t[1][0]-t[0][0],t[1][1]-t[0][1]]},n}const xX=Object.freeze(Object.defineProperty({__proto__:null,voronoi:bX},Symbol.toStringTag,{value:"Module"})),wX=Ef(xX);var Hb=zt,EX=vr,SX=wX;function PX(e){return e=e.slice(),e.push(e[0]),Hb.polygon([e])}function ID(e,r){if(r=r||{},!Hb.isObject(r))throw new Error("options is invalid");var t=r.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(t))throw new Error("bbox is invalid");return EX.collectionOf(e,"Point","points"),Hb.featureCollection(SX.voronoi().x(function(n){return n.geometry.coordinates[0]}).y(function(n){return n.geometry.coordinates[1]}).extent([[t[0],t[1]],[t[2],t[3]]]).polygons(e.features).map(PX))}VE.exports=ID;VE.exports.default=ID;var AX=VE.exports,YE={exports:{}},Zh=zt,IX=gh,OX=VR,W1=vr;function OD(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var EO=OD(IX),CX=OD(OX);function CD(e,r,t,n){n=n||{};var i=n.steps||64,l=n.units||"kilometers",p=n.angle||0,u=n.pivot||e,_=n.properties||e.properties||{};if(!e)throw new Error("center is required");if(!r)throw new Error("xSemiAxis is required");if(!t)throw new Error("ySemiAxis is required");if(!Zh.isObject(n))throw new Error("options must be an object");if(!Zh.isNumber(i))throw new Error("steps must be a number");if(!Zh.isNumber(p))throw new Error("angle must be a number");var m=W1.getCoord(e);if(l==="degrees")var S=Zh.degreesToRadians(p);else r=EO.default(e,r,90,{units:l}),t=EO.default(e,t,0,{units:l}),r=W1.getCoord(r)[0]-m[0],t=W1.getCoord(t)[1]-m[1];for(var P=[],O=0;O<i;O+=1){var M=O*-360/i,B=r*t/Math.sqrt(Math.pow(t,2)+Math.pow(r,2)*Math.pow(SO(M),2)),$=r*t/Math.sqrt(Math.pow(r,2)+Math.pow(t,2)/Math.pow(SO(M),2));if(M<-90&&M>=-270&&(B=-B),M<-180&&M>=-360&&($=-$),l==="degrees"){var q=B*Math.cos(S)+$*Math.sin(S),X=$*Math.cos(S)-B*Math.sin(S);B=q,$=X}P.push([B+m[0],$+m[1]])}return P.push(P[0]),l==="degrees"?Zh.polygon([P],_):CX.default(Zh.polygon([P],_),p,{pivot:u})}function SO(e){var r=e*Math.PI/180;return Math.tan(r)}YE.exports=CD;YE.exports.default=CD;var TD=YE.exports,Od={};Object.defineProperty(Od,"__esModule",{value:!0});var PO=nr,AO=zt;function TX(e,r){r===void 0&&(r={});var t=0,n=0,i=0;return PO.geomEach(e,function(l,p,u){var _=r.weight?u==null?void 0:u[r.weight]:void 0;if(_=_??1,!AO.isNumber(_))throw new Error("weight value must be a number for feature index "+p);_=Number(_),_>0&&PO.coordEach(l,function(m){t+=m[0]*_,n+=m[1]*_,i+=_})}),AO.point([t/i,n/i],r.properties,r)}Od.default=TX;var WE={},ZE=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(WE,"__esModule",{value:!0});var MX=ZE(Od),LX=ZE(Vo),RX=ZE(Kl),Xp=zt,MD=nr;function DX(e,r){if(r===void 0&&(r={}),r=r||{},!Xp.isObject(r))throw new Error("options is invalid");var t=r.counter||10;if(!Xp.isNumber(t))throw new Error("counter must be a number");var n=r.weight,i=MX.default(e,{weight:r.weight}),l=Xp.featureCollection([]);MD.featureEach(e,function(u){var _;l.features.push(RX.default(u,{properties:{weight:(_=u.properties)===null||_===void 0?void 0:_[n]}}))});var p={tolerance:r.tolerance,medianCandidates:[]};return LD(i.geometry.coordinates,[0,0],l,p,t)}function LD(e,r,t,n,i){var l=n.tolerance||.001,p=0,u=0,_=0,m=0;if(MD.featureEach(t,function(O){var M,B=(M=O.properties)===null||M===void 0?void 0:M.weight,$=B??1;if($=Number($),!Xp.isNumber($))throw new Error("weight value must be a number");if($>0){m+=1;var q=$*LX.default(O,e);q===0&&(q=1);var X=$/q;p+=O.geometry.coordinates[0]*X,u+=O.geometry.coordinates[1]*X,_+=X}}),m<1)throw new Error("no features to measure");var S=p/_,P=u/_;return m===1||i===0||Math.abs(S-r[0])<l&&Math.abs(P-r[1])<l?Xp.point([S,P],{medianCandidates:n.medianCandidates}):(n.medianCandidates.push([S,P]),LD([S,P],e,t,n,i-1))}WE.default=DX;var HE={exports:{}},om=nr,Ep=vr,am=zt,NX=Od,FX=ZM,kX=TD;function JE(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var BX=JE(NX),zX=JE(FX),jX=JE(kX);function RD(e,r){if(r=r||{},!am.isObject(r))throw new Error("options is invalid");var t=r.steps||64,n=r.weight,i=r.properties||{};if(!am.isNumber(t))throw new Error("steps must be a number");if(!am.isObject(i))throw new Error("properties must be a number");var l=om.coordAll(e).length,p=BX.default(e,{weight:n}),u=0,_=0,m=0;om.featureEach(e,function(ie){var ee=ie.properties[n]||1,W=IO(Ep.getCoords(ie),Ep.getCoords(p));u+=Math.pow(W.x,2)*ee,_+=Math.pow(W.y,2)*ee,m+=W.x*W.y*ee});var S=u-_,P=Math.sqrt(Math.pow(S,2)+4*Math.pow(m,2)),O=2*m,M=Math.atan((S+P)/O),B=M*180/Math.PI,$=0,q=0,X=0;om.featureEach(e,function(ie){var ee=ie.properties[n]||1,W=IO(Ep.getCoords(ie),Ep.getCoords(p));$+=Math.pow(W.x*Math.cos(M)-W.y*Math.sin(M),2)*ee,q+=Math.pow(W.x*Math.sin(M)+W.y*Math.cos(M),2)*ee,X+=ee});var R=Math.sqrt(2*$/X),k=Math.sqrt(2*q/X),U=jX.default(p,R,k,{units:"degrees",angle:B,steps:t,properties:i}),H=zX.default(e,am.featureCollection([U])),ue={meanCenterCoordinates:Ep.getCoords(p),semiMajorAxis:R,semiMinorAxis:k,numberOfFeatures:l,angle:B,percentageWithinEllipse:100*om.coordAll(H).length/l};return U.properties.standardDeviationalEllipse=ue,U}function IO(e,r){return{x:e[0]-r[0],y:e[1]-r[1]}}HE.exports=RD;HE.exports.default=RD;var UX=HE.exports,KE={},DD=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(KE,"__esModule",{value:!0});var OO=DD(Pc),Z1=zt,CO=DD(dh);function $X(e,r,t,n){if(n===void 0&&(n={}),!Z1.isObject(n))throw new Error("options is invalid");if(!e)throw new Error("startPoint is required");if(!r)throw new Error("midPoint is required");if(!t)throw new Error("endPoint is required");var i=e,l=r,p=t,u=Z1.bearingToAzimuth(n.mercator!==!0?OO.default(i,l):CO.default(i,l)),_=Z1.bearingToAzimuth(n.mercator!==!0?OO.default(p,l):CO.default(p,l)),m=Math.abs(u-_);return n.explementary===!0?360-m:m}KE.default=$X;var QE={exports:{}},eS=nr,Sp=zt;function ND(e,r){var t=[],n=r.iterations||1;if(!e)throw new Error("inputPolys is required");return eS.geomEach(e,function(i,l,p){var u,_,m;switch(i.type){case"Polygon":u=[[]];for(var S=0;S<n;S++)m=[[]],_=i,S>0&&(_=Sp.polygon(u).geometry),GX(_,m),u=m.slice(0);t.push(Sp.polygon(u,p));break;case"MultiPolygon":u=[[[]]];for(var P=0;P<n;P++)m=[[[]]],_=i,P>0&&(_=Sp.multiPolygon(u).geometry),qX(_,m),u=m.slice(0);t.push(Sp.multiPolygon(u,p));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}}),Sp.featureCollection(t)}function GX(e,r){var t=0,n=0;eS.coordEach(e,function(i,l,p,u,_){_>t&&(t=_,n=l,r.push([]));var m=l-n,S=e.coordinates[_][m+1],P=i[0],O=i[1],M=S[0],B=S[1];r[_].push([.75*P+.25*M,.75*O+.25*B]),r[_].push([.25*P+.75*M,.25*O+.75*B])},!0),r.forEach(function(i){i.push(i[0])})}function qX(e,r){var t=0,n=0,i=0;eS.coordEach(e,function(l,p,u,_,m){_>i&&(i=_,n=p,r.push([[]])),m>t&&(t=m,n=p,r[_].push([]));var S=p-n,P=e.coordinates[_][m][S+1],O=l[0],M=l[1],B=P[0],$=P[1];r[_][m].push([.75*O+.25*B,.75*M+.25*$]),r[_][m].push([.25*O+.75*B,.25*M+.75*$])},!0),r.forEach(function(l){l.forEach(function(p){p.push(p[0])})})}QE.exports=ND;QE.exports.default=ND;var VX=QE.exports,tS={},Cd={},XX=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cd,"__esModule",{value:!0});var YX=XX(Kl),TO=vr,WX=nr;function FD(e,r,t){t===void 0&&(t=2);var n=TO.getCoord(e),i=TO.getCoord(r),l=n[0]-i[0],p=n[1]-i[1];return t===1?Math.abs(l)+Math.abs(p):Math.pow(Math.pow(l,t)+Math.pow(p,t),1/t)}Cd.pNormDistance=FD;function ZX(e,r){r=r||{};var t=r.threshold||1e4,n=r.p||2,i=r.binary||!1,l=r.alpha||-1,p=r.standardization||!1,u=[];WX.featureEach(e,function(M){u.push(YX.default(M))});for(var _=[],m=0;m<u.length;m++)_[m]=[];for(var m=0;m<u.length;m++)for(var S=m;S<u.length;S++){m===S&&(_[m][S]=0);var P=FD(u[m],u[S],n);_[m][S]=P,_[S][m]=P}for(var m=0;m<u.length;m++)for(var S=0;S<u.length;S++){var P=_[m][S];P!==0&&(i?P<=t?_[m][S]=1:_[m][S]=0:P<=t?_[m][S]=Math.pow(P,l):_[m][S]=0)}if(p)for(var m=0;m<u.length;m++)for(var O=_[m].reduce(function(B,$){return B+$},0),S=0;S<u.length;S++)_[m][S]=_[m][S]/O;return _}Cd.default=ZX;var HX=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tS,"__esModule",{value:!0});var JX=HX(Cd),KX=nr;function QX(e,r){var t=r.inputField,n=r.threshold||1e5,i=r.p||2,l=r.binary||!1,p=r.alpha||-1,u=r.standardization||!0,_=JX.default(e,{alpha:p,binary:l,p:i,standardization:u,threshold:n}),m=[];KX.featureEach(e,function(be){var Oe=be.properties||{};m.push(Oe[t])});for(var S=kD(m),P=eY(m),O=0,M=0,B=0,$=0,q=_.length,X=0;X<q;X++){for(var R=0,k=0;k<q;k++)O+=_[X][k]*(m[X]-S)*(m[k]-S),M+=_[X][k],B+=Math.pow(_[X][k]+_[k][X],2),R+=_[X][k]+_[k][X];$+=Math.pow(R,2)}B=.5*B;var U=O/M/P,H=-1/(q-1),ue=q*q*B-q*$+3*(M*M),ie=(q-1)*(q+1)*(M*M),ee=ue/ie-H*H,W=Math.sqrt(ee),J=(U-H)/W;return{expectedMoranIndex:H,moranIndex:U,stdNorm:W,zNorm:J}}tS.default=QX;function kD(e){for(var r=0,t=0,n=e;t<n.length;t++){var i=n[t];r+=i}return r/e.length}function eY(e){for(var r=kD(e),t=0,n=0,i=e;n<i.length;n++){var l=i[n];t+=Math.pow(l-r,2)}return t/e.length}var Zv={},tY=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zv,"__esModule",{value:!0});var rY=nr,nY=zt,iY=tY(ua);function oY(e,r){return r===void 0&&(r={}),BD(e,"mercator",r)}Zv.toMercator=oY;function aY(e,r){return r===void 0&&(r={}),BD(e,"wgs84",r)}Zv.toWgs84=aY;function BD(e,r,t){t===void 0&&(t={}),t=t||{};var n=t.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&nY.isNumber(e[0])?e=r==="mercator"?MO(e):LO(e):(n!==!0&&(e=iY.default(e)),rY.coordEach(e,function(i){var l=r==="mercator"?MO(i):LO(i);i[0]=l[0],i[1]=l[1]})),e}function MO(e){var r=Math.PI/180,t=6378137,n=20037508342789244e-9,i=Math.abs(e[0])<=180?e[0]:e[0]-sY(e[0])*360,l=[t*i*r,t*Math.log(Math.tan(Math.PI*.25+.5*e[1]*r))];return l[0]>n&&(l[0]=n),l[0]<-n&&(l[0]=-n),l[1]>n&&(l[1]=n),l[1]<-n&&(l[1]=-n),l}function LO(e){var r=180/Math.PI,t=6378137;return[e[0]*r/t,(Math.PI*.5-2*Math.atan(Math.exp(-e[1]/t)))*r]}function sY(e){return e<0?-1:e>0?1:0}var Rf={},uY=we&&we.__spreadArrays||function(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;for(var n=Array(e),i=0,r=0;r<t;r++)for(var l=arguments[r],p=0,u=l.length;p<u;p++,i++)n[i]=l[p];return n};Object.defineProperty(Rf,"__esModule",{value:!0});var Lu=zt;function Hv(e){return Array.isArray(e)?RO(e):e&&e.bbox?RO(e.bbox):[pY(),dY()]}Rf.randomPosition=Hv;function lY(e,r){r===void 0&&(r={}),e==null&&(e=1);for(var t=[],n=0;n<e;n++)t.push(Lu.point(Hv(r.bbox)));return Lu.featureCollection(t)}Rf.randomPoint=lY;function cY(e,r){r===void 0&&(r={}),e==null&&(e=1),(!Lu.isNumber(r.num_vertices)||r.num_vertices===void 0)&&(r.num_vertices=10),(!Lu.isNumber(r.max_radial_length)||r.max_radial_length===void 0)&&(r.max_radial_length=10);for(var t=[],n=function(l){var p=[],u=uY(Array(r.num_vertices+1)).map(Math.random);u.forEach(function(_,m,S){S[m]=m>0?_+S[m-1]:_}),u.forEach(function(_){_=_*2*Math.PI/u[u.length-1];var m=Math.random();p.push([m*(r.max_radial_length||10)*Math.sin(_),m*(r.max_radial_length||10)*Math.cos(_)])}),p[p.length-1]=p[0],p=p.map(fY(Hv(r.bbox))),t.push(Lu.polygon([p]))},i=0;i<e;i++)n();return Lu.featureCollection(t)}Rf.randomPolygon=cY;function hY(e,r){if(r===void 0&&(r={}),r=r||{},!Lu.isObject(r))throw new Error("options is invalid");var t=r.bbox,n=r.num_vertices,i=r.max_length,l=r.max_rotation;e==null&&(e=1),(!Lu.isNumber(n)||n===void 0||n<2)&&(n=10),(!Lu.isNumber(i)||i===void 0)&&(i=1e-4),(!Lu.isNumber(l)||l===void 0)&&(l=Math.PI/8);for(var p=[],u=0;u<e;u++){for(var _=Hv(t),m=[_],S=0;S<n-1;S++){var P=S===0?Math.random()*2*Math.PI:Math.tan((m[S][1]-m[S-1][1])/(m[S][0]-m[S-1][0])),O=P+(Math.random()-.5)*l*2,M=Math.random()*i;m.push([m[S][0]+M*Math.cos(O),m[S][1]+M*Math.sin(O)])}p.push(Lu.lineString(m))}return Lu.featureCollection(p)}Rf.randomLineString=hY;function fY(e){return function(r){return[r[0]+e[0],r[1]+e[1]]}}function zD(){return Math.random()-.5}function pY(){return zD()*360}function dY(){return zD()*180}function RO(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}var Ql={};Object.defineProperty(Ql,"__esModule",{value:!0});var jD=nr,UD=zt;function gY(e,r){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(r==null)throw new Error("filter is required");var t=[];return jD.featureEach(e,function(n){rS(n.properties,r)&&t.push(n)}),UD.featureCollection(t)}Ql.getCluster=gY;function $D(e,r,t){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(r==null)throw new Error("property is required");for(var n=GD(e,r),i=Object.keys(n),l=0;l<i.length;l++){for(var p=i[l],u=n[p],_=[],m=0;m<u.length;m++)_.push(e.features[u[m]]);t(UD.featureCollection(_),p,l)}}Ql.clusterEach=$D;function mY(e,r,t,n){var i=n;return $D(e,r,function(l,p,u){u===0&&n===void 0?i=l:i=t(i,l,p,u)}),i}Ql.clusterReduce=mY;function GD(e,r){var t={};return jD.featureEach(e,function(n,i){var l=n.properties||{};if(Object.prototype.hasOwnProperty.call(l,String(r))){var p=l[r];Object.prototype.hasOwnProperty.call(t,p)?t[p].push(i):t[p]=[i]}}),t}Ql.createBins=GD;function rS(e,r){if(e===void 0)return!1;var t=typeof r;if(t==="number"||t==="string")return Object.prototype.hasOwnProperty.call(e,r);if(Array.isArray(r)){for(var n=0;n<r.length;n++)if(!rS(e,r[n]))return!1;return!0}else return qD(e,r)}Ql.applyFilter=rS;function qD(e,r){for(var t=Object.keys(r),n=0;n<t.length;n++){var i=t[n];if(e[i]!==r[i])return!1}return!0}Ql.propertiesContainsFilter=qD;function vY(e,r){if(!r)return{};if(!r.length)return{};for(var t={},n=0;n<r.length;n++){var i=r[n];Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}Ql.filterProperties=vY;var nS={exports:{}},VD={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(we,function(){function t(rt,Se){if(!(rt instanceof Se))throw new TypeError("Cannot call a class as a function")}function n(rt,Se){for(var ce=0;ce<Se.length;ce++){var ge=Se[ce];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(rt,ge.key,ge)}}function i(rt,Se,ce){return Se&&n(rt.prototype,Se),ce&&n(rt,ce),rt}/**
 * splaytree v3.1.0
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */var l=function(){function rt(Se,ce){this.next=null,this.key=Se,this.data=ce,this.left=null,this.right=null}return rt}();function p(rt,Se){return rt>Se?1:rt<Se?-1:0}function u(rt,Se,ce){for(var ge=new l(null,null),Be=ge,Xe=ge;;){var $e=ce(rt,Se.key);if($e<0){if(Se.left===null)break;if(ce(rt,Se.left.key)<0){var ht=Se.left;if(Se.left=ht.right,ht.right=Se,Se=ht,Se.left===null)break}Xe.left=Se,Xe=Se,Se=Se.left}else if($e>0){if(Se.right===null)break;if(ce(rt,Se.right.key)>0){var ht=Se.right;if(Se.right=ht.left,ht.left=Se,Se=ht,Se.right===null)break}Be.right=Se,Be=Se,Se=Se.right}else break}return Be.right=Se.left,Xe.left=Se.right,Se.left=ge.right,Se.right=ge.left,Se}function _(rt,Se,ce,ge){var Be=new l(rt,Se);if(ce===null)return Be.left=Be.right=null,Be;ce=u(rt,ce,ge);var Xe=ge(rt,ce.key);return Xe<0?(Be.left=ce.left,Be.right=ce,ce.left=null):Xe>=0&&(Be.right=ce.right,Be.left=ce,ce.right=null),Be}function m(rt,Se,ce){var ge=null,Be=null;if(Se){Se=u(rt,Se,ce);var Xe=ce(Se.key,rt);Xe===0?(ge=Se.left,Be=Se.right):Xe<0?(Be=Se.right,Se.right=null,ge=Se):(ge=Se.left,Se.left=null,Be=Se)}return{left:ge,right:Be}}function S(rt,Se,ce){return Se===null?rt:(rt===null||(Se=u(rt.key,Se,ce),Se.left=rt),Se)}function P(rt,Se,ce,ge,Be){if(rt){ge(""+Se+(ce?"└── ":"├── ")+Be(rt)+`
`);var Xe=Se+(ce?"    ":"│   ");rt.left&&P(rt.left,Xe,!1,ge,Be),rt.right&&P(rt.right,Xe,!0,ge,Be)}}var O=function(){function rt(Se){Se===void 0&&(Se=p),this._root=null,this._size=0,this._comparator=Se}return rt.prototype.insert=function(Se,ce){return this._size++,this._root=_(Se,ce,this._root,this._comparator)},rt.prototype.add=function(Se,ce){var ge=new l(Se,ce);this._root===null&&(ge.left=ge.right=null,this._size++,this._root=ge);var Be=this._comparator,Xe=u(Se,this._root,Be),$e=Be(Se,Xe.key);return $e===0?this._root=Xe:($e<0?(ge.left=Xe.left,ge.right=Xe,Xe.left=null):$e>0&&(ge.right=Xe.right,ge.left=Xe,Xe.right=null),this._size++,this._root=ge),this._root},rt.prototype.remove=function(Se){this._root=this._remove(Se,this._root,this._comparator)},rt.prototype._remove=function(Se,ce,ge){var Be;if(ce===null)return null;ce=u(Se,ce,ge);var Xe=ge(Se,ce.key);return Xe===0?(ce.left===null?Be=ce.right:(Be=u(Se,ce.left,ge),Be.right=ce.right),this._size--,Be):ce},rt.prototype.pop=function(){var Se=this._root;if(Se){for(;Se.left;)Se=Se.left;return this._root=u(Se.key,this._root,this._comparator),this._root=this._remove(Se.key,this._root,this._comparator),{key:Se.key,data:Se.data}}return null},rt.prototype.findStatic=function(Se){for(var ce=this._root,ge=this._comparator;ce;){var Be=ge(Se,ce.key);if(Be===0)return ce;Be<0?ce=ce.left:ce=ce.right}return null},rt.prototype.find=function(Se){return this._root&&(this._root=u(Se,this._root,this._comparator),this._comparator(Se,this._root.key)!==0)?null:this._root},rt.prototype.contains=function(Se){for(var ce=this._root,ge=this._comparator;ce;){var Be=ge(Se,ce.key);if(Be===0)return!0;Be<0?ce=ce.left:ce=ce.right}return!1},rt.prototype.forEach=function(Se,ce){for(var ge=this._root,Be=[],Xe=!1;!Xe;)ge!==null?(Be.push(ge),ge=ge.left):Be.length!==0?(ge=Be.pop(),Se.call(ce,ge),ge=ge.right):Xe=!0;return this},rt.prototype.range=function(Se,ce,ge,Be){for(var Xe=[],$e=this._comparator,ht=this._root,Qe;Xe.length!==0||ht;)if(ht)Xe.push(ht),ht=ht.left;else{if(ht=Xe.pop(),Qe=$e(ht.key,ce),Qe>0)break;if($e(ht.key,Se)>=0&&ge.call(Be,ht))return this;ht=ht.right}return this},rt.prototype.keys=function(){var Se=[];return this.forEach(function(ce){var ge=ce.key;return Se.push(ge)}),Se},rt.prototype.values=function(){var Se=[];return this.forEach(function(ce){var ge=ce.data;return Se.push(ge)}),Se},rt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},rt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},rt.prototype.minNode=function(Se){if(Se===void 0&&(Se=this._root),Se)for(;Se.left;)Se=Se.left;return Se},rt.prototype.maxNode=function(Se){if(Se===void 0&&(Se=this._root),Se)for(;Se.right;)Se=Se.right;return Se},rt.prototype.at=function(Se){for(var ce=this._root,ge=!1,Be=0,Xe=[];!ge;)if(ce)Xe.push(ce),ce=ce.left;else if(Xe.length>0){if(ce=Xe.pop(),Be===Se)return ce;Be++,ce=ce.right}else ge=!0;return null},rt.prototype.next=function(Se){var ce=this._root,ge=null;if(Se.right){for(ge=Se.right;ge.left;)ge=ge.left;return ge}for(var Be=this._comparator;ce;){var Xe=Be(Se.key,ce.key);if(Xe===0)break;Xe<0?(ge=ce,ce=ce.left):ce=ce.right}return ge},rt.prototype.prev=function(Se){var ce=this._root,ge=null;if(Se.left!==null){for(ge=Se.left;ge.right;)ge=ge.right;return ge}for(var Be=this._comparator;ce;){var Xe=Be(Se.key,ce.key);if(Xe===0)break;Xe<0?ce=ce.left:(ge=ce,ce=ce.right)}return ge},rt.prototype.clear=function(){return this._root=null,this._size=0,this},rt.prototype.toList=function(){return $(this._root)},rt.prototype.load=function(Se,ce,ge){ce===void 0&&(ce=[]),ge===void 0&&(ge=!1);var Be=Se.length,Xe=this._comparator;if(ge&&R(Se,ce,0,Be-1,Xe),this._root===null)this._root=M(Se,ce,0,Be),this._size=Be;else{var $e=X(this.toList(),B(Se,ce),Xe);Be=this._size+Be,this._root=q({head:$e},0,Be)}return this},rt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(rt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),rt.prototype.toString=function(Se){Se===void 0&&(Se=function(Be){return String(Be.key)});var ce=[];return P(this._root,"",!0,function(ge){return ce.push(ge)},Se),ce.join("")},rt.prototype.update=function(Se,ce,ge){var Be=this._comparator,Xe=m(Se,this._root,Be),$e=Xe.left,ht=Xe.right;Be(Se,ce)<0?ht=_(ce,ge,ht,Be):$e=_(ce,ge,$e,Be),this._root=S($e,ht,Be)},rt.prototype.split=function(Se){return m(Se,this._root,this._comparator)},rt}();function M(rt,Se,ce,ge){var Be=ge-ce;if(Be>0){var Xe=ce+Math.floor(Be/2),$e=rt[Xe],ht=Se[Xe],Qe=new l($e,ht);return Qe.left=M(rt,Se,ce,Xe),Qe.right=M(rt,Se,Xe+1,ge),Qe}return null}function B(rt,Se){for(var ce=new l(null,null),ge=ce,Be=0;Be<rt.length;Be++)ge=ge.next=new l(rt[Be],Se[Be]);return ge.next=null,ce.next}function $(rt){for(var Se=rt,ce=[],ge=!1,Be=new l(null,null),Xe=Be;!ge;)Se?(ce.push(Se),Se=Se.left):ce.length>0?(Se=Xe=Xe.next=ce.pop(),Se=Se.right):ge=!0;return Xe.next=null,Be.next}function q(rt,Se,ce){var ge=ce-Se;if(ge>0){var Be=Se+Math.floor(ge/2),Xe=q(rt,Se,Be),$e=rt.head;return $e.left=Xe,rt.head=rt.head.next,$e.right=q(rt,Be+1,ce),$e}return null}function X(rt,Se,ce){for(var ge=new l(null,null),Be=ge,Xe=rt,$e=Se;Xe!==null&&$e!==null;)ce(Xe.key,$e.key)<0?(Be.next=Xe,Xe=Xe.next):(Be.next=$e,$e=$e.next),Be=Be.next;return Xe!==null?Be.next=Xe:$e!==null&&(Be.next=$e),ge.next}function R(rt,Se,ce,ge,Be){if(!(ce>=ge)){for(var Xe=rt[ce+ge>>1],$e=ce-1,ht=ge+1;;){do $e++;while(Be(rt[$e],Xe)<0);do ht--;while(Be(rt[ht],Xe)>0);if($e>=ht)break;var Qe=rt[$e];rt[$e]=rt[ht],rt[ht]=Qe,Qe=Se[$e],Se[$e]=Se[ht],Se[ht]=Qe}R(rt,Se,ce,ht,Be),R(rt,Se,ht+1,ge,Be)}}var k=function(Se,ce){return Se.ll.x<=ce.x&&ce.x<=Se.ur.x&&Se.ll.y<=ce.y&&ce.y<=Se.ur.y},U=function(Se,ce){if(ce.ur.x<Se.ll.x||Se.ur.x<ce.ll.x||ce.ur.y<Se.ll.y||Se.ur.y<ce.ll.y)return null;var ge=Se.ll.x<ce.ll.x?ce.ll.x:Se.ll.x,Be=Se.ur.x<ce.ur.x?Se.ur.x:ce.ur.x,Xe=Se.ll.y<ce.ll.y?ce.ll.y:Se.ll.y,$e=Se.ur.y<ce.ur.y?Se.ur.y:ce.ur.y;return{ll:{x:ge,y:Xe},ur:{x:Be,y:$e}}},H=Number.EPSILON;H===void 0&&(H=Math.pow(2,-52));var ue=H*H,ie=function(Se,ce){if(-H<Se&&Se<H&&-H<ce&&ce<H)return 0;var ge=Se-ce;return ge*ge<ue*Se*ce?0:Se<ce?-1:1},ee=function(){function rt(){t(this,rt),this.reset()}return i(rt,[{key:"reset",value:function(){this.xRounder=new W,this.yRounder=new W}},{key:"round",value:function(ce,ge){return{x:this.xRounder.round(ce),y:this.yRounder.round(ge)}}}]),rt}(),W=function(){function rt(){t(this,rt),this.tree=new O,this.round(0)}return i(rt,[{key:"round",value:function(ce){var ge=this.tree.add(ce),Be=this.tree.prev(ge);if(Be!==null&&ie(ge.key,Be.key)===0)return this.tree.remove(ce),Be.key;var Xe=this.tree.next(ge);return Xe!==null&&ie(ge.key,Xe.key)===0?(this.tree.remove(ce),Xe.key):ce}}]),rt}(),J=new ee,be=function(Se,ce){return Se.x*ce.y-Se.y*ce.x},Oe=function(Se,ce){return Se.x*ce.x+Se.y*ce.y},Ae=function(Se,ce,ge){var Be={x:ce.x-Se.x,y:ce.y-Se.y},Xe={x:ge.x-Se.x,y:ge.y-Se.y},$e=be(Be,Xe);return ie($e,0)},ae=function(Se){return Math.sqrt(Oe(Se,Se))},ct=function(Se,ce,ge){var Be={x:ce.x-Se.x,y:ce.y-Se.y},Xe={x:ge.x-Se.x,y:ge.y-Se.y};return be(Xe,Be)/ae(Xe)/ae(Be)},Pe=function(Se,ce,ge){var Be={x:ce.x-Se.x,y:ce.y-Se.y},Xe={x:ge.x-Se.x,y:ge.y-Se.y};return Oe(Xe,Be)/ae(Xe)/ae(Be)},V=function(Se,ce,ge){return ce.y===0?null:{x:Se.x+ce.x/ce.y*(ge-Se.y),y:ge}},Q=function(Se,ce,ge){return ce.x===0?null:{x:ge,y:Se.y+ce.y/ce.x*(ge-Se.x)}},he=function(Se,ce,ge,Be){if(ce.x===0)return Q(ge,Be,Se.x);if(Be.x===0)return Q(Se,ce,ge.x);if(ce.y===0)return V(ge,Be,Se.y);if(Be.y===0)return V(Se,ce,ge.y);var Xe=be(ce,Be);if(Xe==0)return null;var $e={x:ge.x-Se.x,y:ge.y-Se.y},ht=be($e,ce)/Xe,Qe=be($e,Be)/Xe,Vt=Se.x+Qe*ce.x,ir=ge.x+ht*Be.x,it=Se.y+Qe*ce.y,Tt=ge.y+ht*Be.y,Nt=(Vt+ir)/2,Ar=(it+Tt)/2;return{x:Nt,y:Ar}},fe=function(){i(rt,null,[{key:"compare",value:function(ce,ge){var Be=rt.comparePoints(ce.point,ge.point);return Be!==0?Be:(ce.point!==ge.point&&ce.link(ge),ce.isLeft!==ge.isLeft?ce.isLeft?1:-1:se.compare(ce.segment,ge.segment))}},{key:"comparePoints",value:function(ce,ge){return ce.x<ge.x?-1:ce.x>ge.x?1:ce.y<ge.y?-1:ce.y>ge.y?1:0}}]);function rt(Se,ce){t(this,rt),Se.events===void 0?Se.events=[this]:Se.events.push(this),this.point=Se,this.isLeft=ce}return i(rt,[{key:"link",value:function(ce){if(ce.point===this.point)throw new Error("Tried to link already linked events");for(var ge=ce.point.events,Be=0,Xe=ge.length;Be<Xe;Be++){var $e=ge[Be];this.point.events.push($e),$e.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var ce=this.point.events.length,ge=0;ge<ce;ge++){var Be=this.point.events[ge];if(Be.segment.consumedBy===void 0)for(var Xe=ge+1;Xe<ce;Xe++){var $e=this.point.events[Xe];$e.consumedBy===void 0&&Be.otherSE.point.events===$e.otherSE.point.events&&Be.segment.consume($e.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var ce=[],ge=0,Be=this.point.events.length;ge<Be;ge++){var Xe=this.point.events[ge];Xe!==this&&!Xe.segment.ringOut&&Xe.segment.isInResult()&&ce.push(Xe)}return ce}},{key:"getLeftmostComparator",value:function(ce){var ge=this,Be=new Map,Xe=function(ht){var Qe=ht.otherSE;Be.set(ht,{sine:ct(ge.point,ce.point,Qe.point),cosine:Pe(ge.point,ce.point,Qe.point)})};return function($e,ht){Be.has($e)||Xe($e),Be.has(ht)||Xe(ht);var Qe=Be.get($e),Vt=Qe.sine,ir=Qe.cosine,it=Be.get(ht),Tt=it.sine,Nt=it.cosine;return Vt>=0&&Tt>=0?ir<Nt?1:ir>Nt?-1:0:Vt<0&&Tt<0?ir<Nt?-1:ir>Nt?1:0:Tt<Vt?-1:Tt>Vt?1:0}}}]),rt}(),ye=0,se=function(){i(rt,null,[{key:"compare",value:function(ce,ge){var Be=ce.leftSE.point.x,Xe=ge.leftSE.point.x,$e=ce.rightSE.point.x,ht=ge.rightSE.point.x;if(ht<Be)return 1;if($e<Xe)return-1;var Qe=ce.leftSE.point.y,Vt=ge.leftSE.point.y,ir=ce.rightSE.point.y,it=ge.rightSE.point.y;if(Be<Xe){if(Vt<Qe&&Vt<ir)return 1;if(Vt>Qe&&Vt>ir)return-1;var Tt=ce.comparePoint(ge.leftSE.point);if(Tt<0)return 1;if(Tt>0)return-1;var Nt=ge.comparePoint(ce.rightSE.point);return Nt!==0?Nt:-1}if(Be>Xe){if(Qe<Vt&&Qe<it)return-1;if(Qe>Vt&&Qe>it)return 1;var Ar=ge.comparePoint(ce.leftSE.point);if(Ar!==0)return Ar;var Ir=ce.comparePoint(ge.rightSE.point);return Ir<0?1:Ir>0?-1:1}if(Qe<Vt)return-1;if(Qe>Vt)return 1;if($e<ht){var Rt=ge.comparePoint(ce.rightSE.point);if(Rt!==0)return Rt}if($e>ht){var sn=ce.comparePoint(ge.rightSE.point);if(sn<0)return 1;if(sn>0)return-1}if($e!==ht){var un=ir-Qe,Gn=$e-Be,rn=it-Vt,qr=ht-Xe;if(un>Gn&&rn<qr)return 1;if(un<Gn&&rn>qr)return-1}return $e>ht?1:$e<ht||ir<it?-1:ir>it?1:ce.id<ge.id?-1:ce.id>ge.id?1:0}}]);function rt(Se,ce,ge,Be){t(this,rt),this.id=++ye,this.leftSE=Se,Se.segment=this,Se.otherSE=ce,this.rightSE=ce,ce.segment=this,ce.otherSE=Se,this.rings=ge,this.windings=Be}return i(rt,[{key:"replaceRightSE",value:function(ce){this.rightSE=ce,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var ce=this.leftSE.point.y,ge=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:ce<ge?ce:ge},ur:{x:this.rightSE.point.x,y:ce>ge?ce:ge}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(ce){return ce.x===this.leftSE.point.x&&ce.y===this.leftSE.point.y||ce.x===this.rightSE.point.x&&ce.y===this.rightSE.point.y}},{key:"comparePoint",value:function(ce){if(this.isAnEndpoint(ce))return 0;var ge=this.leftSE.point,Be=this.rightSE.point,Xe=this.vector();if(ge.x===Be.x)return ce.x===ge.x?0:ce.x<ge.x?1:-1;var $e=(ce.y-ge.y)/Xe.y,ht=ge.x+$e*Xe.x;if(ce.x===ht)return 0;var Qe=(ce.x-ge.x)/Xe.x,Vt=ge.y+Qe*Xe.y;return ce.y===Vt?0:ce.y<Vt?-1:1}},{key:"getIntersection",value:function(ce){var ge=this.bbox(),Be=ce.bbox(),Xe=U(ge,Be);if(Xe===null)return null;var $e=this.leftSE.point,ht=this.rightSE.point,Qe=ce.leftSE.point,Vt=ce.rightSE.point,ir=k(ge,Qe)&&this.comparePoint(Qe)===0,it=k(Be,$e)&&ce.comparePoint($e)===0,Tt=k(ge,Vt)&&this.comparePoint(Vt)===0,Nt=k(Be,ht)&&ce.comparePoint(ht)===0;if(it&&ir)return Nt&&!Tt?ht:!Nt&&Tt?Vt:null;if(it)return Tt&&$e.x===Vt.x&&$e.y===Vt.y?null:$e;if(ir)return Nt&&ht.x===Qe.x&&ht.y===Qe.y?null:Qe;if(Nt&&Tt)return null;if(Nt)return ht;if(Tt)return Vt;var Ar=he($e,this.vector(),Qe,ce.vector());return Ar===null||!k(Xe,Ar)?null:J.round(Ar.x,Ar.y)}},{key:"split",value:function(ce){var ge=[],Be=ce.events!==void 0,Xe=new fe(ce,!0),$e=new fe(ce,!1),ht=this.rightSE;this.replaceRightSE($e),ge.push($e),ge.push(Xe);var Qe=new rt(Xe,ht,this.rings.slice(),this.windings.slice());return fe.comparePoints(Qe.leftSE.point,Qe.rightSE.point)>0&&Qe.swapEvents(),fe.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Be&&(Xe.checkForConsuming(),$e.checkForConsuming()),ge}},{key:"swapEvents",value:function(){var ce=this.rightSE;this.rightSE=this.leftSE,this.leftSE=ce,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var ge=0,Be=this.windings.length;ge<Be;ge++)this.windings[ge]*=-1}},{key:"consume",value:function(ce){for(var ge=this,Be=ce;ge.consumedBy;)ge=ge.consumedBy;for(;Be.consumedBy;)Be=Be.consumedBy;var Xe=rt.compare(ge,Be);if(Xe!==0){if(Xe>0){var $e=ge;ge=Be,Be=$e}if(ge.prev===Be){var ht=ge;ge=Be,Be=ht}for(var Qe=0,Vt=Be.rings.length;Qe<Vt;Qe++){var ir=Be.rings[Qe],it=Be.windings[Qe],Tt=ge.rings.indexOf(ir);Tt===-1?(ge.rings.push(ir),ge.windings.push(it)):ge.windings[Tt]+=it}Be.rings=null,Be.windings=null,Be.consumedBy=ge,Be.leftSE.consumedBy=ge.leftSE,Be.rightSE.consumedBy=ge.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var ce=this.prev.consumedBy||this.prev;this._beforeState=ce.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var ce=this.beforeState();this._afterState={rings:ce.rings.slice(0),windings:ce.windings.slice(0),multiPolys:[]};for(var ge=this._afterState.rings,Be=this._afterState.windings,Xe=this._afterState.multiPolys,$e=0,ht=this.rings.length;$e<ht;$e++){var Qe=this.rings[$e],Vt=this.windings[$e],ir=ge.indexOf(Qe);ir===-1?(ge.push(Qe),Be.push(Vt)):Be[ir]+=Vt}for(var it=[],Tt=[],Nt=0,Ar=ge.length;Nt<Ar;Nt++)if(Be[Nt]!==0){var Ir=ge[Nt],Rt=Ir.poly;if(Tt.indexOf(Rt)===-1)if(Ir.isExterior)it.push(Rt);else{Tt.indexOf(Rt)===-1&&Tt.push(Rt);var sn=it.indexOf(Ir.poly);sn!==-1&&it.splice(sn,1)}}for(var un=0,Gn=it.length;un<Gn;un++){var rn=it[un].multiPoly;Xe.indexOf(rn)===-1&&Xe.push(rn)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var ce=this.beforeState().multiPolys,ge=this.afterState().multiPolys;switch(Ye.type){case"union":{var Be=ce.length===0,Xe=ge.length===0;this._isInResult=Be!==Xe;break}case"intersection":{var $e,ht;ce.length<ge.length?($e=ce.length,ht=ge.length):($e=ge.length,ht=ce.length),this._isInResult=ht===Ye.numMultiPolys&&$e<ht;break}case"xor":{var Qe=Math.abs(ce.length-ge.length);this._isInResult=Qe%2===1;break}case"difference":{var Vt=function(it){return it.length===1&&it[0].isSubject};this._isInResult=Vt(ce)!==Vt(ge);break}default:throw new Error("Unrecognized operation type found ".concat(Ye.type))}return this._isInResult}}],[{key:"fromRing",value:function(ce,ge,Be){var Xe,$e,ht,Qe=fe.comparePoints(ce,ge);if(Qe<0)Xe=ce,$e=ge,ht=1;else if(Qe>0)Xe=ge,$e=ce,ht=-1;else throw new Error("Tried to create degenerate segment at [".concat(ce.x,", ").concat(ce.y,"]"));var Vt=new fe(Xe,!0),ir=new fe($e,!1);return new rt(Vt,ir,[Be],[ht])}}]),rt}(),De=function(){function rt(Se,ce,ge){if(t(this,rt),!Array.isArray(Se)||Se.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=ce,this.isExterior=ge,this.segments=[],typeof Se[0][0]!="number"||typeof Se[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Be=J.round(Se[0][0],Se[0][1]);this.bbox={ll:{x:Be.x,y:Be.y},ur:{x:Be.x,y:Be.y}};for(var Xe=Be,$e=1,ht=Se.length;$e<ht;$e++){if(typeof Se[$e][0]!="number"||typeof Se[$e][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Qe=J.round(Se[$e][0],Se[$e][1]);Qe.x===Xe.x&&Qe.y===Xe.y||(this.segments.push(se.fromRing(Xe,Qe,this)),Qe.x<this.bbox.ll.x&&(this.bbox.ll.x=Qe.x),Qe.y<this.bbox.ll.y&&(this.bbox.ll.y=Qe.y),Qe.x>this.bbox.ur.x&&(this.bbox.ur.x=Qe.x),Qe.y>this.bbox.ur.y&&(this.bbox.ur.y=Qe.y),Xe=Qe)}(Be.x!==Xe.x||Be.y!==Xe.y)&&this.segments.push(se.fromRing(Xe,Be,this))}return i(rt,[{key:"getSweepEvents",value:function(){for(var ce=[],ge=0,Be=this.segments.length;ge<Be;ge++){var Xe=this.segments[ge];ce.push(Xe.leftSE),ce.push(Xe.rightSE)}return ce}}]),rt}(),ke=function(){function rt(Se,ce){if(t(this,rt),!Array.isArray(Se))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new De(Se[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var ge=1,Be=Se.length;ge<Be;ge++){var Xe=new De(Se[ge],this,!1);Xe.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Xe.bbox.ll.x),Xe.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Xe.bbox.ll.y),Xe.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Xe.bbox.ur.x),Xe.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Xe.bbox.ur.y),this.interiorRings.push(Xe)}this.multiPoly=ce}return i(rt,[{key:"getSweepEvents",value:function(){for(var ce=this.exteriorRing.getSweepEvents(),ge=0,Be=this.interiorRings.length;ge<Be;ge++)for(var Xe=this.interiorRings[ge].getSweepEvents(),$e=0,ht=Xe.length;$e<ht;$e++)ce.push(Xe[$e]);return ce}}]),rt}(),We=function(){function rt(Se,ce){if(t(this,rt),!Array.isArray(Se))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof Se[0][0][0]=="number"&&(Se=[Se])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var ge=0,Be=Se.length;ge<Be;ge++){var Xe=new ke(Se[ge],this);Xe.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Xe.bbox.ll.x),Xe.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Xe.bbox.ll.y),Xe.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Xe.bbox.ur.x),Xe.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Xe.bbox.ur.y),this.polys.push(Xe)}this.isSubject=ce}return i(rt,[{key:"getSweepEvents",value:function(){for(var ce=[],ge=0,Be=this.polys.length;ge<Be;ge++)for(var Xe=this.polys[ge].getSweepEvents(),$e=0,ht=Xe.length;$e<ht;$e++)ce.push(Xe[$e]);return ce}}]),rt}(),He=function(){i(rt,null,[{key:"factory",value:function(ce){for(var ge=[],Be=0,Xe=ce.length;Be<Xe;Be++){var $e=ce[Be];if(!(!$e.isInResult()||$e.ringOut)){for(var ht=null,Qe=$e.leftSE,Vt=$e.rightSE,ir=[Qe],it=Qe.point,Tt=[];ht=Qe,Qe=Vt,ir.push(Qe),Qe.point!==it;)for(;;){var Nt=Qe.getAvailableLinkedEvents();if(Nt.length===0){var Ar=ir[0].point,Ir=ir[ir.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Ar.x,",")+" ".concat(Ar.y,"]. Last matching segment found ends at")+" [".concat(Ir.x,", ").concat(Ir.y,"]."))}if(Nt.length===1){Vt=Nt[0].otherSE;break}for(var Rt=null,sn=0,un=Tt.length;sn<un;sn++)if(Tt[sn].point===Qe.point){Rt=sn;break}if(Rt!==null){var Gn=Tt.splice(Rt)[0],rn=ir.splice(Gn.index);rn.unshift(rn[0].otherSE),ge.push(new rt(rn.reverse()));continue}Tt.push({index:ir.length,point:Qe.point});var qr=Qe.getLeftmostComparator(ht);Vt=Nt.sort(qr)[0].otherSE;break}ge.push(new rt(ir))}}return ge}}]);function rt(Se){t(this,rt),this.events=Se;for(var ce=0,ge=Se.length;ce<ge;ce++)Se[ce].segment.ringOut=this;this.poly=null}return i(rt,[{key:"getGeom",value:function(){for(var ce=this.events[0].point,ge=[ce],Be=1,Xe=this.events.length-1;Be<Xe;Be++){var $e=this.events[Be].point,ht=this.events[Be+1].point;Ae($e,ce,ht)!==0&&(ge.push($e),ce=$e)}if(ge.length===1)return null;var Qe=ge[0],Vt=ge[1];Ae(Qe,ce,Vt)===0&&ge.shift(),ge.push(ge[0]);for(var ir=this.isExteriorRing()?1:-1,it=this.isExteriorRing()?0:ge.length-1,Tt=this.isExteriorRing()?ge.length:-1,Nt=[],Ar=it;Ar!=Tt;Ar+=ir)Nt.push([ge[Ar].x,ge[Ar].y]);return Nt}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var ce=this.enclosingRing();this._isExteriorRing=ce?!ce.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var ce=this.events[0],ge=1,Be=this.events.length;ge<Be;ge++){var Xe=this.events[ge];fe.compare(ce,Xe)>0&&(ce=Xe)}for(var $e=ce.segment.prevInResult(),ht=$e?$e.prevInResult():null;;){if(!$e)return null;if(!ht)return $e.ringOut;if(ht.ringOut!==$e.ringOut)return ht.ringOut.enclosingRing()!==$e.ringOut?$e.ringOut:$e.ringOut.enclosingRing();$e=ht.prevInResult(),ht=$e?$e.prevInResult():null}}}]),rt}(),dt=function(){function rt(Se){t(this,rt),this.exteriorRing=Se,Se.poly=this,this.interiorRings=[]}return i(rt,[{key:"addInterior",value:function(ce){this.interiorRings.push(ce),ce.poly=this}},{key:"getGeom",value:function(){var ce=[this.exteriorRing.getGeom()];if(ce[0]===null)return null;for(var ge=0,Be=this.interiorRings.length;ge<Be;ge++){var Xe=this.interiorRings[ge].getGeom();Xe!==null&&ce.push(Xe)}return ce}}]),rt}(),yt=function(){function rt(Se){t(this,rt),this.rings=Se,this.polys=this._composePolys(Se)}return i(rt,[{key:"getGeom",value:function(){for(var ce=[],ge=0,Be=this.polys.length;ge<Be;ge++){var Xe=this.polys[ge].getGeom();Xe!==null&&ce.push(Xe)}return ce}},{key:"_composePolys",value:function(ce){for(var ge=[],Be=0,Xe=ce.length;Be<Xe;Be++){var $e=ce[Be];if(!$e.poly)if($e.isExteriorRing())ge.push(new dt($e));else{var ht=$e.enclosingRing();ht.poly||ge.push(new dt(ht)),ht.poly.addInterior($e)}}return ge}}]),rt}(),Lt=function(){function rt(Se){var ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:se.compare;t(this,rt),this.queue=Se,this.tree=new O(ce),this.segments=[]}return i(rt,[{key:"process",value:function(ce){var ge=ce.segment,Be=[];if(ce.consumedBy)return ce.isLeft?this.queue.remove(ce.otherSE):this.tree.remove(ge),Be;var Xe=ce.isLeft?this.tree.insert(ge):this.tree.find(ge);if(!Xe)throw new Error("Unable to find segment #".concat(ge.id," ")+"[".concat(ge.leftSE.point.x,", ").concat(ge.leftSE.point.y,"] -> ")+"[".concat(ge.rightSE.point.x,", ").concat(ge.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var $e=Xe,ht=Xe,Qe=void 0,Vt=void 0;Qe===void 0;)$e=this.tree.prev($e),$e===null?Qe=null:$e.key.consumedBy===void 0&&(Qe=$e.key);for(;Vt===void 0;)ht=this.tree.next(ht),ht===null?Vt=null:ht.key.consumedBy===void 0&&(Vt=ht.key);if(ce.isLeft){var ir=null;if(Qe){var it=Qe.getIntersection(ge);if(it!==null&&(ge.isAnEndpoint(it)||(ir=it),!Qe.isAnEndpoint(it)))for(var Tt=this._splitSafely(Qe,it),Nt=0,Ar=Tt.length;Nt<Ar;Nt++)Be.push(Tt[Nt])}var Ir=null;if(Vt){var Rt=Vt.getIntersection(ge);if(Rt!==null&&(ge.isAnEndpoint(Rt)||(Ir=Rt),!Vt.isAnEndpoint(Rt)))for(var sn=this._splitSafely(Vt,Rt),un=0,Gn=sn.length;un<Gn;un++)Be.push(sn[un])}if(ir!==null||Ir!==null){var rn=null;if(ir===null)rn=Ir;else if(Ir===null)rn=ir;else{var qr=fe.comparePoints(ir,Ir);rn=qr<=0?ir:Ir}this.queue.remove(ge.rightSE),Be.push(ge.rightSE);for(var Fn=ge.split(rn),Lr=0,Et=Fn.length;Lr<Et;Lr++)Be.push(Fn[Lr])}Be.length>0?(this.tree.remove(ge),Be.push(ce)):(this.segments.push(ge),ge.prev=Qe)}else{if(Qe&&Vt){var li=Qe.getIntersection(Vt);if(li!==null){if(!Qe.isAnEndpoint(li))for(var Le=this._splitSafely(Qe,li),ne=0,pe=Le.length;ne<pe;ne++)Be.push(Le[ne]);if(!Vt.isAnEndpoint(li))for(var Ie=this._splitSafely(Vt,li),Ne=0,Ue=Ie.length;Ne<Ue;Ne++)Be.push(Ie[Ne])}}this.tree.remove(ge)}return Be}},{key:"_splitSafely",value:function(ce,ge){this.tree.remove(ce);var Be=ce.rightSE;this.queue.remove(Be);var Xe=ce.split(ge);return Xe.push(Be),ce.consumedBy===void 0&&this.tree.insert(ce),Xe}}]),rt}(),pt=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ct=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,mt=function(){function rt(){t(this,rt)}return i(rt,[{key:"run",value:function(ce,ge,Be){Ye.type=ce,J.reset();for(var Xe=[new We(ge,!0)],$e=0,ht=Be.length;$e<ht;$e++)Xe.push(new We(Be[$e],!1));if(Ye.numMultiPolys=Xe.length,Ye.type==="difference")for(var Qe=Xe[0],Vt=1;Vt<Xe.length;)U(Xe[Vt].bbox,Qe.bbox)!==null?Vt++:Xe.splice(Vt,1);if(Ye.type==="intersection"){for(var ir=0,it=Xe.length;ir<it;ir++)for(var Tt=Xe[ir],Nt=ir+1,Ar=Xe.length;Nt<Ar;Nt++)if(U(Tt.bbox,Xe[Nt].bbox)===null)return[]}for(var Ir=new O(fe.compare),Rt=0,sn=Xe.length;Rt<sn;Rt++)for(var un=Xe[Rt].getSweepEvents(),Gn=0,rn=un.length;Gn<rn;Gn++)if(Ir.insert(un[Gn]),Ir.size>pt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var qr=new Lt(Ir),Fn=Ir.size,Lr=Ir.pop();Lr;){var Et=Lr.key;if(Ir.size===Fn){var li=Et.segment;throw new Error("Unable to pop() ".concat(Et.isLeft?"left":"right"," SweepEvent ")+"[".concat(Et.point.x,", ").concat(Et.point.y,"] from segment #").concat(li.id," ")+"[".concat(li.leftSE.point.x,", ").concat(li.leftSE.point.y,"] -> ")+"[".concat(li.rightSE.point.x,", ").concat(li.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Ir.size>pt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(qr.segments.length>Ct)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Le=qr.process(Et),ne=0,pe=Le.length;ne<pe;ne++){var Ie=Le[ne];Ie.consumedBy===void 0&&Ir.insert(Ie)}Fn=Ir.size,Lr=Ir.pop()}J.reset();var Ne=He.factory(qr.segments),Ue=new yt(Ne);return Ue.getGeom()}}]),rt}(),Ye=new mt,Zt=function(Se){for(var ce=arguments.length,ge=new Array(ce>1?ce-1:0),Be=1;Be<ce;Be++)ge[Be-1]=arguments[Be];return Ye.run("union",Se,ge)},hr=function(Se){for(var ce=arguments.length,ge=new Array(ce>1?ce-1:0),Be=1;Be<ce;Be++)ge[Be-1]=arguments[Be];return Ye.run("intersection",Se,ge)},$t=function(Se){for(var ce=arguments.length,ge=new Array(ce>1?ce-1:0),Be=1;Be<ce;Be++)ge[Be-1]=arguments[Be];return Ye.run("xor",Se,ge)},yr=function(Se){for(var ce=arguments.length,ge=new Array(ce>1?ce-1:0),Be=1;Be<ce;Be++)ge[Be-1]=arguments[Be];return Ye.run("difference",Se,ge)},nn={union:Zt,intersection:hr,xor:$t,difference:yr};return nn})})(VD);var Td=VD.exports,yY=Td,DO=zt,NO=vr;function _Y(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var bY=_Y(yY);function XD(e,r){var t=NO.getGeom(e),n=NO.getGeom(r),i=e.properties||{},l=bY.default.difference(t.coordinates,n.coordinates);return l.length===0?null:l.length===1?DO.polygon(l[0],i):DO.multiPolygon(l,i)}nS.exports=XD;nS.exports.default=XD;var xY=nS.exports,iS={exports:{}},Jb={exports:{}};(function(e,r){(function(t,n){n(r)})(we,function(t){function n(){}function i(o){this.message=o||""}function l(o){this.message=o||""}function p(o){this.message=o||""}function u(){}function _(o){return o===null?Ke:o.color}function m(o){return o===null?null:o.parent}function S(o,c){o!==null&&(o.color=c)}function P(o){return o===null?null:o.left}function O(o){return o===null?null:o.right}function M(){this.root_=null,this.size_=0}function B(){}function $(){this.array_=[],arguments[0]instanceof qr&&this.addAll(arguments[0])}function q(){}function X(o){this.message=o||""}function R(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(o){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var c=Object(this),g=Math.max(Math.min(c.length,9007199254740991),0)||0,v=1 in arguments&&parseInt(Number(arguments[1]),10)||0;v=v<0?Math.max(g+v,0):Math.min(v,g);var A=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:g;for(A=A<0?Math.max(g+arguments[2],0):Math.min(A,g);v<A;)c[v]=o,++v;return c},writable:!0}),Number.isFinite=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},Number.isInteger=Number.isInteger||function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(o){return o!=o},Math.trunc=Math.trunc||function(o){return o<0?Math.ceil(o):Math.floor(o)};var k=function(){};k.prototype.interfaces_=function(){return[]},k.prototype.getClass=function(){return k},k.prototype.equalsWithTolerance=function(o,c,g){return Math.abs(o-c)<=g};var U=function(o){function c(g){o.call(this,g),this.name="IllegalArgumentException",this.message=g,this.stack=new o().stack}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c}(Error),H=function(){},ue={MAX_VALUE:{configurable:!0}};H.isNaN=function(o){return Number.isNaN(o)},H.doubleToLongBits=function(o){return o},H.longBitsToDouble=function(o){return o},H.isInfinite=function(o){return!Number.isFinite(o)},ue.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(H,ue);var ie=function(){},ee=function(){},W=function(){},J=function o(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=o.NULL_ORDINATE;else if(arguments.length===1){var c=arguments[0];this.x=c.x,this.y=c.y,this.z=c.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=o.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},be={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};J.prototype.setOrdinate=function(o,c){switch(o){case J.X:this.x=c;break;case J.Y:this.y=c;break;case J.Z:this.z=c;break;default:throw new U("Invalid ordinate index: "+o)}},J.prototype.equals2D=function(){if(arguments.length===1){var o=arguments[0];return this.x===o.x&&this.y===o.y}if(arguments.length===2){var c=arguments[0],g=arguments[1];return!!k.equalsWithTolerance(this.x,c.x,g)&&!!k.equalsWithTolerance(this.y,c.y,g)}},J.prototype.getOrdinate=function(o){switch(o){case J.X:return this.x;case J.Y:return this.y;case J.Z:return this.z}throw new U("Invalid ordinate index: "+o)},J.prototype.equals3D=function(o){return this.x===o.x&&this.y===o.y&&(this.z===o.z||H.isNaN(this.z))&&H.isNaN(o.z)},J.prototype.equals=function(o){return o instanceof J&&this.equals2D(o)},J.prototype.equalInZ=function(o,c){return k.equalsWithTolerance(this.z,o.z,c)},J.prototype.compareTo=function(o){var c=o;return this.x<c.x?-1:this.x>c.x?1:this.y<c.y?-1:this.y>c.y?1:0},J.prototype.clone=function(){},J.prototype.copy=function(){return new J(this)},J.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},J.prototype.distance3D=function(o){var c=this.x-o.x,g=this.y-o.y,v=this.z-o.z;return Math.sqrt(c*c+g*g+v*v)},J.prototype.distance=function(o){var c=this.x-o.x,g=this.y-o.y;return Math.sqrt(c*c+g*g)},J.prototype.hashCode=function(){var o=17;return o=37*o+J.hashCode(this.x),o=37*o+J.hashCode(this.y)},J.prototype.setCoordinate=function(o){this.x=o.x,this.y=o.y,this.z=o.z},J.prototype.interfaces_=function(){return[ie,ee,n]},J.prototype.getClass=function(){return J},J.hashCode=function(){if(arguments.length===1){var o=arguments[0],c=H.doubleToLongBits(o);return Math.trunc((c^c)>>>32)}},be.DimensionalComparator.get=function(){return Oe},be.serialVersionUID.get=function(){return 6683108902428367e3},be.NULL_ORDINATE.get=function(){return H.NaN},be.X.get=function(){return 0},be.Y.get=function(){return 1},be.Z.get=function(){return 2},Object.defineProperties(J,be);var Oe=function(o){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var c=arguments[0];if(c!==2&&c!==3)throw new U("only 2 or 3 dimensions may be specified");this._dimensionsToTest=c}}};Oe.prototype.compare=function(o,c){var g=o,v=c,A=Oe.compare(g.x,v.x);if(A!==0)return A;var N=Oe.compare(g.y,v.y);return N!==0?N:this._dimensionsToTest<=2?0:Oe.compare(g.z,v.z)},Oe.prototype.interfaces_=function(){return[W]},Oe.prototype.getClass=function(){return Oe},Oe.compare=function(o,c){return o<c?-1:o>c?1:H.isNaN(o)?H.isNaN(c)?0:-1:H.isNaN(c)?1:0};var Ae=function(){};Ae.prototype.create=function(){},Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae};var ae=function(){},ct={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};ae.prototype.interfaces_=function(){return[]},ae.prototype.getClass=function(){return ae},ae.toLocationSymbol=function(o){switch(o){case ae.EXTERIOR:return"e";case ae.BOUNDARY:return"b";case ae.INTERIOR:return"i";case ae.NONE:return"-"}throw new U("Unknown location value: "+o)},ct.INTERIOR.get=function(){return 0},ct.BOUNDARY.get=function(){return 1},ct.EXTERIOR.get=function(){return 2},ct.NONE.get=function(){return-1},Object.defineProperties(ae,ct);var Pe=function(o,c){return o.interfaces_&&o.interfaces_().indexOf(c)>-1},V=function(){},Q={LOG_10:{configurable:!0}};V.prototype.interfaces_=function(){return[]},V.prototype.getClass=function(){return V},V.log10=function(o){var c=Math.log(o);return H.isInfinite(c)||H.isNaN(c)?c:c/V.LOG_10},V.min=function(o,c,g,v){var A=o;return c<A&&(A=c),g<A&&(A=g),v<A&&(A=v),A},V.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],c=arguments[1],g=arguments[2];return o<c?c:o>g?g:o}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var v=arguments[0],A=arguments[1],N=arguments[2];return v<A?A:v>N?N:v}},V.wrap=function(o,c){return o<0?c- -o%c:o%c},V.max=function(){if(arguments.length===3){var o=arguments[0],c=arguments[1],g=arguments[2],v=o;return c>v&&(v=c),g>v&&(v=g),v}if(arguments.length===4){var A=arguments[0],N=arguments[1],G=arguments[2],le=arguments[3],xe=A;return N>xe&&(xe=N),G>xe&&(xe=G),le>xe&&(xe=le),xe}},V.average=function(o,c){return(o+c)/2},Q.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(V,Q);var he=function(o){this.str=o};he.prototype.append=function(o){this.str+=o},he.prototype.setCharAt=function(o,c){this.str=this.str.substr(0,o)+c+this.str.substr(o+1)},he.prototype.toString=function(o){return this.str};var fe=function(o){this.value=o};fe.prototype.intValue=function(){return this.value},fe.prototype.compareTo=function(o){return this.value<o?-1:this.value>o?1:0},fe.isNaN=function(o){return Number.isNaN(o)};var ye=function(){};ye.isWhitespace=function(o){return o<=32&&o>=0||o===127},ye.toUpperCase=function(o){return o.toUpperCase()};var se=function o(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var c=arguments[0];this.init(c)}else if(arguments[0]instanceof o){var g=arguments[0];this.init(g)}else if(typeof arguments[0]=="string"){var v=arguments[0];o.call(this,o.parse(v))}}else if(arguments.length===2){var A=arguments[0],N=arguments[1];this.init(A,N)}},De={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};se.prototype.le=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<=o._lo},se.prototype.extractSignificantDigits=function(o,c){var g=this.abs(),v=se.magnitude(g._hi),A=se.TEN.pow(v);(g=g.divide(A)).gt(se.TEN)?(g=g.divide(se.TEN),v+=1):g.lt(se.ONE)&&(g=g.multiply(se.TEN),v-=1);for(var N=v+1,G=new he,le=se.MAX_PRINT_DIGITS-1,xe=0;xe<=le;xe++){o&&xe===N&&G.append(".");var x=Math.trunc(g._hi);if(x<0)break;var a=!1,d=0;x>9?(a=!0,d="9"):d="0"+x,G.append(d),g=g.subtract(se.valueOf(x)).multiply(se.TEN),a&&g.selfAdd(se.TEN);var b=!0,w=se.magnitude(g._hi);if(w<0&&Math.abs(w)>=le-xe&&(b=!1),!b)break}return c[0]=v,G.toString()},se.prototype.sqr=function(){return this.multiply(this)},se.prototype.doubleValue=function(){return this._hi+this._lo},se.prototype.subtract=function(){if(arguments[0]instanceof se){var o=arguments[0];return this.add(o.negate())}if(typeof arguments[0]=="number"){var c=arguments[0];return this.add(-c)}},se.prototype.equals=function(){if(arguments.length===1){var o=arguments[0];return this._hi===o._hi&&this._lo===o._lo}},se.prototype.isZero=function(){return this._hi===0&&this._lo===0},se.prototype.selfSubtract=function(){if(arguments[0]instanceof se){var o=arguments[0];return this.isNaN()?this:this.selfAdd(-o._hi,-o._lo)}if(typeof arguments[0]=="number"){var c=arguments[0];return this.isNaN()?this:this.selfAdd(-c,0)}},se.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},se.prototype.min=function(o){return this.le(o)?this:o},se.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof se){var o=arguments[0];return this.selfDivide(o._hi,o._lo)}if(typeof arguments[0]=="number"){var c=arguments[0];return this.selfDivide(c,0)}}else if(arguments.length===2){var g=arguments[0],v=arguments[1],A=null,N=null,G=null,le=null,xe=null,x=null,a=null,d=null;return xe=this._hi/g,x=se.SPLIT*xe,A=x-xe,d=se.SPLIT*g,A=x-A,N=xe-A,G=d-g,a=xe*g,G=d-G,le=g-G,d=A*G-a+A*le+N*G+N*le,x=(this._hi-a-d+this._lo-xe*v)/g,d=xe+x,this._hi=d,this._lo=xe-d+x,this}},se.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},se.prototype.divide=function(){if(arguments[0]instanceof se){var o=arguments[0],c=null,g=null,v=null,A=null,N=null,G=null,le=null,xe=null;return g=(N=this._hi/o._hi)-(c=(G=se.SPLIT*N)-(c=G-N)),xe=c*(v=(xe=se.SPLIT*o._hi)-(v=xe-o._hi))-(le=N*o._hi)+c*(A=o._hi-v)+g*v+g*A,G=(this._hi-le-xe+this._lo-N*o._lo)/o._hi,new se(xe=N+G,N-xe+G)}if(typeof arguments[0]=="number"){var x=arguments[0];return H.isNaN(x)?se.createNaN():se.copy(this).selfDivide(x,0)}},se.prototype.ge=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>=o._lo},se.prototype.pow=function(o){if(o===0)return se.valueOf(1);var c=new se(this),g=se.valueOf(1),v=Math.abs(o);if(v>1)for(;v>0;)v%2==1&&g.selfMultiply(c),(v/=2)>0&&(c=c.sqr());else g=c;return o<0?g.reciprocal():g},se.prototype.ceil=function(){if(this.isNaN())return se.NaN;var o=Math.ceil(this._hi),c=0;return o===this._hi&&(c=Math.ceil(this._lo)),new se(o,c)},se.prototype.compareTo=function(o){var c=o;return this._hi<c._hi?-1:this._hi>c._hi?1:this._lo<c._lo?-1:this._lo>c._lo?1:0},se.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},se.prototype.setValue=function(){if(arguments[0]instanceof se){var o=arguments[0];return this.init(o),this}if(typeof arguments[0]=="number"){var c=arguments[0];return this.init(c),this}},se.prototype.max=function(o){return this.ge(o)?this:o},se.prototype.sqrt=function(){if(this.isZero())return se.valueOf(0);if(this.isNegative())return se.NaN;var o=1/Math.sqrt(this._hi),c=this._hi*o,g=se.valueOf(c),v=this.subtract(g.sqr())._hi*(.5*o);return g.add(v)},se.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof se){var o=arguments[0];return this.selfAdd(o._hi,o._lo)}if(typeof arguments[0]=="number"){var c=arguments[0],g=null,v=null,A=null,N=null,G=null,le=null;return A=this._hi+c,G=A-this._hi,N=A-G,N=c-G+(this._hi-N),le=N+this._lo,g=A+le,v=le+(A-g),this._hi=g+v,this._lo=v+(g-this._hi),this}}else if(arguments.length===2){var xe=arguments[0],x=arguments[1],a=null,d=null,b=null,w=null,I=null,L=null,F=null;w=this._hi+xe,d=this._lo+x,I=w-(L=w-this._hi),b=d-(F=d-this._lo);var j=(a=w+(L=(I=xe-L+(this._hi-I))+d))+(L=(b=x-F+(this._lo-b))+(L+(w-a))),Y=L+(a-j);return this._hi=j,this._lo=Y,this}},se.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof se){var o=arguments[0];return this.selfMultiply(o._hi,o._lo)}if(typeof arguments[0]=="number"){var c=arguments[0];return this.selfMultiply(c,0)}}else if(arguments.length===2){var g=arguments[0],v=arguments[1],A=null,N=null,G=null,le=null,xe=null,x=null;A=(xe=se.SPLIT*this._hi)-this._hi,x=se.SPLIT*g,A=xe-A,N=this._hi-A,G=x-g;var a=(xe=this._hi*g)+(x=A*(G=x-G)-xe+A*(le=g-G)+N*G+N*le+(this._hi*v+this._lo*g)),d=x+(A=xe-a);return this._hi=a,this._lo=d,this}},se.prototype.selfSqr=function(){return this.selfMultiply(this)},se.prototype.floor=function(){if(this.isNaN())return se.NaN;var o=Math.floor(this._hi),c=0;return o===this._hi&&(c=Math.floor(this._lo)),new se(o,c)},se.prototype.negate=function(){return this.isNaN()?this:new se(-this._hi,-this._lo)},se.prototype.clone=function(){},se.prototype.multiply=function(){if(arguments[0]instanceof se){var o=arguments[0];return o.isNaN()?se.createNaN():se.copy(this).selfMultiply(o)}if(typeof arguments[0]=="number"){var c=arguments[0];return H.isNaN(c)?se.createNaN():se.copy(this).selfMultiply(c,0)}},se.prototype.isNaN=function(){return H.isNaN(this._hi)},se.prototype.intValue=function(){return Math.trunc(this._hi)},se.prototype.toString=function(){var o=se.magnitude(this._hi);return o>=-3&&o<=20?this.toStandardNotation():this.toSciNotation()},se.prototype.toStandardNotation=function(){var o=this.getSpecialNumberString();if(o!==null)return o;var c=new Array(1).fill(null),g=this.extractSignificantDigits(!0,c),v=c[0]+1,A=g;if(g.charAt(0)===".")A="0"+g;else if(v<0)A="0."+se.stringOfChar("0",-v)+g;else if(g.indexOf(".")===-1){var N=v-g.length;A=g+se.stringOfChar("0",N)+".0"}return this.isNegative()?"-"+A:A},se.prototype.reciprocal=function(){var o=null,c=null,g=null,v=null,A=null,N=null,G=null,le=null;c=(A=1/this._hi)-(o=(N=se.SPLIT*A)-(o=N-A)),g=(le=se.SPLIT*this._hi)-this._hi;var xe=A+(N=(1-(G=A*this._hi)-(le=o*(g=le-g)-G+o*(v=this._hi-g)+c*g+c*v)-A*this._lo)/this._hi);return new se(xe,A-xe+N)},se.prototype.toSciNotation=function(){if(this.isZero())return se.SCI_NOT_ZERO;var o=this.getSpecialNumberString();if(o!==null)return o;var c=new Array(1).fill(null),g=this.extractSignificantDigits(!1,c),v=se.SCI_NOT_EXPONENT_CHAR+c[0];if(g.charAt(0)==="0")throw new Error("Found leading zero: "+g);var A="";g.length>1&&(A=g.substring(1));var N=g.charAt(0)+"."+A;return this.isNegative()?"-"+N+v:N+v},se.prototype.abs=function(){return this.isNaN()?se.NaN:this.isNegative()?this.negate():new se(this)},se.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0},se.prototype.lt=function(o){return(this._hi<o._hi||this._hi===o._hi)&&this._lo<o._lo},se.prototype.add=function(){if(arguments[0]instanceof se){var o=arguments[0];return se.copy(this).selfAdd(o)}if(typeof arguments[0]=="number"){var c=arguments[0];return se.copy(this).selfAdd(c)}},se.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var o=arguments[0];this._hi=o,this._lo=0}else if(arguments[0]instanceof se){var c=arguments[0];this._hi=c._hi,this._lo=c._lo}}else if(arguments.length===2){var g=arguments[0],v=arguments[1];this._hi=g,this._lo=v}},se.prototype.gt=function(o){return(this._hi>o._hi||this._hi===o._hi)&&this._lo>o._lo},se.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0},se.prototype.trunc=function(){return this.isNaN()?se.NaN:this.isPositive()?this.floor():this.ceil()},se.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},se.prototype.interfaces_=function(){return[n,ie,ee]},se.prototype.getClass=function(){return se},se.sqr=function(o){return se.valueOf(o).selfMultiply(o)},se.valueOf=function(){if(typeof arguments[0]=="string"){var o=arguments[0];return se.parse(o)}if(typeof arguments[0]=="number"){var c=arguments[0];return new se(c)}},se.sqrt=function(o){return se.valueOf(o).sqrt()},se.parse=function(o){for(var c=0,g=o.length;ye.isWhitespace(o.charAt(c));)c++;var v=!1;if(c<g){var A=o.charAt(c);A!=="-"&&A!=="+"||(c++,A==="-"&&(v=!0))}for(var N=new se,G=0,le=0,xe=0;!(c>=g);){var x=o.charAt(c);if(c++,ye.isDigit(x)){var a=x-"0";N.selfMultiply(se.TEN),N.selfAdd(a),G++}else{if(x!=="."){if(x==="e"||x==="E"){var d=o.substring(c);try{xe=fe.parseInt(d)}catch(F){throw F instanceof Error?new Error("Invalid exponent "+d+" in string "+o):F}break}throw new Error("Unexpected character '"+x+"' at position "+c+" in string "+o)}le=G}}var b=N,w=G-le-xe;if(w===0)b=N;else if(w>0){var I=se.TEN.pow(w);b=N.divide(I)}else if(w<0){var L=se.TEN.pow(-w);b=N.multiply(L)}return v?b.negate():b},se.createNaN=function(){return new se(H.NaN,H.NaN)},se.copy=function(o){return new se(o)},se.magnitude=function(o){var c=Math.abs(o),g=Math.log(c)/Math.log(10),v=Math.trunc(Math.floor(g));return 10*Math.pow(10,v)<=c&&(v+=1),v},se.stringOfChar=function(o,c){for(var g=new he,v=0;v<c;v++)g.append(o);return g.toString()},De.PI.get=function(){return new se(3.141592653589793,12246467991473532e-32)},De.TWO_PI.get=function(){return new se(6.283185307179586,24492935982947064e-32)},De.PI_2.get=function(){return new se(1.5707963267948966,6123233995736766e-32)},De.E.get=function(){return new se(2.718281828459045,14456468917292502e-32)},De.NaN.get=function(){return new se(H.NaN,H.NaN)},De.EPS.get=function(){return 123259516440783e-46},De.SPLIT.get=function(){return 134217729},De.MAX_PRINT_DIGITS.get=function(){return 32},De.TEN.get=function(){return se.valueOf(10)},De.ONE.get=function(){return se.valueOf(1)},De.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},De.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(se,De);var ke=function(){},We={DP_SAFE_EPSILON:{configurable:!0}};ke.prototype.interfaces_=function(){return[]},ke.prototype.getClass=function(){return ke},ke.orientationIndex=function(o,c,g){var v=ke.orientationIndexFilter(o,c,g);if(v<=1)return v;var A=se.valueOf(c.x).selfAdd(-o.x),N=se.valueOf(c.y).selfAdd(-o.y),G=se.valueOf(g.x).selfAdd(-c.x),le=se.valueOf(g.y).selfAdd(-c.y);return A.selfMultiply(le).selfSubtract(N.selfMultiply(G)).signum()},ke.signOfDet2x2=function(o,c,g,v){return o.multiply(v).selfSubtract(c.multiply(g)).signum()},ke.intersection=function(o,c,g,v){var A=se.valueOf(v.y).selfSubtract(g.y).selfMultiply(se.valueOf(c.x).selfSubtract(o.x)),N=se.valueOf(v.x).selfSubtract(g.x).selfMultiply(se.valueOf(c.y).selfSubtract(o.y)),G=A.subtract(N),le=se.valueOf(v.x).selfSubtract(g.x).selfMultiply(se.valueOf(o.y).selfSubtract(g.y)),xe=se.valueOf(v.y).selfSubtract(g.y).selfMultiply(se.valueOf(o.x).selfSubtract(g.x)),x=le.subtract(xe).selfDivide(G).doubleValue(),a=se.valueOf(o.x).selfAdd(se.valueOf(c.x).selfSubtract(o.x).selfMultiply(x)).doubleValue(),d=se.valueOf(c.x).selfSubtract(o.x).selfMultiply(se.valueOf(o.y).selfSubtract(g.y)),b=se.valueOf(c.y).selfSubtract(o.y).selfMultiply(se.valueOf(o.x).selfSubtract(g.x)),w=d.subtract(b).selfDivide(G).doubleValue(),I=se.valueOf(g.y).selfAdd(se.valueOf(v.y).selfSubtract(g.y).selfMultiply(w)).doubleValue();return new J(a,I)},ke.orientationIndexFilter=function(o,c,g){var v=null,A=(o.x-g.x)*(c.y-g.y),N=(o.y-g.y)*(c.x-g.x),G=A-N;if(A>0){if(N<=0)return ke.signum(G);v=A+N}else{if(!(A<0)||N>=0)return ke.signum(G);v=-A-N}var le=ke.DP_SAFE_EPSILON*v;return G>=le||-G>=le?ke.signum(G):2},ke.signum=function(o){return o>0?1:o<0?-1:0},We.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(ke,We);var He=function(){},dt={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};dt.X.get=function(){return 0},dt.Y.get=function(){return 1},dt.Z.get=function(){return 2},dt.M.get=function(){return 3},He.prototype.setOrdinate=function(o,c,g){},He.prototype.size=function(){},He.prototype.getOrdinate=function(o,c){},He.prototype.getCoordinate=function(){},He.prototype.getCoordinateCopy=function(o){},He.prototype.getDimension=function(){},He.prototype.getX=function(o){},He.prototype.clone=function(){},He.prototype.expandEnvelope=function(o){},He.prototype.copy=function(){},He.prototype.getY=function(o){},He.prototype.toCoordinateArray=function(){},He.prototype.interfaces_=function(){return[ee]},He.prototype.getClass=function(){return He},Object.defineProperties(He,dt);var yt=function(){},Lt=function(o){function c(){o.call(this,"Projective point not representable on the Cartesian plane.")}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(yt),pt=function(){};pt.arraycopy=function(o,c,g,v,A){for(var N=0,G=c;G<c+A;G++)g[v+N]=o[G],N++},pt.getProperty=function(o){return{"line.separator":`
`}[o]};var Ct=function o(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var c=arguments[0];this.x=c.x,this.y=c.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var g=arguments[0],v=arguments[1];this.x=g,this.y=v,this.w=1}else if(arguments[0]instanceof o&&arguments[1]instanceof o){var A=arguments[0],N=arguments[1];this.x=A.y*N.w-N.y*A.w,this.y=N.x*A.w-A.x*N.w,this.w=A.x*N.y-N.x*A.y}else if(arguments[0]instanceof J&&arguments[1]instanceof J){var G=arguments[0],le=arguments[1];this.x=G.y-le.y,this.y=le.x-G.x,this.w=G.x*le.y-le.x*G.y}}else if(arguments.length===3){var xe=arguments[0],x=arguments[1],a=arguments[2];this.x=xe,this.y=x,this.w=a}else if(arguments.length===4){var d=arguments[0],b=arguments[1],w=arguments[2],I=arguments[3],L=d.y-b.y,F=b.x-d.x,j=d.x*b.y-b.x*d.y,Y=w.y-I.y,K=I.x-w.x,re=w.x*I.y-I.x*w.y;this.x=F*re-K*j,this.y=Y*j-L*re,this.w=L*K-Y*F}};Ct.prototype.getY=function(){var o=this.y/this.w;if(H.isNaN(o)||H.isInfinite(o))throw new Lt;return o},Ct.prototype.getX=function(){var o=this.x/this.w;if(H.isNaN(o)||H.isInfinite(o))throw new Lt;return o},Ct.prototype.getCoordinate=function(){var o=new J;return o.x=this.getX(),o.y=this.getY(),o},Ct.prototype.interfaces_=function(){return[]},Ct.prototype.getClass=function(){return Ct},Ct.intersection=function(o,c,g,v){var A=o.y-c.y,N=c.x-o.x,G=o.x*c.y-c.x*o.y,le=g.y-v.y,xe=v.x-g.x,x=g.x*v.y-v.x*g.y,a=A*xe-le*N,d=(N*x-xe*G)/a,b=(le*G-A*x)/a;if(H.isNaN(d)||H.isInfinite(d)||H.isNaN(b)||H.isInfinite(b))throw new Lt;return new J(d,b)};var mt=function o(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof J){var c=arguments[0];this.init(c.x,c.x,c.y,c.y)}else if(arguments[0]instanceof o){var g=arguments[0];this.init(g)}}else if(arguments.length===2){var v=arguments[0],A=arguments[1];this.init(v.x,A.x,v.y,A.y)}else if(arguments.length===4){var N=arguments[0],G=arguments[1],le=arguments[2],xe=arguments[3];this.init(N,G,le,xe)}},Ye={serialVersionUID:{configurable:!0}};mt.prototype.getArea=function(){return this.getWidth()*this.getHeight()},mt.prototype.equals=function(o){if(!(o instanceof mt))return!1;var c=o;return this.isNull()?c.isNull():this._maxx===c.getMaxX()&&this._maxy===c.getMaxY()&&this._minx===c.getMinX()&&this._miny===c.getMinY()},mt.prototype.intersection=function(o){if(this.isNull()||o.isNull()||!this.intersects(o))return new mt;var c=this._minx>o._minx?this._minx:o._minx,g=this._miny>o._miny?this._miny:o._miny,v=this._maxx<o._maxx?this._maxx:o._maxx,A=this._maxy<o._maxy?this._maxy:o._maxy;return new mt(c,v,g,A)},mt.prototype.isNull=function(){return this._maxx<this._minx},mt.prototype.getMaxX=function(){return this._maxx},mt.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof J){var o=arguments[0];return this.covers(o.x,o.y)}if(arguments[0]instanceof mt){var c=arguments[0];return!this.isNull()&&!c.isNull()&&c.getMinX()>=this._minx&&c.getMaxX()<=this._maxx&&c.getMinY()>=this._miny&&c.getMaxY()<=this._maxy}}else if(arguments.length===2){var g=arguments[0],v=arguments[1];return!this.isNull()&&g>=this._minx&&g<=this._maxx&&v>=this._miny&&v<=this._maxy}},mt.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof mt){var o=arguments[0];return!this.isNull()&&!o.isNull()&&!(o._minx>this._maxx||o._maxx<this._minx||o._miny>this._maxy||o._maxy<this._miny)}if(arguments[0]instanceof J){var c=arguments[0];return this.intersects(c.x,c.y)}}else if(arguments.length===2){var g=arguments[0],v=arguments[1];return!this.isNull()&&!(g>this._maxx||g<this._minx||v>this._maxy||v<this._miny)}},mt.prototype.getMinY=function(){return this._miny},mt.prototype.getMinX=function(){return this._minx},mt.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof J){var o=arguments[0];this.expandToInclude(o.x,o.y)}else if(arguments[0]instanceof mt){var c=arguments[0];if(c.isNull())return null;this.isNull()?(this._minx=c.getMinX(),this._maxx=c.getMaxX(),this._miny=c.getMinY(),this._maxy=c.getMaxY()):(c._minx<this._minx&&(this._minx=c._minx),c._maxx>this._maxx&&(this._maxx=c._maxx),c._miny<this._miny&&(this._miny=c._miny),c._maxy>this._maxy&&(this._maxy=c._maxy))}}else if(arguments.length===2){var g=arguments[0],v=arguments[1];this.isNull()?(this._minx=g,this._maxx=g,this._miny=v,this._maxy=v):(g<this._minx&&(this._minx=g),g>this._maxx&&(this._maxx=g),v<this._miny&&(this._miny=v),v>this._maxy&&(this._maxy=v))}},mt.prototype.minExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),c=this.getHeight();return o<c?o:c},mt.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},mt.prototype.compareTo=function(o){var c=o;return this.isNull()?c.isNull()?0:-1:c.isNull()?1:this._minx<c._minx?-1:this._minx>c._minx?1:this._miny<c._miny?-1:this._miny>c._miny?1:this._maxx<c._maxx?-1:this._maxx>c._maxx?1:this._maxy<c._maxy?-1:this._maxy>c._maxy?1:0},mt.prototype.translate=function(o,c){if(this.isNull())return null;this.init(this.getMinX()+o,this.getMaxX()+o,this.getMinY()+c,this.getMaxY()+c)},mt.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},mt.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},mt.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},mt.prototype.maxExtent=function(){if(this.isNull())return 0;var o=this.getWidth(),c=this.getHeight();return o>c?o:c},mt.prototype.expandBy=function(){if(arguments.length===1){var o=arguments[0];this.expandBy(o,o)}else if(arguments.length===2){var c=arguments[0],g=arguments[1];if(this.isNull())return null;this._minx-=c,this._maxx+=c,this._miny-=g,this._maxy+=g,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},mt.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof mt){var o=arguments[0];return this.covers(o)}if(arguments[0]instanceof J){var c=arguments[0];return this.covers(c)}}else if(arguments.length===2){var g=arguments[0],v=arguments[1];return this.covers(g,v)}},mt.prototype.centre=function(){return this.isNull()?null:new J((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},mt.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof J){var o=arguments[0];this.init(o.x,o.x,o.y,o.y)}else if(arguments[0]instanceof mt){var c=arguments[0];this._minx=c._minx,this._maxx=c._maxx,this._miny=c._miny,this._maxy=c._maxy}}else if(arguments.length===2){var g=arguments[0],v=arguments[1];this.init(g.x,v.x,g.y,v.y)}else if(arguments.length===4){var A=arguments[0],N=arguments[1],G=arguments[2],le=arguments[3];A<N?(this._minx=A,this._maxx=N):(this._minx=N,this._maxx=A),G<le?(this._miny=G,this._maxy=le):(this._miny=le,this._maxy=G)}},mt.prototype.getMaxY=function(){return this._maxy},mt.prototype.distance=function(o){if(this.intersects(o))return 0;var c=0;this._maxx<o._minx?c=o._minx-this._maxx:this._minx>o._maxx&&(c=this._minx-o._maxx);var g=0;return this._maxy<o._miny?g=o._miny-this._maxy:this._miny>o._maxy&&(g=this._miny-o._maxy),c===0?g:g===0?c:Math.sqrt(c*c+g*g)},mt.prototype.hashCode=function(){var o=17;return o=37*o+J.hashCode(this._minx),o=37*o+J.hashCode(this._maxx),o=37*o+J.hashCode(this._miny),o=37*o+J.hashCode(this._maxy)},mt.prototype.interfaces_=function(){return[ie,n]},mt.prototype.getClass=function(){return mt},mt.intersects=function(){if(arguments.length===3){var o=arguments[0],c=arguments[1],g=arguments[2];return g.x>=(o.x<c.x?o.x:c.x)&&g.x<=(o.x>c.x?o.x:c.x)&&g.y>=(o.y<c.y?o.y:c.y)&&g.y<=(o.y>c.y?o.y:c.y)}if(arguments.length===4){var v=arguments[0],A=arguments[1],N=arguments[2],G=arguments[3],le=Math.min(N.x,G.x),xe=Math.max(N.x,G.x),x=Math.min(v.x,A.x),a=Math.max(v.x,A.x);return!(x>xe)&&!(a<le)&&(le=Math.min(N.y,G.y),xe=Math.max(N.y,G.y),x=Math.min(v.y,A.y),a=Math.max(v.y,A.y),!(x>xe)&&!(a<le))}},Ye.serialVersionUID.get=function(){return 5873921885273102e3},Object.defineProperties(mt,Ye);var Zt={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},hr=function(o){this.geometryFactory=o||new Rr};hr.prototype.read=function(o){var c,g,v;o=o.replace(/[\n\r]/g," ");var A=Zt.typeStr.exec(o);if(o.search("EMPTY")!==-1&&((A=Zt.emptyTypeStr.exec(o))[2]=void 0),A&&(g=A[1].toLowerCase(),v=A[2],yr[g]&&(c=yr[g].apply(this,[v]))),c===void 0)throw new Error("Could not parse WKT "+o);return c},hr.prototype.write=function(o){return this.extractGeometry(o)},hr.prototype.extractGeometry=function(o){var c=o.getGeometryType().toLowerCase();if(!$t[c])return null;var g=c.toUpperCase();return o.isEmpty()?g+" EMPTY":g+"("+$t[c].apply(this,[o])+")"};var $t={coordinate:function(o){return o.x+" "+o.y},point:function(o){return $t.coordinate.call(this,o._coordinates._coordinates[0])},multipoint:function(o){for(var c=[],g=0,v=o._geometries.length;g<v;++g)c.push("("+$t.point.apply(this,[o._geometries[g]])+")");return c.join(",")},linestring:function(o){for(var c=[],g=0,v=o._points._coordinates.length;g<v;++g)c.push($t.coordinate.apply(this,[o._points._coordinates[g]]));return c.join(",")},linearring:function(o){for(var c=[],g=0,v=o._points._coordinates.length;g<v;++g)c.push($t.coordinate.apply(this,[o._points._coordinates[g]]));return c.join(",")},multilinestring:function(o){for(var c=[],g=0,v=o._geometries.length;g<v;++g)c.push("("+$t.linestring.apply(this,[o._geometries[g]])+")");return c.join(",")},polygon:function(o){var c=[];c.push("("+$t.linestring.apply(this,[o._shell])+")");for(var g=0,v=o._holes.length;g<v;++g)c.push("("+$t.linestring.apply(this,[o._holes[g]])+")");return c.join(",")},multipolygon:function(o){for(var c=[],g=0,v=o._geometries.length;g<v;++g)c.push("("+$t.polygon.apply(this,[o._geometries[g]])+")");return c.join(",")},geometrycollection:function(o){for(var c=[],g=0,v=o._geometries.length;g<v;++g)c.push(this.extractGeometry(o._geometries[g]));return c.join(",")}},yr={point:function(o){if(o===void 0)return this.geometryFactory.createPoint();var c=o.trim().split(Zt.spaces);return this.geometryFactory.createPoint(new J(Number.parseFloat(c[0]),Number.parseFloat(c[1])))},multipoint:function(o){if(o===void 0)return this.geometryFactory.createMultiPoint();for(var c,g=o.trim().split(","),v=[],A=0,N=g.length;A<N;++A)c=g[A].replace(Zt.trimParens,"$1"),v.push(yr.point.apply(this,[c]));return this.geometryFactory.createMultiPoint(v)},linestring:function(o){if(o===void 0)return this.geometryFactory.createLineString();for(var c,g=o.trim().split(","),v=[],A=0,N=g.length;A<N;++A)c=g[A].trim().split(Zt.spaces),v.push(new J(Number.parseFloat(c[0]),Number.parseFloat(c[1])));return this.geometryFactory.createLineString(v)},linearring:function(o){if(o===void 0)return this.geometryFactory.createLinearRing();for(var c,g=o.trim().split(","),v=[],A=0,N=g.length;A<N;++A)c=g[A].trim().split(Zt.spaces),v.push(new J(Number.parseFloat(c[0]),Number.parseFloat(c[1])));return this.geometryFactory.createLinearRing(v)},multilinestring:function(o){if(o===void 0)return this.geometryFactory.createMultiLineString();for(var c,g=o.trim().split(Zt.parenComma),v=[],A=0,N=g.length;A<N;++A)c=g[A].replace(Zt.trimParens,"$1"),v.push(yr.linestring.apply(this,[c]));return this.geometryFactory.createMultiLineString(v)},polygon:function(o){if(o===void 0)return this.geometryFactory.createPolygon();for(var c,g,v,A,N=o.trim().split(Zt.parenComma),G=[],le=0,xe=N.length;le<xe;++le)c=N[le].replace(Zt.trimParens,"$1"),g=yr.linestring.apply(this,[c]),v=this.geometryFactory.createLinearRing(g._points),le===0?A=v:G.push(v);return this.geometryFactory.createPolygon(A,G)},multipolygon:function(o){if(o===void 0)return this.geometryFactory.createMultiPolygon();for(var c,g=o.trim().split(Zt.doubleParenComma),v=[],A=0,N=g.length;A<N;++A)c=g[A].replace(Zt.trimParens,"$1"),v.push(yr.polygon.apply(this,[c]));return this.geometryFactory.createMultiPolygon(v)},geometrycollection:function(o){if(o===void 0)return this.geometryFactory.createGeometryCollection();for(var c=(o=o.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),g=[],v=0,A=c.length;v<A;++v)g.push(this.read(c[v]));return this.geometryFactory.createGeometryCollection(g)}},nn=function(o){this.parser=new hr(o)};nn.prototype.write=function(o){return this.parser.write(o)},nn.toLineString=function(o,c){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+o.x+" "+o.y+", "+c.x+" "+c.y+" )"};var rt=function(o){function c(g){o.call(this,g),this.name="RuntimeException",this.message=g,this.stack=new o().stack}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c}(Error),Se=function(o){function c(){if(o.call(this),arguments.length===0)o.call(this);else if(arguments.length===1){var g=arguments[0];o.call(this,g)}}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(rt),ce=function(){};ce.prototype.interfaces_=function(){return[]},ce.prototype.getClass=function(){return ce},ce.shouldNeverReachHere=function(){if(arguments.length===0)ce.shouldNeverReachHere(null);else if(arguments.length===1){var o=arguments[0];throw new Se("Should never reach here"+(o!==null?": "+o:""))}},ce.isTrue=function(){var o,c;if(arguments.length===1)o=arguments[0],ce.isTrue(o,null);else if(arguments.length===2&&(o=arguments[0],c=arguments[1],!o))throw c===null?new Se:new Se(c)},ce.equals=function(){var o,c,g;if(arguments.length===2)o=arguments[0],c=arguments[1],ce.equals(o,c,null);else if(arguments.length===3&&(o=arguments[0],c=arguments[1],g=arguments[2],!c.equals(o)))throw new Se("Expected "+o+" but encountered "+c+(g!==null?": "+g:""))};var ge=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new J,this._intPt[1]=new J,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Be={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};ge.prototype.getIndexAlongSegment=function(o,c){return this.computeIntLineIndex(),this._intLineIndex[o][c]},ge.prototype.getTopologySummary=function(){var o=new he;return this.isEndPoint()&&o.append(" endpoint"),this._isProper&&o.append(" proper"),this.isCollinear()&&o.append(" collinear"),o.toString()},ge.prototype.computeIntersection=function(o,c,g,v){this._inputLines[0][0]=o,this._inputLines[0][1]=c,this._inputLines[1][0]=g,this._inputLines[1][1]=v,this._result=this.computeIntersect(o,c,g,v)},ge.prototype.getIntersectionNum=function(){return this._result},ge.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var o=arguments[0];this.getEdgeDistance(o,0)>this.getEdgeDistance(o,1)?(this._intLineIndex[o][0]=0,this._intLineIndex[o][1]=1):(this._intLineIndex[o][0]=1,this._intLineIndex[o][1]=0)}},ge.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},ge.prototype.setPrecisionModel=function(o){this._precisionModel=o},ge.prototype.isInteriorIntersection=function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var o=arguments[0],c=0;c<this._result;c++)if(!this._intPt[c].equals2D(this._inputLines[o][0])&&!this._intPt[c].equals2D(this._inputLines[o][1]))return!0;return!1}},ge.prototype.getIntersection=function(o){return this._intPt[o]},ge.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},ge.prototype.hasIntersection=function(){return this._result!==ge.NO_INTERSECTION},ge.prototype.getEdgeDistance=function(o,c){return ge.computeEdgeDistance(this._intPt[c],this._inputLines[o][0],this._inputLines[o][1])},ge.prototype.isCollinear=function(){return this._result===ge.COLLINEAR_INTERSECTION},ge.prototype.toString=function(){return nn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+nn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},ge.prototype.getEndpoint=function(o,c){return this._inputLines[o][c]},ge.prototype.isIntersection=function(o){for(var c=0;c<this._result;c++)if(this._intPt[c].equals2D(o))return!0;return!1},ge.prototype.getIntersectionAlongSegment=function(o,c){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[o][c]]},ge.prototype.interfaces_=function(){return[]},ge.prototype.getClass=function(){return ge},ge.computeEdgeDistance=function(o,c,g){var v=Math.abs(g.x-c.x),A=Math.abs(g.y-c.y),N=-1;if(o.equals(c))N=0;else if(o.equals(g))N=v>A?v:A;else{var G=Math.abs(o.x-c.x),le=Math.abs(o.y-c.y);(N=v>A?G:le)!==0||o.equals(c)||(N=Math.max(G,le))}return ce.isTrue(!(N===0&&!o.equals(c)),"Bad distance calculation"),N},ge.nonRobustComputeEdgeDistance=function(o,c,g){var v=o.x-c.x,A=o.y-c.y,N=Math.sqrt(v*v+A*A);return ce.isTrue(!(N===0&&!o.equals(c)),"Invalid distance calculation"),N},Be.DONT_INTERSECT.get=function(){return 0},Be.DO_INTERSECT.get=function(){return 1},Be.COLLINEAR.get=function(){return 2},Be.NO_INTERSECTION.get=function(){return 0},Be.POINT_INTERSECTION.get=function(){return 1},Be.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(ge,Be);var Xe=function(o){function c(){o.apply(this,arguments)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.isInSegmentEnvelopes=function(g){var v=new mt(this._inputLines[0][0],this._inputLines[0][1]),A=new mt(this._inputLines[1][0],this._inputLines[1][1]);return v.contains(g)&&A.contains(g)},c.prototype.computeIntersection=function(){if(arguments.length!==3)return o.prototype.computeIntersection.apply(this,arguments);var g=arguments[0],v=arguments[1],A=arguments[2];if(this._isProper=!1,mt.intersects(v,A,g)&&Qe.orientationIndex(v,A,g)===0&&Qe.orientationIndex(A,v,g)===0)return this._isProper=!0,(g.equals(v)||g.equals(A))&&(this._isProper=!1),this._result=o.POINT_INTERSECTION,null;this._result=o.NO_INTERSECTION},c.prototype.normalizeToMinimum=function(g,v,A,N,G){G.x=this.smallestInAbsValue(g.x,v.x,A.x,N.x),G.y=this.smallestInAbsValue(g.y,v.y,A.y,N.y),g.x-=G.x,g.y-=G.y,v.x-=G.x,v.y-=G.y,A.x-=G.x,A.y-=G.y,N.x-=G.x,N.y-=G.y},c.prototype.safeHCoordinateIntersection=function(g,v,A,N){var G=null;try{G=Ct.intersection(g,v,A,N)}catch(le){if(!(le instanceof Lt))throw le;G=c.nearestEndpoint(g,v,A,N)}return G},c.prototype.intersection=function(g,v,A,N){var G=this.intersectionWithNormalization(g,v,A,N);return this.isInSegmentEnvelopes(G)||(G=new J(c.nearestEndpoint(g,v,A,N))),this._precisionModel!==null&&this._precisionModel.makePrecise(G),G},c.prototype.smallestInAbsValue=function(g,v,A,N){var G=g,le=Math.abs(G);return Math.abs(v)<le&&(G=v,le=Math.abs(v)),Math.abs(A)<le&&(G=A,le=Math.abs(A)),Math.abs(N)<le&&(G=N),G},c.prototype.checkDD=function(g,v,A,N,G){var le=ke.intersection(g,v,A,N),xe=this.isInSegmentEnvelopes(le);pt.out.println("DD in env = "+xe+"  --------------------- "+le),G.distance(le)>1e-4&&pt.out.println("Distance = "+G.distance(le))},c.prototype.intersectionWithNormalization=function(g,v,A,N){var G=new J(g),le=new J(v),xe=new J(A),x=new J(N),a=new J;this.normalizeToEnvCentre(G,le,xe,x,a);var d=this.safeHCoordinateIntersection(G,le,xe,x);return d.x+=a.x,d.y+=a.y,d},c.prototype.computeCollinearIntersection=function(g,v,A,N){var G=mt.intersects(g,v,A),le=mt.intersects(g,v,N),xe=mt.intersects(A,N,g),x=mt.intersects(A,N,v);return G&&le?(this._intPt[0]=A,this._intPt[1]=N,o.COLLINEAR_INTERSECTION):xe&&x?(this._intPt[0]=g,this._intPt[1]=v,o.COLLINEAR_INTERSECTION):G&&xe?(this._intPt[0]=A,this._intPt[1]=g,!A.equals(g)||le||x?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):G&&x?(this._intPt[0]=A,this._intPt[1]=v,!A.equals(v)||le||xe?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):le&&xe?(this._intPt[0]=N,this._intPt[1]=g,!N.equals(g)||G||x?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):le&&x?(this._intPt[0]=N,this._intPt[1]=v,!N.equals(v)||G||xe?o.COLLINEAR_INTERSECTION:o.POINT_INTERSECTION):o.NO_INTERSECTION},c.prototype.normalizeToEnvCentre=function(g,v,A,N,G){var le=g.x<v.x?g.x:v.x,xe=g.y<v.y?g.y:v.y,x=g.x>v.x?g.x:v.x,a=g.y>v.y?g.y:v.y,d=A.x<N.x?A.x:N.x,b=A.y<N.y?A.y:N.y,w=A.x>N.x?A.x:N.x,I=A.y>N.y?A.y:N.y,L=((le>d?le:d)+(x<w?x:w))/2,F=((xe>b?xe:b)+(a<I?a:I))/2;G.x=L,G.y=F,g.x-=G.x,g.y-=G.y,v.x-=G.x,v.y-=G.y,A.x-=G.x,A.y-=G.y,N.x-=G.x,N.y-=G.y},c.prototype.computeIntersect=function(g,v,A,N){if(this._isProper=!1,!mt.intersects(g,v,A,N))return o.NO_INTERSECTION;var G=Qe.orientationIndex(g,v,A),le=Qe.orientationIndex(g,v,N);if(G>0&&le>0||G<0&&le<0)return o.NO_INTERSECTION;var xe=Qe.orientationIndex(A,N,g),x=Qe.orientationIndex(A,N,v);return xe>0&&x>0||xe<0&&x<0?o.NO_INTERSECTION:G===0&&le===0&&xe===0&&x===0?this.computeCollinearIntersection(g,v,A,N):(G===0||le===0||xe===0||x===0?(this._isProper=!1,g.equals2D(A)||g.equals2D(N)?this._intPt[0]=g:v.equals2D(A)||v.equals2D(N)?this._intPt[0]=v:G===0?this._intPt[0]=new J(A):le===0?this._intPt[0]=new J(N):xe===0?this._intPt[0]=new J(g):x===0&&(this._intPt[0]=new J(v))):(this._isProper=!0,this._intPt[0]=this.intersection(g,v,A,N)),o.POINT_INTERSECTION)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c.nearestEndpoint=function(g,v,A,N){var G=g,le=Qe.distancePointLine(g,A,N),xe=Qe.distancePointLine(v,A,N);return xe<le&&(le=xe,G=v),(xe=Qe.distancePointLine(A,g,v))<le&&(le=xe,G=A),(xe=Qe.distancePointLine(N,g,v))<le&&(le=xe,G=N),G},c}(ge),$e=function(){};$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e},$e.orientationIndex=function(o,c,g){var v=c.x-o.x,A=c.y-o.y,N=g.x-c.x,G=g.y-c.y;return $e.signOfDet2x2(v,A,N,G)},$e.signOfDet2x2=function(o,c,g,v){var A=null,N=null,G=null;if(A=1,o===0||v===0)return c===0||g===0?0:c>0?g>0?-A:A:g>0?A:-A;if(c===0||g===0)return v>0?o>0?A:-A:o>0?-A:A;if(c>0?v>0?c<=v||(A=-A,N=o,o=g,g=N,N=c,c=v,v=N):c<=-v?(A=-A,g=-g,v=-v):(N=o,o=-g,g=N,N=c,c=-v,v=N):v>0?-c<=v?(A=-A,o=-o,c=-c):(N=-o,o=g,g=N,N=-c,c=v,v=N):c>=v?(o=-o,c=-c,g=-g,v=-v):(A=-A,N=-o,o=-g,g=N,N=-c,c=-v,v=N),o>0){if(!(g>0)||!(o<=g))return A}else{if(g>0||!(o>=g))return-A;A=-A,o=-o,g=-g}for(;;){if(G=Math.floor(g/o),g-=G*o,(v-=G*c)<0)return-A;if(v>c)return A;if(o>g+g){if(c<v+v)return A}else{if(c>v+v)return-A;g=o-g,v=c-v,A=-A}if(v===0)return g===0?0:-A;if(g===0||(G=Math.floor(o/g),o-=G*g,(c-=G*v)<0))return A;if(c>v)return-A;if(g>o+o){if(v<c+c)return-A}else{if(v>c+c)return A;o=g-o,c=v-c,A=-A}if(c===0)return o===0?0:A;if(o===0)return-A}};var ht=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var o=arguments[0];this._p=o};ht.prototype.countSegment=function(o,c){if(o.x<this._p.x&&c.x<this._p.x)return null;if(this._p.x===c.x&&this._p.y===c.y)return this._isPointOnSegment=!0,null;if(o.y===this._p.y&&c.y===this._p.y){var g=o.x,v=c.x;return g>v&&(g=c.x,v=o.x),this._p.x>=g&&this._p.x<=v&&(this._isPointOnSegment=!0),null}if(o.y>this._p.y&&c.y<=this._p.y||c.y>this._p.y&&o.y<=this._p.y){var A=o.x-this._p.x,N=o.y-this._p.y,G=c.x-this._p.x,le=c.y-this._p.y,xe=$e.signOfDet2x2(A,N,G,le);if(xe===0)return this._isPointOnSegment=!0,null;le<N&&(xe=-xe),xe>0&&this._crossingCount++}},ht.prototype.isPointInPolygon=function(){return this.getLocation()!==ae.EXTERIOR},ht.prototype.getLocation=function(){return this._isPointOnSegment?ae.BOUNDARY:this._crossingCount%2==1?ae.INTERIOR:ae.EXTERIOR},ht.prototype.isOnSegment=function(){return this._isPointOnSegment},ht.prototype.interfaces_=function(){return[]},ht.prototype.getClass=function(){return ht},ht.locatePointInRing=function(){if(arguments[0]instanceof J&&Pe(arguments[1],He)){for(var o=arguments[0],c=arguments[1],g=new ht(o),v=new J,A=new J,N=1;N<c.size();N++)if(c.getCoordinate(N,v),c.getCoordinate(N-1,A),g.countSegment(v,A),g.isOnSegment())return g.getLocation();return g.getLocation()}if(arguments[0]instanceof J&&arguments[1]instanceof Array){for(var G=arguments[0],le=arguments[1],xe=new ht(G),x=1;x<le.length;x++){var a=le[x],d=le[x-1];if(xe.countSegment(a,d),xe.isOnSegment())return xe.getLocation()}return xe.getLocation()}};var Qe=function(){},Vt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe},Qe.orientationIndex=function(o,c,g){return ke.orientationIndex(o,c,g)},Qe.signedArea=function(){if(arguments[0]instanceof Array){var o=arguments[0];if(o.length<3)return 0;for(var c=0,g=o[0].x,v=1;v<o.length-1;v++){var A=o[v].x-g,N=o[v+1].y;c+=A*(o[v-1].y-N)}return c/2}if(Pe(arguments[0],He)){var G=arguments[0],le=G.size();if(le<3)return 0;var xe=new J,x=new J,a=new J;G.getCoordinate(0,x),G.getCoordinate(1,a);var d=x.x;a.x-=d;for(var b=0,w=1;w<le-1;w++)xe.y=x.y,x.x=a.x,x.y=a.y,G.getCoordinate(w+1,a),a.x-=d,b+=x.x*(xe.y-a.y);return b/2}},Qe.distanceLineLine=function(o,c,g,v){if(o.equals(c))return Qe.distancePointLine(o,g,v);if(g.equals(v))return Qe.distancePointLine(v,o,c);var A=!1;if(mt.intersects(o,c,g,v)){var N=(c.x-o.x)*(v.y-g.y)-(c.y-o.y)*(v.x-g.x);if(N===0)A=!0;else{var G=(o.y-g.y)*(v.x-g.x)-(o.x-g.x)*(v.y-g.y),le=((o.y-g.y)*(c.x-o.x)-(o.x-g.x)*(c.y-o.y))/N,xe=G/N;(xe<0||xe>1||le<0||le>1)&&(A=!0)}}else A=!0;return A?V.min(Qe.distancePointLine(o,g,v),Qe.distancePointLine(c,g,v),Qe.distancePointLine(g,o,c),Qe.distancePointLine(v,o,c)):0},Qe.isPointInRing=function(o,c){return Qe.locatePointInRing(o,c)!==ae.EXTERIOR},Qe.computeLength=function(o){var c=o.size();if(c<=1)return 0;var g=0,v=new J;o.getCoordinate(0,v);for(var A=v.x,N=v.y,G=1;G<c;G++){o.getCoordinate(G,v);var le=v.x,xe=v.y,x=le-A,a=xe-N;g+=Math.sqrt(x*x+a*a),A=le,N=xe}return g},Qe.isCCW=function(o){var c=o.length-1;if(c<3)throw new U("Ring has fewer than 4 points, so orientation cannot be determined");for(var g=o[0],v=0,A=1;A<=c;A++){var N=o[A];N.y>g.y&&(g=N,v=A)}var G=v;do(G-=1)<0&&(G=c);while(o[G].equals2D(g)&&G!==v);var le=v;do le=(le+1)%c;while(o[le].equals2D(g)&&le!==v);var xe=o[G],x=o[le];if(xe.equals2D(g)||x.equals2D(g)||xe.equals2D(x))return!1;var a=Qe.computeOrientation(xe,g,x),d=!1;return d=a===0?xe.x>x.x:a>0,d},Qe.locatePointInRing=function(o,c){return ht.locatePointInRing(o,c)},Qe.distancePointLinePerpendicular=function(o,c,g){var v=(g.x-c.x)*(g.x-c.x)+(g.y-c.y)*(g.y-c.y),A=((c.y-o.y)*(g.x-c.x)-(c.x-o.x)*(g.y-c.y))/v;return Math.abs(A)*Math.sqrt(v)},Qe.computeOrientation=function(o,c,g){return Qe.orientationIndex(o,c,g)},Qe.distancePointLine=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1];if(c.length===0)throw new U("Line array must contain at least one vertex");for(var g=o.distance(c[0]),v=0;v<c.length-1;v++){var A=Qe.distancePointLine(o,c[v],c[v+1]);A<g&&(g=A)}return g}if(arguments.length===3){var N=arguments[0],G=arguments[1],le=arguments[2];if(G.x===le.x&&G.y===le.y)return N.distance(G);var xe=(le.x-G.x)*(le.x-G.x)+(le.y-G.y)*(le.y-G.y),x=((N.x-G.x)*(le.x-G.x)+(N.y-G.y)*(le.y-G.y))/xe;if(x<=0)return N.distance(G);if(x>=1)return N.distance(le);var a=((G.y-N.y)*(le.x-G.x)-(G.x-N.x)*(le.y-G.y))/xe;return Math.abs(a)*Math.sqrt(xe)}},Qe.isOnLine=function(o,c){for(var g=new Xe,v=1;v<c.length;v++){var A=c[v-1],N=c[v];if(g.computeIntersection(o,A,N),g.hasIntersection())return!0}return!1},Vt.CLOCKWISE.get=function(){return-1},Vt.RIGHT.get=function(){return Qe.CLOCKWISE},Vt.COUNTERCLOCKWISE.get=function(){return 1},Vt.LEFT.get=function(){return Qe.COUNTERCLOCKWISE},Vt.COLLINEAR.get=function(){return 0},Vt.STRAIGHT.get=function(){return Qe.COLLINEAR},Object.defineProperties(Qe,Vt);var ir=function(){};ir.prototype.filter=function(o){},ir.prototype.interfaces_=function(){return[]},ir.prototype.getClass=function(){return ir};var it=function(){var o=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=o,this._SRID=o.getSRID()},Tt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};it.prototype.isGeometryCollection=function(){return this.getSortIndex()===it.SORTINDEX_GEOMETRYCOLLECTION},it.prototype.getFactory=function(){return this._factory},it.prototype.getGeometryN=function(o){return this},it.prototype.getArea=function(){return 0},it.prototype.isRectangle=function(){return!1},it.prototype.equals=function(){if(arguments[0]instanceof it){var o=arguments[0];return o!==null&&this.equalsTopo(o)}if(arguments[0]instanceof Object){var c=arguments[0];if(!(c instanceof it))return!1;var g=c;return this.equalsExact(g)}},it.prototype.equalsExact=function(o){return this===o||this.equalsExact(o,0)},it.prototype.geometryChanged=function(){this.apply(it.geometryChangedFilter)},it.prototype.geometryChangedAction=function(){this._envelope=null},it.prototype.equalsNorm=function(o){return o!==null&&this.norm().equalsExact(o.norm())},it.prototype.getLength=function(){return 0},it.prototype.getNumGeometries=function(){return 1},it.prototype.compareTo=function(){if(arguments.length===1){var o=arguments[0],c=o;return this.getSortIndex()!==c.getSortIndex()?this.getSortIndex()-c.getSortIndex():this.isEmpty()&&c.isEmpty()?0:this.isEmpty()?-1:c.isEmpty()?1:this.compareToSameClass(o)}if(arguments.length===2){var g=arguments[0],v=arguments[1];return this.getSortIndex()!==g.getSortIndex()?this.getSortIndex()-g.getSortIndex():this.isEmpty()&&g.isEmpty()?0:this.isEmpty()?-1:g.isEmpty()?1:this.compareToSameClass(g,v)}},it.prototype.getUserData=function(){return this._userData},it.prototype.getSRID=function(){return this._SRID},it.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},it.prototype.checkNotGeometryCollection=function(o){if(o.getSortIndex()===it.SORTINDEX_GEOMETRYCOLLECTION)throw new U("This method does not support GeometryCollection arguments")},it.prototype.equal=function(o,c,g){return g===0?o.equals(c):o.distance(c)<=g},it.prototype.norm=function(){var o=this.copy();return o.normalize(),o},it.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},it.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new mt(this._envelope)},it.prototype.setSRID=function(o){this._SRID=o},it.prototype.setUserData=function(o){this._userData=o},it.prototype.compare=function(o,c){for(var g=o.iterator(),v=c.iterator();g.hasNext()&&v.hasNext();){var A=g.next(),N=v.next(),G=A.compareTo(N);if(G!==0)return G}return g.hasNext()?1:v.hasNext()?-1:0},it.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},it.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===it.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===it.SORTINDEX_MULTIPOINT||this.getSortIndex()===it.SORTINDEX_MULTILINESTRING||this.getSortIndex()===it.SORTINDEX_MULTIPOLYGON},it.prototype.interfaces_=function(){return[ee,ie,n]},it.prototype.getClass=function(){return it},it.hasNonEmptyElements=function(o){for(var c=0;c<o.length;c++)if(!o[c].isEmpty())return!0;return!1},it.hasNullElements=function(o){for(var c=0;c<o.length;c++)if(o[c]===null)return!0;return!1},Tt.serialVersionUID.get=function(){return 8763622679187377e3},Tt.SORTINDEX_POINT.get=function(){return 0},Tt.SORTINDEX_MULTIPOINT.get=function(){return 1},Tt.SORTINDEX_LINESTRING.get=function(){return 2},Tt.SORTINDEX_LINEARRING.get=function(){return 3},Tt.SORTINDEX_MULTILINESTRING.get=function(){return 4},Tt.SORTINDEX_POLYGON.get=function(){return 5},Tt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},Tt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},Tt.geometryChangedFilter.get=function(){return Nt},Object.defineProperties(it,Tt);var Nt=function(){};Nt.interfaces_=function(){return[ir]},Nt.filter=function(o){o.geometryChangedAction()};var Ar=function(){};Ar.prototype.filter=function(o){},Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar};var Ir=function(){},Rt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Ir.prototype.isInBoundary=function(o){},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir},Rt.Mod2BoundaryNodeRule.get=function(){return sn},Rt.EndPointBoundaryNodeRule.get=function(){return un},Rt.MultiValentEndPointBoundaryNodeRule.get=function(){return Gn},Rt.MonoValentEndPointBoundaryNodeRule.get=function(){return rn},Rt.MOD2_BOUNDARY_RULE.get=function(){return new sn},Rt.ENDPOINT_BOUNDARY_RULE.get=function(){return new un},Rt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Gn},Rt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new rn},Rt.OGC_SFS_BOUNDARY_RULE.get=function(){return Ir.MOD2_BOUNDARY_RULE},Object.defineProperties(Ir,Rt);var sn=function(){};sn.prototype.isInBoundary=function(o){return o%2==1},sn.prototype.interfaces_=function(){return[Ir]},sn.prototype.getClass=function(){return sn};var un=function(){};un.prototype.isInBoundary=function(o){return o>0},un.prototype.interfaces_=function(){return[Ir]},un.prototype.getClass=function(){return un};var Gn=function(){};Gn.prototype.isInBoundary=function(o){return o>1},Gn.prototype.interfaces_=function(){return[Ir]},Gn.prototype.getClass=function(){return Gn};var rn=function(){};rn.prototype.isInBoundary=function(o){return o===1},rn.prototype.interfaces_=function(){return[Ir]},rn.prototype.getClass=function(){return rn};var qr=function(){};qr.prototype.add=function(){},qr.prototype.addAll=function(){},qr.prototype.isEmpty=function(){},qr.prototype.iterator=function(){},qr.prototype.size=function(){},qr.prototype.toArray=function(){},qr.prototype.remove=function(){},(i.prototype=new Error).name="IndexOutOfBoundsException";var Fn=function(){};Fn.prototype.hasNext=function(){},Fn.prototype.next=function(){},Fn.prototype.remove=function(){};var Lr=function(o){function c(){o.apply(this,arguments)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.get=function(){},c.prototype.set=function(){},c.prototype.isEmpty=function(){},c}(qr);(l.prototype=new Error).name="NoSuchElementException";var Et=function(o){function c(){o.call(this),this.array_=[],arguments[0]instanceof qr&&this.addAll(arguments[0])}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.ensureCapacity=function(){},c.prototype.interfaces_=function(){return[o,qr]},c.prototype.add=function(g){return arguments.length===1?this.array_.push(g):this.array_.splice(arguments[0],arguments[1]),!0},c.prototype.clear=function(){this.array_=[]},c.prototype.addAll=function(g){for(var v=g.iterator();v.hasNext();)this.add(v.next());return!0},c.prototype.set=function(g,v){var A=this.array_[g];return this.array_[g]=v,A},c.prototype.iterator=function(){return new li(this)},c.prototype.get=function(g){if(g<0||g>=this.size())throw new i;return this.array_[g]},c.prototype.isEmpty=function(){return this.array_.length===0},c.prototype.size=function(){return this.array_.length},c.prototype.toArray=function(){for(var g=[],v=0,A=this.array_.length;v<A;v++)g.push(this.array_[v]);return g},c.prototype.remove=function(g){for(var v=!1,A=0,N=this.array_.length;A<N;A++)if(this.array_[A]===g){this.array_.splice(A,1),v=!0;break}return v},c}(Lr),li=function(o){function c(g){o.call(this),this.arrayList_=g,this.position_=0}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new l;return this.arrayList_.get(this.position_++)},c.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},c.prototype.set=function(g){return this.arrayList_.set(this.position_-1,g)},c.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},c}(Fn),Le=function(o){function c(){if(o.call(this),arguments.length!==0){if(arguments.length===1){var v=arguments[0];this.ensureCapacity(v.length),this.add(v,!0)}else if(arguments.length===2){var A=arguments[0],N=arguments[1];this.ensureCapacity(A.length),this.add(A,N)}}}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={coordArrayType:{configurable:!0}};return g.coordArrayType.get=function(){return new Array(0).fill(null)},c.prototype.getCoordinate=function(v){return this.get(v)},c.prototype.addAll=function(){if(arguments.length===2){for(var v=arguments[0],A=arguments[1],N=!1,G=v.iterator();G.hasNext();)this.add(G.next(),A),N=!0;return N}return o.prototype.addAll.apply(this,arguments)},c.prototype.clone=function(){for(var v=o.prototype.clone.call(this),A=0;A<this.size();A++)v.add(A,this.get(A).copy());return v},c.prototype.toCoordinateArray=function(){return this.toArray(c.coordArrayType)},c.prototype.add=function(){if(arguments.length===1){var v=arguments[0];o.prototype.add.call(this,v)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var A=arguments[0],N=arguments[1];return this.add(A,N,!0),!0}if(arguments[0]instanceof J&&typeof arguments[1]=="boolean"){var G=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(G))return null;o.prototype.add.call(this,G)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var le=arguments[0],xe=arguments[1];return this.add(le,xe),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var x=arguments[0],a=arguments[1];if(arguments[2])for(var d=0;d<x.length;d++)this.add(x[d],a);else for(var b=x.length-1;b>=0;b--)this.add(x[b],a);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof J){var w=arguments[0],I=arguments[1];if(!arguments[2]){var L=this.size();if(L>0&&(w>0&&this.get(w-1).equals2D(I)||w<L&&this.get(w).equals2D(I)))return null}o.prototype.add.call(this,w,I)}}else if(arguments.length===4){var F=arguments[0],j=arguments[1],Y=arguments[2],K=arguments[3],re=1;Y>K&&(re=-1);for(var me=Y;me!==K;me+=re)this.add(F[me],j);return!0}},c.prototype.closeRing=function(){this.size()>0&&this.add(new J(this.get(0)),!1)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},Object.defineProperties(c,g),c}(Et),ne=function(){},pe={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};pe.ForwardComparator.get=function(){return Ie},pe.BidirectionalComparator.get=function(){return Ne},pe.coordArrayType.get=function(){return new Array(0).fill(null)},ne.prototype.interfaces_=function(){return[]},ne.prototype.getClass=function(){return ne},ne.isRing=function(o){return!(o.length<4)&&!!o[0].equals2D(o[o.length-1])},ne.ptNotInList=function(o,c){for(var g=0;g<o.length;g++){var v=o[g];if(ne.indexOf(v,c)<0)return v}return null},ne.scroll=function(o,c){var g=ne.indexOf(c,o);if(g<0)return null;var v=new Array(o.length).fill(null);pt.arraycopy(o,g,v,0,o.length-g),pt.arraycopy(o,0,v,o.length-g,g),pt.arraycopy(v,0,o,0,o.length)},ne.equals=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1];if(o===c)return!0;if(o===null||c===null||o.length!==c.length)return!1;for(var g=0;g<o.length;g++)if(!o[g].equals(c[g]))return!1;return!0}if(arguments.length===3){var v=arguments[0],A=arguments[1],N=arguments[2];if(v===A)return!0;if(v===null||A===null||v.length!==A.length)return!1;for(var G=0;G<v.length;G++)if(N.compare(v[G],A[G])!==0)return!1;return!0}},ne.intersection=function(o,c){for(var g=new Le,v=0;v<o.length;v++)c.intersects(o[v])&&g.add(o[v],!0);return g.toCoordinateArray()},ne.hasRepeatedPoints=function(o){for(var c=1;c<o.length;c++)if(o[c-1].equals(o[c]))return!0;return!1},ne.removeRepeatedPoints=function(o){return ne.hasRepeatedPoints(o)?new Le(o,!1).toCoordinateArray():o},ne.reverse=function(o){for(var c=o.length-1,g=Math.trunc(c/2),v=0;v<=g;v++){var A=o[v];o[v]=o[c-v],o[c-v]=A}},ne.removeNull=function(o){for(var c=0,g=0;g<o.length;g++)o[g]!==null&&c++;var v=new Array(c).fill(null);if(c===0)return v;for(var A=0,N=0;N<o.length;N++)o[N]!==null&&(v[A++]=o[N]);return v},ne.copyDeep=function(){if(arguments.length===1){for(var o=arguments[0],c=new Array(o.length).fill(null),g=0;g<o.length;g++)c[g]=new J(o[g]);return c}if(arguments.length===5)for(var v=arguments[0],A=arguments[1],N=arguments[2],G=arguments[3],le=arguments[4],xe=0;xe<le;xe++)N[G+xe]=new J(v[A+xe])},ne.isEqualReversed=function(o,c){for(var g=0;g<o.length;g++){var v=o[g],A=c[o.length-g-1];if(v.compareTo(A)!==0)return!1}return!0},ne.envelope=function(o){for(var c=new mt,g=0;g<o.length;g++)c.expandToInclude(o[g]);return c},ne.toCoordinateArray=function(o){return o.toArray(ne.coordArrayType)},ne.atLeastNCoordinatesOrNothing=function(o,c){return c.length>=o?c:[]},ne.indexOf=function(o,c){for(var g=0;g<c.length;g++)if(o.equals(c[g]))return g;return-1},ne.increasingDirection=function(o){for(var c=0;c<Math.trunc(o.length/2);c++){var g=o.length-1-c,v=o[c].compareTo(o[g]);if(v!==0)return v}return 1},ne.compare=function(o,c){for(var g=0;g<o.length&&g<c.length;){var v=o[g].compareTo(c[g]);if(v!==0)return v;g++}return g<c.length?-1:g<o.length?1:0},ne.minCoordinate=function(o){for(var c=null,g=0;g<o.length;g++)(c===null||c.compareTo(o[g])>0)&&(c=o[g]);return c},ne.extract=function(o,c,g){c=V.clamp(c,0,o.length);var v=(g=V.clamp(g,-1,o.length))-c+1;g<0&&(v=0),c>=o.length&&(v=0),g<c&&(v=0);var A=new Array(v).fill(null);if(v===0)return A;for(var N=0,G=c;G<=g;G++)A[N++]=o[G];return A},Object.defineProperties(ne,pe);var Ie=function(){};Ie.prototype.compare=function(o,c){return ne.compare(o,c)},Ie.prototype.interfaces_=function(){return[W]},Ie.prototype.getClass=function(){return Ie};var Ne=function(){};Ne.prototype.compare=function(o,c){var g=o,v=c;if(g.length<v.length)return-1;if(g.length>v.length)return 1;if(g.length===0)return 0;var A=ne.compare(g,v);return ne.isEqualReversed(g,v)?0:A},Ne.prototype.OLDcompare=function(o,c){var g=o,v=c;if(g.length<v.length)return-1;if(g.length>v.length)return 1;if(g.length===0)return 0;for(var A=ne.increasingDirection(g),N=ne.increasingDirection(v),G=A>0?0:g.length-1,le=N>0?0:g.length-1,xe=0;xe<g.length;xe++){var x=g[G].compareTo(v[le]);if(x!==0)return x;G+=A,le+=N}return 0},Ne.prototype.interfaces_=function(){return[W]},Ne.prototype.getClass=function(){return Ne};var Ue=function(){};Ue.prototype.get=function(){},Ue.prototype.put=function(){},Ue.prototype.size=function(){},Ue.prototype.values=function(){},Ue.prototype.entrySet=function(){};var et=function(o){function c(){o.apply(this,arguments)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c}(Ue);(p.prototype=new Error).name="OperationNotSupported",(u.prototype=new qr).contains=function(){};var Ve=function(o){function c(){o.call(this),this.array_=[],arguments[0]instanceof qr&&this.addAll(arguments[0])}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.contains=function(g){for(var v=0,A=this.array_.length;v<A;v++)if(this.array_[v]===g)return!0;return!1},c.prototype.add=function(g){return!this.contains(g)&&(this.array_.push(g),!0)},c.prototype.addAll=function(g){for(var v=g.iterator();v.hasNext();)this.add(v.next());return!0},c.prototype.remove=function(g){throw new Error},c.prototype.size=function(){return this.array_.length},c.prototype.isEmpty=function(){return this.array_.length===0},c.prototype.toArray=function(){for(var g=[],v=0,A=this.array_.length;v<A;v++)g.push(this.array_[v]);return g},c.prototype.iterator=function(){return new qe(this)},c}(u),qe=function(o){function c(g){o.call(this),this.hashSet_=g,this.position_=0}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new l;return this.hashSet_.array_[this.position_++]},c.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},c.prototype.remove=function(){throw new p},c}(Fn),Ke=0;(M.prototype=new et).get=function(o){for(var c=this.root_;c!==null;){var g=o.compareTo(c.key);if(g<0)c=c.left;else{if(!(g>0))return c.value;c=c.right}}return null},M.prototype.put=function(o,c){if(this.root_===null)return this.root_={key:o,value:c,left:null,right:null,parent:null,color:Ke,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var g,v,A=this.root_;do if(g=A,(v=o.compareTo(A.key))<0)A=A.left;else{if(!(v>0)){var N=A.value;return A.value=c,N}A=A.right}while(A!==null);var G={key:o,left:null,right:null,value:c,parent:g,color:Ke,getValue:function(){return this.value},getKey:function(){return this.key}};return v<0?g.left=G:g.right=G,this.fixAfterInsertion(G),this.size_++,null},M.prototype.fixAfterInsertion=function(o){for(o.color=1;o!=null&&o!==this.root_&&o.parent.color===1;)if(m(o)===P(m(m(o)))){var c=O(m(m(o)));_(c)===1?(S(m(o),Ke),S(c,Ke),S(m(m(o)),1),o=m(m(o))):(o===O(m(o))&&(o=m(o),this.rotateLeft(o)),S(m(o),Ke),S(m(m(o)),1),this.rotateRight(m(m(o))))}else{var g=P(m(m(o)));_(g)===1?(S(m(o),Ke),S(g,Ke),S(m(m(o)),1),o=m(m(o))):(o===P(m(o))&&(o=m(o),this.rotateRight(o)),S(m(o),Ke),S(m(m(o)),1),this.rotateLeft(m(m(o))))}this.root_.color=Ke},M.prototype.values=function(){var o=new Et,c=this.getFirstEntry();if(c!==null)for(o.add(c.value);(c=M.successor(c))!==null;)o.add(c.value);return o},M.prototype.entrySet=function(){var o=new Ve,c=this.getFirstEntry();if(c!==null)for(o.add(c);(c=M.successor(c))!==null;)o.add(c);return o},M.prototype.rotateLeft=function(o){if(o!=null){var c=o.right;o.right=c.left,c.left!=null&&(c.left.parent=o),c.parent=o.parent,o.parent===null?this.root_=c:o.parent.left===o?o.parent.left=c:o.parent.right=c,c.left=o,o.parent=c}},M.prototype.rotateRight=function(o){if(o!=null){var c=o.left;o.left=c.right,c.right!=null&&(c.right.parent=o),c.parent=o.parent,o.parent===null?this.root_=c:o.parent.right===o?o.parent.right=c:o.parent.left=c,c.right=o,o.parent=c}},M.prototype.getFirstEntry=function(){var o=this.root_;if(o!=null)for(;o.left!=null;)o=o.left;return o},M.successor=function(o){if(o===null)return null;if(o.right!==null){for(var c=o.right;c.left!==null;)c=c.left;return c}for(var g=o.parent,v=o;g!==null&&v===g.right;)v=g,g=g.parent;return g},M.prototype.size=function(){return this.size_};var gt=function(){};gt.prototype.interfaces_=function(){return[]},gt.prototype.getClass=function(){return gt},B.prototype=new u,($.prototype=new B).contains=function(o){for(var c=0,g=this.array_.length;c<g;c++)if(this.array_[c].compareTo(o)===0)return!0;return!1},$.prototype.add=function(o){if(this.contains(o))return!1;for(var c=0,g=this.array_.length;c<g;c++)if(this.array_[c].compareTo(o)===1)return this.array_.splice(c,0,o),!0;return this.array_.push(o),!0},$.prototype.addAll=function(o){for(var c=o.iterator();c.hasNext();)this.add(c.next());return!0},$.prototype.remove=function(o){throw new p},$.prototype.size=function(){return this.array_.length},$.prototype.isEmpty=function(){return this.array_.length===0},$.prototype.toArray=function(){for(var o=[],c=0,g=this.array_.length;c<g;c++)o.push(this.array_[c]);return o},$.prototype.iterator=function(){return new vt(this)};var vt=function(o){this.treeSet_=o,this.position_=0};vt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new l;return this.treeSet_.array_[this.position_++]},vt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},vt.prototype.remove=function(){throw new p};var ft=function(){};ft.sort=function(){var o,c,g,v,A=arguments[0];if(arguments.length===1)v=function(G,le){return G.compareTo(le)},A.sort(v);else if(arguments.length===2)g=arguments[1],v=function(G,le){return g.compare(G,le)},A.sort(v);else if(arguments.length===3){(c=A.slice(arguments[1],arguments[2])).sort();var N=A.slice(0,arguments[1]).concat(c,A.slice(arguments[2],A.length));for(A.splice(0,A.length),o=0;o<N.length;o++)A.push(N[o])}else if(arguments.length===4)for(c=A.slice(arguments[1],arguments[2]),g=arguments[3],v=function(G,le){return g.compare(G,le)},c.sort(v),N=A.slice(0,arguments[1]).concat(c,A.slice(arguments[2],A.length)),A.splice(0,A.length),o=0;o<N.length;o++)A.push(N[o])},ft.asList=function(o){for(var c=new Et,g=0,v=o.length;g<v;g++)c.add(o[g]);return c};var Ot=function(){},ur={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};ur.P.get=function(){return 0},ur.L.get=function(){return 1},ur.A.get=function(){return 2},ur.FALSE.get=function(){return-1},ur.TRUE.get=function(){return-2},ur.DONTCARE.get=function(){return-3},ur.SYM_FALSE.get=function(){return"F"},ur.SYM_TRUE.get=function(){return"T"},ur.SYM_DONTCARE.get=function(){return"*"},ur.SYM_P.get=function(){return"0"},ur.SYM_L.get=function(){return"1"},ur.SYM_A.get=function(){return"2"},Ot.prototype.interfaces_=function(){return[]},Ot.prototype.getClass=function(){return Ot},Ot.toDimensionSymbol=function(o){switch(o){case Ot.FALSE:return Ot.SYM_FALSE;case Ot.TRUE:return Ot.SYM_TRUE;case Ot.DONTCARE:return Ot.SYM_DONTCARE;case Ot.P:return Ot.SYM_P;case Ot.L:return Ot.SYM_L;case Ot.A:return Ot.SYM_A}throw new U("Unknown dimension value: "+o)},Ot.toDimensionValue=function(o){switch(ye.toUpperCase(o)){case Ot.SYM_FALSE:return Ot.FALSE;case Ot.SYM_TRUE:return Ot.TRUE;case Ot.SYM_DONTCARE:return Ot.DONTCARE;case Ot.SYM_P:return Ot.P;case Ot.SYM_L:return Ot.L;case Ot.SYM_A:return Ot.A}throw new U("Unknown dimension symbol: "+o)},Object.defineProperties(Ot,ur);var jt=function(){};jt.prototype.filter=function(o){},jt.prototype.interfaces_=function(){return[]},jt.prototype.getClass=function(){return jt};var Xt=function(){};Xt.prototype.filter=function(o,c){},Xt.prototype.isDone=function(){},Xt.prototype.isGeometryChanged=function(){},Xt.prototype.interfaces_=function(){return[]},Xt.prototype.getClass=function(){return Xt};var Ht=function(o){function c(v,A){if(o.call(this,A),this._geometries=v||[],o.hasNullElements(this._geometries))throw new U("geometries must not contain null elements")}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={serialVersionUID:{configurable:!0}};return c.prototype.computeEnvelopeInternal=function(){for(var v=new mt,A=0;A<this._geometries.length;A++)v.expandToInclude(this._geometries[A].getEnvelopeInternal());return v},c.prototype.getGeometryN=function(v){return this._geometries[v]},c.prototype.getSortIndex=function(){return o.SORTINDEX_GEOMETRYCOLLECTION},c.prototype.getCoordinates=function(){for(var v=new Array(this.getNumPoints()).fill(null),A=-1,N=0;N<this._geometries.length;N++)for(var G=this._geometries[N].getCoordinates(),le=0;le<G.length;le++)v[++A]=G[le];return v},c.prototype.getArea=function(){for(var v=0,A=0;A<this._geometries.length;A++)v+=this._geometries[A].getArea();return v},c.prototype.equalsExact=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];if(!this.isEquivalentClass(v))return!1;var N=v;if(this._geometries.length!==N._geometries.length)return!1;for(var G=0;G<this._geometries.length;G++)if(!this._geometries[G].equalsExact(N._geometries[G],A))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},c.prototype.normalize=function(){for(var v=0;v<this._geometries.length;v++)this._geometries[v].normalize();ft.sort(this._geometries)},c.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},c.prototype.getBoundaryDimension=function(){for(var v=Ot.FALSE,A=0;A<this._geometries.length;A++)v=Math.max(v,this._geometries[A].getBoundaryDimension());return v},c.prototype.getDimension=function(){for(var v=Ot.FALSE,A=0;A<this._geometries.length;A++)v=Math.max(v,this._geometries[A].getDimension());return v},c.prototype.getLength=function(){for(var v=0,A=0;A<this._geometries.length;A++)v+=this._geometries[A].getLength();return v},c.prototype.getNumPoints=function(){for(var v=0,A=0;A<this._geometries.length;A++)v+=this._geometries[A].getNumPoints();return v},c.prototype.getNumGeometries=function(){return this._geometries.length},c.prototype.reverse=function(){for(var v=this._geometries.length,A=new Array(v).fill(null),N=0;N<this._geometries.length;N++)A[N]=this._geometries[N].reverse();return this.getFactory().createGeometryCollection(A)},c.prototype.compareToSameClass=function(){if(arguments.length===1){var v=arguments[0],A=new $(ft.asList(this._geometries)),N=new $(ft.asList(v._geometries));return this.compare(A,N)}if(arguments.length===2){for(var G=arguments[0],le=arguments[1],xe=G,x=this.getNumGeometries(),a=xe.getNumGeometries(),d=0;d<x&&d<a;){var b=this.getGeometryN(d),w=xe.getGeometryN(d),I=b.compareToSameClass(w,le);if(I!==0)return I;d++}return d<x?1:d<a?-1:0}},c.prototype.apply=function(){if(Pe(arguments[0],Ar))for(var v=arguments[0],A=0;A<this._geometries.length;A++)this._geometries[A].apply(v);else if(Pe(arguments[0],Xt)){var N=arguments[0];if(this._geometries.length===0)return null;for(var G=0;G<this._geometries.length&&(this._geometries[G].apply(N),!N.isDone());G++);N.isGeometryChanged()&&this.geometryChanged()}else if(Pe(arguments[0],jt)){var le=arguments[0];le.filter(this);for(var xe=0;xe<this._geometries.length;xe++)this._geometries[xe].apply(le)}else if(Pe(arguments[0],ir)){var x=arguments[0];x.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(x)}},c.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),ce.shouldNeverReachHere(),null},c.prototype.clone=function(){var v=o.prototype.clone.call(this);v._geometries=new Array(this._geometries.length).fill(null);for(var A=0;A<this._geometries.length;A++)v._geometries[A]=this._geometries[A].clone();return v},c.prototype.getGeometryType=function(){return"GeometryCollection"},c.prototype.copy=function(){for(var v=new Array(this._geometries.length).fill(null),A=0;A<v.length;A++)v[A]=this._geometries[A].copy();return new c(v,this._factory)},c.prototype.isEmpty=function(){for(var v=0;v<this._geometries.length;v++)if(!this._geometries[v].isEmpty())return!1;return!0},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},g.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(c,g),c}(it),Ur=function(o){function c(){o.apply(this,arguments)}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={serialVersionUID:{configurable:!0}};return c.prototype.getSortIndex=function(){return it.SORTINDEX_MULTILINESTRING},c.prototype.equalsExact=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];return!!this.isEquivalentClass(v)&&o.prototype.equalsExact.call(this,v,A)}return o.prototype.equalsExact.apply(this,arguments)},c.prototype.getBoundaryDimension=function(){return this.isClosed()?Ot.FALSE:0},c.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var v=0;v<this._geometries.length;v++)if(!this._geometries[v].isClosed())return!1;return!0},c.prototype.getDimension=function(){return 1},c.prototype.reverse=function(){for(var v=this._geometries.length,A=new Array(v).fill(null),N=0;N<this._geometries.length;N++)A[v-1-N]=this._geometries[N].reverse();return this.getFactory().createMultiLineString(A)},c.prototype.getBoundary=function(){return new $r(this).getBoundary()},c.prototype.getGeometryType=function(){return"MultiLineString"},c.prototype.copy=function(){for(var v=new Array(this._geometries.length).fill(null),A=0;A<v.length;A++)v[A]=this._geometries[A].copy();return new c(v,this._factory)},c.prototype.interfaces_=function(){return[gt]},c.prototype.getClass=function(){return c},g.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(c,g),c}(Ht),$r=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var o=arguments[0],c=Ir.MOD2_BOUNDARY_RULE;this._geom=o,this._geomFact=o.getFactory(),this._bnRule=c}else if(arguments.length===2){var g=arguments[0],v=arguments[1];this._geom=g,this._geomFact=g.getFactory(),this._bnRule=v}};$r.prototype.boundaryMultiLineString=function(o){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var c=this.computeBoundaryCoordinates(o);return c.length===1?this._geomFact.createPoint(c[0]):this._geomFact.createMultiPointFromCoords(c)},$r.prototype.getBoundary=function(){return this._geom instanceof Fr?this.boundaryLineString(this._geom):this._geom instanceof Ur?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},$r.prototype.boundaryLineString=function(o){return this._geom.isEmpty()?this.getEmptyMultiPoint():o.isClosed()?this._bnRule.isInBoundary(2)?o.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([o.getStartPoint(),o.getEndPoint()])},$r.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},$r.prototype.computeBoundaryCoordinates=function(o){var c=new Et;this._endpointMap=new M;for(var g=0;g<o.getNumGeometries();g++){var v=o.getGeometryN(g);v.getNumPoints()!==0&&(this.addEndpoint(v.getCoordinateN(0)),this.addEndpoint(v.getCoordinateN(v.getNumPoints()-1)))}for(var A=this._endpointMap.entrySet().iterator();A.hasNext();){var N=A.next(),G=N.getValue().count;this._bnRule.isInBoundary(G)&&c.add(N.getKey())}return ne.toCoordinateArray(c)},$r.prototype.addEndpoint=function(o){var c=this._endpointMap.get(o);c===null&&(c=new zr,this._endpointMap.put(o,c)),c.count++},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.getBoundary=function(){if(arguments.length===1){var o=arguments[0];return new $r(o).getBoundary()}if(arguments.length===2){var c=arguments[0],g=arguments[1];return new $r(c,g).getBoundary()}};var zr=function(){this.count=null};zr.prototype.interfaces_=function(){return[]},zr.prototype.getClass=function(){return zr};var Cr=function(){},Zi={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr},Cr.chars=function(o,c){for(var g=new Array(c).fill(null),v=0;v<c;v++)g[v]=o;return String(g)},Cr.getStackTrace=function(){if(arguments.length===1){var o=arguments[0],c=new function(){},g=new function(){};return o.printStackTrace(g),c.toString()}if(arguments.length===2){for(var v=arguments[0],A=arguments[1],N="",G=new function(){}(new function(){}(Cr.getStackTrace(v))),le=0;le<A;le++)try{N+=G.readLine()+Cr.NEWLINE}catch(xe){if(!(xe instanceof q))throw xe;ce.shouldNeverReachHere()}return N}},Cr.split=function(o,c){for(var g=c.length,v=new Et,A=""+o,N=A.indexOf(c);N>=0;){var G=A.substring(0,N);v.add(G),N=(A=A.substring(N+g)).indexOf(c)}A.length>0&&v.add(A);for(var le=new Array(v.size()).fill(null),xe=0;xe<le.length;xe++)le[xe]=v.get(xe);return le},Cr.toString=function(){if(arguments.length===1){var o=arguments[0];return Cr.SIMPLE_ORDINATE_FORMAT.format(o)}},Cr.spaces=function(o){return Cr.chars(" ",o)},Zi.NEWLINE.get=function(){return pt.getProperty("line.separator")},Zi.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}},Object.defineProperties(Cr,Zi);var Ut=function(){};Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut},Ut.copyCoord=function(o,c,g,v){for(var A=Math.min(o.getDimension(),g.getDimension()),N=0;N<A;N++)g.setOrdinate(v,N,o.getOrdinate(c,N))},Ut.isRing=function(o){var c=o.size();return c===0||!(c<=3)&&o.getOrdinate(0,He.X)===o.getOrdinate(c-1,He.X)&&o.getOrdinate(0,He.Y)===o.getOrdinate(c-1,He.Y)},Ut.isEqual=function(o,c){var g=o.size();if(g!==c.size())return!1;for(var v=Math.min(o.getDimension(),c.getDimension()),A=0;A<g;A++)for(var N=0;N<v;N++){var G=o.getOrdinate(A,N),le=c.getOrdinate(A,N);if(o.getOrdinate(A,N)!==c.getOrdinate(A,N)&&(!H.isNaN(G)||!H.isNaN(le)))return!1}return!0},Ut.extend=function(o,c,g){var v=o.create(g,c.getDimension()),A=c.size();if(Ut.copy(c,0,v,0,A),A>0)for(var N=A;N<g;N++)Ut.copy(c,A-1,v,N,1);return v},Ut.reverse=function(o){for(var c=o.size()-1,g=Math.trunc(c/2),v=0;v<=g;v++)Ut.swap(o,v,c-v)},Ut.swap=function(o,c,g){if(c===g)return null;for(var v=0;v<o.getDimension();v++){var A=o.getOrdinate(c,v);o.setOrdinate(c,v,o.getOrdinate(g,v)),o.setOrdinate(g,v,A)}},Ut.copy=function(o,c,g,v,A){for(var N=0;N<A;N++)Ut.copyCoord(o,c+N,g,v+N)},Ut.toString=function(){if(arguments.length===1){var o=arguments[0],c=o.size();if(c===0)return"()";var g=o.getDimension(),v=new he;v.append("(");for(var A=0;A<c;A++){A>0&&v.append(" ");for(var N=0;N<g;N++)N>0&&v.append(","),v.append(Cr.toString(o.getOrdinate(A,N)))}return v.append(")"),v.toString()}},Ut.ensureValidRing=function(o,c){var g=c.size();return g===0?c:g<=3?Ut.createClosedRing(o,c,4):c.getOrdinate(0,He.X)===c.getOrdinate(g-1,He.X)&&c.getOrdinate(0,He.Y)===c.getOrdinate(g-1,He.Y)?c:Ut.createClosedRing(o,c,g+1)},Ut.createClosedRing=function(o,c,g){var v=o.create(g,c.getDimension()),A=c.size();Ut.copy(c,0,v,0,A);for(var N=A;N<g;N++)Ut.copy(c,0,v,N,1);return v};var Fr=function(o){function c(v,A){o.call(this,A),this._points=null,this.init(v)}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={serialVersionUID:{configurable:!0}};return c.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new mt:this._points.expandEnvelope(new mt)},c.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},c.prototype.getSortIndex=function(){return o.SORTINDEX_LINESTRING},c.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},c.prototype.equalsExact=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];if(!this.isEquivalentClass(v))return!1;var N=v;if(this._points.size()!==N._points.size())return!1;for(var G=0;G<this._points.size();G++)if(!this.equal(this._points.getCoordinate(G),N._points.getCoordinate(G),A))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},c.prototype.normalize=function(){for(var v=0;v<Math.trunc(this._points.size()/2);v++){var A=this._points.size()-1-v;if(!this._points.getCoordinate(v).equals(this._points.getCoordinate(A)))return this._points.getCoordinate(v).compareTo(this._points.getCoordinate(A))>0&&Ut.reverse(this._points),null}},c.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},c.prototype.getBoundaryDimension=function(){return this.isClosed()?Ot.FALSE:0},c.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},c.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},c.prototype.getDimension=function(){return 1},c.prototype.getLength=function(){return Qe.computeLength(this._points)},c.prototype.getNumPoints=function(){return this._points.size()},c.prototype.reverse=function(){var v=this._points.copy();return Ut.reverse(v),this.getFactory().createLineString(v)},c.prototype.compareToSameClass=function(){if(arguments.length===1){for(var v=arguments[0],A=0,N=0;A<this._points.size()&&N<v._points.size();){var G=this._points.getCoordinate(A).compareTo(v._points.getCoordinate(N));if(G!==0)return G;A++,N++}return A<this._points.size()?1:N<v._points.size()?-1:0}if(arguments.length===2){var le=arguments[0];return arguments[1].compare(this._points,le._points)}},c.prototype.apply=function(){if(Pe(arguments[0],Ar))for(var v=arguments[0],A=0;A<this._points.size();A++)v.filter(this._points.getCoordinate(A));else if(Pe(arguments[0],Xt)){var N=arguments[0];if(this._points.size()===0)return null;for(var G=0;G<this._points.size()&&(N.filter(this._points,G),!N.isDone());G++);N.isGeometryChanged()&&this.geometryChanged()}else Pe(arguments[0],jt)?arguments[0].filter(this):Pe(arguments[0],ir)&&arguments[0].filter(this)},c.prototype.getBoundary=function(){return new $r(this).getBoundary()},c.prototype.isEquivalentClass=function(v){return v instanceof c},c.prototype.clone=function(){var v=o.prototype.clone.call(this);return v._points=this._points.clone(),v},c.prototype.getCoordinateN=function(v){return this._points.getCoordinate(v)},c.prototype.getGeometryType=function(){return"LineString"},c.prototype.copy=function(){return new c(this._points.copy(),this._factory)},c.prototype.getCoordinateSequence=function(){return this._points},c.prototype.isEmpty=function(){return this._points.size()===0},c.prototype.init=function(v){if(v===null&&(v=this.getFactory().getCoordinateSequenceFactory().create([])),v.size()===1)throw new U("Invalid number of points in LineString (found "+v.size()+" - must be 0 or >= 2)");this._points=v},c.prototype.isCoordinate=function(v){for(var A=0;A<this._points.size();A++)if(this._points.getCoordinate(A).equals(v))return!0;return!1},c.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},c.prototype.getPointN=function(v){return this.getFactory().createPoint(this._points.getCoordinate(v))},c.prototype.interfaces_=function(){return[gt]},c.prototype.getClass=function(){return c},g.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(c,g),c}(it),_t=function(){};_t.prototype.interfaces_=function(){return[]},_t.prototype.getClass=function(){return _t};var Vr=function(o){function c(v,A){o.call(this,A),this._coordinates=v||null,this.init(this._coordinates)}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={serialVersionUID:{configurable:!0}};return c.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new mt;var v=new mt;return v.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),v},c.prototype.getSortIndex=function(){return o.SORTINDEX_POINT},c.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},c.prototype.equalsExact=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];return!!this.isEquivalentClass(v)&&(!(!this.isEmpty()||!v.isEmpty())||this.isEmpty()===v.isEmpty()&&this.equal(v.getCoordinate(),this.getCoordinate(),A))}return o.prototype.equalsExact.apply(this,arguments)},c.prototype.normalize=function(){},c.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},c.prototype.getBoundaryDimension=function(){return Ot.FALSE},c.prototype.getDimension=function(){return 0},c.prototype.getNumPoints=function(){return this.isEmpty()?0:1},c.prototype.reverse=function(){return this.copy()},c.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},c.prototype.compareToSameClass=function(){if(arguments.length===1){var v=arguments[0];return this.getCoordinate().compareTo(v.getCoordinate())}if(arguments.length===2){var A=arguments[0];return arguments[1].compare(this._coordinates,A._coordinates)}},c.prototype.apply=function(){if(Pe(arguments[0],Ar)){var v=arguments[0];if(this.isEmpty())return null;v.filter(this.getCoordinate())}else if(Pe(arguments[0],Xt)){var A=arguments[0];if(this.isEmpty())return null;A.filter(this._coordinates,0),A.isGeometryChanged()&&this.geometryChanged()}else Pe(arguments[0],jt)?arguments[0].filter(this):Pe(arguments[0],ir)&&arguments[0].filter(this)},c.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},c.prototype.clone=function(){var v=o.prototype.clone.call(this);return v._coordinates=this._coordinates.clone(),v},c.prototype.getGeometryType=function(){return"Point"},c.prototype.copy=function(){return new c(this._coordinates.copy(),this._factory)},c.prototype.getCoordinateSequence=function(){return this._coordinates},c.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},c.prototype.isEmpty=function(){return this._coordinates.size()===0},c.prototype.init=function(v){v===null&&(v=this.getFactory().getCoordinateSequenceFactory().create([])),ce.isTrue(v.size()<=1),this._coordinates=v},c.prototype.isSimple=function(){return!0},c.prototype.interfaces_=function(){return[_t]},c.prototype.getClass=function(){return c},g.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(c,g),c}(it),vi=function(){};vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi};var ii=function(o){function c(v,A,N){if(o.call(this,N),this._shell=null,this._holes=null,v===null&&(v=this.getFactory().createLinearRing()),A===null&&(A=[]),o.hasNullElements(A))throw new U("holes must not contain null elements");if(v.isEmpty()&&o.hasNonEmptyElements(A))throw new U("shell is empty but holes are not");this._shell=v,this._holes=A}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={serialVersionUID:{configurable:!0}};return c.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},c.prototype.getSortIndex=function(){return o.SORTINDEX_POLYGON},c.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var v=new Array(this.getNumPoints()).fill(null),A=-1,N=this._shell.getCoordinates(),G=0;G<N.length;G++)v[++A]=N[G];for(var le=0;le<this._holes.length;le++)for(var xe=this._holes[le].getCoordinates(),x=0;x<xe.length;x++)v[++A]=xe[x];return v},c.prototype.getArea=function(){var v=0;v+=Math.abs(Qe.signedArea(this._shell.getCoordinateSequence()));for(var A=0;A<this._holes.length;A++)v-=Math.abs(Qe.signedArea(this._holes[A].getCoordinateSequence()));return v},c.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var v=this._shell.getCoordinateSequence(),A=this.getEnvelopeInternal(),N=0;N<5;N++){var G=v.getX(N);if(G!==A.getMinX()&&G!==A.getMaxX())return!1;var le=v.getY(N);if(le!==A.getMinY()&&le!==A.getMaxY())return!1}for(var xe=v.getX(0),x=v.getY(0),a=1;a<=4;a++){var d=v.getX(a),b=v.getY(a);if(d!==xe==(b!==x))return!1;xe=d,x=b}return!0},c.prototype.equalsExact=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];if(!this.isEquivalentClass(v))return!1;var N=v,G=this._shell,le=N._shell;if(!G.equalsExact(le,A)||this._holes.length!==N._holes.length)return!1;for(var xe=0;xe<this._holes.length;xe++)if(!this._holes[xe].equalsExact(N._holes[xe],A))return!1;return!0}return o.prototype.equalsExact.apply(this,arguments)},c.prototype.normalize=function(){if(arguments.length===0){this.normalize(this._shell,!0);for(var v=0;v<this._holes.length;v++)this.normalize(this._holes[v],!1);ft.sort(this._holes)}else if(arguments.length===2){var A=arguments[0],N=arguments[1];if(A.isEmpty())return null;var G=new Array(A.getCoordinates().length-1).fill(null);pt.arraycopy(A.getCoordinates(),0,G,0,G.length);var le=ne.minCoordinate(A.getCoordinates());ne.scroll(G,le),pt.arraycopy(G,0,A.getCoordinates(),0,G.length),A.getCoordinates()[G.length]=G[0],Qe.isCCW(A.getCoordinates())===N&&ne.reverse(A.getCoordinates())}},c.prototype.getCoordinate=function(){return this._shell.getCoordinate()},c.prototype.getNumInteriorRing=function(){return this._holes.length},c.prototype.getBoundaryDimension=function(){return 1},c.prototype.getDimension=function(){return 2},c.prototype.getLength=function(){var v=0;v+=this._shell.getLength();for(var A=0;A<this._holes.length;A++)v+=this._holes[A].getLength();return v},c.prototype.getNumPoints=function(){for(var v=this._shell.getNumPoints(),A=0;A<this._holes.length;A++)v+=this._holes[A].getNumPoints();return v},c.prototype.reverse=function(){var v=this.copy();v._shell=this._shell.copy().reverse(),v._holes=new Array(this._holes.length).fill(null);for(var A=0;A<this._holes.length;A++)v._holes[A]=this._holes[A].copy().reverse();return v},c.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},c.prototype.compareToSameClass=function(){if(arguments.length===1){var v=arguments[0],A=this._shell,N=v._shell;return A.compareToSameClass(N)}if(arguments.length===2){var G=arguments[0],le=arguments[1],xe=G,x=this._shell,a=xe._shell,d=x.compareToSameClass(a,le);if(d!==0)return d;for(var b=this.getNumInteriorRing(),w=xe.getNumInteriorRing(),I=0;I<b&&I<w;){var L=this.getInteriorRingN(I),F=xe.getInteriorRingN(I),j=L.compareToSameClass(F,le);if(j!==0)return j;I++}return I<b?1:I<w?-1:0}},c.prototype.apply=function(v){if(Pe(v,Ar)){this._shell.apply(v);for(var A=0;A<this._holes.length;A++)this._holes[A].apply(v)}else if(Pe(v,Xt)){if(this._shell.apply(v),!v.isDone())for(var N=0;N<this._holes.length&&(this._holes[N].apply(v),!v.isDone());N++);v.isGeometryChanged()&&this.geometryChanged()}else if(Pe(v,jt))v.filter(this);else if(Pe(v,ir)){v.filter(this),this._shell.apply(v);for(var G=0;G<this._holes.length;G++)this._holes[G].apply(v)}},c.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var v=new Array(this._holes.length+1).fill(null);v[0]=this._shell;for(var A=0;A<this._holes.length;A++)v[A+1]=this._holes[A];return v.length<=1?this.getFactory().createLinearRing(v[0].getCoordinateSequence()):this.getFactory().createMultiLineString(v)},c.prototype.clone=function(){var v=o.prototype.clone.call(this);v._shell=this._shell.clone(),v._holes=new Array(this._holes.length).fill(null);for(var A=0;A<this._holes.length;A++)v._holes[A]=this._holes[A].clone();return v},c.prototype.getGeometryType=function(){return"Polygon"},c.prototype.copy=function(){for(var v=this._shell.copy(),A=new Array(this._holes.length).fill(null),N=0;N<A.length;N++)A[N]=this._holes[N].copy();return new c(v,A,this._factory)},c.prototype.getExteriorRing=function(){return this._shell},c.prototype.isEmpty=function(){return this._shell.isEmpty()},c.prototype.getInteriorRingN=function(v){return this._holes[v]},c.prototype.interfaces_=function(){return[vi]},c.prototype.getClass=function(){return c},g.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(c,g),c}(it),ci=function(o){function c(){o.apply(this,arguments)}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={serialVersionUID:{configurable:!0}};return c.prototype.getSortIndex=function(){return it.SORTINDEX_MULTIPOINT},c.prototype.isValid=function(){return!0},c.prototype.equalsExact=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];return!!this.isEquivalentClass(v)&&o.prototype.equalsExact.call(this,v,A)}return o.prototype.equalsExact.apply(this,arguments)},c.prototype.getCoordinate=function(){if(arguments.length===1){var v=arguments[0];return this._geometries[v].getCoordinate()}return o.prototype.getCoordinate.apply(this,arguments)},c.prototype.getBoundaryDimension=function(){return Ot.FALSE},c.prototype.getDimension=function(){return 0},c.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},c.prototype.getGeometryType=function(){return"MultiPoint"},c.prototype.copy=function(){for(var v=new Array(this._geometries.length).fill(null),A=0;A<v.length;A++)v[A]=this._geometries[A].copy();return new c(v,this._factory)},c.prototype.interfaces_=function(){return[_t]},c.prototype.getClass=function(){return c},g.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(c,g),c}(Ht),hi=function(o){function c(v,A){v instanceof J&&A instanceof Rr&&(v=A.getCoordinateSequenceFactory().create(v)),o.call(this,v,A),this.validateConstruction()}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return c.prototype.getSortIndex=function(){return it.SORTINDEX_LINEARRING},c.prototype.getBoundaryDimension=function(){return Ot.FALSE},c.prototype.isClosed=function(){return!!this.isEmpty()||o.prototype.isClosed.call(this)},c.prototype.reverse=function(){var v=this._points.copy();return Ut.reverse(v),this.getFactory().createLinearRing(v)},c.prototype.validateConstruction=function(){if(!this.isEmpty()&&!o.prototype.isClosed.call(this))throw new U("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<c.MINIMUM_VALID_SIZE)throw new U("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},c.prototype.getGeometryType=function(){return"LinearRing"},c.prototype.copy=function(){return new c(this._points.copy(),this._factory)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},g.MINIMUM_VALID_SIZE.get=function(){return 4},g.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(c,g),c}(Fr),Bo=function(o){function c(){o.apply(this,arguments)}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={serialVersionUID:{configurable:!0}};return c.prototype.getSortIndex=function(){return it.SORTINDEX_MULTIPOLYGON},c.prototype.equalsExact=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];return!!this.isEquivalentClass(v)&&o.prototype.equalsExact.call(this,v,A)}return o.prototype.equalsExact.apply(this,arguments)},c.prototype.getBoundaryDimension=function(){return 1},c.prototype.getDimension=function(){return 2},c.prototype.reverse=function(){for(var v=this._geometries.length,A=new Array(v).fill(null),N=0;N<this._geometries.length;N++)A[N]=this._geometries[N].reverse();return this.getFactory().createMultiPolygon(A)},c.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var v=new Et,A=0;A<this._geometries.length;A++)for(var N=this._geometries[A].getBoundary(),G=0;G<N.getNumGeometries();G++)v.add(N.getGeometryN(G));var le=new Array(v.size()).fill(null);return this.getFactory().createMultiLineString(v.toArray(le))},c.prototype.getGeometryType=function(){return"MultiPolygon"},c.prototype.copy=function(){for(var v=new Array(this._geometries.length).fill(null),A=0;A<v.length;A++)v[A]=this._geometries[A].copy();return new c(v,this._factory)},c.prototype.interfaces_=function(){return[vi]},c.prototype.getClass=function(){return c},g.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(c,g),c}(Ht),ji=function(o){this._factory=o||null,this._isUserDataCopied=!1},Qn={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ji.prototype.setCopyUserData=function(o){this._isUserDataCopied=o},ji.prototype.edit=function(o,c){if(o===null)return null;var g=this.editInternal(o,c);return this._isUserDataCopied&&g.setUserData(o.getUserData()),g},ji.prototype.editInternal=function(o,c){return this._factory===null&&(this._factory=o.getFactory()),o instanceof Ht?this.editGeometryCollection(o,c):o instanceof ii?this.editPolygon(o,c):o instanceof Vr?c.edit(o,this._factory):o instanceof Fr?c.edit(o,this._factory):(ce.shouldNeverReachHere("Unsupported Geometry class: "+o.getClass().getName()),null)},ji.prototype.editGeometryCollection=function(o,c){for(var g=c.edit(o,this._factory),v=new Et,A=0;A<g.getNumGeometries();A++){var N=this.edit(g.getGeometryN(A),c);N===null||N.isEmpty()||v.add(N)}return g.getClass()===ci?this._factory.createMultiPoint(v.toArray([])):g.getClass()===Ur?this._factory.createMultiLineString(v.toArray([])):g.getClass()===Bo?this._factory.createMultiPolygon(v.toArray([])):this._factory.createGeometryCollection(v.toArray([]))},ji.prototype.editPolygon=function(o,c){var g=c.edit(o,this._factory);if(g===null&&(g=this._factory.createPolygon(null)),g.isEmpty())return g;var v=this.edit(g.getExteriorRing(),c);if(v===null||v.isEmpty())return this._factory.createPolygon();for(var A=new Et,N=0;N<g.getNumInteriorRing();N++){var G=this.edit(g.getInteriorRingN(N),c);G===null||G.isEmpty()||A.add(G)}return this._factory.createPolygon(v,A.toArray([]))},ji.prototype.interfaces_=function(){return[]},ji.prototype.getClass=function(){return ji},ji.GeometryEditorOperation=function(){},Qn.NoOpGeometryOperation.get=function(){return Eo},Qn.CoordinateOperation.get=function(){return Xo},Qn.CoordinateSequenceOperation.get=function(){return Xn},Object.defineProperties(ji,Qn);var Eo=function(){};Eo.prototype.edit=function(o,c){return o},Eo.prototype.interfaces_=function(){return[ji.GeometryEditorOperation]},Eo.prototype.getClass=function(){return Eo};var Xo=function(){};Xo.prototype.edit=function(o,c){var g=this.editCoordinates(o.getCoordinates(),o);return g===null?o:o instanceof hi?c.createLinearRing(g):o instanceof Fr?c.createLineString(g):o instanceof Vr?g.length>0?c.createPoint(g[0]):c.createPoint():o},Xo.prototype.interfaces_=function(){return[ji.GeometryEditorOperation]},Xo.prototype.getClass=function(){return Xo};var Xn=function(){};Xn.prototype.edit=function(o,c){return o instanceof hi?c.createLinearRing(this.edit(o.getCoordinateSequence(),o)):o instanceof Fr?c.createLineString(this.edit(o.getCoordinateSequence(),o)):o instanceof Vr?c.createPoint(this.edit(o.getCoordinateSequence(),o)):o},Xn.prototype.interfaces_=function(){return[ji.GeometryEditorOperation]},Xn.prototype.getClass=function(){return Xn};var kn=function(){if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var o=arguments[0];this._coordinates=new Array(o).fill(null);for(var c=0;c<o;c++)this._coordinates[c]=new J}else if(Pe(arguments[0],He)){var g=arguments[0];if(g===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=g.getDimension(),this._coordinates=new Array(g.size()).fill(null);for(var v=0;v<this._coordinates.length;v++)this._coordinates[v]=g.getCoordinateCopy(v)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var A=arguments[0],N=arguments[1];this._coordinates=A,this._dimension=N,A===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var G=arguments[0],le=arguments[1];this._coordinates=new Array(G).fill(null),this._dimension=le;for(var xe=0;xe<G;xe++)this._coordinates[xe]=new J}}},Ui={serialVersionUID:{configurable:!0}};kn.prototype.setOrdinate=function(o,c,g){switch(c){case He.X:this._coordinates[o].x=g;break;case He.Y:this._coordinates[o].y=g;break;case He.Z:this._coordinates[o].z=g;break;default:throw new U("invalid ordinateIndex")}},kn.prototype.size=function(){return this._coordinates.length},kn.prototype.getOrdinate=function(o,c){switch(c){case He.X:return this._coordinates[o].x;case He.Y:return this._coordinates[o].y;case He.Z:return this._coordinates[o].z}return H.NaN},kn.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._coordinates[o]}if(arguments.length===2){var c=arguments[0],g=arguments[1];g.x=this._coordinates[c].x,g.y=this._coordinates[c].y,g.z=this._coordinates[c].z}},kn.prototype.getCoordinateCopy=function(o){return new J(this._coordinates[o])},kn.prototype.getDimension=function(){return this._dimension},kn.prototype.getX=function(o){return this._coordinates[o].x},kn.prototype.clone=function(){for(var o=new Array(this.size()).fill(null),c=0;c<this._coordinates.length;c++)o[c]=this._coordinates[c].clone();return new kn(o,this._dimension)},kn.prototype.expandEnvelope=function(o){for(var c=0;c<this._coordinates.length;c++)o.expandToInclude(this._coordinates[c]);return o},kn.prototype.copy=function(){for(var o=new Array(this.size()).fill(null),c=0;c<this._coordinates.length;c++)o[c]=this._coordinates[c].copy();return new kn(o,this._dimension)},kn.prototype.toString=function(){if(this._coordinates.length>0){var o=new he(17*this._coordinates.length);o.append("("),o.append(this._coordinates[0]);for(var c=1;c<this._coordinates.length;c++)o.append(", "),o.append(this._coordinates[c]);return o.append(")"),o.toString()}return"()"},kn.prototype.getY=function(o){return this._coordinates[o].y},kn.prototype.toCoordinateArray=function(){return this._coordinates},kn.prototype.interfaces_=function(){return[He,n]},kn.prototype.getClass=function(){return kn},Ui.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(kn,Ui);var mo=function(){},zo={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};mo.prototype.readResolve=function(){return mo.instance()},mo.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new kn(o)}if(Pe(arguments[0],He)){var c=arguments[0];return new kn(c)}}else if(arguments.length===2){var g=arguments[0],v=arguments[1];return v>3&&(v=3),v<2?new kn(g):new kn(g,v)}},mo.prototype.interfaces_=function(){return[Ae,n]},mo.prototype.getClass=function(){return mo},mo.instance=function(){return mo.instanceObject},zo.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},zo.instanceObject.get=function(){return new mo},Object.defineProperties(mo,zo);var Ls=function(o){function c(){o.call(this),this.map_=new Map}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.get=function(g){return this.map_.get(g)||null},c.prototype.put=function(g,v){return this.map_.set(g,v),v},c.prototype.values=function(){for(var g=new Et,v=this.map_.values(),A=v.next();!A.done;)g.add(A.value),A=v.next();return g},c.prototype.entrySet=function(){var g=new Ve;return this.map_.entries().forEach(function(v){return g.add(v)}),g},c.prototype.size=function(){return this.map_.size()},c}(Ue),er=function o(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=o.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof $i){var c=arguments[0];this._modelType=c,c===o.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var g=arguments[0];this._modelType=o.FIXED,this.setScale(g)}else if(arguments[0]instanceof o){var v=arguments[0];this._modelType=v._modelType,this._scale=v._scale}}},Rs={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};er.prototype.equals=function(o){if(!(o instanceof er))return!1;var c=o;return this._modelType===c._modelType&&this._scale===c._scale},er.prototype.compareTo=function(o){var c=o,g=this.getMaximumSignificantDigits(),v=c.getMaximumSignificantDigits();return new fe(g).compareTo(new fe(v))},er.prototype.getScale=function(){return this._scale},er.prototype.isFloating=function(){return this._modelType===er.FLOATING||this._modelType===er.FLOATING_SINGLE},er.prototype.getType=function(){return this._modelType},er.prototype.toString=function(){var o="UNKNOWN";return this._modelType===er.FLOATING?o="Floating":this._modelType===er.FLOATING_SINGLE?o="Floating-Single":this._modelType===er.FIXED&&(o="Fixed (Scale="+this.getScale()+")"),o},er.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var o=arguments[0];return H.isNaN(o)||this._modelType===er.FLOATING_SINGLE?o:this._modelType===er.FIXED?Math.round(o*this._scale)/this._scale:o}if(arguments[0]instanceof J){var c=arguments[0];if(this._modelType===er.FLOATING)return null;c.x=this.makePrecise(c.x),c.y=this.makePrecise(c.y)}},er.prototype.getMaximumSignificantDigits=function(){var o=16;return this._modelType===er.FLOATING?o=16:this._modelType===er.FLOATING_SINGLE?o=6:this._modelType===er.FIXED&&(o=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),o},er.prototype.setScale=function(o){this._scale=Math.abs(o)},er.prototype.interfaces_=function(){return[n,ie]},er.prototype.getClass=function(){return er},er.mostPrecise=function(o,c){return o.compareTo(c)>=0?o:c},Rs.serialVersionUID.get=function(){return 7777263578777804e3},Rs.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(er,Rs);var $i=function o(c){this._name=c||null,o.nameToTypeMap.put(c,this)},ha={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};$i.prototype.readResolve=function(){return $i.nameToTypeMap.get(this._name)},$i.prototype.toString=function(){return this._name},$i.prototype.interfaces_=function(){return[n]},$i.prototype.getClass=function(){return $i},ha.serialVersionUID.get=function(){return-552860263173159e4},ha.nameToTypeMap.get=function(){return new Ls},Object.defineProperties($i,ha),er.Type=$i,er.FIXED=new $i("FIXED"),er.FLOATING=new $i("FLOATING"),er.FLOATING_SINGLE=new $i("FLOATING SINGLE");var Rr=function o(){this._precisionModel=new er,this._SRID=0,this._coordinateSequenceFactory=o.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Pe(arguments[0],Ae)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof er&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Ds={serialVersionUID:{configurable:!0}};Rr.prototype.toGeometry=function(o){return o.isNull()?this.createPoint(null):o.getMinX()===o.getMaxX()&&o.getMinY()===o.getMaxY()?this.createPoint(new J(o.getMinX(),o.getMinY())):o.getMinX()===o.getMaxX()||o.getMinY()===o.getMaxY()?this.createLineString([new J(o.getMinX(),o.getMinY()),new J(o.getMaxX(),o.getMaxY())]):this.createPolygon(this.createLinearRing([new J(o.getMinX(),o.getMinY()),new J(o.getMinX(),o.getMaxY()),new J(o.getMaxX(),o.getMaxY()),new J(o.getMaxX(),o.getMinY()),new J(o.getMinX(),o.getMinY())]),null)},Rr.prototype.createLineString=function(o){return o?o instanceof Array?new Fr(this.getCoordinateSequenceFactory().create(o),this):Pe(o,He)?new Fr(o,this):void 0:new Fr(this.getCoordinateSequenceFactory().create([]),this)},Rr.prototype.createMultiLineString=function(){if(arguments.length===0)return new Ur(null,this);if(arguments.length===1){var o=arguments[0];return new Ur(o,this)}},Rr.prototype.buildGeometry=function(o){for(var c=null,g=!1,v=!1,A=o.iterator();A.hasNext();){var N=A.next(),G=N.getClass();c===null&&(c=G),G!==c&&(g=!0),N.isGeometryCollectionOrDerived()&&(v=!0)}if(c===null)return this.createGeometryCollection();if(g||v)return this.createGeometryCollection(Rr.toGeometryArray(o));var le=o.iterator().next();if(o.size()>1){if(le instanceof ii)return this.createMultiPolygon(Rr.toPolygonArray(o));if(le instanceof Fr)return this.createMultiLineString(Rr.toLineStringArray(o));if(le instanceof Vr)return this.createMultiPoint(Rr.toPointArray(o));ce.shouldNeverReachHere("Unhandled class: "+le.getClass().getName())}return le},Rr.prototype.createMultiPointFromCoords=function(o){return this.createMultiPoint(o!==null?this.getCoordinateSequenceFactory().create(o):null)},Rr.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof J){var o=arguments[0];return this.createPoint(o!==null?this.getCoordinateSequenceFactory().create([o]):null)}if(Pe(arguments[0],He)){var c=arguments[0];return new Vr(c,this)}}},Rr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Rr.prototype.createPolygon=function(){if(arguments.length===0)return new ii(null,null,this);if(arguments.length===1){if(Pe(arguments[0],He)){var o=arguments[0];return this.createPolygon(this.createLinearRing(o))}if(arguments[0]instanceof Array){var c=arguments[0];return this.createPolygon(this.createLinearRing(c))}if(arguments[0]instanceof hi){var g=arguments[0];return this.createPolygon(g,null)}}else if(arguments.length===2){var v=arguments[0],A=arguments[1];return new ii(v,A,this)}},Rr.prototype.getSRID=function(){return this._SRID},Rr.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Ht(null,this);if(arguments.length===1){var o=arguments[0];return new Ht(o,this)}},Rr.prototype.createGeometry=function(o){return new ji(this).edit(o,{edit:function(){if(arguments.length===2){var c=arguments[0];return this._coordinateSequenceFactory.create(c)}}})},Rr.prototype.getPrecisionModel=function(){return this._precisionModel},Rr.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return this.createLinearRing(o!==null?this.getCoordinateSequenceFactory().create(o):null)}if(Pe(arguments[0],He)){var c=arguments[0];return new hi(c,this)}}},Rr.prototype.createMultiPolygon=function(){if(arguments.length===0)return new Bo(null,this);if(arguments.length===1){var o=arguments[0];return new Bo(o,this)}},Rr.prototype.createMultiPoint=function(){if(arguments.length===0)return new ci(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return new ci(o,this)}if(arguments[0]instanceof Array){var c=arguments[0];return this.createMultiPoint(c!==null?this.getCoordinateSequenceFactory().create(c):null)}if(Pe(arguments[0],He)){var g=arguments[0];if(g===null)return this.createMultiPoint(new Array(0).fill(null));for(var v=new Array(g.size()).fill(null),A=0;A<g.size();A++){var N=this.getCoordinateSequenceFactory().create(1,g.getDimension());Ut.copy(g,A,N,0,1),v[A]=this.createPoint(N)}return this.createMultiPoint(v)}}},Rr.prototype.interfaces_=function(){return[n]},Rr.prototype.getClass=function(){return Rr},Rr.toMultiPolygonArray=function(o){var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.toGeometryArray=function(o){if(o===null)return null;var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.getDefaultCoordinateSequenceFactory=function(){return mo.instance()},Rr.toMultiLineStringArray=function(o){var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.toLineStringArray=function(o){var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.toMultiPointArray=function(o){var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.toLinearRingArray=function(o){var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.toPointArray=function(o){var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.toPolygonArray=function(o){var c=new Array(o.size()).fill(null);return o.toArray(c)},Rr.createPointFromInternalCoord=function(o,c){return c.getPrecisionModel().makePrecise(o),c.getFactory().createPoint(o)},Ds.serialVersionUID.get=function(){return-6820524753094096e3},Object.defineProperties(Rr,Ds);var Il=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ws=function(o){this.geometryFactory=o||new Rr};Ws.prototype.read=function(o){var c,g=(c=typeof o=="string"?JSON.parse(o):o).type;if(!Hi[g])throw new Error("Unknown GeoJSON type: "+c.type);return Il.indexOf(g)!==-1?Hi[g].apply(this,[c.coordinates]):g==="GeometryCollection"?Hi[g].apply(this,[c.geometries]):Hi[g].apply(this,[c])},Ws.prototype.write=function(o){var c=o.getGeometryType();if(!Yo[c])throw new Error("Geometry is not supported");return Yo[c].apply(this,[o])};var Hi={Feature:function(o){var c={};for(var g in o)c[g]=o[g];if(o.geometry){var v=o.geometry.type;if(!Hi[v])throw new Error("Unknown GeoJSON type: "+o.type);c.geometry=this.read(o.geometry)}return o.bbox&&(c.bbox=Hi.bbox.apply(this,[o.bbox])),c},FeatureCollection:function(o){var c={};if(o.features){c.features=[];for(var g=0;g<o.features.length;++g)c.features.push(this.read(o.features[g]))}return o.bbox&&(c.bbox=this.parse.bbox.apply(this,[o.bbox])),c},coordinates:function(o){for(var c=[],g=0;g<o.length;++g){var v=o[g];c.push(new J(v[0],v[1]))}return c},bbox:function(o){return this.geometryFactory.createLinearRing([new J(o[0],o[1]),new J(o[2],o[1]),new J(o[2],o[3]),new J(o[0],o[3]),new J(o[0],o[1])])},Point:function(o){var c=new J(o[0],o[1]);return this.geometryFactory.createPoint(c)},MultiPoint:function(o){for(var c=[],g=0;g<o.length;++g)c.push(Hi.Point.apply(this,[o[g]]));return this.geometryFactory.createMultiPoint(c)},LineString:function(o){var c=Hi.coordinates.apply(this,[o]);return this.geometryFactory.createLineString(c)},MultiLineString:function(o){for(var c=[],g=0;g<o.length;++g)c.push(Hi.LineString.apply(this,[o[g]]));return this.geometryFactory.createMultiLineString(c)},Polygon:function(o){for(var c=Hi.coordinates.apply(this,[o[0]]),g=this.geometryFactory.createLinearRing(c),v=[],A=1;A<o.length;++A){var N=o[A],G=Hi.coordinates.apply(this,[N]),le=this.geometryFactory.createLinearRing(G);v.push(le)}return this.geometryFactory.createPolygon(g,v)},MultiPolygon:function(o){for(var c=[],g=0;g<o.length;++g){var v=o[g];c.push(Hi.Polygon.apply(this,[v]))}return this.geometryFactory.createMultiPolygon(c)},GeometryCollection:function(o){for(var c=[],g=0;g<o.length;++g){var v=o[g];c.push(this.read(v))}return this.geometryFactory.createGeometryCollection(c)}},Yo={coordinate:function(o){return[o.x,o.y]},Point:function(o){return{type:"Point",coordinates:Yo.coordinate.apply(this,[o.getCoordinate()])}},MultiPoint:function(o){for(var c=[],g=0;g<o._geometries.length;++g){var v=o._geometries[g],A=Yo.Point.apply(this,[v]);c.push(A.coordinates)}return{type:"MultiPoint",coordinates:c}},LineString:function(o){for(var c=[],g=o.getCoordinates(),v=0;v<g.length;++v){var A=g[v];c.push(Yo.coordinate.apply(this,[A]))}return{type:"LineString",coordinates:c}},MultiLineString:function(o){for(var c=[],g=0;g<o._geometries.length;++g){var v=o._geometries[g],A=Yo.LineString.apply(this,[v]);c.push(A.coordinates)}return{type:"MultiLineString",coordinates:c}},Polygon:function(o){var c=[],g=Yo.LineString.apply(this,[o._shell]);c.push(g.coordinates);for(var v=0;v<o._holes.length;++v){var A=o._holes[v],N=Yo.LineString.apply(this,[A]);c.push(N.coordinates)}return{type:"Polygon",coordinates:c}},MultiPolygon:function(o){for(var c=[],g=0;g<o._geometries.length;++g){var v=o._geometries[g],A=Yo.Polygon.apply(this,[v]);c.push(A.coordinates)}return{type:"MultiPolygon",coordinates:c}},GeometryCollection:function(o){for(var c=[],g=0;g<o._geometries.length;++g){var v=o._geometries[g],A=v.getGeometryType();c.push(Yo[A].apply(this,[v]))}return{type:"GeometryCollection",geometries:c}}},Zs=function(o){this.geometryFactory=o||new Rr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ws(this.geometryFactory)};Zs.prototype.read=function(o){var c=this.parser.read(o);return this.precisionModel.getType()===er.FIXED&&this.reducePrecision(c),c},Zs.prototype.reducePrecision=function(o){var c,g;if(o.coordinate)this.precisionModel.makePrecise(o.coordinate);else if(o.points)for(c=0,g=o.points.length;c<g;c++)this.precisionModel.makePrecise(o.points[c]);else if(o.geometries)for(c=0,g=o.geometries.length;c<g;c++)this.reducePrecision(o.geometries[c])};var Qu=function(){this.parser=new Ws(this.geometryFactory)};Qu.prototype.write=function(o){return this.parser.write(o)};var Pt=function(){},Hs={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Pt.prototype.interfaces_=function(){return[]},Pt.prototype.getClass=function(){return Pt},Pt.opposite=function(o){return o===Pt.LEFT?Pt.RIGHT:o===Pt.RIGHT?Pt.LEFT:o},Hs.ON.get=function(){return 0},Hs.LEFT.get=function(){return 1},Hs.RIGHT.get=function(){return 2},Object.defineProperties(Pt,Hs),(X.prototype=new Error).name="EmptyStackException",(R.prototype=new Lr).add=function(o){return this.array_.push(o),!0},R.prototype.get=function(o){if(o<0||o>=this.size())throw new Error;return this.array_[o]},R.prototype.push=function(o){return this.array_.push(o),o},R.prototype.pop=function(o){if(this.array_.length===0)throw new X;return this.array_.pop()},R.prototype.peek=function(){if(this.array_.length===0)throw new X;return this.array_[this.array_.length-1]},R.prototype.empty=function(){return this.array_.length===0},R.prototype.isEmpty=function(){return this.empty()},R.prototype.search=function(o){return this.array_.indexOf(o)},R.prototype.size=function(){return this.array_.length},R.prototype.toArray=function(){for(var o=[],c=0,g=this.array_.length;c<g;c++)o.push(this.array_[c]);return o};var io=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};io.prototype.getCoordinate=function(){return this._minCoord},io.prototype.getRightmostSide=function(o,c){var g=this.getRightmostSideOfSegment(o,c);return g<0&&(g=this.getRightmostSideOfSegment(o,c-1)),g<0&&(this._minCoord=null,this.checkForRightmostCoordinate(o)),g},io.prototype.findRightmostEdgeAtVertex=function(){var o=this._minDe.getEdge().getCoordinates();ce.isTrue(this._minIndex>0&&this._minIndex<o.length,"rightmost point expected to be interior vertex of edge");var c=o[this._minIndex-1],g=o[this._minIndex+1],v=Qe.computeOrientation(this._minCoord,g,c),A=!1;(c.y<this._minCoord.y&&g.y<this._minCoord.y&&v===Qe.COUNTERCLOCKWISE||c.y>this._minCoord.y&&g.y>this._minCoord.y&&v===Qe.CLOCKWISE)&&(A=!0),A&&(this._minIndex=this._minIndex-1)},io.prototype.getRightmostSideOfSegment=function(o,c){var g=o.getEdge().getCoordinates();if(c<0||c+1>=g.length||g[c].y===g[c+1].y)return-1;var v=Pt.LEFT;return g[c].y<g[c+1].y&&(v=Pt.RIGHT),v},io.prototype.getEdge=function(){return this._orientedDe},io.prototype.checkForRightmostCoordinate=function(o){for(var c=o.getEdge().getCoordinates(),g=0;g<c.length-1;g++)(this._minCoord===null||c[g].x>this._minCoord.x)&&(this._minDe=o,this._minIndex=g,this._minCoord=c[g])},io.prototype.findRightmostEdgeAtNode=function(){var o=this._minDe.getNode().getEdges();this._minDe=o.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},io.prototype.findEdge=function(o){for(var c=o.iterator();c.hasNext();){var g=c.next();g.isForward()&&this.checkForRightmostCoordinate(g)}ce.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Pt.LEFT&&(this._orientedDe=this._minDe.getSym())},io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io};var Wo=function(o){function c(g,v){o.call(this,c.msgWithCoord(g,v)),this.pt=v?new J(v):null,this.name="TopologyException"}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.getCoordinate=function(){return this.pt},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c.msgWithCoord=function(g,v){return v?g:g+" [ "+v+" ]"},c}(rt),Js=function(){this.array_=[]};Js.prototype.addLast=function(o){this.array_.push(o)},Js.prototype.removeFirst=function(){return this.array_.shift()},Js.prototype.isEmpty=function(){return this.array_.length===0};var fi=function(){this._finder=null,this._dirEdgeList=new Et,this._nodes=new Et,this._rightMostCoord=null,this._env=null,this._finder=new io};fi.prototype.clearVisitedEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();)o.next().setVisited(!1)},fi.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},fi.prototype.computeNodeDepth=function(o){for(var c=null,g=o.getEdges().iterator();g.hasNext();){var v=g.next();if(v.isVisited()||v.getSym().isVisited()){c=v;break}}if(c===null)throw new Wo("unable to find edge to compute depths at "+o.getCoordinate());o.getEdges().computeDepths(c);for(var A=o.getEdges().iterator();A.hasNext();){var N=A.next();N.setVisited(!0),this.copySymDepths(N)}},fi.prototype.computeDepth=function(o){this.clearVisitedEdges();var c=this._finder.getEdge();c.setEdgeDepths(Pt.RIGHT,o),this.copySymDepths(c),this.computeDepths(c)},fi.prototype.create=function(o){this.addReachable(o),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},fi.prototype.findResultEdges=function(){for(var o=this._dirEdgeList.iterator();o.hasNext();){var c=o.next();c.getDepth(Pt.RIGHT)>=1&&c.getDepth(Pt.LEFT)<=0&&!c.isInteriorAreaEdge()&&c.setInResult(!0)}},fi.prototype.computeDepths=function(o){var c=new Ve,g=new Js,v=o.getNode();for(g.addLast(v),c.add(v),o.setVisited(!0);!g.isEmpty();){var A=g.removeFirst();c.add(A),this.computeNodeDepth(A);for(var N=A.getEdges().iterator();N.hasNext();){var G=N.next().getSym();if(!G.isVisited()){var le=G.getNode();c.contains(le)||(g.addLast(le),c.add(le))}}}},fi.prototype.compareTo=function(o){var c=o;return this._rightMostCoord.x<c._rightMostCoord.x?-1:this._rightMostCoord.x>c._rightMostCoord.x?1:0},fi.prototype.getEnvelope=function(){if(this._env===null){for(var o=new mt,c=this._dirEdgeList.iterator();c.hasNext();)for(var g=c.next().getEdge().getCoordinates(),v=0;v<g.length-1;v++)o.expandToInclude(g[v]);this._env=o}return this._env},fi.prototype.addReachable=function(o){var c=new R;for(c.add(o);!c.empty();){var g=c.pop();this.add(g,c)}},fi.prototype.copySymDepths=function(o){var c=o.getSym();c.setDepth(Pt.LEFT,o.getDepth(Pt.RIGHT)),c.setDepth(Pt.RIGHT,o.getDepth(Pt.LEFT))},fi.prototype.add=function(o,c){o.setVisited(!0),this._nodes.add(o);for(var g=o.getEdges().iterator();g.hasNext();){var v=g.next();this._dirEdgeList.add(v);var A=v.getSym().getNode();A.isVisited()||c.push(A)}},fi.prototype.getNodes=function(){return this._nodes},fi.prototype.getDirectedEdges=function(){return this._dirEdgeList},fi.prototype.interfaces_=function(){return[ie]},fi.prototype.getClass=function(){return fi};var an=function o(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var c=arguments[0];this.init(c.length)}else if(Number.isInteger(arguments[0])){var g=arguments[0];this.init(1),this.location[Pt.ON]=g}else if(arguments[0]instanceof o){var v=arguments[0];if(this.init(v.location.length),v!==null)for(var A=0;A<this.location.length;A++)this.location[A]=v.location[A]}}else if(arguments.length===3){var N=arguments[0],G=arguments[1],le=arguments[2];this.init(3),this.location[Pt.ON]=N,this.location[Pt.LEFT]=G,this.location[Pt.RIGHT]=le}};an.prototype.setAllLocations=function(o){for(var c=0;c<this.location.length;c++)this.location[c]=o},an.prototype.isNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]!==ae.NONE)return!1;return!0},an.prototype.setAllLocationsIfNull=function(o){for(var c=0;c<this.location.length;c++)this.location[c]===ae.NONE&&(this.location[c]=o)},an.prototype.isLine=function(){return this.location.length===1},an.prototype.merge=function(o){if(o.location.length>this.location.length){var c=new Array(3).fill(null);c[Pt.ON]=this.location[Pt.ON],c[Pt.LEFT]=ae.NONE,c[Pt.RIGHT]=ae.NONE,this.location=c}for(var g=0;g<this.location.length;g++)this.location[g]===ae.NONE&&g<o.location.length&&(this.location[g]=o.location[g])},an.prototype.getLocations=function(){return this.location},an.prototype.flip=function(){if(this.location.length<=1)return null;var o=this.location[Pt.LEFT];this.location[Pt.LEFT]=this.location[Pt.RIGHT],this.location[Pt.RIGHT]=o},an.prototype.toString=function(){var o=new he;return this.location.length>1&&o.append(ae.toLocationSymbol(this.location[Pt.LEFT])),o.append(ae.toLocationSymbol(this.location[Pt.ON])),this.location.length>1&&o.append(ae.toLocationSymbol(this.location[Pt.RIGHT])),o.toString()},an.prototype.setLocations=function(o,c,g){this.location[Pt.ON]=o,this.location[Pt.LEFT]=c,this.location[Pt.RIGHT]=g},an.prototype.get=function(o){return o<this.location.length?this.location[o]:ae.NONE},an.prototype.isArea=function(){return this.location.length>1},an.prototype.isAnyNull=function(){for(var o=0;o<this.location.length;o++)if(this.location[o]===ae.NONE)return!0;return!1},an.prototype.setLocation=function(){if(arguments.length===1){var o=arguments[0];this.setLocation(Pt.ON,o)}else if(arguments.length===2){var c=arguments[0],g=arguments[1];this.location[c]=g}},an.prototype.init=function(o){this.location=new Array(o).fill(null),this.setAllLocations(ae.NONE)},an.prototype.isEqualOnSide=function(o,c){return this.location[c]===o.location[c]},an.prototype.allPositionsEqual=function(o){for(var c=0;c<this.location.length;c++)if(this.location[c]!==o)return!1;return!0},an.prototype.interfaces_=function(){return[]},an.prototype.getClass=function(){return an};var Xr=function o(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var c=arguments[0];this.elt[0]=new an(c),this.elt[1]=new an(c)}else if(arguments[0]instanceof o){var g=arguments[0];this.elt[0]=new an(g.elt[0]),this.elt[1]=new an(g.elt[1])}}else if(arguments.length===2){var v=arguments[0],A=arguments[1];this.elt[0]=new an(ae.NONE),this.elt[1]=new an(ae.NONE),this.elt[v].setLocation(A)}else if(arguments.length===3){var N=arguments[0],G=arguments[1],le=arguments[2];this.elt[0]=new an(N,G,le),this.elt[1]=new an(N,G,le)}else if(arguments.length===4){var xe=arguments[0],x=arguments[1],a=arguments[2],d=arguments[3];this.elt[0]=new an(ae.NONE,ae.NONE,ae.NONE),this.elt[1]=new an(ae.NONE,ae.NONE,ae.NONE),this.elt[xe].setLocations(x,a,d)}};Xr.prototype.getGeometryCount=function(){var o=0;return this.elt[0].isNull()||o++,this.elt[1].isNull()||o++,o},Xr.prototype.setAllLocations=function(o,c){this.elt[o].setAllLocations(c)},Xr.prototype.isNull=function(o){return this.elt[o].isNull()},Xr.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var o=arguments[0];this.setAllLocationsIfNull(0,o),this.setAllLocationsIfNull(1,o)}else if(arguments.length===2){var c=arguments[0],g=arguments[1];this.elt[c].setAllLocationsIfNull(g)}},Xr.prototype.isLine=function(o){return this.elt[o].isLine()},Xr.prototype.merge=function(o){for(var c=0;c<2;c++)this.elt[c]===null&&o.elt[c]!==null?this.elt[c]=new an(o.elt[c]):this.elt[c].merge(o.elt[c])},Xr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Xr.prototype.getLocation=function(){if(arguments.length===1){var o=arguments[0];return this.elt[o].get(Pt.ON)}if(arguments.length===2){var c=arguments[0],g=arguments[1];return this.elt[c].get(g)}},Xr.prototype.toString=function(){var o=new he;return this.elt[0]!==null&&(o.append("A:"),o.append(this.elt[0].toString())),this.elt[1]!==null&&(o.append(" B:"),o.append(this.elt[1].toString())),o.toString()},Xr.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var o=arguments[0];return this.elt[o].isArea()}},Xr.prototype.isAnyNull=function(o){return this.elt[o].isAnyNull()},Xr.prototype.setLocation=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1];this.elt[o].setLocation(Pt.ON,c)}else if(arguments.length===3){var g=arguments[0],v=arguments[1],A=arguments[2];this.elt[g].setLocation(v,A)}},Xr.prototype.isEqualOnSide=function(o,c){return this.elt[0].isEqualOnSide(o.elt[0],c)&&this.elt[1].isEqualOnSide(o.elt[1],c)},Xr.prototype.allPositionsEqual=function(o,c){return this.elt[o].allPositionsEqual(c)},Xr.prototype.toLine=function(o){this.elt[o].isArea()&&(this.elt[o]=new an(this.elt[o].location[0]))},Xr.prototype.interfaces_=function(){return[]},Xr.prototype.getClass=function(){return Xr},Xr.toLineLabel=function(o){for(var c=new Xr(ae.NONE),g=0;g<2;g++)c.setLocation(g,o.getLocation(g));return c};var Bn=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Et,this._pts=new Et,this._label=new Xr(ae.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Et,this._geometryFactory=null;var o=arguments[0],c=arguments[1];this._geometryFactory=c,this.computePoints(o),this.computeRing()};Bn.prototype.computeRing=function(){if(this._ring!==null)return null;for(var o=new Array(this._pts.size()).fill(null),c=0;c<this._pts.size();c++)o[c]=this._pts.get(c);this._ring=this._geometryFactory.createLinearRing(o),this._isHole=Qe.isCCW(this._ring.getCoordinates())},Bn.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},Bn.prototype.computePoints=function(o){this._startDe=o;var c=o,g=!0;do{if(c===null)throw new Wo("Found null DirectedEdge");if(c.getEdgeRing()===this)throw new Wo("Directed Edge visited twice during ring-building at "+c.getCoordinate());this._edges.add(c);var v=c.getLabel();ce.isTrue(v.isArea()),this.mergeLabel(v),this.addPoints(c.getEdge(),c.isForward(),g),g=!1,this.setEdgeRing(c,this),c=this.getNext(c)}while(c!==this._startDe)},Bn.prototype.getLinearRing=function(){return this._ring},Bn.prototype.getCoordinate=function(o){return this._pts.get(o)},Bn.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var o=this._startDe;do{var c=o.getNode().getEdges().getOutgoingDegree(this);c>this._maxNodeDegree&&(this._maxNodeDegree=c),o=this.getNext(o)}while(o!==this._startDe);this._maxNodeDegree*=2},Bn.prototype.addPoints=function(o,c,g){var v=o.getCoordinates();if(c){var A=1;g&&(A=0);for(var N=A;N<v.length;N++)this._pts.add(v[N])}else{var G=v.length-2;g&&(G=v.length-1);for(var le=G;le>=0;le--)this._pts.add(v[le])}},Bn.prototype.isHole=function(){return this._isHole},Bn.prototype.setInResult=function(){var o=this._startDe;do o.getEdge().setInResult(!0),o=o.getNext();while(o!==this._startDe)},Bn.prototype.containsPoint=function(o){var c=this.getLinearRing();if(!c.getEnvelopeInternal().contains(o)||!Qe.isPointInRing(o,c.getCoordinates()))return!1;for(var g=this._holes.iterator();g.hasNext();)if(g.next().containsPoint(o))return!1;return!0},Bn.prototype.addHole=function(o){this._holes.add(o)},Bn.prototype.isShell=function(){return this._shell===null},Bn.prototype.getLabel=function(){return this._label},Bn.prototype.getEdges=function(){return this._edges},Bn.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Bn.prototype.getShell=function(){return this._shell},Bn.prototype.mergeLabel=function(){if(arguments.length===1){var o=arguments[0];this.mergeLabel(o,0),this.mergeLabel(o,1)}else if(arguments.length===2){var c=arguments[0],g=arguments[1],v=c.getLocation(g,Pt.RIGHT);if(v===ae.NONE)return null;if(this._label.getLocation(g)===ae.NONE)return this._label.setLocation(g,v),null}},Bn.prototype.setShell=function(o){this._shell=o,o!==null&&o.addHole(this)},Bn.prototype.toPolygon=function(o){for(var c=new Array(this._holes.size()).fill(null),g=0;g<this._holes.size();g++)c[g]=this._holes.get(g).getLinearRing();return o.createPolygon(this.getLinearRing(),c)},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn};var So=function(o){function c(){var g=arguments[0],v=arguments[1];o.call(this,g,v)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.setEdgeRing=function(g,v){g.setMinEdgeRing(v)},c.prototype.getNext=function(g){return g.getNextMin()},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Bn),Ks=function(o){function c(){var g=arguments[0],v=arguments[1];o.call(this,g,v)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.buildMinimalRings=function(){var g=new Et,v=this._startDe;do{if(v.getMinEdgeRing()===null){var A=new So(v,this._geometryFactory);g.add(A)}v=v.getNext()}while(v!==this._startDe);return g},c.prototype.setEdgeRing=function(g,v){g.setEdgeRing(v)},c.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var g=this._startDe;do g.getNode().getEdges().linkMinimalDirectedEdges(this),g=g.getNext();while(g!==this._startDe)},c.prototype.getNext=function(g){return g.getNext()},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Bn),Ci=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._label=o}}};Ci.prototype.setVisited=function(o){this._isVisited=o},Ci.prototype.setInResult=function(o){this._isInResult=o},Ci.prototype.isCovered=function(){return this._isCovered},Ci.prototype.isCoveredSet=function(){return this._isCoveredSet},Ci.prototype.setLabel=function(o){this._label=o},Ci.prototype.getLabel=function(){return this._label},Ci.prototype.setCovered=function(o){this._isCovered=o,this._isCoveredSet=!0},Ci.prototype.updateIM=function(o){ce.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(o)},Ci.prototype.isInResult=function(){return this._isInResult},Ci.prototype.isVisited=function(){return this._isVisited},Ci.prototype.interfaces_=function(){return[]},Ci.prototype.getClass=function(){return Ci};var Ua=function(o){function c(){o.call(this),this._coord=null,this._edges=null;var g=arguments[0],v=arguments[1];this._coord=g,this._edges=v,this._label=new Xr(0,ae.NONE)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.isIncidentEdgeInResult=function(){for(var g=this.getEdges().getEdges().iterator();g.hasNext();)if(g.next().getEdge().isInResult())return!0;return!1},c.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},c.prototype.getCoordinate=function(){return this._coord},c.prototype.print=function(g){g.println("node "+this._coord+" lbl: "+this._label)},c.prototype.computeIM=function(g){},c.prototype.computeMergedLocation=function(g,v){var A=ae.NONE;if(A=this._label.getLocation(v),!g.isNull(v)){var N=g.getLocation(v);A!==ae.BOUNDARY&&(A=N)}return A},c.prototype.setLabel=function(){if(arguments.length!==2)return o.prototype.setLabel.apply(this,arguments);var g=arguments[0],v=arguments[1];this._label===null?this._label=new Xr(g,v):this._label.setLocation(g,v)},c.prototype.getEdges=function(){return this._edges},c.prototype.mergeLabel=function(){if(arguments[0]instanceof c){var g=arguments[0];this.mergeLabel(g._label)}else if(arguments[0]instanceof Xr)for(var v=arguments[0],A=0;A<2;A++){var N=this.computeMergedLocation(v,A);this._label.getLocation(A)===ae.NONE&&this._label.setLocation(A,N)}},c.prototype.add=function(g){this._edges.insert(g),g.setNode(this)},c.prototype.setLabelBoundary=function(g){if(this._label===null)return null;var v=ae.NONE;this._label!==null&&(v=this._label.getLocation(g));var A=null;switch(v){case ae.BOUNDARY:A=ae.INTERIOR;break;case ae.INTERIOR:default:A=ae.BOUNDARY}this._label.setLocation(g,A)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Ci),Ji=function(){this.nodeMap=new M,this.nodeFact=null;var o=arguments[0];this.nodeFact=o};Ji.prototype.find=function(o){return this.nodeMap.get(o)},Ji.prototype.addNode=function(){if(arguments[0]instanceof J){var o=arguments[0],c=this.nodeMap.get(o);return c===null&&(c=this.nodeFact.createNode(o),this.nodeMap.put(o,c)),c}if(arguments[0]instanceof Ua){var g=arguments[0],v=this.nodeMap.get(g.getCoordinate());return v===null?(this.nodeMap.put(g.getCoordinate(),g),g):(v.mergeLabel(g),v)}},Ji.prototype.print=function(o){for(var c=this.iterator();c.hasNext();)c.next().print(o)},Ji.prototype.iterator=function(){return this.nodeMap.values().iterator()},Ji.prototype.values=function(){return this.nodeMap.values()},Ji.prototype.getBoundaryNodes=function(o){for(var c=new Et,g=this.iterator();g.hasNext();){var v=g.next();v.getLabel().getLocation(o)===ae.BOUNDARY&&c.add(v)}return c},Ji.prototype.add=function(o){var c=o.getCoordinate();this.addNode(c).add(o)},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji};var Zr=function(){},Oa={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Zr.prototype.interfaces_=function(){return[]},Zr.prototype.getClass=function(){return Zr},Zr.isNorthern=function(o){return o===Zr.NE||o===Zr.NW},Zr.isOpposite=function(o,c){return o===c?!1:(o-c+4)%4===2},Zr.commonHalfPlane=function(o,c){if(o===c)return o;if((o-c+4)%4===2)return-1;var g=o<c?o:c;return g===0&&(o>c?o:c)===3?3:g},Zr.isInHalfPlane=function(o,c){return c===Zr.SE?o===Zr.SE||o===Zr.SW:o===c||o===c+1},Zr.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],c=arguments[1];if(o===0&&c===0)throw new U("Cannot compute the quadrant for point ( "+o+", "+c+" )");return o>=0?c>=0?Zr.NE:Zr.SE:c>=0?Zr.NW:Zr.SW}if(arguments[0]instanceof J&&arguments[1]instanceof J){var g=arguments[0],v=arguments[1];if(v.x===g.x&&v.y===g.y)throw new U("Cannot compute the quadrant for two identical points "+g);return v.x>=g.x?v.y>=g.y?Zr.NE:Zr.SE:v.y>=g.y?Zr.NW:Zr.SW}},Oa.NE.get=function(){return 0},Oa.NW.get=function(){return 1},Oa.SW.get=function(){return 2},Oa.SE.get=function(){return 3},Object.defineProperties(Zr,Oa);var Yn=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var o=arguments[0];this._edge=o}else if(arguments.length===3){var c=arguments[0],g=arguments[1],v=arguments[2];this._edge=c,this.init(g,v),this._label=null}else if(arguments.length===4){var A=arguments[0],N=arguments[1],G=arguments[2],le=arguments[3];this._edge=A,this.init(N,G),this._label=le}};Yn.prototype.compareDirection=function(o){return this._dx===o._dx&&this._dy===o._dy?0:this._quadrant>o._quadrant?1:this._quadrant<o._quadrant?-1:Qe.computeOrientation(o._p0,o._p1,this._p1)},Yn.prototype.getDy=function(){return this._dy},Yn.prototype.getCoordinate=function(){return this._p0},Yn.prototype.setNode=function(o){this._node=o},Yn.prototype.print=function(o){var c=Math.atan2(this._dy,this._dx),g=this.getClass().getName(),v=g.lastIndexOf("."),A=g.substring(v+1);o.print("  "+A+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+c+"   "+this._label)},Yn.prototype.compareTo=function(o){var c=o;return this.compareDirection(c)},Yn.prototype.getDirectedCoordinate=function(){return this._p1},Yn.prototype.getDx=function(){return this._dx},Yn.prototype.getLabel=function(){return this._label},Yn.prototype.getEdge=function(){return this._edge},Yn.prototype.getQuadrant=function(){return this._quadrant},Yn.prototype.getNode=function(){return this._node},Yn.prototype.toString=function(){var o=Math.atan2(this._dy,this._dx),c=this.getClass().getName(),g=c.lastIndexOf(".");return"  "+c.substring(g+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+o+"   "+this._label},Yn.prototype.computeLabel=function(o){},Yn.prototype.init=function(o,c){this._p0=o,this._p1=c,this._dx=c.x-o.x,this._dy=c.y-o.y,this._quadrant=Zr.quadrant(this._dx,this._dy),ce.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")},Yn.prototype.interfaces_=function(){return[ie]},Yn.prototype.getClass=function(){return Yn};var Ns=function(o){function c(){var g=arguments[0],v=arguments[1];if(o.call(this,g),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=v,v)this.init(g.getCoordinate(0),g.getCoordinate(1));else{var A=g.getNumPoints()-1;this.init(g.getCoordinate(A),g.getCoordinate(A-1))}this.computeDirectedLabel()}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.getNextMin=function(){return this._nextMin},c.prototype.getDepth=function(g){return this._depth[g]},c.prototype.setVisited=function(g){this._isVisited=g},c.prototype.computeDirectedLabel=function(){this._label=new Xr(this._edge.getLabel()),this._isForward||this._label.flip()},c.prototype.getNext=function(){return this._next},c.prototype.setDepth=function(g,v){if(this._depth[g]!==-999&&this._depth[g]!==v)throw new Wo("assigned depths do not match",this.getCoordinate());this._depth[g]=v},c.prototype.isInteriorAreaEdge=function(){for(var g=!0,v=0;v<2;v++)this._label.isArea(v)&&this._label.getLocation(v,Pt.LEFT)===ae.INTERIOR&&this._label.getLocation(v,Pt.RIGHT)===ae.INTERIOR||(g=!1);return g},c.prototype.setNextMin=function(g){this._nextMin=g},c.prototype.print=function(g){o.prototype.print.call(this,g),g.print(" "+this._depth[Pt.LEFT]+"/"+this._depth[Pt.RIGHT]),g.print(" ("+this.getDepthDelta()+")"),this._isInResult&&g.print(" inResult")},c.prototype.setMinEdgeRing=function(g){this._minEdgeRing=g},c.prototype.isLineEdge=function(){var g=this._label.isLine(0)||this._label.isLine(1),v=!this._label.isArea(0)||this._label.allPositionsEqual(0,ae.EXTERIOR),A=!this._label.isArea(1)||this._label.allPositionsEqual(1,ae.EXTERIOR);return g&&v&&A},c.prototype.setEdgeRing=function(g){this._edgeRing=g},c.prototype.getMinEdgeRing=function(){return this._minEdgeRing},c.prototype.getDepthDelta=function(){var g=this._edge.getDepthDelta();return this._isForward||(g=-g),g},c.prototype.setInResult=function(g){this._isInResult=g},c.prototype.getSym=function(){return this._sym},c.prototype.isForward=function(){return this._isForward},c.prototype.getEdge=function(){return this._edge},c.prototype.printEdge=function(g){this.print(g),g.print(" "),this._isForward?this._edge.print(g):this._edge.printReverse(g)},c.prototype.setSym=function(g){this._sym=g},c.prototype.setVisitedEdge=function(g){this.setVisited(g),this._sym.setVisited(g)},c.prototype.setEdgeDepths=function(g,v){var A=this.getEdge().getDepthDelta();this._isForward||(A=-A);var N=1;g===Pt.LEFT&&(N=-1);var G=Pt.opposite(g),le=v+A*N;this.setDepth(g,v),this.setDepth(G,le)},c.prototype.getEdgeRing=function(){return this._edgeRing},c.prototype.isInResult=function(){return this._isInResult},c.prototype.setNext=function(g){this._next=g},c.prototype.isVisited=function(){return this._isVisited},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c.depthFactor=function(g,v){return g===ae.EXTERIOR&&v===ae.INTERIOR?1:g===ae.INTERIOR&&v===ae.EXTERIOR?-1:0},c}(Yn),Ti=function(){};Ti.prototype.createNode=function(o){return new Ua(o,null)},Ti.prototype.interfaces_=function(){return[]},Ti.prototype.getClass=function(){return Ti};var Yr=function(){if(this._edges=new Et,this._nodes=null,this._edgeEndList=new Et,arguments.length===0)this._nodes=new Ji(new Ti);else if(arguments.length===1){var o=arguments[0];this._nodes=new Ji(o)}};Yr.prototype.printEdges=function(o){o.println("Edges:");for(var c=0;c<this._edges.size();c++){o.println("edge "+c+":");var g=this._edges.get(c);g.print(o),g.eiList.print(o)}},Yr.prototype.find=function(o){return this._nodes.find(o)},Yr.prototype.addNode=function(){if(arguments[0]instanceof Ua){var o=arguments[0];return this._nodes.addNode(o)}if(arguments[0]instanceof J){var c=arguments[0];return this._nodes.addNode(c)}},Yr.prototype.getNodeIterator=function(){return this._nodes.iterator()},Yr.prototype.linkResultDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkResultDirectedEdges()},Yr.prototype.debugPrintln=function(o){pt.out.println(o)},Yr.prototype.isBoundaryNode=function(o,c){var g=this._nodes.find(c);if(g===null)return!1;var v=g.getLabel();return v!==null&&v.getLocation(o)===ae.BOUNDARY},Yr.prototype.linkAllDirectedEdges=function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkAllDirectedEdges()},Yr.prototype.matchInSameDirection=function(o,c,g,v){return!!o.equals(g)&&Qe.computeOrientation(o,c,v)===Qe.COLLINEAR&&Zr.quadrant(o,c)===Zr.quadrant(g,v)},Yr.prototype.getEdgeEnds=function(){return this._edgeEndList},Yr.prototype.debugPrint=function(o){pt.out.print(o)},Yr.prototype.getEdgeIterator=function(){return this._edges.iterator()},Yr.prototype.findEdgeInSameDirection=function(o,c){for(var g=0;g<this._edges.size();g++){var v=this._edges.get(g),A=v.getCoordinates();if(this.matchInSameDirection(o,c,A[0],A[1])||this.matchInSameDirection(o,c,A[A.length-1],A[A.length-2]))return v}return null},Yr.prototype.insertEdge=function(o){this._edges.add(o)},Yr.prototype.findEdgeEnd=function(o){for(var c=this.getEdgeEnds().iterator();c.hasNext();){var g=c.next();if(g.getEdge()===o)return g}return null},Yr.prototype.addEdges=function(o){for(var c=o.iterator();c.hasNext();){var g=c.next();this._edges.add(g);var v=new Ns(g,!0),A=new Ns(g,!1);v.setSym(A),A.setSym(v),this.add(v),this.add(A)}},Yr.prototype.add=function(o){this._nodes.add(o),this._edgeEndList.add(o)},Yr.prototype.getNodes=function(){return this._nodes.values()},Yr.prototype.findEdge=function(o,c){for(var g=0;g<this._edges.size();g++){var v=this._edges.get(g),A=v.getCoordinates();if(o.equals(A[0])&&c.equals(A[1]))return v}return null},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr},Yr.linkResultDirectedEdges=function(o){for(var c=o.iterator();c.hasNext();)c.next().getEdges().linkResultDirectedEdges()};var Mi=function(){this._geometryFactory=null,this._shellList=new Et;var o=arguments[0];this._geometryFactory=o};Mi.prototype.sortShellsAndHoles=function(o,c,g){for(var v=o.iterator();v.hasNext();){var A=v.next();A.isHole()?g.add(A):c.add(A)}},Mi.prototype.computePolygons=function(o){for(var c=new Et,g=o.iterator();g.hasNext();){var v=g.next().toPolygon(this._geometryFactory);c.add(v)}return c},Mi.prototype.placeFreeHoles=function(o,c){for(var g=c.iterator();g.hasNext();){var v=g.next();if(v.getShell()===null){var A=this.findEdgeRingContaining(v,o);if(A===null)throw new Wo("unable to assign hole to a shell",v.getCoordinate(0));v.setShell(A)}}},Mi.prototype.buildMinimalEdgeRings=function(o,c,g){for(var v=new Et,A=o.iterator();A.hasNext();){var N=A.next();if(N.getMaxNodeDegree()>2){N.linkDirectedEdgesForMinimalEdgeRings();var G=N.buildMinimalRings(),le=this.findShell(G);le!==null?(this.placePolygonHoles(le,G),c.add(le)):g.addAll(G)}else v.add(N)}return v},Mi.prototype.containsPoint=function(o){for(var c=this._shellList.iterator();c.hasNext();)if(c.next().containsPoint(o))return!0;return!1},Mi.prototype.buildMaximalEdgeRings=function(o){for(var c=new Et,g=o.iterator();g.hasNext();){var v=g.next();if(v.isInResult()&&v.getLabel().isArea()&&v.getEdgeRing()===null){var A=new Ks(v,this._geometryFactory);c.add(A),A.setInResult()}}return c},Mi.prototype.placePolygonHoles=function(o,c){for(var g=c.iterator();g.hasNext();){var v=g.next();v.isHole()&&v.setShell(o)}},Mi.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Mi.prototype.findEdgeRingContaining=function(o,c){for(var g=o.getLinearRing(),v=g.getEnvelopeInternal(),A=g.getCoordinateN(0),N=null,G=null,le=c.iterator();le.hasNext();){var xe=le.next(),x=xe.getLinearRing(),a=x.getEnvelopeInternal();N!==null&&(G=N.getLinearRing().getEnvelopeInternal());var d=!1;a.contains(v)&&Qe.isPointInRing(A,x.getCoordinates())&&(d=!0),d&&(N===null||G.contains(a))&&(N=xe)}return N},Mi.prototype.findShell=function(o){for(var c=0,g=null,v=o.iterator();v.hasNext();){var A=v.next();A.isHole()||(g=A,c++)}return ce.isTrue(c<=1,"found two shells in MinimalEdgeRing list"),g},Mi.prototype.add=function(){if(arguments.length===1){var o=arguments[0];this.add(o.getEdgeEnds(),o.getNodes())}else if(arguments.length===2){var c=arguments[0],g=arguments[1];Yr.linkResultDirectedEdges(g);var v=this.buildMaximalEdgeRings(c),A=new Et,N=this.buildMinimalEdgeRings(v,this._shellList,A);this.sortShellsAndHoles(N,this._shellList,A),this.placeFreeHoles(this._shellList,A)}},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi};var fa=function(){};fa.prototype.getBounds=function(){},fa.prototype.interfaces_=function(){return[]},fa.prototype.getClass=function(){return fa};var wi=function(){this._bounds=null,this._item=null;var o=arguments[0],c=arguments[1];this._bounds=o,this._item=c};wi.prototype.getItem=function(){return this._item},wi.prototype.getBounds=function(){return this._bounds},wi.prototype.interfaces_=function(){return[fa,n]},wi.prototype.getClass=function(){return wi};var oo=function(){this._size=null,this._items=null,this._size=0,this._items=new Et,this._items.add(null)};oo.prototype.poll=function(){if(this.isEmpty())return null;var o=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),o},oo.prototype.size=function(){return this._size},oo.prototype.reorder=function(o){for(var c=null,g=this._items.get(o);2*o<=this._size&&((c=2*o)!==this._size&&this._items.get(c+1).compareTo(this._items.get(c))<0&&c++,this._items.get(c).compareTo(g)<0);o=c)this._items.set(o,this._items.get(c));this._items.set(o,g)},oo.prototype.clear=function(){this._size=0,this._items.clear()},oo.prototype.isEmpty=function(){return this._size===0},oo.prototype.add=function(o){this._items.add(null),this._size+=1;var c=this._size;for(this._items.set(0,o);o.compareTo(this._items.get(Math.trunc(c/2)))<0;c/=2)this._items.set(c,this._items.get(Math.trunc(c/2)));this._items.set(c,o)},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo};var Gr=function(){};Gr.prototype.visitItem=function(o){},Gr.prototype.interfaces_=function(){return[]},Gr.prototype.getClass=function(){return Gr};var pa=function(){};pa.prototype.insert=function(o,c){},pa.prototype.remove=function(o,c){},pa.prototype.query=function(){},pa.prototype.interfaces_=function(){return[]},pa.prototype.getClass=function(){return pa};var Wn=function(){if(this._childBoundables=new Et,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._level=o}}},bu={serialVersionUID:{configurable:!0}};Wn.prototype.getLevel=function(){return this._level},Wn.prototype.size=function(){return this._childBoundables.size()},Wn.prototype.getChildBoundables=function(){return this._childBoundables},Wn.prototype.addChildBoundable=function(o){ce.isTrue(this._bounds===null),this._childBoundables.add(o)},Wn.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Wn.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds},Wn.prototype.interfaces_=function(){return[fa,n]},Wn.prototype.getClass=function(){return Wn},bu.serialVersionUID.get=function(){return 6493722185909574e3},Object.defineProperties(Wn,bu);var Ki=function(){};Ki.reverseOrder=function(){return{compare:function(o,c){return c.compareTo(o)}}},Ki.min=function(o){return Ki.sort(o),o.get(0)},Ki.sort=function(o,c){var g=o.toArray();c?ft.sort(g,c):ft.sort(g);for(var v=o.iterator(),A=0,N=g.length;A<N;A++)v.next(),v.set(g[A])},Ki.singletonList=function(o){var c=new Et;return c.add(o),c};var Zn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var o=arguments[0],c=arguments[1],g=arguments[2];this._boundable1=o,this._boundable2=c,this._itemDistance=g,this._distance=this.distance()};Zn.prototype.expandToQueue=function(o,c){var g=Zn.isComposite(this._boundable1),v=Zn.isComposite(this._boundable2);if(g&&v)return Zn.area(this._boundable1)>Zn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,o,c),null):(this.expand(this._boundable2,this._boundable1,o,c),null);if(g)return this.expand(this._boundable1,this._boundable2,o,c),null;if(v)return this.expand(this._boundable2,this._boundable1,o,c),null;throw new U("neither boundable is composite")},Zn.prototype.isLeaves=function(){return!(Zn.isComposite(this._boundable1)||Zn.isComposite(this._boundable2))},Zn.prototype.compareTo=function(o){var c=o;return this._distance<c._distance?-1:this._distance>c._distance?1:0},Zn.prototype.expand=function(o,c,g,v){for(var A=o.getChildBoundables().iterator();A.hasNext();){var N=A.next(),G=new Zn(N,c,this._itemDistance);G.getDistance()<v&&g.add(G)}},Zn.prototype.getBoundable=function(o){return o===0?this._boundable1:this._boundable2},Zn.prototype.getDistance=function(){return this._distance},Zn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Zn.prototype.interfaces_=function(){return[ie]},Zn.prototype.getClass=function(){return Zn},Zn.area=function(o){return o.getBounds().getArea()},Zn.isComposite=function(o){return o instanceof Wn};var pi=function o(){if(this._root=null,this._built=!1,this._itemBoundables=new Et,this._nodeCapacity=null,arguments.length===0){var c=o.DEFAULT_NODE_CAPACITY;this._nodeCapacity=c}else if(arguments.length===1){var g=arguments[0];ce.isTrue(g>1,"Node capacity must be greater than 1"),this._nodeCapacity=g}},Ca={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};pi.prototype.getNodeCapacity=function(){return this._nodeCapacity},pi.prototype.lastNode=function(o){return o.get(o.size()-1)},pi.prototype.size=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var o=0,c=arguments[0].getChildBoundables().iterator();c.hasNext();){var g=c.next();g instanceof Wn?o+=this.size(g):g instanceof wi&&(o+=1)}return o}},pi.prototype.removeItem=function(o,c){for(var g=null,v=o.getChildBoundables().iterator();v.hasNext();){var A=v.next();A instanceof wi&&A.getItem()===c&&(g=A)}return g!==null&&(o.getChildBoundables().remove(g),!0)},pi.prototype.itemsTree=function(){if(arguments.length===0){this.build();var o=this.itemsTree(this._root);return o===null?new Et:o}if(arguments.length===1){for(var c=arguments[0],g=new Et,v=c.getChildBoundables().iterator();v.hasNext();){var A=v.next();if(A instanceof Wn){var N=this.itemsTree(A);N!==null&&g.add(N)}else A instanceof wi?g.add(A.getItem()):ce.shouldNeverReachHere()}return g.size()<=0?null:g}},pi.prototype.insert=function(o,c){ce.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new wi(o,c))},pi.prototype.boundablesAtLevel=function(){if(arguments.length===1){var o=arguments[0],c=new Et;return this.boundablesAtLevel(o,this._root,c),c}if(arguments.length===3){var g=arguments[0],v=arguments[1],A=arguments[2];if(ce.isTrue(g>-2),v.getLevel()===g)return A.add(v),null;for(var N=v.getChildBoundables().iterator();N.hasNext();){var G=N.next();G instanceof Wn?this.boundablesAtLevel(g,G,A):(ce.isTrue(G instanceof wi),g===-1&&A.add(G))}return null}},pi.prototype.query=function(){if(arguments.length===1){var o=arguments[0];this.build();var c=new Et;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,c),c}if(arguments.length===2){var g=arguments[0],v=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),g)&&this.query(g,this._root,v)}else if(arguments.length===3){if(Pe(arguments[2],Gr)&&arguments[0]instanceof Object&&arguments[1]instanceof Wn)for(var A=arguments[0],N=arguments[1],G=arguments[2],le=N.getChildBoundables(),xe=0;xe<le.size();xe++){var x=le.get(xe);this.getIntersectsOp().intersects(x.getBounds(),A)&&(x instanceof Wn?this.query(A,x,G):x instanceof wi?G.visitItem(x.getItem()):ce.shouldNeverReachHere())}else if(Pe(arguments[2],Lr)&&arguments[0]instanceof Object&&arguments[1]instanceof Wn)for(var a=arguments[0],d=arguments[1],b=arguments[2],w=d.getChildBoundables(),I=0;I<w.size();I++){var L=w.get(I);this.getIntersectsOp().intersects(L.getBounds(),a)&&(L instanceof Wn?this.query(a,L,b):L instanceof wi?b.add(L.getItem()):ce.shouldNeverReachHere())}}},pi.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},pi.prototype.getRoot=function(){return this.build(),this._root},pi.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.remove(o,this._root,c)}if(arguments.length===3){var g=arguments[0],v=arguments[1],A=arguments[2],N=this.removeItem(v,A);if(N)return!0;for(var G=null,le=v.getChildBoundables().iterator();le.hasNext();){var xe=le.next();if(this.getIntersectsOp().intersects(xe.getBounds(),g)&&xe instanceof Wn&&(N=this.remove(g,xe,A))){G=xe;break}}return G!==null&&G.getChildBoundables().isEmpty()&&v.getChildBoundables().remove(G),N}},pi.prototype.createHigherLevels=function(o,c){ce.isTrue(!o.isEmpty());var g=this.createParentBoundables(o,c+1);return g.size()===1?g.get(0):this.createHigherLevels(g,c+1)},pi.prototype.depth=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var o=0,c=arguments[0].getChildBoundables().iterator();c.hasNext();){var g=c.next();if(g instanceof Wn){var v=this.depth(g);v>o&&(o=v)}}return o+1}},pi.prototype.createParentBoundables=function(o,c){ce.isTrue(!o.isEmpty());var g=new Et;g.add(this.createNode(c));var v=new Et(o);Ki.sort(v,this.getComparator());for(var A=v.iterator();A.hasNext();){var N=A.next();this.lastNode(g).getChildBoundables().size()===this.getNodeCapacity()&&g.add(this.createNode(c)),this.lastNode(g).addChildBoundable(N)}return g},pi.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},pi.prototype.interfaces_=function(){return[n]},pi.prototype.getClass=function(){return pi},pi.compareDoubles=function(o,c){return o>c?1:o<c?-1:0},Ca.IntersectsOp.get=function(){return Ol},Ca.serialVersionUID.get=function(){return-3886435814360241e3},Ca.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(pi,Ca);var Ol=function(){},Fs=function(){};Fs.prototype.distance=function(o,c){},Fs.prototype.interfaces_=function(){return[]},Fs.prototype.getClass=function(){return Fs};var el=function(o){function c(v){v=v||c.DEFAULT_NODE_CAPACITY,o.call(this,v)}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return c.prototype.createParentBoundablesFromVerticalSlices=function(v,A){ce.isTrue(v.length>0);for(var N=new Et,G=0;G<v.length;G++)N.addAll(this.createParentBoundablesFromVerticalSlice(v[G],A));return N},c.prototype.createNode=function(v){return new ds(v)},c.prototype.size=function(){return arguments.length===0?o.prototype.size.call(this):o.prototype.size.apply(this,arguments)},c.prototype.insert=function(){if(arguments.length!==2)return o.prototype.insert.apply(this,arguments);var v=arguments[0],A=arguments[1];if(v.isNull())return null;o.prototype.insert.call(this,v,A)},c.prototype.getIntersectsOp=function(){return c.intersectsOp},c.prototype.verticalSlices=function(v,A){for(var N=Math.trunc(Math.ceil(v.size()/A)),G=new Array(A).fill(null),le=v.iterator(),xe=0;xe<A;xe++){G[xe]=new Et;for(var x=0;le.hasNext()&&x<N;){var a=le.next();G[xe].add(a),x++}}return G},c.prototype.query=function(){if(arguments.length===1){var v=arguments[0];return o.prototype.query.call(this,v)}if(arguments.length===2){var A=arguments[0],N=arguments[1];o.prototype.query.call(this,A,N)}else if(arguments.length===3){if(Pe(arguments[2],Gr)&&arguments[0]instanceof Object&&arguments[1]instanceof Wn){var G=arguments[0],le=arguments[1],xe=arguments[2];o.prototype.query.call(this,G,le,xe)}else if(Pe(arguments[2],Lr)&&arguments[0]instanceof Object&&arguments[1]instanceof Wn){var x=arguments[0],a=arguments[1],d=arguments[2];o.prototype.query.call(this,x,a,d)}}},c.prototype.getComparator=function(){return c.yComparator},c.prototype.createParentBoundablesFromVerticalSlice=function(v,A){return o.prototype.createParentBoundables.call(this,v,A)},c.prototype.remove=function(){if(arguments.length===2){var v=arguments[0],A=arguments[1];return o.prototype.remove.call(this,v,A)}return o.prototype.remove.apply(this,arguments)},c.prototype.depth=function(){return arguments.length===0?o.prototype.depth.call(this):o.prototype.depth.apply(this,arguments)},c.prototype.createParentBoundables=function(v,A){ce.isTrue(!v.isEmpty());var N=Math.trunc(Math.ceil(v.size()/this.getNodeCapacity())),G=new Et(v);Ki.sort(G,c.xComparator);var le=this.verticalSlices(G,Math.trunc(Math.ceil(Math.sqrt(N))));return this.createParentBoundablesFromVerticalSlices(le,A)},c.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Pe(arguments[0],Fs)){var v=arguments[0],A=new Zn(this.getRoot(),this.getRoot(),v);return this.nearestNeighbour(A)}if(arguments[0]instanceof Zn){var N=arguments[0];return this.nearestNeighbour(N,H.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof c&&Pe(arguments[1],Fs)){var G=arguments[0],le=arguments[1],xe=new Zn(this.getRoot(),G.getRoot(),le);return this.nearestNeighbour(xe)}if(arguments[0]instanceof Zn&&typeof arguments[1]=="number"){var x=arguments[0],a=arguments[1],d=null,b=new oo;for(b.add(x);!b.isEmpty()&&a>0;){var w=b.poll(),I=w.getDistance();if(I>=a)break;w.isLeaves()?(a=I,d=w):w.expandToQueue(b,a)}return[d.getBoundable(0).getItem(),d.getBoundable(1).getItem()]}}else if(arguments.length===3){var L=arguments[0],F=arguments[1],j=arguments[2],Y=new wi(L,F),K=new Zn(this.getRoot(),Y,j);return this.nearestNeighbour(K)[0]}},c.prototype.interfaces_=function(){return[pa,n]},c.prototype.getClass=function(){return c},c.centreX=function(v){return c.avg(v.getMinX(),v.getMaxX())},c.avg=function(v,A){return(v+A)/2},c.centreY=function(v){return c.avg(v.getMinY(),v.getMaxY())},g.STRtreeNode.get=function(){return ds},g.serialVersionUID.get=function(){return 0x39920f7d5f261e0},g.xComparator.get=function(){return{interfaces_:function(){return[W]},compare:function(v,A){return o.compareDoubles(c.centreX(v.getBounds()),c.centreX(A.getBounds()))}}},g.yComparator.get=function(){return{interfaces_:function(){return[W]},compare:function(v,A){return o.compareDoubles(c.centreY(v.getBounds()),c.centreY(A.getBounds()))}}},g.intersectsOp.get=function(){return{interfaces_:function(){return[o.IntersectsOp]},intersects:function(v,A){return v.intersects(A)}}},g.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(c,g),c}(pi),ds=function(o){function c(){var g=arguments[0];o.call(this,g)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.computeBounds=function(){for(var g=null,v=this.getChildBoundables().iterator();v.hasNext();){var A=v.next();g===null?g=new mt(A.getBounds()):g.expandToInclude(A.getBounds())}return g},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Wn),di=function(){};di.prototype.interfaces_=function(){return[]},di.prototype.getClass=function(){return di},di.relativeSign=function(o,c){return o<c?-1:o>c?1:0},di.compare=function(o,c,g){if(c.equals2D(g))return 0;var v=di.relativeSign(c.x,g.x),A=di.relativeSign(c.y,g.y);switch(o){case 0:return di.compareValue(v,A);case 1:return di.compareValue(A,v);case 2:return di.compareValue(A,-v);case 3:return di.compareValue(-v,A);case 4:return di.compareValue(-v,-A);case 5:return di.compareValue(-A,-v);case 6:return di.compareValue(-A,v);case 7:return di.compareValue(v,-A)}return ce.shouldNeverReachHere("invalid octant value"),0},di.compareValue=function(o,c){return o<0?-1:o>0?1:c<0?-1:c>0?1:0};var Gi=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var o=arguments[0],c=arguments[1],g=arguments[2],v=arguments[3];this._segString=o,this.coord=new J(c),this.segmentIndex=g,this._segmentOctant=v,this._isInterior=!c.equals2D(o.getCoordinate(g))};Gi.prototype.getCoordinate=function(){return this.coord},Gi.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex)},Gi.prototype.compareTo=function(o){var c=o;return this.segmentIndex<c.segmentIndex?-1:this.segmentIndex>c.segmentIndex?1:this.coord.equals2D(c.coord)?0:di.compare(this._segmentOctant,this.coord,c.coord)},Gi.prototype.isEndPoint=function(o){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===o},Gi.prototype.isInterior=function(){return this._isInterior},Gi.prototype.interfaces_=function(){return[ie]},Gi.prototype.getClass=function(){return Gi};var qn=function(){this._nodeMap=new M,this._edge=null;var o=arguments[0];this._edge=o};qn.prototype.getSplitCoordinates=function(){var o=new Le;this.addEndpoints();for(var c=this.iterator(),g=c.next();c.hasNext();){var v=c.next();this.addEdgeCoordinates(g,v,o),g=v}return o.toCoordinateArray()},qn.prototype.addCollapsedNodes=function(){var o=new Et;this.findCollapsesFromInsertedNodes(o),this.findCollapsesFromExistingVertices(o);for(var c=o.iterator();c.hasNext();){var g=c.next().intValue();this.add(this._edge.getCoordinate(g),g)}},qn.prototype.print=function(o){o.println("Intersections:");for(var c=this.iterator();c.hasNext();)c.next().print(o)},qn.prototype.findCollapsesFromExistingVertices=function(o){for(var c=0;c<this._edge.size()-2;c++){var g=this._edge.getCoordinate(c),v=this._edge.getCoordinate(c+2);g.equals2D(v)&&o.add(new fe(c+1))}},qn.prototype.addEdgeCoordinates=function(o,c,g){var v=this._edge.getCoordinate(c.segmentIndex),A=c.isInterior()||!c.coord.equals2D(v);g.add(new J(o.coord),!1);for(var N=o.segmentIndex+1;N<=c.segmentIndex;N++)g.add(this._edge.getCoordinate(N));A&&g.add(new J(c.coord))},qn.prototype.iterator=function(){return this._nodeMap.values().iterator()},qn.prototype.addSplitEdges=function(o){this.addEndpoints(),this.addCollapsedNodes();for(var c=this.iterator(),g=c.next();c.hasNext();){var v=c.next(),A=this.createSplitEdge(g,v);o.add(A),g=v}},qn.prototype.findCollapseIndex=function(o,c,g){if(!o.coord.equals2D(c.coord))return!1;var v=c.segmentIndex-o.segmentIndex;return c.isInterior()||v--,v===1&&(g[0]=o.segmentIndex+1,!0)},qn.prototype.findCollapsesFromInsertedNodes=function(o){for(var c=new Array(1).fill(null),g=this.iterator(),v=g.next();g.hasNext();){var A=g.next();this.findCollapseIndex(v,A,c)&&o.add(new fe(c[0])),v=A}},qn.prototype.getEdge=function(){return this._edge},qn.prototype.addEndpoints=function(){var o=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(o),o)},qn.prototype.createSplitEdge=function(o,c){var g=c.segmentIndex-o.segmentIndex+2,v=this._edge.getCoordinate(c.segmentIndex),A=c.isInterior()||!c.coord.equals2D(v);A||g--;var N=new Array(g).fill(null),G=0;N[G++]=new J(o.coord);for(var le=o.segmentIndex+1;le<=c.segmentIndex;le++)N[G++]=this._edge.getCoordinate(le);return A&&(N[G]=new J(c.coord)),new zn(N,this._edge.getData())},qn.prototype.add=function(o,c){var g=new Gi(this._edge,o,c,this._edge.getSegmentOctant(c)),v=this._nodeMap.get(g);return v!==null?(ce.isTrue(v.coord.equals2D(o),"Found equal nodes with different coordinates"),v):(this._nodeMap.put(g,g),g)},qn.prototype.checkSplitEdgesCorrectness=function(o){var c=this._edge.getCoordinates(),g=o.get(0).getCoordinate(0);if(!g.equals2D(c[0]))throw new rt("bad split edge start point at "+g);var v=o.get(o.size()-1).getCoordinates(),A=v[v.length-1];if(!A.equals2D(c[c.length-1]))throw new rt("bad split edge end point at "+A)},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn};var $a=function(){};$a.prototype.interfaces_=function(){return[]},$a.prototype.getClass=function(){return $a},$a.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],c=arguments[1];if(o===0&&c===0)throw new U("Cannot compute the octant for point ( "+o+", "+c+" )");var g=Math.abs(o),v=Math.abs(c);return o>=0?c>=0?g>=v?0:1:g>=v?7:6:c>=0?g>=v?3:2:g>=v?4:5}if(arguments[0]instanceof J&&arguments[1]instanceof J){var A=arguments[0],N=arguments[1],G=N.x-A.x,le=N.y-A.y;if(G===0&&le===0)throw new U("Cannot compute the octant for two identical points "+A);return $a.octant(G,le)}};var Zo=function(){};Zo.prototype.getCoordinates=function(){},Zo.prototype.size=function(){},Zo.prototype.getCoordinate=function(o){},Zo.prototype.isClosed=function(){},Zo.prototype.setData=function(o){},Zo.prototype.getData=function(){},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo};var Qs=function(){};Qs.prototype.addIntersection=function(o,c){},Qs.prototype.interfaces_=function(){return[Zo]},Qs.prototype.getClass=function(){return Qs};var zn=function(){this._nodeList=new qn(this),this._pts=null,this._data=null;var o=arguments[0],c=arguments[1];this._pts=o,this._data=c};zn.prototype.getCoordinates=function(){return this._pts},zn.prototype.size=function(){return this._pts.length},zn.prototype.getCoordinate=function(o){return this._pts[o]},zn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},zn.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(o),this.getCoordinate(o+1))},zn.prototype.setData=function(o){this._data=o},zn.prototype.safeOctant=function(o,c){return o.equals2D(c)?0:$a.octant(o,c)},zn.prototype.getData=function(){return this._data},zn.prototype.addIntersection=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1];this.addIntersectionNode(o,c)}else if(arguments.length===4){var g=arguments[0],v=arguments[1],A=arguments[3],N=new J(g.getIntersection(A));this.addIntersection(N,v)}},zn.prototype.toString=function(){return nn.toLineString(new kn(this._pts))},zn.prototype.getNodeList=function(){return this._nodeList},zn.prototype.addIntersectionNode=function(o,c){var g=c,v=g+1;if(v<this._pts.length){var A=this._pts[v];o.equals2D(A)&&(g=v)}return this._nodeList.add(o,g)},zn.prototype.addIntersections=function(o,c,g){for(var v=0;v<o.getIntersectionNum();v++)this.addIntersection(o,c,g,v)},zn.prototype.interfaces_=function(){return[Qs]},zn.prototype.getClass=function(){return zn},zn.getNodedSubstrings=function(){if(arguments.length===1){var o=arguments[0],c=new Et;return zn.getNodedSubstrings(o,c),c}if(arguments.length===2)for(var g=arguments[0],v=arguments[1],A=g.iterator();A.hasNext();)A.next().getNodeList().addSplitEdges(v)};var or=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new J,this.p1=new J;else if(arguments.length===1){var o=arguments[0];this.p0=new J(o.p0),this.p1=new J(o.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var c=arguments[0],g=arguments[1],v=arguments[2],A=arguments[3];this.p0=new J(c,g),this.p1=new J(v,A)}},Cl={serialVersionUID:{configurable:!0}};or.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},or.prototype.orientationIndex=function(){if(arguments[0]instanceof or){var o=arguments[0],c=Qe.orientationIndex(this.p0,this.p1,o.p0),g=Qe.orientationIndex(this.p0,this.p1,o.p1);return c>=0&&g>=0||c<=0&&g<=0?Math.max(c,g):0}if(arguments[0]instanceof J){var v=arguments[0];return Qe.orientationIndex(this.p0,this.p1,v)}},or.prototype.toGeometry=function(o){return o.createLineString([this.p0,this.p1])},or.prototype.isVertical=function(){return this.p0.x===this.p1.x},or.prototype.equals=function(o){if(!(o instanceof or))return!1;var c=o;return this.p0.equals(c.p0)&&this.p1.equals(c.p1)},or.prototype.intersection=function(o){var c=new Xe;return c.computeIntersection(this.p0,this.p1,o.p0,o.p1),c.hasIntersection()?c.getIntersection(0):null},or.prototype.project=function(){if(arguments[0]instanceof J){var o=arguments[0];if(o.equals(this.p0)||o.equals(this.p1))return new J(o);var c=this.projectionFactor(o),g=new J;return g.x=this.p0.x+c*(this.p1.x-this.p0.x),g.y=this.p0.y+c*(this.p1.y-this.p0.y),g}if(arguments[0]instanceof or){var v=arguments[0],A=this.projectionFactor(v.p0),N=this.projectionFactor(v.p1);if(A>=1&&N>=1||A<=0&&N<=0)return null;var G=this.project(v.p0);A<0&&(G=this.p0),A>1&&(G=this.p1);var le=this.project(v.p1);return N<0&&(le=this.p0),N>1&&(le=this.p1),new or(G,le)}},or.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},or.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},or.prototype.getCoordinate=function(o){return o===0?this.p0:this.p1},or.prototype.distancePerpendicular=function(o){return Qe.distancePointLinePerpendicular(o,this.p0,this.p1)},or.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},or.prototype.midPoint=function(){return or.midPoint(this.p0,this.p1)},or.prototype.projectionFactor=function(o){if(o.equals(this.p0))return 0;if(o.equals(this.p1))return 1;var c=this.p1.x-this.p0.x,g=this.p1.y-this.p0.y,v=c*c+g*g;return v<=0?H.NaN:((o.x-this.p0.x)*c+(o.y-this.p0.y)*g)/v},or.prototype.closestPoints=function(o){var c=this.intersection(o);if(c!==null)return[c,c];var g=new Array(2).fill(null),v=H.MAX_VALUE,A=null,N=this.closestPoint(o.p0);v=N.distance(o.p0),g[0]=N,g[1]=o.p0;var G=this.closestPoint(o.p1);(A=G.distance(o.p1))<v&&(v=A,g[0]=G,g[1]=o.p1);var le=o.closestPoint(this.p0);(A=le.distance(this.p0))<v&&(v=A,g[0]=this.p0,g[1]=le);var xe=o.closestPoint(this.p1);return(A=xe.distance(this.p1))<v&&(v=A,g[0]=this.p1,g[1]=xe),g},or.prototype.closestPoint=function(o){var c=this.projectionFactor(o);return c>0&&c<1?this.project(o):this.p0.distance(o)<this.p1.distance(o)?this.p0:this.p1},or.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},or.prototype.getLength=function(){return this.p0.distance(this.p1)},or.prototype.compareTo=function(o){var c=o,g=this.p0.compareTo(c.p0);return g!==0?g:this.p1.compareTo(c.p1)},or.prototype.reverse=function(){var o=this.p0;this.p0=this.p1,this.p1=o},or.prototype.equalsTopo=function(o){return this.p0.equals(o.p0)&&(this.p1.equals(o.p1)||this.p0.equals(o.p1))&&this.p1.equals(o.p0)},or.prototype.lineIntersection=function(o){try{return Ct.intersection(this.p0,this.p1,o.p0,o.p1)}catch(c){if(!(c instanceof Lt))throw c}return null},or.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},or.prototype.pointAlongOffset=function(o,c){var g=this.p0.x+o*(this.p1.x-this.p0.x),v=this.p0.y+o*(this.p1.y-this.p0.y),A=this.p1.x-this.p0.x,N=this.p1.y-this.p0.y,G=Math.sqrt(A*A+N*N),le=0,xe=0;if(c!==0){if(G<=0)throw new Error("Cannot compute offset from zero-length line segment");le=c*A/G,xe=c*N/G}return new J(g-xe,v+le)},or.prototype.setCoordinates=function(){if(arguments.length===1){var o=arguments[0];this.setCoordinates(o.p0,o.p1)}else if(arguments.length===2){var c=arguments[0],g=arguments[1];this.p0.x=c.x,this.p0.y=c.y,this.p1.x=g.x,this.p1.y=g.y}},or.prototype.segmentFraction=function(o){var c=this.projectionFactor(o);return c<0?c=0:(c>1||H.isNaN(c))&&(c=1),c},or.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},or.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},or.prototype.distance=function(){if(arguments[0]instanceof or){var o=arguments[0];return Qe.distanceLineLine(this.p0,this.p1,o.p0,o.p1)}if(arguments[0]instanceof J){var c=arguments[0];return Qe.distancePointLine(c,this.p0,this.p1)}},or.prototype.pointAlong=function(o){var c=new J;return c.x=this.p0.x+o*(this.p1.x-this.p0.x),c.y=this.p0.y+o*(this.p1.y-this.p0.y),c},or.prototype.hashCode=function(){var o=H.doubleToLongBits(this.p0.x);o^=31*H.doubleToLongBits(this.p0.y);var c=Math.trunc(o)^Math.trunc(o>>32),g=H.doubleToLongBits(this.p1.x);return g^=31*H.doubleToLongBits(this.p1.y),c^(Math.trunc(g)^Math.trunc(g>>32))},or.prototype.interfaces_=function(){return[ie,n]},or.prototype.getClass=function(){return or},or.midPoint=function(o,c){return new J((o.x+c.x)/2,(o.y+c.y)/2)},Cl.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(or,Cl);var eu=function(){this.tempEnv1=new mt,this.tempEnv2=new mt,this._overlapSeg1=new or,this._overlapSeg2=new or};eu.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var o=arguments[0],c=arguments[1],g=arguments[2],v=arguments[3];o.getLineSegment(c,this._overlapSeg1),g.getLineSegment(v,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}},eu.prototype.interfaces_=function(){return[]},eu.prototype.getClass=function(){return eu};var _i=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var o=arguments[0],c=arguments[1],g=arguments[2],v=arguments[3];this._pts=o,this._start=c,this._end=g,this._context=v};_i.prototype.getLineSegment=function(o,c){c.p0=this._pts[o],c.p1=this._pts[o+1]},_i.prototype.computeSelect=function(o,c,g,v){var A=this._pts[c],N=this._pts[g];if(v.tempEnv1.init(A,N),g-c==1)return v.select(this,c),null;if(!o.intersects(v.tempEnv1))return null;var G=Math.trunc((c+g)/2);c<G&&this.computeSelect(o,c,G,v),G<g&&this.computeSelect(o,G,g,v)},_i.prototype.getCoordinates=function(){for(var o=new Array(this._end-this._start+1).fill(null),c=0,g=this._start;g<=this._end;g++)o[c++]=this._pts[g];return o},_i.prototype.computeOverlaps=function(o,c){this.computeOverlapsInternal(this._start,this._end,o,o._start,o._end,c)},_i.prototype.setId=function(o){this._id=o},_i.prototype.select=function(o,c){this.computeSelect(o,this._start,this._end,c)},_i.prototype.getEnvelope=function(){if(this._env===null){var o=this._pts[this._start],c=this._pts[this._end];this._env=new mt(o,c)}return this._env},_i.prototype.getEndIndex=function(){return this._end},_i.prototype.getStartIndex=function(){return this._start},_i.prototype.getContext=function(){return this._context},_i.prototype.getId=function(){return this._id},_i.prototype.computeOverlapsInternal=function(o,c,g,v,A,N){var G=this._pts[o],le=this._pts[c],xe=g._pts[v],x=g._pts[A];if(c-o==1&&A-v==1)return N.overlap(this,o,g,v),null;if(N.tempEnv1.init(G,le),N.tempEnv2.init(xe,x),!N.tempEnv1.intersects(N.tempEnv2))return null;var a=Math.trunc((o+c)/2),d=Math.trunc((v+A)/2);o<a&&(v<d&&this.computeOverlapsInternal(o,a,g,v,d,N),d<A&&this.computeOverlapsInternal(o,a,g,d,A,N)),a<c&&(v<d&&this.computeOverlapsInternal(a,c,g,v,d,N),d<A&&this.computeOverlapsInternal(a,c,g,d,A,N))},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i};var Ho=function(){};Ho.prototype.interfaces_=function(){return[]},Ho.prototype.getClass=function(){return Ho},Ho.getChainStartIndices=function(o){var c=0,g=new Et;g.add(new fe(c));do{var v=Ho.findChainEnd(o,c);g.add(new fe(v)),c=v}while(c<o.length-1);return Ho.toIntArray(g)},Ho.findChainEnd=function(o,c){for(var g=c;g<o.length-1&&o[g].equals2D(o[g+1]);)g++;if(g>=o.length-1)return o.length-1;for(var v=Zr.quadrant(o[g],o[g+1]),A=c+1;A<o.length&&!(!o[A-1].equals2D(o[A])&&Zr.quadrant(o[A-1],o[A])!==v);)A++;return A-1},Ho.getChains=function(){if(arguments.length===1){var o=arguments[0];return Ho.getChains(o,null)}if(arguments.length===2){for(var c=arguments[0],g=arguments[1],v=new Et,A=Ho.getChainStartIndices(c),N=0;N<A.length-1;N++){var G=new _i(c,A[N],A[N+1],g);v.add(G)}return v}},Ho.toIntArray=function(o){for(var c=new Array(o.size()).fill(null),g=0;g<c.length;g++)c[g]=o.get(g).intValue();return c};var Jo=function(){};Jo.prototype.computeNodes=function(o){},Jo.prototype.getNodedSubstrings=function(){},Jo.prototype.interfaces_=function(){return[]},Jo.prototype.getClass=function(){return Jo};var Ga=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this.setSegmentIntersector(o)}}};Ga.prototype.setSegmentIntersector=function(o){this._segInt=o},Ga.prototype.interfaces_=function(){return[Jo]},Ga.prototype.getClass=function(){return Ga};var tl=function(o){function c(v){v?o.call(this,v):o.call(this),this._monoChains=new Et,this._index=new el,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}o&&(c.__proto__=o),(c.prototype=Object.create(o&&o.prototype)).constructor=c;var g={SegmentOverlapAction:{configurable:!0}};return c.prototype.getMonotoneChains=function(){return this._monoChains},c.prototype.getNodedSubstrings=function(){return zn.getNodedSubstrings(this._nodedSegStrings)},c.prototype.getIndex=function(){return this._index},c.prototype.add=function(v){for(var A=Ho.getChains(v.getCoordinates(),v).iterator();A.hasNext();){var N=A.next();N.setId(this._idCounter++),this._index.insert(N.getEnvelope(),N),this._monoChains.add(N)}},c.prototype.computeNodes=function(v){this._nodedSegStrings=v;for(var A=v.iterator();A.hasNext();)this.add(A.next());this.intersectChains()},c.prototype.intersectChains=function(){for(var v=new rl(this._segInt),A=this._monoChains.iterator();A.hasNext();)for(var N=A.next(),G=this._index.query(N.getEnvelope()).iterator();G.hasNext();){var le=G.next();if(le.getId()>N.getId()&&(N.computeOverlaps(le,v),this._nOverlaps++),this._segInt.isDone())return null}},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},g.SegmentOverlapAction.get=function(){return rl},Object.defineProperties(c,g),c}(Ga),rl=function(o){function c(){o.call(this),this._si=null;var g=arguments[0];this._si=g}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.overlap=function(){if(arguments.length!==4)return o.prototype.overlap.apply(this,arguments);var g=arguments[0],v=arguments[1],A=arguments[2],N=arguments[3],G=g.getContext(),le=A.getContext();this._si.processIntersections(G,v,le,N)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(eu),tr=function o(){if(this._quadrantSegments=o.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=o.CAP_ROUND,this._joinStyle=o.JOIN_ROUND,this._mitreLimit=o.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=o.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var c=arguments[0];this.setQuadrantSegments(c)}else if(arguments.length===2){var g=arguments[0],v=arguments[1];this.setQuadrantSegments(g),this.setEndCapStyle(v)}else if(arguments.length===4){var A=arguments[0],N=arguments[1],G=arguments[2],le=arguments[3];this.setQuadrantSegments(A),this.setEndCapStyle(N),this.setJoinStyle(G),this.setMitreLimit(le)}}},Ko={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};tr.prototype.getEndCapStyle=function(){return this._endCapStyle},tr.prototype.isSingleSided=function(){return this._isSingleSided},tr.prototype.setQuadrantSegments=function(o){this._quadrantSegments=o,this._quadrantSegments===0&&(this._joinStyle=tr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=tr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),o<=0&&(this._quadrantSegments=1),this._joinStyle!==tr.JOIN_ROUND&&(this._quadrantSegments=tr.DEFAULT_QUADRANT_SEGMENTS)},tr.prototype.getJoinStyle=function(){return this._joinStyle},tr.prototype.setJoinStyle=function(o){this._joinStyle=o},tr.prototype.setSimplifyFactor=function(o){this._simplifyFactor=o<0?0:o},tr.prototype.getSimplifyFactor=function(){return this._simplifyFactor},tr.prototype.getQuadrantSegments=function(){return this._quadrantSegments},tr.prototype.setEndCapStyle=function(o){this._endCapStyle=o},tr.prototype.getMitreLimit=function(){return this._mitreLimit},tr.prototype.setMitreLimit=function(o){this._mitreLimit=o},tr.prototype.setSingleSided=function(o){this._isSingleSided=o},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},tr.bufferDistanceError=function(o){var c=Math.PI/2/o;return 1-Math.cos(c/2)},Ko.CAP_ROUND.get=function(){return 1},Ko.CAP_FLAT.get=function(){return 2},Ko.CAP_SQUARE.get=function(){return 3},Ko.JOIN_ROUND.get=function(){return 1},Ko.JOIN_MITRE.get=function(){return 2},Ko.JOIN_BEVEL.get=function(){return 3},Ko.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Ko.DEFAULT_MITRE_LIMIT.get=function(){return 5},Ko.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(tr,Ko);var ei=function(o){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Qe.COUNTERCLOCKWISE,this._inputLine=o||null},xu={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ei.prototype.isDeletable=function(o,c,g,v){var A=this._inputLine[o],N=this._inputLine[c],G=this._inputLine[g];return!!this.isConcave(A,N,G)&&!!this.isShallow(A,N,G,v)&&this.isShallowSampled(A,N,o,g,v)},ei.prototype.deleteShallowConcavities=function(){for(var o=1,c=this.findNextNonDeletedIndex(o),g=this.findNextNonDeletedIndex(c),v=!1;g<this._inputLine.length;){var A=!1;this.isDeletable(o,c,g,this._distanceTol)&&(this._isDeleted[c]=ei.DELETE,A=!0,v=!0),o=A?g:c,c=this.findNextNonDeletedIndex(o),g=this.findNextNonDeletedIndex(c)}return v},ei.prototype.isShallowConcavity=function(o,c,g,v){return Qe.computeOrientation(o,c,g)!==this._angleOrientation?!1:Qe.distancePointLine(c,o,g)<v},ei.prototype.isShallowSampled=function(o,c,g,v,A){var N=Math.trunc((v-g)/ei.NUM_PTS_TO_CHECK);N<=0&&(N=1);for(var G=g;G<v;G+=N)if(!this.isShallow(o,c,this._inputLine[G],A))return!1;return!0},ei.prototype.isConcave=function(o,c,g){var v=Qe.computeOrientation(o,c,g)===this._angleOrientation;return v},ei.prototype.simplify=function(o){this._distanceTol=Math.abs(o),o<0&&(this._angleOrientation=Qe.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var c=!1;do c=this.deleteShallowConcavities();while(c);return this.collapseLine()},ei.prototype.findNextNonDeletedIndex=function(o){for(var c=o+1;c<this._inputLine.length&&this._isDeleted[c]===ei.DELETE;)c++;return c},ei.prototype.isShallow=function(o,c,g,v){return Qe.distancePointLine(c,o,g)<v},ei.prototype.collapseLine=function(){for(var o=new Le,c=0;c<this._inputLine.length;c++)this._isDeleted[c]!==ei.DELETE&&o.add(this._inputLine[c]);return o.toCoordinateArray()},ei.prototype.interfaces_=function(){return[]},ei.prototype.getClass=function(){return ei},ei.simplify=function(o,c){return new ei(o).simplify(c)},xu.INIT.get=function(){return 0},xu.DELETE.get=function(){return 1},xu.KEEP.get=function(){return 1},xu.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(ei,xu);var Ei=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Et},nc={COORDINATE_ARRAY_TYPE:{configurable:!0}};Ei.prototype.getCoordinates=function(){return this._ptList.toArray(Ei.COORDINATE_ARRAY_TYPE)},Ei.prototype.setPrecisionModel=function(o){this._precisionModel=o},Ei.prototype.addPt=function(o){var c=new J(o);if(this._precisionModel.makePrecise(c),this.isRedundant(c))return null;this._ptList.add(c)},Ei.prototype.revere=function(){},Ei.prototype.addPts=function(o,c){if(c)for(var g=0;g<o.length;g++)this.addPt(o[g]);else for(var v=o.length-1;v>=0;v--)this.addPt(o[v])},Ei.prototype.isRedundant=function(o){if(this._ptList.size()<1)return!1;var c=this._ptList.get(this._ptList.size()-1);return o.distance(c)<this._minimimVertexDistance},Ei.prototype.toString=function(){return new Rr().createLineString(this.getCoordinates()).toString()},Ei.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var o=new J(this._ptList.get(0)),c=this._ptList.get(this._ptList.size()-1);if(o.equals(c))return null;this._ptList.add(o)},Ei.prototype.setMinimumVertexDistance=function(o){this._minimimVertexDistance=o},Ei.prototype.interfaces_=function(){return[]},Ei.prototype.getClass=function(){return Ei},nc.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Ei,nc);var Wr=function(){},ks={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr},Wr.toDegrees=function(o){return 180*o/Math.PI},Wr.normalize=function(o){for(;o>Math.PI;)o-=Wr.PI_TIMES_2;for(;o<=-Math.PI;)o+=Wr.PI_TIMES_2;return o},Wr.angle=function(){if(arguments.length===1){var o=arguments[0];return Math.atan2(o.y,o.x)}if(arguments.length===2){var c=arguments[0],g=arguments[1],v=g.x-c.x,A=g.y-c.y;return Math.atan2(A,v)}},Wr.isAcute=function(o,c,g){var v=o.x-c.x,A=o.y-c.y;return v*(g.x-c.x)+A*(g.y-c.y)>0},Wr.isObtuse=function(o,c,g){var v=o.x-c.x,A=o.y-c.y;return v*(g.x-c.x)+A*(g.y-c.y)<0},Wr.interiorAngle=function(o,c,g){var v=Wr.angle(c,o),A=Wr.angle(c,g);return Math.abs(A-v)},Wr.normalizePositive=function(o){if(o<0){for(;o<0;)o+=Wr.PI_TIMES_2;o>=Wr.PI_TIMES_2&&(o=0)}else{for(;o>=Wr.PI_TIMES_2;)o-=Wr.PI_TIMES_2;o<0&&(o=0)}return o},Wr.angleBetween=function(o,c,g){var v=Wr.angle(c,o),A=Wr.angle(c,g);return Wr.diff(v,A)},Wr.diff=function(o,c){var g=null;return(g=o<c?c-o:o-c)>Math.PI&&(g=2*Math.PI-g),g},Wr.toRadians=function(o){return o*Math.PI/180},Wr.getTurn=function(o,c){var g=Math.sin(c-o);return g>0?Wr.COUNTERCLOCKWISE:g<0?Wr.CLOCKWISE:Wr.NONE},Wr.angleBetweenOriented=function(o,c,g){var v=Wr.angle(c,o),A=Wr.angle(c,g)-v;return A<=-Math.PI?A+Wr.PI_TIMES_2:A>Math.PI?A-Wr.PI_TIMES_2:A},ks.PI_TIMES_2.get=function(){return 2*Math.PI},ks.PI_OVER_2.get=function(){return Math.PI/2},ks.PI_OVER_4.get=function(){return Math.PI/4},ks.COUNTERCLOCKWISE.get=function(){return Qe.COUNTERCLOCKWISE},ks.CLOCKWISE.get=function(){return Qe.CLOCKWISE},ks.NONE.get=function(){return Qe.COLLINEAR},Object.defineProperties(Wr,ks);var Un=function o(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new or,this._seg1=new or,this._offset0=new or,this._offset1=new or,this._side=0,this._hasNarrowConcaveAngle=!1;var c=arguments[0],g=arguments[1],v=arguments[2];this._precisionModel=c,this._bufParams=g,this._li=new Xe,this._filletAngleQuantum=Math.PI/2/g.getQuadrantSegments(),g.getQuadrantSegments()>=8&&g.getJoinStyle()===tr.JOIN_ROUND&&(this._closingSegLengthFactor=o.MAX_CLOSING_SEG_LEN_FACTOR),this.init(v)},Hn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Un.prototype.addNextSegment=function(o,c){if(this._s0=this._s1,this._s1=this._s2,this._s2=o,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var g=Qe.computeOrientation(this._s0,this._s1,this._s2),v=g===Qe.CLOCKWISE&&this._side===Pt.LEFT||g===Qe.COUNTERCLOCKWISE&&this._side===Pt.RIGHT;g===0?this.addCollinear(c):v?this.addOutsideTurn(g,c):this.addInsideTurn(g,c)},Un.prototype.addLineEndCap=function(o,c){var g=new or(o,c),v=new or;this.computeOffsetSegment(g,Pt.LEFT,this._distance,v);var A=new or;this.computeOffsetSegment(g,Pt.RIGHT,this._distance,A);var N=c.x-o.x,G=c.y-o.y,le=Math.atan2(G,N);switch(this._bufParams.getEndCapStyle()){case tr.CAP_ROUND:this._segList.addPt(v.p1),this.addFilletArc(c,le+Math.PI/2,le-Math.PI/2,Qe.CLOCKWISE,this._distance),this._segList.addPt(A.p1);break;case tr.CAP_FLAT:this._segList.addPt(v.p1),this._segList.addPt(A.p1);break;case tr.CAP_SQUARE:var xe=new J;xe.x=Math.abs(this._distance)*Math.cos(le),xe.y=Math.abs(this._distance)*Math.sin(le);var x=new J(v.p1.x+xe.x,v.p1.y+xe.y),a=new J(A.p1.x+xe.x,A.p1.y+xe.y);this._segList.addPt(x),this._segList.addPt(a)}},Un.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Un.prototype.addMitreJoin=function(o,c,g,v){var A=!0,N=null;try{N=Ct.intersection(c.p0,c.p1,g.p0,g.p1),(v<=0?1:N.distance(o)/Math.abs(v))>this._bufParams.getMitreLimit()&&(A=!1)}catch(G){if(!(G instanceof Lt))throw G;N=new J(0,0),A=!1}A?this._segList.addPt(N):this.addLimitedMitreJoin(c,g,v,this._bufParams.getMitreLimit())},Un.prototype.addFilletCorner=function(o,c,g,v,A){var N=c.x-o.x,G=c.y-o.y,le=Math.atan2(G,N),xe=g.x-o.x,x=g.y-o.y,a=Math.atan2(x,xe);v===Qe.CLOCKWISE?le<=a&&(le+=2*Math.PI):le>=a&&(le-=2*Math.PI),this._segList.addPt(c),this.addFilletArc(o,le,a,v,A),this._segList.addPt(g)},Un.prototype.addOutsideTurn=function(o,c){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Un.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===tr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===tr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(c&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,o,this._distance),this._segList.addPt(this._offset1.p0))},Un.prototype.createSquare=function(o){this._segList.addPt(new J(o.x+this._distance,o.y+this._distance)),this._segList.addPt(new J(o.x+this._distance,o.y-this._distance)),this._segList.addPt(new J(o.x-this._distance,o.y-this._distance)),this._segList.addPt(new J(o.x-this._distance,o.y+this._distance)),this._segList.closeRing()},Un.prototype.addSegments=function(o,c){this._segList.addPts(o,c)},Un.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Un.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Un.prototype.initSideSegments=function(o,c,g){this._s1=o,this._s2=c,this._side=g,this._seg1.setCoordinates(o,c),this.computeOffsetSegment(this._seg1,g,this._distance,this._offset1)},Un.prototype.addLimitedMitreJoin=function(o,c,g,v){var A=this._seg0.p1,N=Wr.angle(A,this._seg0.p0),G=Wr.angleBetweenOriented(this._seg0.p0,A,this._seg1.p1)/2,le=Wr.normalize(N+G),xe=Wr.normalize(le+Math.PI),x=v*g,a=g-x*Math.abs(Math.sin(G)),d=A.x+x*Math.cos(xe),b=A.y+x*Math.sin(xe),w=new J(d,b),I=new or(A,w),L=I.pointAlongOffset(1,a),F=I.pointAlongOffset(1,-a);this._side===Pt.LEFT?(this._segList.addPt(L),this._segList.addPt(F)):(this._segList.addPt(F),this._segList.addPt(L))},Un.prototype.computeOffsetSegment=function(o,c,g,v){var A=c===Pt.LEFT?1:-1,N=o.p1.x-o.p0.x,G=o.p1.y-o.p0.y,le=Math.sqrt(N*N+G*G),xe=A*g*N/le,x=A*g*G/le;v.p0.x=o.p0.x-x,v.p0.y=o.p0.y+xe,v.p1.x=o.p1.x-x,v.p1.y=o.p1.y+xe},Un.prototype.addFilletArc=function(o,c,g,v,A){var N=v===Qe.CLOCKWISE?-1:1,G=Math.abs(c-g),le=Math.trunc(G/this._filletAngleQuantum+.5);if(le<1)return null;for(var xe=G/le,x=0,a=new J;x<G;){var d=c+N*x;a.x=o.x+A*Math.cos(d),a.y=o.y+A*Math.sin(d),this._segList.addPt(a),x+=xe}},Un.prototype.addInsideTurn=function(o,c){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Un.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var g=new J((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(g);var v=new J((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(v)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Un.prototype.createCircle=function(o){var c=new J(o.x+this._distance,o.y);this._segList.addPt(c),this.addFilletArc(o,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Un.prototype.addBevelJoin=function(o,c){this._segList.addPt(o.p1),this._segList.addPt(c.p0)},Un.prototype.init=function(o){this._distance=o,this._maxCurveSegmentError=o*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ei,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(o*Un.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Un.prototype.addCollinear=function(o){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===tr.JOIN_BEVEL||this._bufParams.getJoinStyle()===tr.JOIN_MITRE?(o&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Qe.CLOCKWISE,this._distance))},Un.prototype.closeRing=function(){this._segList.closeRing()},Un.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un},Hn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Hn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Hn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Hn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Un,Hn);var Li=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var o=arguments[0],c=arguments[1];this._precisionModel=o,this._bufParams=c};Li.prototype.getOffsetCurve=function(o,c){if(this._distance=c,c===0)return null;var g=c<0,v=Math.abs(c),A=this.getSegGen(v);o.length<=1?this.computePointCurve(o[0],A):this.computeOffsetCurve(o,g,A);var N=A.getCoordinates();return g&&ne.reverse(N),N},Li.prototype.computeSingleSidedBufferCurve=function(o,c,g){var v=this.simplifyTolerance(this._distance);if(c){g.addSegments(o,!0);var A=ei.simplify(o,-v),N=A.length-1;g.initSideSegments(A[N],A[N-1],Pt.LEFT),g.addFirstSegment();for(var G=N-2;G>=0;G--)g.addNextSegment(A[G],!0)}else{g.addSegments(o,!1);var le=ei.simplify(o,v),xe=le.length-1;g.initSideSegments(le[0],le[1],Pt.LEFT),g.addFirstSegment();for(var x=2;x<=xe;x++)g.addNextSegment(le[x],!0)}g.addLastSegment(),g.closeRing()},Li.prototype.computeRingBufferCurve=function(o,c,g){var v=this.simplifyTolerance(this._distance);c===Pt.RIGHT&&(v=-v);var A=ei.simplify(o,v),N=A.length-1;g.initSideSegments(A[N-1],A[0],c);for(var G=1;G<=N;G++){var le=G!==1;g.addNextSegment(A[G],le)}g.closeRing()},Li.prototype.computeLineBufferCurve=function(o,c){var g=this.simplifyTolerance(this._distance),v=ei.simplify(o,g),A=v.length-1;c.initSideSegments(v[0],v[1],Pt.LEFT);for(var N=2;N<=A;N++)c.addNextSegment(v[N],!0);c.addLastSegment(),c.addLineEndCap(v[A-1],v[A]);var G=ei.simplify(o,-g),le=G.length-1;c.initSideSegments(G[le],G[le-1],Pt.LEFT);for(var xe=le-2;xe>=0;xe--)c.addNextSegment(G[xe],!0);c.addLastSegment(),c.addLineEndCap(G[1],G[0]),c.closeRing()},Li.prototype.computePointCurve=function(o,c){switch(this._bufParams.getEndCapStyle()){case tr.CAP_ROUND:c.createCircle(o);break;case tr.CAP_SQUARE:c.createSquare(o)}},Li.prototype.getLineCurve=function(o,c){if(this._distance=c,c<0&&!this._bufParams.isSingleSided()||c===0)return null;var g=Math.abs(c),v=this.getSegGen(g);if(o.length<=1)this.computePointCurve(o[0],v);else if(this._bufParams.isSingleSided()){var A=c<0;this.computeSingleSidedBufferCurve(o,A,v)}else this.computeLineBufferCurve(o,v);return v.getCoordinates()},Li.prototype.getBufferParameters=function(){return this._bufParams},Li.prototype.simplifyTolerance=function(o){return o*this._bufParams.getSimplifyFactor()},Li.prototype.getRingCurve=function(o,c,g){if(this._distance=g,o.length<=2)return this.getLineCurve(o,g);if(g===0)return Li.copyCoordinates(o);var v=this.getSegGen(g);return this.computeRingBufferCurve(o,c,v),v.getCoordinates()},Li.prototype.computeOffsetCurve=function(o,c,g){var v=this.simplifyTolerance(this._distance);if(c){var A=ei.simplify(o,-v),N=A.length-1;g.initSideSegments(A[N],A[N-1],Pt.LEFT),g.addFirstSegment();for(var G=N-2;G>=0;G--)g.addNextSegment(A[G],!0)}else{var le=ei.simplify(o,v),xe=le.length-1;g.initSideSegments(le[0],le[1],Pt.LEFT),g.addFirstSegment();for(var x=2;x<=xe;x++)g.addNextSegment(le[x],!0)}g.addLastSegment()},Li.prototype.getSegGen=function(o){return new Un(this._precisionModel,this._bufParams,o)},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.copyCoordinates=function(o){for(var c=new Array(o.length).fill(null),g=0;g<c.length;g++)c[g]=new J(o[g]);return c};var Br=function(){this._subgraphs=null,this._seg=new or,this._cga=new Qe;var o=arguments[0];this._subgraphs=o},wu={DepthSegment:{configurable:!0}};Br.prototype.findStabbedSegments=function(){if(arguments.length===1){for(var o=arguments[0],c=new Et,g=this._subgraphs.iterator();g.hasNext();){var v=g.next(),A=v.getEnvelope();o.y<A.getMinY()||o.y>A.getMaxY()||this.findStabbedSegments(o,v.getDirectedEdges(),c)}return c}if(arguments.length===3){if(Pe(arguments[2],Lr)&&arguments[0]instanceof J&&arguments[1]instanceof Ns){for(var N=arguments[0],G=arguments[1],le=arguments[2],xe=G.getEdge().getCoordinates(),x=0;x<xe.length-1;x++)if(this._seg.p0=xe[x],this._seg.p1=xe[x+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<N.x)&&!(this._seg.isHorizontal()||N.y<this._seg.p0.y||N.y>this._seg.p1.y||Qe.computeOrientation(this._seg.p0,this._seg.p1,N)===Qe.RIGHT)){var a=G.getDepth(Pt.LEFT);this._seg.p0.equals(xe[x])||(a=G.getDepth(Pt.RIGHT));var d=new ln(this._seg,a);le.add(d)}}else if(Pe(arguments[2],Lr)&&arguments[0]instanceof J&&Pe(arguments[1],Lr))for(var b=arguments[0],w=arguments[1],I=arguments[2],L=w.iterator();L.hasNext();){var F=L.next();F.isForward()&&this.findStabbedSegments(b,F,I)}}},Br.prototype.getDepth=function(o){var c=this.findStabbedSegments(o);return c.size()===0?0:Ki.min(c)._leftDepth},Br.prototype.interfaces_=function(){return[]},Br.prototype.getClass=function(){return Br},wu.DepthSegment.get=function(){return ln},Object.defineProperties(Br,wu);var ln=function(){this._upwardSeg=null,this._leftDepth=null;var o=arguments[0],c=arguments[1];this._upwardSeg=new or(o),this._leftDepth=c};ln.prototype.compareTo=function(o){var c=o;if(this._upwardSeg.minX()>=c._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=c._upwardSeg.minX())return-1;var g=this._upwardSeg.orientationIndex(c._upwardSeg);return g!==0||(g=-1*c._upwardSeg.orientationIndex(this._upwardSeg))!=0?g:this._upwardSeg.compareTo(c._upwardSeg)},ln.prototype.compareX=function(o,c){var g=o.p0.compareTo(c.p0);return g!==0?g:o.p1.compareTo(c.p1)},ln.prototype.toString=function(){return this._upwardSeg.toString()},ln.prototype.interfaces_=function(){return[ie]},ln.prototype.getClass=function(){return ln};var dr=function(o,c,g){this.p0=o||null,this.p1=c||null,this.p2=g||null};dr.prototype.area=function(){return dr.area(this.p0,this.p1,this.p2)},dr.prototype.signedArea=function(){return dr.signedArea(this.p0,this.p1,this.p2)},dr.prototype.interpolateZ=function(o){if(o===null)throw new U("Supplied point is null.");return dr.interpolateZ(o,this.p0,this.p1,this.p2)},dr.prototype.longestSideLength=function(){return dr.longestSideLength(this.p0,this.p1,this.p2)},dr.prototype.isAcute=function(){return dr.isAcute(this.p0,this.p1,this.p2)},dr.prototype.circumcentre=function(){return dr.circumcentre(this.p0,this.p1,this.p2)},dr.prototype.area3D=function(){return dr.area3D(this.p0,this.p1,this.p2)},dr.prototype.centroid=function(){return dr.centroid(this.p0,this.p1,this.p2)},dr.prototype.inCentre=function(){return dr.inCentre(this.p0,this.p1,this.p2)},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr},dr.area=function(o,c,g){return Math.abs(((g.x-o.x)*(c.y-o.y)-(c.x-o.x)*(g.y-o.y))/2)},dr.signedArea=function(o,c,g){return((g.x-o.x)*(c.y-o.y)-(c.x-o.x)*(g.y-o.y))/2},dr.det=function(o,c,g,v){return o*v-c*g},dr.interpolateZ=function(o,c,g,v){var A=c.x,N=c.y,G=g.x-A,le=v.x-A,xe=g.y-N,x=v.y-N,a=G*x-le*xe,d=o.x-A,b=o.y-N,w=(x*d-le*b)/a,I=(-xe*d+G*b)/a;return c.z+w*(g.z-c.z)+I*(v.z-c.z)},dr.longestSideLength=function(o,c,g){var v=o.distance(c),A=c.distance(g),N=g.distance(o),G=v;return A>G&&(G=A),N>G&&(G=N),G},dr.isAcute=function(o,c,g){return!!Wr.isAcute(o,c,g)&&!!Wr.isAcute(c,g,o)&&!!Wr.isAcute(g,o,c)},dr.circumcentre=function(o,c,g){var v=g.x,A=g.y,N=o.x-v,G=o.y-A,le=c.x-v,xe=c.y-A,x=2*dr.det(N,G,le,xe),a=dr.det(G,N*N+G*G,xe,le*le+xe*xe),d=dr.det(N,N*N+G*G,le,le*le+xe*xe);return new J(v-a/x,A+d/x)},dr.perpendicularBisector=function(o,c){var g=c.x-o.x,v=c.y-o.y,A=new Ct(o.x+g/2,o.y+v/2,1),N=new Ct(o.x-v+g/2,o.y+g+v/2,1);return new Ct(A,N)},dr.angleBisector=function(o,c,g){var v=c.distance(o),A=v/(v+c.distance(g)),N=g.x-o.x,G=g.y-o.y;return new J(o.x+A*N,o.y+A*G)},dr.area3D=function(o,c,g){var v=c.x-o.x,A=c.y-o.y,N=c.z-o.z,G=g.x-o.x,le=g.y-o.y,xe=g.z-o.z,x=A*xe-N*le,a=N*G-v*xe,d=v*le-A*G,b=x*x+a*a+d*d,w=Math.sqrt(b)/2;return w},dr.centroid=function(o,c,g){var v=(o.x+c.x+g.x)/3,A=(o.y+c.y+g.y)/3;return new J(v,A)},dr.inCentre=function(o,c,g){var v=c.distance(g),A=o.distance(g),N=o.distance(c),G=v+A+N,le=(v*o.x+A*c.x+N*g.x)/G,xe=(v*o.y+A*c.y+N*g.y)/G;return new J(le,xe)};var Ri=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Et;var o=arguments[0],c=arguments[1],g=arguments[2];this._inputGeom=o,this._distance=c,this._curveBuilder=g};Ri.prototype.addPoint=function(o){if(this._distance<=0)return null;var c=o.getCoordinates(),g=this._curveBuilder.getLineCurve(c,this._distance);this.addCurve(g,ae.EXTERIOR,ae.INTERIOR)},Ri.prototype.addPolygon=function(o){var c=this._distance,g=Pt.LEFT;this._distance<0&&(c=-this._distance,g=Pt.RIGHT);var v=o.getExteriorRing(),A=ne.removeRepeatedPoints(v.getCoordinates());if(this._distance<0&&this.isErodedCompletely(v,this._distance)||this._distance<=0&&A.length<3)return null;this.addPolygonRing(A,c,g,ae.EXTERIOR,ae.INTERIOR);for(var N=0;N<o.getNumInteriorRing();N++){var G=o.getInteriorRingN(N),le=ne.removeRepeatedPoints(G.getCoordinates());this._distance>0&&this.isErodedCompletely(G,-this._distance)||this.addPolygonRing(le,c,Pt.opposite(g),ae.INTERIOR,ae.EXTERIOR)}},Ri.prototype.isTriangleErodedCompletely=function(o,c){var g=new dr(o[0],o[1],o[2]),v=g.inCentre();return Qe.distancePointLine(v,g.p0,g.p1)<Math.abs(c)},Ri.prototype.addLineString=function(o){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var c=ne.removeRepeatedPoints(o.getCoordinates()),g=this._curveBuilder.getLineCurve(c,this._distance);this.addCurve(g,ae.EXTERIOR,ae.INTERIOR)},Ri.prototype.addCurve=function(o,c,g){if(o===null||o.length<2)return null;var v=new zn(o,new Xr(0,ae.BOUNDARY,c,g));this._curveList.add(v)},Ri.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Ri.prototype.addPolygonRing=function(o,c,g,v,A){if(c===0&&o.length<hi.MINIMUM_VALID_SIZE)return null;var N=v,G=A;o.length>=hi.MINIMUM_VALID_SIZE&&Qe.isCCW(o)&&(N=A,G=v,g=Pt.opposite(g));var le=this._curveBuilder.getRingCurve(o,g,c);this.addCurve(le,N,G)},Ri.prototype.add=function(o){if(o.isEmpty())return null;o instanceof ii?this.addPolygon(o):o instanceof Fr?this.addLineString(o):o instanceof Vr?this.addPoint(o):o instanceof ci?this.addCollection(o):o instanceof Ur?this.addCollection(o):o instanceof Bo?this.addCollection(o):o instanceof Ht&&this.addCollection(o)},Ri.prototype.isErodedCompletely=function(o,c){var g=o.getCoordinates();if(g.length<4)return c<0;if(g.length===4)return this.isTriangleErodedCompletely(g,c);var v=o.getEnvelopeInternal(),A=Math.min(v.getHeight(),v.getWidth());return c<0&&2*Math.abs(c)>A},Ri.prototype.addCollection=function(o){for(var c=0;c<o.getNumGeometries();c++){var g=o.getGeometryN(c);this.add(g)}},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri};var qa=function(){};qa.prototype.locate=function(o){},qa.prototype.interfaces_=function(){return[]},qa.prototype.getClass=function(){return qa};var Qo=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var o=arguments[0];this._parent=o,this._atStart=!0,this._index=0,this._max=o.getNumGeometries()};Qo.prototype.next=function(){if(this._atStart)return this._atStart=!1,Qo.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new l;var o=this._parent.getGeometryN(this._index++);return o instanceof Ht?(this._subcollectionIterator=new Qo(o),this._subcollectionIterator.next()):o},Qo.prototype.remove=function(){throw new Error(this.getClass().getName())},Qo.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Qo.prototype.interfaces_=function(){return[Fn]},Qo.prototype.getClass=function(){return Qo},Qo.isAtomic=function(o){return!(o instanceof Ht)};var Po=function(){this._geom=null;var o=arguments[0];this._geom=o};Po.prototype.locate=function(o){return Po.locate(o,this._geom)},Po.prototype.interfaces_=function(){return[qa]},Po.prototype.getClass=function(){return Po},Po.isPointInRing=function(o,c){return!!c.getEnvelopeInternal().intersects(o)&&Qe.isPointInRing(o,c.getCoordinates())},Po.containsPointInPolygon=function(o,c){if(c.isEmpty())return!1;var g=c.getExteriorRing();if(!Po.isPointInRing(o,g))return!1;for(var v=0;v<c.getNumInteriorRing();v++){var A=c.getInteriorRingN(v);if(Po.isPointInRing(o,A))return!1}return!0},Po.containsPoint=function(o,c){if(c instanceof ii)return Po.containsPointInPolygon(o,c);if(c instanceof Ht)for(var g=new Qo(c);g.hasNext();){var v=g.next();if(v!==c&&Po.containsPoint(o,v))return!0}return!1},Po.locate=function(o,c){return c.isEmpty()?ae.EXTERIOR:Po.containsPoint(o,c)?ae.INTERIOR:ae.EXTERIOR};var Si=function(){this._edgeMap=new M,this._edgeList=null,this._ptInAreaLocation=[ae.NONE,ae.NONE]};Si.prototype.getNextCW=function(o){this.getEdges();var c=this._edgeList.indexOf(o),g=c-1;return c===0&&(g=this._edgeList.size()-1),this._edgeList.get(g)},Si.prototype.propagateSideLabels=function(o){for(var c=ae.NONE,g=this.iterator();g.hasNext();){var v=g.next().getLabel();v.isArea(o)&&v.getLocation(o,Pt.LEFT)!==ae.NONE&&(c=v.getLocation(o,Pt.LEFT))}if(c===ae.NONE)return null;for(var A=c,N=this.iterator();N.hasNext();){var G=N.next(),le=G.getLabel();if(le.getLocation(o,Pt.ON)===ae.NONE&&le.setLocation(o,Pt.ON,A),le.isArea(o)){var xe=le.getLocation(o,Pt.LEFT),x=le.getLocation(o,Pt.RIGHT);if(x!==ae.NONE){if(x!==A)throw new Wo("side location conflict",G.getCoordinate());xe===ae.NONE&&ce.shouldNeverReachHere("found single null side (at "+G.getCoordinate()+")"),A=xe}else ce.isTrue(le.getLocation(o,Pt.LEFT)===ae.NONE,"found single null side"),le.setLocation(o,Pt.RIGHT,A),le.setLocation(o,Pt.LEFT,A)}}},Si.prototype.getCoordinate=function(){var o=this.iterator();return o.hasNext()?o.next().getCoordinate():null},Si.prototype.print=function(o){pt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var c=this.iterator();c.hasNext();)c.next().print(o)},Si.prototype.isAreaLabelsConsistent=function(o){return this.computeEdgeEndLabels(o.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Si.prototype.checkAreaLabelsConsistent=function(o){var c=this.getEdges();if(c.size()<=0)return!0;var g=c.size()-1,v=c.get(g).getLabel().getLocation(o,Pt.LEFT);ce.isTrue(v!==ae.NONE,"Found unlabelled area edge");for(var A=v,N=this.iterator();N.hasNext();){var G=N.next().getLabel();ce.isTrue(G.isArea(o),"Found non-area edge");var le=G.getLocation(o,Pt.LEFT),xe=G.getLocation(o,Pt.RIGHT);if(le===xe||xe!==A)return!1;A=le}return!0},Si.prototype.findIndex=function(o){this.iterator();for(var c=0;c<this._edgeList.size();c++)if(this._edgeList.get(c)===o)return c;return-1},Si.prototype.iterator=function(){return this.getEdges().iterator()},Si.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Et(this._edgeMap.values())),this._edgeList},Si.prototype.getLocation=function(o,c,g){return this._ptInAreaLocation[o]===ae.NONE&&(this._ptInAreaLocation[o]=Po.locate(c,g[o].getGeometry())),this._ptInAreaLocation[o]},Si.prototype.toString=function(){var o=new he;o.append("EdgeEndStar:   "+this.getCoordinate()),o.append(`
`);for(var c=this.iterator();c.hasNext();){var g=c.next();o.append(g),o.append(`
`)}return o.toString()},Si.prototype.computeEdgeEndLabels=function(o){for(var c=this.iterator();c.hasNext();)c.next().computeLabel(o)},Si.prototype.computeLabelling=function(o){this.computeEdgeEndLabels(o[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var c=[!1,!1],g=this.iterator();g.hasNext();)for(var v=g.next().getLabel(),A=0;A<2;A++)v.isLine(A)&&v.getLocation(A)===ae.BOUNDARY&&(c[A]=!0);for(var N=this.iterator();N.hasNext();)for(var G=N.next(),le=G.getLabel(),xe=0;xe<2;xe++)if(le.isAnyNull(xe)){var x=ae.NONE;if(c[xe])x=ae.EXTERIOR;else{var a=G.getCoordinate();x=this.getLocation(xe,a,o)}le.setAllLocationsIfNull(xe,x)}},Si.prototype.getDegree=function(){return this._edgeMap.size()},Si.prototype.insertEdgeEnd=function(o,c){this._edgeMap.put(o,c),this._edgeList=null},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si};var Nc=function(o){function c(){o.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var g=null,v=null,A=this._SCANNING_FOR_INCOMING,N=0;N<this._resultAreaEdgeList.size();N++){var G=this._resultAreaEdgeList.get(N),le=G.getSym();if(G.getLabel().isArea())switch(g===null&&G.isInResult()&&(g=G),A){case this._SCANNING_FOR_INCOMING:if(!le.isInResult())continue;v=le,A=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!G.isInResult())continue;v.setNext(G),A=this._SCANNING_FOR_INCOMING}}if(A===this._LINKING_TO_OUTGOING){if(g===null)throw new Wo("no outgoing dirEdge found",this.getCoordinate());ce.isTrue(g.isInResult(),"unable to link last incoming dirEdge"),v.setNext(g)}},c.prototype.insert=function(g){var v=g;this.insertEdgeEnd(v,v)},c.prototype.getRightmostEdge=function(){var g=this.getEdges(),v=g.size();if(v<1)return null;var A=g.get(0);if(v===1)return A;var N=g.get(v-1),G=A.getQuadrant(),le=N.getQuadrant();return Zr.isNorthern(G)&&Zr.isNorthern(le)?A:Zr.isNorthern(G)||Zr.isNorthern(le)?A.getDy()!==0?A:N.getDy()!==0?N:(ce.shouldNeverReachHere("found two horizontal edges incident on node"),null):N},c.prototype.print=function(g){pt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var v=this.iterator();v.hasNext();){var A=v.next();g.print("out "),A.print(g),g.println(),g.print("in "),A.getSym().print(g),g.println()}},c.prototype.getResultAreaEdges=function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Et;for(var g=this.iterator();g.hasNext();){var v=g.next();(v.isInResult()||v.getSym().isInResult())&&this._resultAreaEdgeList.add(v)}return this._resultAreaEdgeList},c.prototype.updateLabelling=function(g){for(var v=this.iterator();v.hasNext();){var A=v.next().getLabel();A.setAllLocationsIfNull(0,g.getLocation(0)),A.setAllLocationsIfNull(1,g.getLocation(1))}},c.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var g=null,v=null,A=this._edgeList.size()-1;A>=0;A--){var N=this._edgeList.get(A),G=N.getSym();v===null&&(v=G),g!==null&&G.setNext(g),g=N}v.setNext(g)},c.prototype.computeDepths=function(){if(arguments.length===1){var g=arguments[0],v=this.findIndex(g),A=g.getDepth(Pt.LEFT),N=g.getDepth(Pt.RIGHT),G=this.computeDepths(v+1,this._edgeList.size(),A);if(this.computeDepths(0,v,G)!==N)throw new Wo("depth mismatch at "+g.getCoordinate())}else if(arguments.length===3){for(var le=arguments[0],xe=arguments[1],x=arguments[2],a=le;a<xe;a++){var d=this._edgeList.get(a);d.setEdgeDepths(Pt.RIGHT,x),x=d.getDepth(Pt.LEFT)}return x}},c.prototype.mergeSymLabels=function(){for(var g=this.iterator();g.hasNext();){var v=g.next();v.getLabel().merge(v.getSym().getLabel())}},c.prototype.linkMinimalDirectedEdges=function(g){for(var v=null,A=null,N=this._SCANNING_FOR_INCOMING,G=this._resultAreaEdgeList.size()-1;G>=0;G--){var le=this._resultAreaEdgeList.get(G),xe=le.getSym();switch(v===null&&le.getEdgeRing()===g&&(v=le),N){case this._SCANNING_FOR_INCOMING:if(xe.getEdgeRing()!==g)continue;A=xe,N=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(le.getEdgeRing()!==g)continue;A.setNextMin(le),N=this._SCANNING_FOR_INCOMING}}N===this._LINKING_TO_OUTGOING&&(ce.isTrue(v!==null,"found null for first outgoing dirEdge"),ce.isTrue(v.getEdgeRing()===g,"unable to link last incoming dirEdge"),A.setNextMin(v))},c.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var g=0,v=this.iterator();v.hasNext();)v.next().isInResult()&&g++;return g}if(arguments.length===1){for(var A=arguments[0],N=0,G=this.iterator();G.hasNext();)G.next().getEdgeRing()===A&&N++;return N}},c.prototype.getLabel=function(){return this._label},c.prototype.findCoveredLineEdges=function(){for(var g=ae.NONE,v=this.iterator();v.hasNext();){var A=v.next(),N=A.getSym();if(!A.isLineEdge()){if(A.isInResult()){g=ae.INTERIOR;break}if(N.isInResult()){g=ae.EXTERIOR;break}}}if(g===ae.NONE)return null;for(var G=g,le=this.iterator();le.hasNext();){var xe=le.next(),x=xe.getSym();xe.isLineEdge()?xe.getEdge().setCovered(G===ae.INTERIOR):(xe.isInResult()&&(G=ae.EXTERIOR),x.isInResult()&&(G=ae.INTERIOR))}},c.prototype.computeLabelling=function(g){o.prototype.computeLabelling.call(this,g),this._label=new Xr(ae.NONE);for(var v=this.iterator();v.hasNext();)for(var A=v.next().getEdge().getLabel(),N=0;N<2;N++){var G=A.getLocation(N);G!==ae.INTERIOR&&G!==ae.BOUNDARY||this._label.setLocation(N,ae.INTERIOR)}},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Si),nl=function(o){function c(){o.apply(this,arguments)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.createNode=function(g){return new Ua(g,new Nc)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Ti),ea=function o(){this._pts=null,this._orientation=null;var c=arguments[0];this._pts=c,this._orientation=o.orientation(c)};ea.prototype.compareTo=function(o){var c=o;return ea.compareOriented(this._pts,this._orientation,c._pts,c._orientation)},ea.prototype.interfaces_=function(){return[ie]},ea.prototype.getClass=function(){return ea},ea.orientation=function(o){return ne.increasingDirection(o)===1},ea.compareOriented=function(o,c,g,v){for(var A=c?1:-1,N=v?1:-1,G=c?o.length:-1,le=v?g.length:-1,xe=c?0:o.length-1,x=v?0:g.length-1;;){var a=o[xe].compareTo(g[x]);if(a!==0)return a;var d=(xe+=A)===G,b=(x+=N)===le;if(d&&!b)return-1;if(!d&&b)return 1;if(d&&b)return 0}};var vo=function(){this._edges=new Et,this._ocaMap=new M};vo.prototype.print=function(o){o.print("MULTILINESTRING ( ");for(var c=0;c<this._edges.size();c++){var g=this._edges.get(c);c>0&&o.print(","),o.print("(");for(var v=g.getCoordinates(),A=0;A<v.length;A++)A>0&&o.print(","),o.print(v[A].x+" "+v[A].y);o.println(")")}o.print(")  ")},vo.prototype.addAll=function(o){for(var c=o.iterator();c.hasNext();)this.add(c.next())},vo.prototype.findEdgeIndex=function(o){for(var c=0;c<this._edges.size();c++)if(this._edges.get(c).equals(o))return c;return-1},vo.prototype.iterator=function(){return this._edges.iterator()},vo.prototype.getEdges=function(){return this._edges},vo.prototype.get=function(o){return this._edges.get(o)},vo.prototype.findEqualEdge=function(o){var c=new ea(o.getCoordinates());return this._ocaMap.get(c)},vo.prototype.add=function(o){this._edges.add(o);var c=new ea(o.getCoordinates());this._ocaMap.put(c,o)},vo.prototype.interfaces_=function(){return[]},vo.prototype.getClass=function(){return vo};var Va=function(){};Va.prototype.processIntersections=function(o,c,g,v){},Va.prototype.isDone=function(){},Va.prototype.interfaces_=function(){return[]},Va.prototype.getClass=function(){return Va};var Qi=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var o=arguments[0];this._li=o};Qi.prototype.isTrivialIntersection=function(o,c,g,v){if(o===g&&this._li.getIntersectionNum()===1){if(Qi.isAdjacentSegments(c,v))return!0;if(o.isClosed()){var A=o.size()-1;if(c===0&&v===A||v===0&&c===A)return!0}}return!1},Qi.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Qi.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Qi.prototype.getLineIntersector=function(){return this._li},Qi.prototype.hasProperIntersection=function(){return this._hasProper},Qi.prototype.processIntersections=function(o,c,g,v){if(o===g&&c===v)return null;this.numTests++;var A=o.getCoordinates()[c],N=o.getCoordinates()[c+1],G=g.getCoordinates()[v],le=g.getCoordinates()[v+1];this._li.computeIntersection(A,N,G,le),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(o,c,g,v)||(this._hasIntersection=!0,o.addIntersections(this._li,c,0),g.addIntersections(this._li,v,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Qi.prototype.hasIntersection=function(){return this._hasIntersection},Qi.prototype.isDone=function(){return!1},Qi.prototype.hasInteriorIntersection=function(){return this._hasInterior},Qi.prototype.interfaces_=function(){return[Va]},Qi.prototype.getClass=function(){return Qi},Qi.isAdjacentSegments=function(o,c){return Math.abs(o-c)===1};var Or=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var o=arguments[0],c=arguments[1],g=arguments[2];this.coord=new J(o),this.segmentIndex=c,this.dist=g};Or.prototype.getSegmentIndex=function(){return this.segmentIndex},Or.prototype.getCoordinate=function(){return this.coord},Or.prototype.print=function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex),o.println(" dist = "+this.dist)},Or.prototype.compareTo=function(o){var c=o;return this.compare(c.segmentIndex,c.dist)},Or.prototype.isEndPoint=function(o){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===o},Or.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Or.prototype.getDistance=function(){return this.dist},Or.prototype.compare=function(o,c){return this.segmentIndex<o?-1:this.segmentIndex>o?1:this.dist<c?-1:this.dist>c?1:0},Or.prototype.interfaces_=function(){return[ie]},Or.prototype.getClass=function(){return Or};var Ao=function(){this._nodeMap=new M,this.edge=null;var o=arguments[0];this.edge=o};Ao.prototype.print=function(o){o.println("Intersections:");for(var c=this.iterator();c.hasNext();)c.next().print(o)},Ao.prototype.iterator=function(){return this._nodeMap.values().iterator()},Ao.prototype.addSplitEdges=function(o){this.addEndpoints();for(var c=this.iterator(),g=c.next();c.hasNext();){var v=c.next(),A=this.createSplitEdge(g,v);o.add(A),g=v}},Ao.prototype.addEndpoints=function(){var o=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[o],o,0)},Ao.prototype.createSplitEdge=function(o,c){var g=c.segmentIndex-o.segmentIndex+2,v=this.edge.pts[c.segmentIndex],A=c.dist>0||!c.coord.equals2D(v);A||g--;var N=new Array(g).fill(null),G=0;N[G++]=new J(o.coord);for(var le=o.segmentIndex+1;le<=c.segmentIndex;le++)N[G++]=this.edge.pts[le];return A&&(N[G]=c.coord),new ta(N,new Xr(this.edge._label))},Ao.prototype.add=function(o,c,g){var v=new Or(o,c,g),A=this._nodeMap.get(v);return A!==null?A:(this._nodeMap.put(v,v),v)},Ao.prototype.isIntersection=function(o){for(var c=this.iterator();c.hasNext();)if(c.next().coord.equals(o))return!0;return!1},Ao.prototype.interfaces_=function(){return[]},Ao.prototype.getClass=function(){return Ao};var Ta=function(){};Ta.prototype.getChainStartIndices=function(o){var c=0,g=new Et;g.add(new fe(c));do{var v=this.findChainEnd(o,c);g.add(new fe(v)),c=v}while(c<o.length-1);return Ta.toIntArray(g)},Ta.prototype.findChainEnd=function(o,c){for(var g=Zr.quadrant(o[c],o[c+1]),v=c+1;v<o.length&&Zr.quadrant(o[v-1],o[v])===g;)v++;return v-1},Ta.prototype.interfaces_=function(){return[]},Ta.prototype.getClass=function(){return Ta},Ta.toIntArray=function(o){for(var c=new Array(o.size()).fill(null),g=0;g<c.length;g++)c[g]=o.get(g).intValue();return c};var da=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new mt,this.env2=new mt;var o=arguments[0];this.e=o,this.pts=o.getCoordinates();var c=new Ta;this.startIndex=c.getChainStartIndices(this.pts)};da.prototype.getCoordinates=function(){return this.pts},da.prototype.getMaxX=function(o){var c=this.pts[this.startIndex[o]].x,g=this.pts[this.startIndex[o+1]].x;return c>g?c:g},da.prototype.getMinX=function(o){var c=this.pts[this.startIndex[o]].x,g=this.pts[this.startIndex[o+1]].x;return c<g?c:g},da.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var o=arguments[0],c=arguments[1],g=arguments[2],v=arguments[3];this.computeIntersectsForChain(this.startIndex[o],this.startIndex[o+1],c,c.startIndex[g],c.startIndex[g+1],v)}else if(arguments.length===6){var A=arguments[0],N=arguments[1],G=arguments[2],le=arguments[3],xe=arguments[4],x=arguments[5],a=this.pts[A],d=this.pts[N],b=G.pts[le],w=G.pts[xe];if(N-A==1&&xe-le==1)return x.addIntersections(this.e,A,G.e,le),null;if(this.env1.init(a,d),this.env2.init(b,w),!this.env1.intersects(this.env2))return null;var I=Math.trunc((A+N)/2),L=Math.trunc((le+xe)/2);A<I&&(le<L&&this.computeIntersectsForChain(A,I,G,le,L,x),L<xe&&this.computeIntersectsForChain(A,I,G,L,xe,x)),I<N&&(le<L&&this.computeIntersectsForChain(I,N,G,le,L,x),L<xe&&this.computeIntersectsForChain(I,N,G,L,xe,x))}},da.prototype.getStartIndexes=function(){return this.startIndex},da.prototype.computeIntersects=function(o,c){for(var g=0;g<this.startIndex.length-1;g++)for(var v=0;v<o.startIndex.length-1;v++)this.computeIntersectsForChain(g,o,v,c)},da.prototype.interfaces_=function(){return[]},da.prototype.getClass=function(){return da};var Hr=function o(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var c=0;c<2;c++)for(var g=0;g<3;g++)this._depth[c][g]=o.NULL_VALUE},Eu={NULL_VALUE:{configurable:!0}};Hr.prototype.getDepth=function(o,c){return this._depth[o][c]},Hr.prototype.setDepth=function(o,c,g){this._depth[o][c]=g},Hr.prototype.isNull=function(){if(arguments.length===0){for(var o=0;o<2;o++)for(var c=0;c<3;c++)if(this._depth[o][c]!==Hr.NULL_VALUE)return!1;return!0}if(arguments.length===1){var g=arguments[0];return this._depth[g][1]===Hr.NULL_VALUE}if(arguments.length===2){var v=arguments[0],A=arguments[1];return this._depth[v][A]===Hr.NULL_VALUE}},Hr.prototype.normalize=function(){for(var o=0;o<2;o++)if(!this.isNull(o)){var c=this._depth[o][1];this._depth[o][2]<c&&(c=this._depth[o][2]),c<0&&(c=0);for(var g=1;g<3;g++){var v=0;this._depth[o][g]>c&&(v=1),this._depth[o][g]=v}}},Hr.prototype.getDelta=function(o){return this._depth[o][Pt.RIGHT]-this._depth[o][Pt.LEFT]},Hr.prototype.getLocation=function(o,c){return this._depth[o][c]<=0?ae.EXTERIOR:ae.INTERIOR},Hr.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Hr.prototype.add=function(){if(arguments.length===1)for(var o=arguments[0],c=0;c<2;c++)for(var g=1;g<3;g++){var v=o.getLocation(c,g);v!==ae.EXTERIOR&&v!==ae.INTERIOR||(this.isNull(c,g)?this._depth[c][g]=Hr.depthAtLocation(v):this._depth[c][g]+=Hr.depthAtLocation(v))}else if(arguments.length===3){var A=arguments[0],N=arguments[1];arguments[2]===ae.INTERIOR&&this._depth[A][N]++}},Hr.prototype.interfaces_=function(){return[]},Hr.prototype.getClass=function(){return Hr},Hr.depthAtLocation=function(o){return o===ae.EXTERIOR?0:o===ae.INTERIOR?1:Hr.NULL_VALUE},Eu.NULL_VALUE.get=function(){return-1},Object.defineProperties(Hr,Eu);var ta=function(o){function c(){if(o.call(this),this.pts=null,this._env=null,this.eiList=new Ao(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Hr,this._depthDelta=0,arguments.length===1){var g=arguments[0];c.call(this,g,null)}else if(arguments.length===2){var v=arguments[0],A=arguments[1];this.pts=v,this._label=A}}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.getDepth=function(){return this._depth},c.prototype.getCollapsedEdge=function(){var g=new Array(2).fill(null);return g[0]=this.pts[0],g[1]=this.pts[1],new c(g,Xr.toLineLabel(this._label))},c.prototype.isIsolated=function(){return this._isIsolated},c.prototype.getCoordinates=function(){return this.pts},c.prototype.setIsolated=function(g){this._isIsolated=g},c.prototype.setName=function(g){this._name=g},c.prototype.equals=function(g){if(!(g instanceof c))return!1;var v=g;if(this.pts.length!==v.pts.length)return!1;for(var A=!0,N=!0,G=this.pts.length,le=0;le<this.pts.length;le++)if(this.pts[le].equals2D(v.pts[le])||(A=!1),this.pts[le].equals2D(v.pts[--G])||(N=!1),!A&&!N)return!1;return!0},c.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var g=arguments[0];return this.pts[g]}},c.prototype.print=function(g){g.print("edge "+this._name+": "),g.print("LINESTRING (");for(var v=0;v<this.pts.length;v++)v>0&&g.print(","),g.print(this.pts[v].x+" "+this.pts[v].y);g.print(")  "+this._label+" "+this._depthDelta)},c.prototype.computeIM=function(g){c.updateIM(this._label,g)},c.prototype.isCollapsed=function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])},c.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},c.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},c.prototype.getDepthDelta=function(){return this._depthDelta},c.prototype.getNumPoints=function(){return this.pts.length},c.prototype.printReverse=function(g){g.print("edge "+this._name+": ");for(var v=this.pts.length-1;v>=0;v--)g.print(this.pts[v]+" ");g.println("")},c.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new da(this)),this._mce},c.prototype.getEnvelope=function(){if(this._env===null){this._env=new mt;for(var g=0;g<this.pts.length;g++)this._env.expandToInclude(this.pts[g])}return this._env},c.prototype.addIntersection=function(g,v,A,N){var G=new J(g.getIntersection(N)),le=v,xe=g.getEdgeDistance(A,N),x=le+1;if(x<this.pts.length){var a=this.pts[x];G.equals2D(a)&&(le=x,xe=0)}this.eiList.add(G,le,xe)},c.prototype.toString=function(){var g=new he;g.append("edge "+this._name+": "),g.append("LINESTRING (");for(var v=0;v<this.pts.length;v++)v>0&&g.append(","),g.append(this.pts[v].x+" "+this.pts[v].y);return g.append(")  "+this._label+" "+this._depthDelta),g.toString()},c.prototype.isPointwiseEqual=function(g){if(this.pts.length!==g.pts.length)return!1;for(var v=0;v<this.pts.length;v++)if(!this.pts[v].equals2D(g.pts[v]))return!1;return!0},c.prototype.setDepthDelta=function(g){this._depthDelta=g},c.prototype.getEdgeIntersectionList=function(){return this.eiList},c.prototype.addIntersections=function(g,v,A){for(var N=0;N<g.getIntersectionNum();N++)this.addIntersection(g,v,A,N)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c.updateIM=function(){if(arguments.length!==2)return o.prototype.updateIM.apply(this,arguments);var g=arguments[0],v=arguments[1];v.setAtLeastIfValid(g.getLocation(0,Pt.ON),g.getLocation(1,Pt.ON),1),g.isArea()&&(v.setAtLeastIfValid(g.getLocation(0,Pt.LEFT),g.getLocation(1,Pt.LEFT),2),v.setAtLeastIfValid(g.getLocation(0,Pt.RIGHT),g.getLocation(1,Pt.RIGHT),2))},c}(Ci),eo=function(o){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new vo,this._bufParams=o||null};eo.prototype.setWorkingPrecisionModel=function(o){this._workingPrecisionModel=o},eo.prototype.insertUniqueEdge=function(o){var c=this._edgeList.findEqualEdge(o);if(c!==null){var g=c.getLabel(),v=o.getLabel();c.isPointwiseEqual(o)||(v=new Xr(o.getLabel())).flip(),g.merge(v);var A=eo.depthDelta(v),N=c.getDepthDelta()+A;c.setDepthDelta(N)}else this._edgeList.add(o),o.setDepthDelta(eo.depthDelta(o.getLabel()))},eo.prototype.buildSubgraphs=function(o,c){for(var g=new Et,v=o.iterator();v.hasNext();){var A=v.next(),N=A.getRightmostCoordinate(),G=new Br(g).getDepth(N);A.computeDepth(G),A.findResultEdges(),g.add(A),c.add(A.getDirectedEdges(),A.getNodes())}},eo.prototype.createSubgraphs=function(o){for(var c=new Et,g=o.getNodes().iterator();g.hasNext();){var v=g.next();if(!v.isVisited()){var A=new fi;A.create(v),c.add(A)}}return Ki.sort(c,Ki.reverseOrder()),c},eo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},eo.prototype.getNoder=function(o){if(this._workingNoder!==null)return this._workingNoder;var c=new tl,g=new Xe;return g.setPrecisionModel(o),c.setSegmentIntersector(new Qi(g)),c},eo.prototype.buffer=function(o,c){var g=this._workingPrecisionModel;g===null&&(g=o.getPrecisionModel()),this._geomFact=o.getFactory();var v=new Li(g,this._bufParams),A=new Ri(o,c,v).getCurves();if(A.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(A,g),this._graph=new Yr(new nl),this._graph.addEdges(this._edgeList.getEdges());var N=this.createSubgraphs(this._graph),G=new Mi(this._geomFact);this.buildSubgraphs(N,G);var le=G.getPolygons();return le.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(le)},eo.prototype.computeNodedEdges=function(o,c){var g=this.getNoder(c);g.computeNodes(o);for(var v=g.getNodedSubstrings().iterator();v.hasNext();){var A=v.next(),N=A.getCoordinates();if(N.length!==2||!N[0].equals2D(N[1])){var G=A.getData(),le=new ta(A.getCoordinates(),new Xr(G));this.insertUniqueEdge(le)}}},eo.prototype.setNoder=function(o){this._workingNoder=o},eo.prototype.interfaces_=function(){return[]},eo.prototype.getClass=function(){return eo},eo.depthDelta=function(o){var c=o.getLocation(0,Pt.LEFT),g=o.getLocation(0,Pt.RIGHT);return c===ae.INTERIOR&&g===ae.EXTERIOR?1:c===ae.EXTERIOR&&g===ae.INTERIOR?-1:0},eo.convertSegStrings=function(o){for(var c=new Rr,g=new Et;o.hasNext();){var v=o.next(),A=c.createLineString(v.getCoordinates());g.add(A)}return c.buildGeometry(g)};var Xa=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var o=arguments[0],c=arguments[1];this._noder=o,this._scaleFactor=c,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var g=arguments[0],v=arguments[1],A=arguments[2],N=arguments[3];this._noder=g,this._scaleFactor=v,this._offsetX=A,this._offsetY=N,this._isScaled=!this.isIntegerPrecision()}};Xa.prototype.rescale=function(){if(Pe(arguments[0],qr))for(var o=arguments[0].iterator();o.hasNext();){var c=o.next();this.rescale(c.getCoordinates())}else if(arguments[0]instanceof Array){for(var g=arguments[0],v=0;v<g.length;v++)g[v].x=g[v].x/this._scaleFactor+this._offsetX,g[v].y=g[v].y/this._scaleFactor+this._offsetY;g.length===2&&g[0].equals2D(g[1])&&pt.out.println(g)}},Xa.prototype.scale=function(){if(Pe(arguments[0],qr)){for(var o=arguments[0],c=new Et,g=o.iterator();g.hasNext();){var v=g.next();c.add(new zn(this.scale(v.getCoordinates()),v.getData()))}return c}if(arguments[0]instanceof Array){for(var A=arguments[0],N=new Array(A.length).fill(null),G=0;G<A.length;G++)N[G]=new J(Math.round((A[G].x-this._offsetX)*this._scaleFactor),Math.round((A[G].y-this._offsetY)*this._scaleFactor),A[G].z);return ne.removeRepeatedPoints(N)}},Xa.prototype.isIntegerPrecision=function(){return this._scaleFactor===1},Xa.prototype.getNodedSubstrings=function(){var o=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(o),o},Xa.prototype.computeNodes=function(o){var c=o;this._isScaled&&(c=this.scale(o)),this._noder.computeNodes(c)},Xa.prototype.interfaces_=function(){return[Jo]},Xa.prototype.getClass=function(){return Xa};var ga=function(){this._li=new Xe,this._segStrings=null;var o=arguments[0];this._segStrings=o},Bs={fact:{configurable:!0}};ga.prototype.checkEndPtVertexIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var c=o.next().getCoordinates();this.checkEndPtVertexIntersections(c[0],this._segStrings),this.checkEndPtVertexIntersections(c[c.length-1],this._segStrings)}else if(arguments.length===2){for(var g=arguments[0],v=arguments[1].iterator();v.hasNext();)for(var A=v.next().getCoordinates(),N=1;N<A.length-1;N++)if(A[N].equals(g))throw new rt("found endpt/interior pt intersection at index "+N+" :pt "+g)}},ga.prototype.checkInteriorIntersections=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();)for(var c=o.next(),g=this._segStrings.iterator();g.hasNext();){var v=g.next();this.checkInteriorIntersections(c,v)}else if(arguments.length===2)for(var A=arguments[0],N=arguments[1],G=A.getCoordinates(),le=N.getCoordinates(),xe=0;xe<G.length-1;xe++)for(var x=0;x<le.length-1;x++)this.checkInteriorIntersections(A,xe,N,x);else if(arguments.length===4){var a=arguments[0],d=arguments[1],b=arguments[2],w=arguments[3];if(a===b&&d===w)return null;var I=a.getCoordinates()[d],L=a.getCoordinates()[d+1],F=b.getCoordinates()[w],j=b.getCoordinates()[w+1];if(this._li.computeIntersection(I,L,F,j),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,I,L)||this.hasInteriorIntersection(this._li,F,j)))throw new rt("found non-noded intersection at "+I+"-"+L+" and "+F+"-"+j)}},ga.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},ga.prototype.checkCollapses=function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var c=o.next();this.checkCollapses(c)}else if(arguments.length===1)for(var g=arguments[0].getCoordinates(),v=0;v<g.length-2;v++)this.checkCollapse(g[v],g[v+1],g[v+2])},ga.prototype.hasInteriorIntersection=function(o,c,g){for(var v=0;v<o.getIntersectionNum();v++){var A=o.getIntersection(v);if(!A.equals(c)&&!A.equals(g))return!0}return!1},ga.prototype.checkCollapse=function(o,c,g){if(o.equals(g))throw new rt("found non-noded collapse at "+ga.fact.createLineString([o,c,g]))},ga.prototype.interfaces_=function(){return[]},ga.prototype.getClass=function(){return ga},Bs.fact.get=function(){return new Rr},Object.defineProperties(ga,Bs);var qi=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var o=arguments[0],c=arguments[1],g=arguments[2];if(this._originalPt=o,this._pt=o,this._scaleFactor=c,this._li=g,c<=0)throw new U("Scale factor must be non-zero");c!==1&&(this._pt=new J(this.scale(o.x),this.scale(o.y)),this._p0Scaled=new J,this._p1Scaled=new J),this.initCorners(this._pt)},Tl={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};qi.prototype.intersectsScaled=function(o,c){var g=Math.min(o.x,c.x),v=Math.max(o.x,c.x),A=Math.min(o.y,c.y),N=Math.max(o.y,c.y),G=this._maxx<g||this._minx>v||this._maxy<A||this._miny>N;if(G)return!1;var le=this.intersectsToleranceSquare(o,c);return ce.isTrue(!(G&&le),"Found bad envelope test"),le},qi.prototype.initCorners=function(o){this._minx=o.x-.5,this._maxx=o.x+.5,this._miny=o.y-.5,this._maxy=o.y+.5,this._corner[0]=new J(this._maxx,this._maxy),this._corner[1]=new J(this._minx,this._maxy),this._corner[2]=new J(this._minx,this._miny),this._corner[3]=new J(this._maxx,this._miny)},qi.prototype.intersects=function(o,c){return this._scaleFactor===1?this.intersectsScaled(o,c):(this.copyScaled(o,this._p0Scaled),this.copyScaled(c,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},qi.prototype.scale=function(o){return Math.round(o*this._scaleFactor)},qi.prototype.getCoordinate=function(){return this._originalPt},qi.prototype.copyScaled=function(o,c){c.x=this.scale(o.x),c.y=this.scale(o.y)},qi.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var o=qi.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new mt(this._originalPt.x-o,this._originalPt.x+o,this._originalPt.y-o,this._originalPt.y+o)}return this._safeEnv},qi.prototype.intersectsPixelClosure=function(o,c){return this._li.computeIntersection(o,c,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,c,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,c,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,c,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},qi.prototype.intersectsToleranceSquare=function(o,c){var g=!1,v=!1;return this._li.computeIntersection(o,c,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(o,c,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(g=!0),this._li.computeIntersection(o,c,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(v=!0),this._li.computeIntersection(o,c,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!g||!v)||!!o.equals(this._pt)||!!c.equals(this._pt))))},qi.prototype.addSnappedNode=function(o,c){var g=o.getCoordinate(c),v=o.getCoordinate(c+1);return!!this.intersects(g,v)&&(o.addIntersection(this.getCoordinate(),c),!0)},qi.prototype.interfaces_=function(){return[]},qi.prototype.getClass=function(){return qi},Tl.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(qi,Tl);var il=function(){this.tempEnv1=new mt,this.selectedSegment=new or};il.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var o=arguments[0],c=arguments[1];o.getLineSegment(c,this.selectedSegment),this.select(this.selectedSegment)}}},il.prototype.interfaces_=function(){return[]},il.prototype.getClass=function(){return il};var tu=function(){this._index=null;var o=arguments[0];this._index=o},ol={HotPixelSnapAction:{configurable:!0}};tu.prototype.snap=function(){if(arguments.length===1){var o=arguments[0];return this.snap(o,null,-1)}if(arguments.length===3){var c=arguments[0],g=arguments[1],v=arguments[2],A=c.getSafeEnvelope(),N=new Ml(c,g,v);return this._index.query(A,{interfaces_:function(){return[Gr]},visitItem:function(G){G.select(A,N)}}),N.isNodeAdded()}},tu.prototype.interfaces_=function(){return[]},tu.prototype.getClass=function(){return tu},ol.HotPixelSnapAction.get=function(){return Ml},Object.defineProperties(tu,ol);var Ml=function(o){function c(){o.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var g=arguments[0],v=arguments[1],A=arguments[2];this._hotPixel=g,this._parentEdge=v,this._hotPixelVertexIndex=A}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.isNodeAdded=function(){return this._isNodeAdded},c.prototype.select=function(){if(arguments.length!==2)return o.prototype.select.apply(this,arguments);var g=arguments[0],v=arguments[1],A=g.getContext();if(this._parentEdge!==null&&A===this._parentEdge&&v===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(A,v)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(il),zs=function(){this._li=null,this._interiorIntersections=null;var o=arguments[0];this._li=o,this._interiorIntersections=new Et};zs.prototype.processIntersections=function(o,c,g,v){if(o===g&&c===v)return null;var A=o.getCoordinates()[c],N=o.getCoordinates()[c+1],G=g.getCoordinates()[v],le=g.getCoordinates()[v+1];if(this._li.computeIntersection(A,N,G,le),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var xe=0;xe<this._li.getIntersectionNum();xe++)this._interiorIntersections.add(this._li.getIntersection(xe));o.addIntersections(this._li,c,0),g.addIntersections(this._li,v,1)}},zs.prototype.isDone=function(){return!1},zs.prototype.getInteriorIntersections=function(){return this._interiorIntersections},zs.prototype.interfaces_=function(){return[Va]},zs.prototype.getClass=function(){return zs};var yo=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var o=arguments[0];this._pm=o,this._li=new Xe,this._li.setPrecisionModel(o),this._scaleFactor=o.getScale()};yo.prototype.checkCorrectness=function(o){var c=zn.getNodedSubstrings(o),g=new ga(c);try{g.checkValid()}catch(v){if(!(v instanceof yt))throw v;v.printStackTrace()}},yo.prototype.getNodedSubstrings=function(){return zn.getNodedSubstrings(this._nodedSegStrings)},yo.prototype.snapRound=function(o,c){var g=this.findInteriorIntersections(o,c);this.computeIntersectionSnaps(g),this.computeVertexSnaps(o)},yo.prototype.findInteriorIntersections=function(o,c){var g=new zs(c);return this._noder.setSegmentIntersector(g),this._noder.computeNodes(o),g.getInteriorIntersections()},yo.prototype.computeVertexSnaps=function(){if(Pe(arguments[0],qr))for(var o=arguments[0].iterator();o.hasNext();){var c=o.next();this.computeVertexSnaps(c)}else if(arguments[0]instanceof zn)for(var g=arguments[0],v=g.getCoordinates(),A=0;A<v.length;A++){var N=new qi(v[A],this._scaleFactor,this._li);this._pointSnapper.snap(N,g,A)&&g.addIntersection(v[A],A)}},yo.prototype.computeNodes=function(o){this._nodedSegStrings=o,this._noder=new tl,this._pointSnapper=new tu(this._noder.getIndex()),this.snapRound(o,this._li)},yo.prototype.computeIntersectionSnaps=function(o){for(var c=o.iterator();c.hasNext();){var g=c.next(),v=new qi(g,this._scaleFactor,this._li);this._pointSnapper.snap(v)}},yo.prototype.interfaces_=function(){return[Jo]},yo.prototype.getClass=function(){return yo};var Vi=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new tr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var o=arguments[0];this._argGeom=o}else if(arguments.length===2){var c=arguments[0],g=arguments[1];this._argGeom=c,this._bufParams=g}},js={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Vi.prototype.bufferFixedPrecision=function(o){var c=new Xa(new yo(new er(1)),o.getScale()),g=new eo(this._bufParams);g.setWorkingPrecisionModel(o),g.setNoder(c),this._resultGeometry=g.buffer(this._argGeom,this._distance)},Vi.prototype.bufferReducedPrecision=function(){var o=this;if(arguments.length===0){for(var c=Vi.MAX_PRECISION_DIGITS;c>=0;c--){try{o.bufferReducedPrecision(c)}catch(N){if(!(N instanceof Wo))throw N;o._saveException=N}if(o._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var g=arguments[0],v=Vi.precisionScaleFactor(this._argGeom,this._distance,g),A=new er(v);this.bufferFixedPrecision(A)}},Vi.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var o=this._argGeom.getFactory().getPrecisionModel();o.getType()===er.FIXED?this.bufferFixedPrecision(o):this.bufferReducedPrecision()},Vi.prototype.setQuadrantSegments=function(o){this._bufParams.setQuadrantSegments(o)},Vi.prototype.bufferOriginalPrecision=function(){try{var o=new eo(this._bufParams);this._resultGeometry=o.buffer(this._argGeom,this._distance)}catch(c){if(!(c instanceof rt))throw c;this._saveException=c}},Vi.prototype.getResultGeometry=function(o){return this._distance=o,this.computeGeometry(),this._resultGeometry},Vi.prototype.setEndCapStyle=function(o){this._bufParams.setEndCapStyle(o)},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi},Vi.bufferOp=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1];return new Vi(o).getResultGeometry(c)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof it&&typeof arguments[1]=="number"){var g=arguments[0],v=arguments[1],A=arguments[2],N=new Vi(g);return N.setQuadrantSegments(A),N.getResultGeometry(v)}if(arguments[2]instanceof tr&&arguments[0]instanceof it&&typeof arguments[1]=="number"){var G=arguments[0],le=arguments[1],xe=arguments[2];return new Vi(G,xe).getResultGeometry(le)}}else if(arguments.length===4){var x=arguments[0],a=arguments[1],d=arguments[2],b=arguments[3],w=new Vi(x);return w.setQuadrantSegments(d),w.setEndCapStyle(b),w.getResultGeometry(a)}},Vi.precisionScaleFactor=function(o,c,g){var v=o.getEnvelopeInternal(),A=V.max(Math.abs(v.getMaxX()),Math.abs(v.getMaxY()),Math.abs(v.getMinX()),Math.abs(v.getMinY()))+2*(c>0?c:0),N=g-Math.trunc(Math.log(A)/Math.log(10)+1);return Math.pow(10,N)},js.CAP_ROUND.get=function(){return tr.CAP_ROUND},js.CAP_BUTT.get=function(){return tr.CAP_FLAT},js.CAP_FLAT.get=function(){return tr.CAP_FLAT},js.CAP_SQUARE.get=function(){return tr.CAP_SQUARE},js.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Vi,js);var ao=function(){this._pt=[new J,new J],this._distance=H.NaN,this._isNull=!0};ao.prototype.getCoordinates=function(){return this._pt},ao.prototype.getCoordinate=function(o){return this._pt[o]},ao.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var c=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(c,g),null;var v=c.distance(g);v<this._distance&&this.initialize(c,g,v)}},ao.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],c=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(c),this._distance=o.distance(c),this._isNull=!1}else if(arguments.length===3){var g=arguments[0],v=arguments[1],A=arguments[2];this._pt[0].setCoordinate(g),this._pt[1].setCoordinate(v),this._distance=A,this._isNull=!1}},ao.prototype.getDistance=function(){return this._distance},ao.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var c=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(c,g),null;var v=c.distance(g);v>this._distance&&this.initialize(c,g,v)}},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao};var Ya=function(){};Ya.prototype.interfaces_=function(){return[]},Ya.prototype.getClass=function(){return Ya},Ya.computeDistance=function(){if(arguments[2]instanceof ao&&arguments[0]instanceof Fr&&arguments[1]instanceof J)for(var o=arguments[0],c=arguments[1],g=arguments[2],v=o.getCoordinates(),A=new or,N=0;N<v.length-1;N++){A.setCoordinates(v[N],v[N+1]);var G=A.closestPoint(c);g.setMinimum(G,c)}else if(arguments[2]instanceof ao&&arguments[0]instanceof ii&&arguments[1]instanceof J){var le=arguments[0],xe=arguments[1],x=arguments[2];Ya.computeDistance(le.getExteriorRing(),xe,x);for(var a=0;a<le.getNumInteriorRing();a++)Ya.computeDistance(le.getInteriorRingN(a),xe,x)}else if(arguments[2]instanceof ao&&arguments[0]instanceof it&&arguments[1]instanceof J){var d=arguments[0],b=arguments[1],w=arguments[2];if(d instanceof Fr)Ya.computeDistance(d,b,w);else if(d instanceof ii)Ya.computeDistance(d,b,w);else if(d instanceof Ht)for(var I=d,L=0;L<I.getNumGeometries();L++){var F=I.getGeometryN(L);Ya.computeDistance(F,b,w)}else w.setMinimum(d.getCoordinate(),b)}else if(arguments[2]instanceof ao&&arguments[0]instanceof or&&arguments[1]instanceof J){var j=arguments[0],Y=arguments[1],K=arguments[2],re=j.closestPoint(Y);K.setMinimum(re,Y)}};var ru=function(o){this._maxPtDist=new ao,this._inputGeom=o||null},ic={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};ru.prototype.computeMaxMidpointDistance=function(o){var c=new Ma(this._inputGeom);o.apply(c),this._maxPtDist.setMaximum(c.getMaxPointDistance())},ru.prototype.computeMaxVertexDistance=function(o){var c=new gs(this._inputGeom);o.apply(c),this._maxPtDist.setMaximum(c.getMaxPointDistance())},ru.prototype.findDistance=function(o){return this.computeMaxVertexDistance(o),this.computeMaxMidpointDistance(o),this._maxPtDist.getDistance()},ru.prototype.getDistancePoints=function(){return this._maxPtDist},ru.prototype.interfaces_=function(){return[]},ru.prototype.getClass=function(){return ru},ic.MaxPointDistanceFilter.get=function(){return gs},ic.MaxMidpointDistanceFilter.get=function(){return Ma},Object.defineProperties(ru,ic);var gs=function(o){this._maxPtDist=new ao,this._minPtDist=new ao,this._geom=o||null};gs.prototype.filter=function(o){this._minPtDist.initialize(),Ya.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},gs.prototype.getMaxPointDistance=function(){return this._maxPtDist},gs.prototype.interfaces_=function(){return[Ar]},gs.prototype.getClass=function(){return gs};var Ma=function(o){this._maxPtDist=new ao,this._minPtDist=new ao,this._geom=o||null};Ma.prototype.filter=function(o,c){if(c===0)return null;var g=o.getCoordinate(c-1),v=o.getCoordinate(c),A=new J((g.x+v.x)/2,(g.y+v.y)/2);this._minPtDist.initialize(),Ya.computeDistance(this._geom,A,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ma.prototype.isDone=function(){return!1},Ma.prototype.isGeometryChanged=function(){return!1},Ma.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ma.prototype.interfaces_=function(){return[Xt]},Ma.prototype.getClass=function(){return Ma};var Di=function(o){this._comps=o||null};Di.prototype.filter=function(o){o instanceof ii&&this._comps.add(o)},Di.prototype.interfaces_=function(){return[jt]},Di.prototype.getClass=function(){return Di},Di.getPolygons=function(){if(arguments.length===1){var o=arguments[0];return Di.getPolygons(o,new Et)}if(arguments.length===2){var c=arguments[0],g=arguments[1];return c instanceof ii?g.add(c):c instanceof Ht&&c.apply(new Di(g)),g}};var Kr=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var o=arguments[0];this._lines=o}else if(arguments.length===2){var c=arguments[0],g=arguments[1];this._lines=c,this._isForcedToLineString=g}};Kr.prototype.filter=function(o){if(this._isForcedToLineString&&o instanceof hi){var c=o.getFactory().createLineString(o.getCoordinateSequence());return this._lines.add(c),null}o instanceof Fr&&this._lines.add(o)},Kr.prototype.setForceToLineString=function(o){this._isForcedToLineString=o},Kr.prototype.interfaces_=function(){return[ir]},Kr.prototype.getClass=function(){return Kr},Kr.getGeometry=function(){if(arguments.length===1){var o=arguments[0];return o.getFactory().buildGeometry(Kr.getLines(o))}if(arguments.length===2){var c=arguments[0],g=arguments[1];return c.getFactory().buildGeometry(Kr.getLines(c,g))}},Kr.getLines=function(){if(arguments.length===1){var o=arguments[0];return Kr.getLines(o,!1)}if(arguments.length===2){if(Pe(arguments[0],qr)&&Pe(arguments[1],qr)){for(var c=arguments[0],g=arguments[1],v=c.iterator();v.hasNext();){var A=v.next();Kr.getLines(A,g)}return g}if(arguments[0]instanceof it&&typeof arguments[1]=="boolean"){var N=arguments[0],G=arguments[1],le=new Et;return N.apply(new Kr(le,G)),le}if(arguments[0]instanceof it&&Pe(arguments[1],qr)){var xe=arguments[0],x=arguments[1];return xe instanceof Fr?x.add(xe):xe.apply(new Kr(x)),x}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Pe(arguments[0],qr)&&Pe(arguments[1],qr)){for(var a=arguments[0],d=arguments[1],b=arguments[2],w=a.iterator();w.hasNext();){var I=w.next();Kr.getLines(I,d,b)}return d}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof it&&Pe(arguments[1],qr)){var L=arguments[0],F=arguments[1],j=arguments[2];return L.apply(new Kr(F,j)),F}}};var Io=function(){if(this._boundaryRule=Ir.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];if(o===null)throw new U("Rule must be non-null");this._boundaryRule=o}}};Io.prototype.locateInternal=function(){if(arguments[0]instanceof J&&arguments[1]instanceof ii){var o=arguments[0],c=arguments[1];if(c.isEmpty())return ae.EXTERIOR;var g=c.getExteriorRing(),v=this.locateInPolygonRing(o,g);if(v===ae.EXTERIOR)return ae.EXTERIOR;if(v===ae.BOUNDARY)return ae.BOUNDARY;for(var A=0;A<c.getNumInteriorRing();A++){var N=c.getInteriorRingN(A),G=this.locateInPolygonRing(o,N);if(G===ae.INTERIOR)return ae.EXTERIOR;if(G===ae.BOUNDARY)return ae.BOUNDARY}return ae.INTERIOR}if(arguments[0]instanceof J&&arguments[1]instanceof Fr){var le=arguments[0],xe=arguments[1];if(!xe.getEnvelopeInternal().intersects(le))return ae.EXTERIOR;var x=xe.getCoordinates();return xe.isClosed()||!le.equals(x[0])&&!le.equals(x[x.length-1])?Qe.isOnLine(le,x)?ae.INTERIOR:ae.EXTERIOR:ae.BOUNDARY}if(arguments[0]instanceof J&&arguments[1]instanceof Vr){var a=arguments[0];return arguments[1].getCoordinate().equals2D(a)?ae.INTERIOR:ae.EXTERIOR}},Io.prototype.locateInPolygonRing=function(o,c){return c.getEnvelopeInternal().intersects(o)?Qe.locatePointInRing(o,c.getCoordinates()):ae.EXTERIOR},Io.prototype.intersects=function(o,c){return this.locate(o,c)!==ae.EXTERIOR},Io.prototype.updateLocationInfo=function(o){o===ae.INTERIOR&&(this._isIn=!0),o===ae.BOUNDARY&&this._numBoundaries++},Io.prototype.computeLocation=function(o,c){if(c instanceof Vr&&this.updateLocationInfo(this.locateInternal(o,c)),c instanceof Fr)this.updateLocationInfo(this.locateInternal(o,c));else if(c instanceof ii)this.updateLocationInfo(this.locateInternal(o,c));else if(c instanceof Ur)for(var g=c,v=0;v<g.getNumGeometries();v++){var A=g.getGeometryN(v);this.updateLocationInfo(this.locateInternal(o,A))}else if(c instanceof Bo)for(var N=c,G=0;G<N.getNumGeometries();G++){var le=N.getGeometryN(G);this.updateLocationInfo(this.locateInternal(o,le))}else if(c instanceof Ht)for(var xe=new Qo(c);xe.hasNext();){var x=xe.next();x!==c&&this.computeLocation(o,x)}},Io.prototype.locate=function(o,c){return c.isEmpty()?ae.EXTERIOR:c instanceof Fr?this.locateInternal(o,c):c instanceof ii?this.locateInternal(o,c):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(o,c),this._boundaryRule.isInBoundary(this._numBoundaries)?ae.BOUNDARY:this._numBoundaries>0||this._isIn?ae.INTERIOR:ae.EXTERIOR)},Io.prototype.interfaces_=function(){return[]},Io.prototype.getClass=function(){return Io};var gi=function o(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var c=arguments[0],g=arguments[1];o.call(this,c,o.INSIDE_AREA,g)}else if(arguments.length===3){var v=arguments[0],A=arguments[1],N=arguments[2];this._component=v,this._segIndex=A,this._pt=N}},al={INSIDE_AREA:{configurable:!0}};gi.prototype.isInsideArea=function(){return this._segIndex===gi.INSIDE_AREA},gi.prototype.getCoordinate=function(){return this._pt},gi.prototype.getGeometryComponent=function(){return this._component},gi.prototype.getSegmentIndex=function(){return this._segIndex},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi},al.INSIDE_AREA.get=function(){return-1},Object.defineProperties(gi,al);var nu=function(o){this._pts=o||null};nu.prototype.filter=function(o){o instanceof Vr&&this._pts.add(o)},nu.prototype.interfaces_=function(){return[jt]},nu.prototype.getClass=function(){return nu},nu.getPoints=function(){if(arguments.length===1){var o=arguments[0];return o instanceof Vr?Ki.singletonList(o):nu.getPoints(o,new Et)}if(arguments.length===2){var c=arguments[0],g=arguments[1];return c instanceof Vr?g.add(c):c instanceof Ht&&c.apply(new nu(g)),g}};var ms=function(){this._locations=null;var o=arguments[0];this._locations=o};ms.prototype.filter=function(o){(o instanceof Vr||o instanceof Fr||o instanceof ii)&&this._locations.add(new gi(o,0,o.getCoordinate()))},ms.prototype.interfaces_=function(){return[jt]},ms.prototype.getClass=function(){return ms},ms.getLocations=function(o){var c=new Et;return o.apply(new ms(c)),c};var to=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Io,this._minDistanceLocation=null,this._minDistance=H.MAX_VALUE,arguments.length===2){var o=arguments[0],c=arguments[1];this._geom=[o,c],this._terminateDistance=0}else if(arguments.length===3){var g=arguments[0],v=arguments[1],A=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=g,this._geom[1]=v,this._terminateDistance=A}};to.prototype.computeContainmentDistance=function(){if(arguments.length===0){var o=new Array(2).fill(null);if(this.computeContainmentDistance(0,o),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,o)}else if(arguments.length===2){var c=arguments[0],g=arguments[1],v=1-c,A=Di.getPolygons(this._geom[c]);if(A.size()>0){var N=ms.getLocations(this._geom[v]);if(this.computeContainmentDistance(N,A,g),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[v]=g[0],this._minDistanceLocation[c]=g[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Pe(arguments[0],Lr)&&Pe(arguments[1],Lr)){for(var G=arguments[0],le=arguments[1],xe=arguments[2],x=0;x<G.size();x++)for(var a=G.get(x),d=0;d<le.size();d++)if(this.computeContainmentDistance(a,le.get(d),xe),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof gi&&arguments[1]instanceof ii){var b=arguments[0],w=arguments[1],I=arguments[2],L=b.getCoordinate();if(ae.EXTERIOR!==this._ptLocator.locate(L,w))return this._minDistance=0,I[0]=b,I[1]=new gi(w,L),null}}},to.prototype.computeMinDistanceLinesPoints=function(o,c,g){for(var v=0;v<o.size();v++)for(var A=o.get(v),N=0;N<c.size();N++){var G=c.get(N);if(this.computeMinDistance(A,G,g),this._minDistance<=this._terminateDistance)return null}},to.prototype.computeFacetDistance=function(){var o=new Array(2).fill(null),c=Kr.getLines(this._geom[0]),g=Kr.getLines(this._geom[1]),v=nu.getPoints(this._geom[0]),A=nu.getPoints(this._geom[1]);return this.computeMinDistanceLines(c,g,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(c,A,o),this.updateMinDistance(o,!1),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistanceLinesPoints(g,v,o),this.updateMinDistance(o,!0),this._minDistance<=this._terminateDistance?null:(o[0]=null,o[1]=null,this.computeMinDistancePoints(v,A,o),void this.updateMinDistance(o,!1))))},to.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},to.prototype.updateMinDistance=function(o,c){if(o[0]===null)return null;c?(this._minDistanceLocation[0]=o[1],this._minDistanceLocation[1]=o[0]):(this._minDistanceLocation[0]=o[0],this._minDistanceLocation[1]=o[1])},to.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},to.prototype.computeMinDistance=function(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Fr&&arguments[1]instanceof Vr){var o=arguments[0],c=arguments[1],g=arguments[2];if(o.getEnvelopeInternal().distance(c.getEnvelopeInternal())>this._minDistance)return null;for(var v=o.getCoordinates(),A=c.getCoordinate(),N=0;N<v.length-1;N++){var G=Qe.distancePointLine(A,v[N],v[N+1]);if(G<this._minDistance){this._minDistance=G;var le=new or(v[N],v[N+1]).closestPoint(A);g[0]=new gi(o,N,le),g[1]=new gi(c,0,A)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Fr&&arguments[1]instanceof Fr){var xe=arguments[0],x=arguments[1],a=arguments[2];if(xe.getEnvelopeInternal().distance(x.getEnvelopeInternal())>this._minDistance)return null;for(var d=xe.getCoordinates(),b=x.getCoordinates(),w=0;w<d.length-1;w++)for(var I=0;I<b.length-1;I++){var L=Qe.distanceLineLine(d[w],d[w+1],b[I],b[I+1]);if(L<this._minDistance){this._minDistance=L;var F=new or(d[w],d[w+1]),j=new or(b[I],b[I+1]),Y=F.closestPoints(j);a[0]=new gi(xe,w,Y[0]),a[1]=new gi(x,I,Y[1])}if(this._minDistance<=this._terminateDistance)return null}}}},to.prototype.computeMinDistancePoints=function(o,c,g){for(var v=0;v<o.size();v++)for(var A=o.get(v),N=0;N<c.size();N++){var G=c.get(N),le=A.getCoordinate().distance(G.getCoordinate());if(le<this._minDistance&&(this._minDistance=le,g[0]=new gi(A,0,A.getCoordinate()),g[1]=new gi(G,0,G.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},to.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new U("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},to.prototype.computeMinDistanceLines=function(o,c,g){for(var v=0;v<o.size();v++)for(var A=o.get(v),N=0;N<c.size();N++){var G=c.get(N);if(this.computeMinDistance(A,G,g),this._minDistance<=this._terminateDistance)return null}},to.prototype.interfaces_=function(){return[]},to.prototype.getClass=function(){return to},to.distance=function(o,c){return new to(o,c).distance()},to.isWithinDistance=function(o,c,g){return new to(o,c,g).distance()<=g},to.nearestPoints=function(o,c){return new to(o,c).nearestPoints()};var Ni=function(){this._pt=[new J,new J],this._distance=H.NaN,this._isNull=!0};Ni.prototype.getCoordinates=function(){return this._pt},Ni.prototype.getCoordinate=function(o){return this._pt[o]},Ni.prototype.setMinimum=function(){if(arguments.length===1){var o=arguments[0];this.setMinimum(o._pt[0],o._pt[1])}else if(arguments.length===2){var c=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(c,g),null;var v=c.distance(g);v<this._distance&&this.initialize(c,g,v)}},Ni.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var o=arguments[0],c=arguments[1];this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(c),this._distance=o.distance(c),this._isNull=!1}else if(arguments.length===3){var g=arguments[0],v=arguments[1],A=arguments[2];this._pt[0].setCoordinate(g),this._pt[1].setCoordinate(v),this._distance=A,this._isNull=!1}},Ni.prototype.toString=function(){return nn.toLineString(this._pt[0],this._pt[1])},Ni.prototype.getDistance=function(){return this._distance},Ni.prototype.setMaximum=function(){if(arguments.length===1){var o=arguments[0];this.setMaximum(o._pt[0],o._pt[1])}else if(arguments.length===2){var c=arguments[0],g=arguments[1];if(this._isNull)return this.initialize(c,g),null;var v=c.distance(g);v>this._distance&&this.initialize(c,g,v)}},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni};var jo=function(){};jo.prototype.interfaces_=function(){return[]},jo.prototype.getClass=function(){return jo},jo.computeDistance=function(){if(arguments[2]instanceof Ni&&arguments[0]instanceof Fr&&arguments[1]instanceof J)for(var o=arguments[0],c=arguments[1],g=arguments[2],v=new or,A=o.getCoordinates(),N=0;N<A.length-1;N++){v.setCoordinates(A[N],A[N+1]);var G=v.closestPoint(c);g.setMinimum(G,c)}else if(arguments[2]instanceof Ni&&arguments[0]instanceof ii&&arguments[1]instanceof J){var le=arguments[0],xe=arguments[1],x=arguments[2];jo.computeDistance(le.getExteriorRing(),xe,x);for(var a=0;a<le.getNumInteriorRing();a++)jo.computeDistance(le.getInteriorRingN(a),xe,x)}else if(arguments[2]instanceof Ni&&arguments[0]instanceof it&&arguments[1]instanceof J){var d=arguments[0],b=arguments[1],w=arguments[2];if(d instanceof Fr)jo.computeDistance(d,b,w);else if(d instanceof ii)jo.computeDistance(d,b,w);else if(d instanceof Ht)for(var I=d,L=0;L<I.getNumGeometries();L++){var F=I.getGeometryN(L);jo.computeDistance(F,b,w)}else w.setMinimum(d.getCoordinate(),b)}else if(arguments[2]instanceof Ni&&arguments[0]instanceof or&&arguments[1]instanceof J){var j=arguments[0],Y=arguments[1],K=arguments[2],re=j.closestPoint(Y);K.setMinimum(re,Y)}};var Pi=function(){this._g0=null,this._g1=null,this._ptDist=new Ni,this._densifyFrac=0;var o=arguments[0],c=arguments[1];this._g0=o,this._g1=c},Yt={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Pi.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Pi.prototype.setDensifyFraction=function(o){if(o>1||o<=0)throw new U("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=o},Pi.prototype.compute=function(o,c){this.computeOrientedDistance(o,c,this._ptDist),this.computeOrientedDistance(c,o,this._ptDist)},Pi.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Pi.prototype.computeOrientedDistance=function(o,c,g){var v=new Wa(c);if(o.apply(v),g.setMaximum(v.getMaxPointDistance()),this._densifyFrac>0){var A=new La(c,this._densifyFrac);o.apply(A),g.setMaximum(A.getMaxPointDistance())}},Pi.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Pi.distance=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1];return new Pi(o,c).distance()}if(arguments.length===3){var g=arguments[0],v=arguments[1],A=arguments[2],N=new Pi(g,v);return N.setDensifyFraction(A),N.distance()}},Yt.MaxPointDistanceFilter.get=function(){return Wa},Yt.MaxDensifiedByFractionDistanceFilter.get=function(){return La},Object.defineProperties(Pi,Yt);var Wa=function(){this._maxPtDist=new Ni,this._minPtDist=new Ni,this._euclideanDist=new jo,this._geom=null;var o=arguments[0];this._geom=o};Wa.prototype.filter=function(o){this._minPtDist.initialize(),jo.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Wa.prototype.getMaxPointDistance=function(){return this._maxPtDist},Wa.prototype.interfaces_=function(){return[Ar]},Wa.prototype.getClass=function(){return Wa};var La=function(){this._maxPtDist=new Ni,this._minPtDist=new Ni,this._geom=null,this._numSubSegs=0;var o=arguments[0],c=arguments[1];this._geom=o,this._numSubSegs=Math.trunc(Math.round(1/c))};La.prototype.filter=function(o,c){if(c===0)return null;for(var g=o.getCoordinate(c-1),v=o.getCoordinate(c),A=(v.x-g.x)/this._numSubSegs,N=(v.y-g.y)/this._numSubSegs,G=0;G<this._numSubSegs;G++){var le=g.x+G*A,xe=g.y+G*N,x=new J(le,xe);this._minPtDist.initialize(),jo.computeDistance(this._geom,x,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},La.prototype.isDone=function(){return!1},La.prototype.isGeometryChanged=function(){return!1},La.prototype.getMaxPointDistance=function(){return this._maxPtDist},La.prototype.interfaces_=function(){return[Xt]},La.prototype.getClass=function(){return La};var Fi=function(o,c,g){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._bufDistance=c||null,this._result=g||null},Ll={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Fi.prototype.checkMaximumDistance=function(o,c,g){var v=new Pi(c,o);if(v.setDensifyFraction(.25),this._maxDistanceFound=v.orientedDistance(),this._maxDistanceFound>g){this._isValid=!1;var A=v.getCoordinates();this._errorLocation=A[1],this._errorIndicator=o.getFactory().createLineString(A),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+nn.toLineString(A[0],A[1])+")"}},Fi.prototype.isValid=function(){var o=Math.abs(this._bufDistance),c=Fi.MAX_DISTANCE_DIFF_FRAC*o;return this._minValidDistance=o-c,this._maxValidDistance=o+c,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Fi.VERBOSE&&pt.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Fi.prototype.checkNegativeValid=function(){if(!(this._input instanceof ii||this._input instanceof Bo||this._input instanceof Ht))return null;var o=this.getPolygonLines(this._input);if(this.checkMinimumDistance(o,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(o,this._result,this._maxValidDistance)},Fi.prototype.getErrorIndicator=function(){return this._errorIndicator},Fi.prototype.checkMinimumDistance=function(o,c,g){var v=new to(o,c,g);if(this._minDistanceFound=v.distance(),this._minDistanceFound<g){this._isValid=!1;var A=v.nearestPoints();this._errorLocation=v.nearestPoints()[1],this._errorIndicator=o.getFactory().createLineString(A),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+nn.toLineString(A[0],A[1])+" )"}},Fi.prototype.checkPositiveValid=function(){var o=this._result.getBoundary();if(this.checkMinimumDistance(this._input,o,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,o,this._maxValidDistance)},Fi.prototype.getErrorLocation=function(){return this._errorLocation},Fi.prototype.getPolygonLines=function(o){for(var c=new Et,g=new Kr(c),v=Di.getPolygons(o).iterator();v.hasNext();)v.next().apply(g);return o.getFactory().buildGeometry(c)},Fi.prototype.getErrorMessage=function(){return this._errMsg},Fi.prototype.interfaces_=function(){return[]},Fi.prototype.getClass=function(){return Fi},Ll.VERBOSE.get=function(){return!1},Ll.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(Fi,Ll);var It=function(o,c,g){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=o||null,this._distance=c||null,this._result=g||null},sl={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};It.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},It.prototype.checkEnvelope=function(){if(this._distance<0)return null;var o=this._distance*It.MAX_ENV_DIFF_FRAC;o===0&&(o=.001);var c=new mt(this._input.getEnvelopeInternal());c.expandBy(this._distance);var g=new mt(this._result.getEnvelopeInternal());g.expandBy(o),g.contains(c)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(g)),this.report("Envelope")},It.prototype.checkDistance=function(){var o=new Fi(this._input,this._distance,this._result);o.isValid()||(this._isValid=!1,this._errorMsg=o.getErrorMessage(),this._errorLocation=o.getErrorLocation(),this._errorIndicator=o.getErrorIndicator()),this.report("Distance")},It.prototype.checkArea=function(){var o=this._input.getArea(),c=this._result.getArea();this._distance>0&&o>c&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&o<c&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},It.prototype.checkPolygonal=function(){this._result instanceof ii||this._result instanceof Bo||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},It.prototype.getErrorIndicator=function(){return this._errorIndicator},It.prototype.getErrorLocation=function(){return this._errorLocation},It.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},It.prototype.report=function(o){if(!It.VERBOSE)return null;pt.out.println("Check "+o+": "+(this._isValid?"passed":"FAILED"))},It.prototype.getErrorMessage=function(){return this._errorMsg},It.prototype.interfaces_=function(){return[]},It.prototype.getClass=function(){return It},It.isValidMsg=function(o,c,g){var v=new It(o,c,g);return v.isValid()?null:v.getErrorMessage()},It.isValid=function(o,c,g){return!!new It(o,c,g).isValid()},sl.VERBOSE.get=function(){return!1},sl.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(It,sl);var Ra=function(){this._pts=null,this._data=null;var o=arguments[0],c=arguments[1];this._pts=o,this._data=c};Ra.prototype.getCoordinates=function(){return this._pts},Ra.prototype.size=function(){return this._pts.length},Ra.prototype.getCoordinate=function(o){return this._pts[o]},Ra.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ra.prototype.getSegmentOctant=function(o){return o===this._pts.length-1?-1:$a.octant(this.getCoordinate(o),this.getCoordinate(o+1))},Ra.prototype.setData=function(o){this._data=o},Ra.prototype.getData=function(){return this._data},Ra.prototype.toString=function(){return nn.toLineString(new kn(this._pts))},Ra.prototype.interfaces_=function(){return[Zo]},Ra.prototype.getClass=function(){return Ra};var Xi=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Et,this._intersectionCount=0,this._keepIntersections=!0;var o=arguments[0];this._li=o,this._interiorIntersection=null};Xi.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Xi.prototype.setCheckEndSegmentsOnly=function(o){this._isCheckEndSegmentsOnly=o},Xi.prototype.getIntersectionSegments=function(){return this._intSegments},Xi.prototype.count=function(){return this._intersectionCount},Xi.prototype.getIntersections=function(){return this._intersections},Xi.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},Xi.prototype.setKeepIntersections=function(o){this._keepIntersections=o},Xi.prototype.processIntersections=function(o,c,g,v){if(!this._findAllIntersections&&this.hasIntersection()||o===g&&c===v||this._isCheckEndSegmentsOnly&&!(this.isEndSegment(o,c)||this.isEndSegment(g,v)))return null;var A=o.getCoordinates()[c],N=o.getCoordinates()[c+1],G=g.getCoordinates()[v],le=g.getCoordinates()[v+1];this._li.computeIntersection(A,N,G,le),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=A,this._intSegments[1]=N,this._intSegments[2]=G,this._intSegments[3]=le,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Xi.prototype.isEndSegment=function(o,c){return c===0||c>=o.size()-2},Xi.prototype.hasIntersection=function(){return this._interiorIntersection!==null},Xi.prototype.isDone=function(){return!this._findAllIntersections&&this._interiorIntersection!==null},Xi.prototype.interfaces_=function(){return[Va]},Xi.prototype.getClass=function(){return Xi},Xi.createAllIntersectionsFinder=function(o){var c=new Xi(o);return c.setFindAllIntersections(!0),c},Xi.createAnyIntersectionFinder=function(o){return new Xi(o)},Xi.createIntersectionCounter=function(o){var c=new Xi(o);return c.setFindAllIntersections(!0),c.setKeepIntersections(!1),c};var Oo=function(){this._li=new Xe,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var o=arguments[0];this._segStrings=o};Oo.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()},Oo.prototype.getIntersections=function(){return this._segInt.getIntersections()},Oo.prototype.isValid=function(){return this.execute(),this._isValid},Oo.prototype.setFindAllIntersections=function(o){this._findAllIntersections=o},Oo.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Xi(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var o=new tl;if(o.setSegmentIntersector(this._segInt),o.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Oo.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Wo(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Oo.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var o=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+nn.toLineString(o[0],o[1])+" and "+nn.toLineString(o[2],o[3])},Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo},Oo.computeIntersections=function(o){var c=new Oo(o);return c.setFindAllIntersections(!0),c.isValid(),c.getIntersections()};var Za=function o(){this._nv=null;var c=arguments[0];this._nv=new Oo(o.toSegmentStrings(c))};Za.prototype.checkValid=function(){this._nv.checkValid()},Za.prototype.interfaces_=function(){return[]},Za.prototype.getClass=function(){return Za},Za.toSegmentStrings=function(o){for(var c=new Et,g=o.iterator();g.hasNext();){var v=g.next();c.add(new Ra(v.getCoordinates(),v))}return c},Za.checkValid=function(o){new Za(o).checkValid()};var iu=function(o){this._mapOp=o};iu.prototype.map=function(o){for(var c=new Et,g=0;g<o.getNumGeometries();g++){var v=this._mapOp.map(o.getGeometryN(g));v.isEmpty()||c.add(v)}return o.getFactory().createGeometryCollection(Rr.toGeometryArray(c))},iu.prototype.interfaces_=function(){return[]},iu.prototype.getClass=function(){return iu},iu.map=function(o,c){return new iu(c).map(o)};var Ha=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Et,this._resultLineList=new Et;var o=arguments[0],c=arguments[1],g=arguments[2];this._op=o,this._geometryFactory=c,this._ptLocator=g};Ha.prototype.collectLines=function(o){for(var c=this._op.getGraph().getEdgeEnds().iterator();c.hasNext();){var g=c.next();this.collectLineEdge(g,o,this._lineEdgesList),this.collectBoundaryTouchEdge(g,o,this._lineEdgesList)}},Ha.prototype.labelIsolatedLine=function(o,c){var g=this._ptLocator.locate(o.getCoordinate(),this._op.getArgGeometry(c));o.getLabel().setLocation(c,g)},Ha.prototype.build=function(o){return this.findCoveredLineEdges(),this.collectLines(o),this.buildLines(o),this._resultLineList},Ha.prototype.collectLineEdge=function(o,c,g){var v=o.getLabel(),A=o.getEdge();o.isLineEdge()&&(o.isVisited()||!Kt.isResultOfOp(v,c)||A.isCovered()||(g.add(A),o.setVisitedEdge(!0)))},Ha.prototype.findCoveredLineEdges=function(){for(var o=this._op.getGraph().getNodes().iterator();o.hasNext();)o.next().getEdges().findCoveredLineEdges();for(var c=this._op.getGraph().getEdgeEnds().iterator();c.hasNext();){var g=c.next(),v=g.getEdge();if(g.isLineEdge()&&!v.isCoveredSet()){var A=this._op.isCoveredByA(g.getCoordinate());v.setCovered(A)}}},Ha.prototype.labelIsolatedLines=function(o){for(var c=o.iterator();c.hasNext();){var g=c.next(),v=g.getLabel();g.isIsolated()&&(v.isNull(0)?this.labelIsolatedLine(g,0):this.labelIsolatedLine(g,1))}},Ha.prototype.buildLines=function(o){for(var c=this._lineEdgesList.iterator();c.hasNext();){var g=c.next(),v=this._geometryFactory.createLineString(g.getCoordinates());this._resultLineList.add(v),g.setInResult(!0)}},Ha.prototype.collectBoundaryTouchEdge=function(o,c,g){var v=o.getLabel();return o.isLineEdge()||o.isVisited()||o.isInteriorAreaEdge()||o.getEdge().isInResult()?null:(ce.isTrue(!(o.isInResult()||o.getSym().isInResult())||!o.getEdge().isInResult()),void(Kt.isResultOfOp(v,c)&&c===Kt.INTERSECTION&&(g.add(o.getEdge()),o.setVisitedEdge(!0))))},Ha.prototype.interfaces_=function(){return[]},Ha.prototype.getClass=function(){return Ha};var Su=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Et;var o=arguments[0],c=arguments[1];this._op=o,this._geometryFactory=c};Su.prototype.filterCoveredNodeToPoint=function(o){var c=o.getCoordinate();if(!this._op.isCoveredByLA(c)){var g=this._geometryFactory.createPoint(c);this._resultPointList.add(g)}},Su.prototype.extractNonCoveredResultNodes=function(o){for(var c=this._op.getGraph().getNodes().iterator();c.hasNext();){var g=c.next();if(!g.isInResult()&&!g.isIncidentEdgeInResult()&&(g.getEdges().getDegree()===0||o===Kt.INTERSECTION)){var v=g.getLabel();Kt.isResultOfOp(v,o)&&this.filterCoveredNodeToPoint(g)}}},Su.prototype.build=function(o){return this.extractNonCoveredResultNodes(o),this._resultPointList},Su.prototype.interfaces_=function(){return[]},Su.prototype.getClass=function(){return Su};var so=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};so.prototype.transformPoint=function(o,c){return this._factory.createPoint(this.transformCoordinates(o.getCoordinateSequence(),o))},so.prototype.transformPolygon=function(o,c){var g=!0,v=this.transformLinearRing(o.getExteriorRing(),o);v!==null&&v instanceof hi&&!v.isEmpty()||(g=!1);for(var A=new Et,N=0;N<o.getNumInteriorRing();N++){var G=this.transformLinearRing(o.getInteriorRingN(N),o);G===null||G.isEmpty()||(G instanceof hi||(g=!1),A.add(G))}if(g)return this._factory.createPolygon(v,A.toArray([]));var le=new Et;return v!==null&&le.add(v),le.addAll(A),this._factory.buildGeometry(le)},so.prototype.createCoordinateSequence=function(o){return this._factory.getCoordinateSequenceFactory().create(o)},so.prototype.getInputGeometry=function(){return this._inputGeom},so.prototype.transformMultiLineString=function(o,c){for(var g=new Et,v=0;v<o.getNumGeometries();v++){var A=this.transformLineString(o.getGeometryN(v),o);A!==null&&(A.isEmpty()||g.add(A))}return this._factory.buildGeometry(g)},so.prototype.transformCoordinates=function(o,c){return this.copy(o)},so.prototype.transformLineString=function(o,c){return this._factory.createLineString(this.transformCoordinates(o.getCoordinateSequence(),o))},so.prototype.transformMultiPoint=function(o,c){for(var g=new Et,v=0;v<o.getNumGeometries();v++){var A=this.transformPoint(o.getGeometryN(v),o);A!==null&&(A.isEmpty()||g.add(A))}return this._factory.buildGeometry(g)},so.prototype.transformMultiPolygon=function(o,c){for(var g=new Et,v=0;v<o.getNumGeometries();v++){var A=this.transformPolygon(o.getGeometryN(v),o);A!==null&&(A.isEmpty()||g.add(A))}return this._factory.buildGeometry(g)},so.prototype.copy=function(o){return o.copy()},so.prototype.transformGeometryCollection=function(o,c){for(var g=new Et,v=0;v<o.getNumGeometries();v++){var A=this.transform(o.getGeometryN(v));A!==null&&(this._pruneEmptyGeometry&&A.isEmpty()||g.add(A))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Rr.toGeometryArray(g)):this._factory.buildGeometry(g)},so.prototype.transform=function(o){if(this._inputGeom=o,this._factory=o.getFactory(),o instanceof Vr)return this.transformPoint(o,null);if(o instanceof ci)return this.transformMultiPoint(o,null);if(o instanceof hi)return this.transformLinearRing(o,null);if(o instanceof Fr)return this.transformLineString(o,null);if(o instanceof Ur)return this.transformMultiLineString(o,null);if(o instanceof ii)return this.transformPolygon(o,null);if(o instanceof Bo)return this.transformMultiPolygon(o,null);if(o instanceof Ht)return this.transformGeometryCollection(o,null);throw new U("Unknown Geometry subtype: "+o.getClass().getName())},so.prototype.transformLinearRing=function(o,c){var g=this.transformCoordinates(o.getCoordinateSequence(),o);if(g===null)return this._factory.createLinearRing(null);var v=g.size();return v>0&&v<4&&!this._preserveType?this._factory.createLineString(g):this._factory.createLinearRing(g)},so.prototype.interfaces_=function(){return[]},so.prototype.getClass=function(){return so};var ra=function o(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new or,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Fr&&typeof arguments[1]=="number"){var c=arguments[0],g=arguments[1];o.call(this,c.getCoordinates(),g)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var v=arguments[0],A=arguments[1];this._srcPts=v,this._isClosed=o.isClosed(v),this._snapTolerance=A}};ra.prototype.snapVertices=function(o,c){for(var g=this._isClosed?o.size()-1:o.size(),v=0;v<g;v++){var A=o.get(v),N=this.findSnapForVertex(A,c);N!==null&&(o.set(v,new J(N)),v===0&&this._isClosed&&o.set(o.size()-1,new J(N)))}},ra.prototype.findSnapForVertex=function(o,c){for(var g=0;g<c.length;g++){if(o.equals2D(c[g]))return null;if(o.distance(c[g])<this._snapTolerance)return c[g]}return null},ra.prototype.snapTo=function(o){var c=new Le(this._srcPts);return this.snapVertices(c,o),this.snapSegments(c,o),c.toCoordinateArray()},ra.prototype.snapSegments=function(o,c){if(c.length===0)return null;var g=c.length;c[0].equals2D(c[c.length-1])&&(g=c.length-1);for(var v=0;v<g;v++){var A=c[v],N=this.findSegmentIndexToSnap(A,o);N>=0&&o.add(N+1,new J(A),!1)}},ra.prototype.findSegmentIndexToSnap=function(o,c){for(var g=H.MAX_VALUE,v=-1,A=0;A<c.size()-1;A++){if(this._seg.p0=c.get(A),this._seg.p1=c.get(A+1),this._seg.p0.equals2D(o)||this._seg.p1.equals2D(o)){if(this._allowSnappingToSourceVertices)continue;return-1}var N=this._seg.distance(o);N<this._snapTolerance&&N<g&&(g=N,v=A)}return v},ra.prototype.setAllowSnappingToSourceVertices=function(o){this._allowSnappingToSourceVertices=o},ra.prototype.interfaces_=function(){return[]},ra.prototype.getClass=function(){return ra},ra.isClosed=function(o){return!(o.length<=1)&&o[0].equals2D(o[o.length-1])};var oi=function(o){this._srcGeom=o||null},oc={SNAP_PRECISION_FACTOR:{configurable:!0}};oi.prototype.snapTo=function(o,c){var g=this.extractTargetCoordinates(o);return new na(c,g).transform(this._srcGeom)},oi.prototype.snapToSelf=function(o,c){var g=this.extractTargetCoordinates(this._srcGeom),v=new na(o,g,!0).transform(this._srcGeom),A=v;return c&&Pe(A,vi)&&(A=v.buffer(0)),A},oi.prototype.computeSnapTolerance=function(o){return this.computeMinimumSegmentLength(o)/10},oi.prototype.extractTargetCoordinates=function(o){for(var c=new $,g=o.getCoordinates(),v=0;v<g.length;v++)c.add(g[v]);return c.toArray(new Array(0).fill(null))},oi.prototype.computeMinimumSegmentLength=function(o){for(var c=H.MAX_VALUE,g=0;g<o.length-1;g++){var v=o[g].distance(o[g+1]);v<c&&(c=v)}return c},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},oi.snap=function(o,c,g){var v=new Array(2).fill(null),A=new oi(o);v[0]=A.snapTo(c,g);var N=new oi(c);return v[1]=N.snapTo(v[0],g),v},oi.computeOverlaySnapTolerance=function(){if(arguments.length===1){var o=arguments[0],c=oi.computeSizeBasedSnapTolerance(o),g=o.getPrecisionModel();if(g.getType()===er.FIXED){var v=1/g.getScale()*2/1.415;v>c&&(c=v)}return c}if(arguments.length===2){var A=arguments[0],N=arguments[1];return Math.min(oi.computeOverlaySnapTolerance(A),oi.computeOverlaySnapTolerance(N))}},oi.computeSizeBasedSnapTolerance=function(o){var c=o.getEnvelopeInternal();return Math.min(c.getHeight(),c.getWidth())*oi.SNAP_PRECISION_FACTOR},oi.snapToSelf=function(o,c,g){return new oi(o).snapToSelf(c,g)},oc.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(oi,oc);var na=function(o){function c(g,v,A){o.call(this),this._snapTolerance=g||null,this._snapPts=v||null,this._isSelfSnap=A!==void 0&&A}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.snapLine=function(g,v){var A=new ra(g,this._snapTolerance);return A.setAllowSnappingToSourceVertices(this._isSelfSnap),A.snapTo(v)},c.prototype.transformCoordinates=function(g,v){var A=g.toCoordinateArray(),N=this.snapLine(A,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(N)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(so),yi=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};yi.prototype.getCommon=function(){return H.longBitsToDouble(this._commonBits)},yi.prototype.add=function(o){var c=H.doubleToLongBits(o);if(this._isFirst)return this._commonBits=c,this._commonSignExp=yi.signExpBits(this._commonBits),this._isFirst=!1,null;if(yi.signExpBits(c)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=yi.numCommonMostSigMantissaBits(this._commonBits,c),this._commonBits=yi.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))},yi.prototype.toString=function(){if(arguments.length===1){var o=arguments[0],c=H.longBitsToDouble(o),g="0000000000000000000000000000000000000000000000000000000000000000"+H.toBinaryString(o),v=g.substring(g.length-64);return v.substring(0,1)+"  "+v.substring(1,12)+"(exp) "+v.substring(12)+" [ "+c+" ]"}},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},yi.getBit=function(o,c){return o&1<<c?1:0},yi.signExpBits=function(o){return o>>52},yi.zeroLowerBits=function(o,c){return o&~((1<<c)-1)},yi.numCommonMostSigMantissaBits=function(o,c){for(var g=0,v=52;v>=0;v--){if(yi.getBit(o,v)!==yi.getBit(c,v))return g;g++}return 52};var vs=function(){this._commonCoord=null,this._ccFilter=new ou},Rl={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};vs.prototype.addCommonBits=function(o){var c=new ys(this._commonCoord);o.apply(c),o.geometryChanged()},vs.prototype.removeCommonBits=function(o){if(this._commonCoord.x===0&&this._commonCoord.y===0)return o;var c=new J(this._commonCoord);c.x=-c.x,c.y=-c.y;var g=new ys(c);return o.apply(g),o.geometryChanged(),o},vs.prototype.getCommonCoordinate=function(){return this._commonCoord},vs.prototype.add=function(o){o.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},vs.prototype.interfaces_=function(){return[]},vs.prototype.getClass=function(){return vs},Rl.CommonCoordinateFilter.get=function(){return ou},Rl.Translater.get=function(){return ys},Object.defineProperties(vs,Rl);var ou=function(){this._commonBitsX=new yi,this._commonBitsY=new yi};ou.prototype.filter=function(o){this._commonBitsX.add(o.x),this._commonBitsY.add(o.y)},ou.prototype.getCommonCoordinate=function(){return new J(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},ou.prototype.interfaces_=function(){return[Ar]},ou.prototype.getClass=function(){return ou};var ys=function(){this.trans=null;var o=arguments[0];this.trans=o};ys.prototype.filter=function(o,c){var g=o.getOrdinate(c,0)+this.trans.x,v=o.getOrdinate(c,1)+this.trans.y;o.setOrdinate(c,0,g),o.setOrdinate(c,1,v)},ys.prototype.isDone=function(){return!1},ys.prototype.isGeometryChanged=function(){return!0},ys.prototype.interfaces_=function(){return[Xt]},ys.prototype.getClass=function(){return ys};var ki=function(o,c){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=o,this._geom[1]=c,this.computeSnapTolerance()};ki.prototype.selfSnap=function(o){return new oi(o).snapTo(o,this._snapTolerance)},ki.prototype.removeCommonBits=function(o){this._cbr=new vs,this._cbr.add(o[0]),this._cbr.add(o[1]);var c=new Array(2).fill(null);return c[0]=this._cbr.removeCommonBits(o[0].copy()),c[1]=this._cbr.removeCommonBits(o[1].copy()),c},ki.prototype.prepareResult=function(o){return this._cbr.addCommonBits(o),o},ki.prototype.getResultGeometry=function(o){var c=this.snap(this._geom),g=Kt.overlayOp(c[0],c[1],o);return this.prepareResult(g)},ki.prototype.checkValid=function(o){o.isValid()||pt.out.println("Snapped geometry is invalid")},ki.prototype.computeSnapTolerance=function(){this._snapTolerance=oi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},ki.prototype.snap=function(o){var c=this.removeCommonBits(o);return oi.snap(c[0],c[1],this._snapTolerance)},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},ki.overlayOp=function(o,c,g){return new ki(o,c).getResultGeometry(g)},ki.union=function(o,c){return ki.overlayOp(o,c,Kt.UNION)},ki.intersection=function(o,c){return ki.overlayOp(o,c,Kt.INTERSECTION)},ki.symDifference=function(o,c){return ki.overlayOp(o,c,Kt.SYMDIFFERENCE)},ki.difference=function(o,c){return ki.overlayOp(o,c,Kt.DIFFERENCE)};var Jn=function(o,c){this._geom=new Array(2).fill(null),this._geom[0]=o,this._geom[1]=c};Jn.prototype.getResultGeometry=function(o){var c=null,g=!1,v=null;try{c=Kt.overlayOp(this._geom[0],this._geom[1],o),g=!0}catch(A){if(!(A instanceof rt))throw A;v=A}if(!g)try{c=ki.overlayOp(this._geom[0],this._geom[1],o)}catch(A){throw A instanceof rt?v:A}return c},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn},Jn.overlayOp=function(o,c,g){return new Jn(o,c).getResultGeometry(g)},Jn.union=function(o,c){return Jn.overlayOp(o,c,Kt.UNION)},Jn.intersection=function(o,c){return Jn.overlayOp(o,c,Kt.INTERSECTION)},Jn.symDifference=function(o,c){return Jn.overlayOp(o,c,Kt.SYMDIFFERENCE)},Jn.difference=function(o,c){return Jn.overlayOp(o,c,Kt.DIFFERENCE)};var Kn=function(){this.mce=null,this.chainIndex=null;var o=arguments[0],c=arguments[1];this.mce=o,this.chainIndex=c};Kn.prototype.computeIntersections=function(o,c){this.mce.computeIntersectsForChain(this.chainIndex,o.mce,o.chainIndex,c)},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn};var uo=function o(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var c=arguments[0],g=arguments[1];this._eventType=o.DELETE,this._xValue=c,this._insertEvent=g}else if(arguments.length===3){var v=arguments[0],A=arguments[1],N=arguments[2];this._eventType=o.INSERT,this._label=v,this._xValue=A,this._obj=N}},Pu={INSERT:{configurable:!0},DELETE:{configurable:!0}};uo.prototype.isDelete=function(){return this._eventType===uo.DELETE},uo.prototype.setDeleteEventIndex=function(o){this._deleteEventIndex=o},uo.prototype.getObject=function(){return this._obj},uo.prototype.compareTo=function(o){var c=o;return this._xValue<c._xValue?-1:this._xValue>c._xValue?1:this._eventType<c._eventType?-1:this._eventType>c._eventType?1:0},uo.prototype.getInsertEvent=function(){return this._insertEvent},uo.prototype.isInsert=function(){return this._eventType===uo.INSERT},uo.prototype.isSameLabel=function(o){return this._label!==null&&this._label===o._label},uo.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},uo.prototype.interfaces_=function(){return[ie]},uo.prototype.getClass=function(){return uo},Pu.INSERT.get=function(){return 1},Pu.DELETE.get=function(){return 2},Object.defineProperties(uo,Pu);var Dl=function(){};Dl.prototype.interfaces_=function(){return[]},Dl.prototype.getClass=function(){return Dl};var Ai=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var o=arguments[0],c=arguments[1],g=arguments[2];this._li=o,this._includeProper=c,this._recordIsolated=g};Ai.prototype.isTrivialIntersection=function(o,c,g,v){if(o===g&&this._li.getIntersectionNum()===1){if(Ai.isAdjacentSegments(c,v))return!0;if(o.isClosed()){var A=o.getNumPoints()-1;if(c===0&&v===A||v===0&&c===A)return!0}}return!1},Ai.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Ai.prototype.setIsDoneIfProperInt=function(o){this._isDoneWhenProperInt=o},Ai.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Ai.prototype.isBoundaryPointInternal=function(o,c){for(var g=c.iterator();g.hasNext();){var v=g.next().getCoordinate();if(o.isIntersection(v))return!0}return!1},Ai.prototype.hasProperIntersection=function(){return this._hasProper},Ai.prototype.hasIntersection=function(){return this._hasIntersection},Ai.prototype.isDone=function(){return this._isDone},Ai.prototype.isBoundaryPoint=function(o,c){return c!==null&&(!!this.isBoundaryPointInternal(o,c[0])||!!this.isBoundaryPointInternal(o,c[1]))},Ai.prototype.setBoundaryNodes=function(o,c){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=o,this._bdyNodes[1]=c},Ai.prototype.addIntersections=function(o,c,g,v){if(o===g&&c===v)return null;this.numTests++;var A=o.getCoordinates()[c],N=o.getCoordinates()[c+1],G=g.getCoordinates()[v],le=g.getCoordinates()[v+1];this._li.computeIntersection(A,N,G,le),this._li.hasIntersection()&&(this._recordIsolated&&(o.setIsolated(!1),g.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(o,c,g,v)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(o.addIntersections(this._li,c,0),g.addIntersections(this._li,v,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai},Ai.isAdjacentSegments=function(o,c){return Math.abs(o-c)===1};var Ch=function(o){function c(){o.call(this),this.events=new Et,this.nOverlaps=null}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.prepareEvents=function(){Ki.sort(this.events);for(var g=0;g<this.events.size();g++){var v=this.events.get(g);v.isDelete()&&v.getInsertEvent().setDeleteEventIndex(g)}},c.prototype.computeIntersections=function(){if(arguments.length===1){var g=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var v=0;v<this.events.size();v++){var A=this.events.get(v);if(A.isInsert()&&this.processOverlaps(v,A.getDeleteEventIndex(),A,g),g.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Ai&&Pe(arguments[0],Lr)&&Pe(arguments[1],Lr)){var N=arguments[0],G=arguments[1],le=arguments[2];this.addEdges(N,N),this.addEdges(G,G),this.computeIntersections(le)}else if(typeof arguments[2]=="boolean"&&Pe(arguments[0],Lr)&&arguments[1]instanceof Ai){var xe=arguments[0],x=arguments[1];arguments[2]?this.addEdges(xe,null):this.addEdges(xe),this.computeIntersections(x)}}},c.prototype.addEdge=function(g,v){for(var A=g.getMonotoneChainEdge(),N=A.getStartIndexes(),G=0;G<N.length-1;G++){var le=new Kn(A,G),xe=new uo(v,A.getMinX(G),le);this.events.add(xe),this.events.add(new uo(A.getMaxX(G),xe))}},c.prototype.processOverlaps=function(g,v,A,N){for(var G=A.getObject(),le=g;le<v;le++){var xe=this.events.get(le);if(xe.isInsert()){var x=xe.getObject();A.isSameLabel(xe)||(G.computeIntersections(x,N),this.nOverlaps++)}}},c.prototype.addEdges=function(){if(arguments.length===1)for(var g=arguments[0].iterator();g.hasNext();){var v=g.next();this.addEdge(v,v)}else if(arguments.length===2)for(var A=arguments[0],N=arguments[1],G=A.iterator();G.hasNext();){var le=G.next();this.addEdge(le,N)}},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Dl),_s=function(){this._min=H.POSITIVE_INFINITY,this._max=H.NEGATIVE_INFINITY},Ja={NodeComparator:{configurable:!0}};_s.prototype.getMin=function(){return this._min},_s.prototype.intersects=function(o,c){return!(this._min>c||this._max<o)},_s.prototype.getMax=function(){return this._max},_s.prototype.toString=function(){return nn.toLineString(new J(this._min,0),new J(this._max,0))},_s.prototype.interfaces_=function(){return[]},_s.prototype.getClass=function(){return _s},Ja.NodeComparator.get=function(){return au},Object.defineProperties(_s,Ja);var au=function(){};au.prototype.compare=function(o,c){var g=o,v=c,A=(g._min+g._max)/2,N=(v._min+v._max)/2;return A<N?-1:A>N?1:0},au.prototype.interfaces_=function(){return[W]},au.prototype.getClass=function(){return au};var fr=function(o){function c(){o.call(this),this._item=null;var g=arguments[0],v=arguments[1],A=arguments[2];this._min=g,this._max=v,this._item=A}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.query=function(g,v,A){if(!this.intersects(g,v))return null;A.visitItem(this._item)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(_s),Er=function(o){function c(){o.call(this),this._node1=null,this._node2=null;var g=arguments[0],v=arguments[1];this._node1=g,this._node2=v,this.buildExtent(this._node1,this._node2)}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.buildExtent=function(g,v){this._min=Math.min(g._min,v._min),this._max=Math.max(g._max,v._max)},c.prototype.query=function(g,v,A){if(!this.intersects(g,v))return null;this._node1!==null&&this._node1.query(g,v,A),this._node2!==null&&this._node2.query(g,v,A)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(_s),ma=function(){this._leaves=new Et,this._root=null,this._level=0};ma.prototype.buildTree=function(){Ki.sort(this._leaves,new _s.NodeComparator);for(var o=this._leaves,c=null,g=new Et;;){if(this.buildLevel(o,g),g.size()===1)return g.get(0);c=o,o=g,g=c}},ma.prototype.insert=function(o,c,g){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new fr(o,c,g))},ma.prototype.query=function(o,c,g){this.init(),this._root.query(o,c,g)},ma.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()},ma.prototype.printNode=function(o){pt.out.println(nn.toLineString(new J(o._min,this._level),new J(o._max,this._level)))},ma.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()},ma.prototype.buildLevel=function(o,c){this._level++,c.clear();for(var g=0;g<o.size();g+=2){var v=o.get(g);if((g+1<o.size()?o.get(g):null)===null)c.add(v);else{var A=new Er(o.get(g),o.get(g+1));c.add(A)}}},ma.prototype.interfaces_=function(){return[]},ma.prototype.getClass=function(){return ma};var Au=function(){this._items=new Et};Au.prototype.visitItem=function(o){this._items.add(o)},Au.prototype.getItems=function(){return this._items},Au.prototype.interfaces_=function(){return[Gr]},Au.prototype.getClass=function(){return Au};var Iu=function(){this._index=null;var o=arguments[0];if(!Pe(o,vi))throw new U("Argument must be Polygonal");this._index=new Co(o)},Uo={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Iu.prototype.locate=function(o){var c=new ht(o),g=new Ka(c);return this._index.query(o.y,o.y,g),c.getLocation()},Iu.prototype.interfaces_=function(){return[qa]},Iu.prototype.getClass=function(){return Iu},Uo.SegmentVisitor.get=function(){return Ka},Uo.IntervalIndexedGeometry.get=function(){return Co},Object.defineProperties(Iu,Uo);var Ka=function(){this._counter=null;var o=arguments[0];this._counter=o};Ka.prototype.visitItem=function(o){var c=o;this._counter.countSegment(c.getCoordinate(0),c.getCoordinate(1))},Ka.prototype.interfaces_=function(){return[Gr]},Ka.prototype.getClass=function(){return Ka};var Co=function(){this._index=new ma;var o=arguments[0];this.init(o)};Co.prototype.init=function(o){for(var c=Kr.getLines(o).iterator();c.hasNext();){var g=c.next().getCoordinates();this.addLine(g)}},Co.prototype.addLine=function(o){for(var c=1;c<o.length;c++){var g=new or(o[c-1],o[c]),v=Math.min(g.p0.y,g.p1.y),A=Math.max(g.p0.y,g.p1.y);this._index.insert(v,A,g)}},Co.prototype.query=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1],g=new Au;return this._index.query(o,c,g),g.getItems()}if(arguments.length===3){var v=arguments[0],A=arguments[1],N=arguments[2];this._index.query(v,A,N)}},Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co};var Nl=function(o){function c(){if(o.call(this),this._parentGeom=null,this._lineEdgeMap=new Ls,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Io,arguments.length===2){var g=arguments[0],v=arguments[1],A=Ir.OGC_SFS_BOUNDARY_RULE;this._argIndex=g,this._parentGeom=v,this._boundaryNodeRule=A,v!==null&&this.add(v)}else if(arguments.length===3){var N=arguments[0],G=arguments[1],le=arguments[2];this._argIndex=N,this._parentGeom=G,this._boundaryNodeRule=le,G!==null&&this.add(G)}}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.insertBoundaryPoint=function(g,v){var A=this._nodes.addNode(v).getLabel(),N=1;ae.NONE,A.getLocation(g,Pt.ON)===ae.BOUNDARY&&N++;var G=c.determineBoundary(this._boundaryNodeRule,N);A.setLocation(g,G)},c.prototype.computeSelfNodes=function(){if(arguments.length===2){var g=arguments[0],v=arguments[1];return this.computeSelfNodes(g,v,!1)}if(arguments.length===3){var A=arguments[0],N=arguments[1],G=arguments[2],le=new Ai(A,!0,!1);le.setIsDoneIfProperInt(G);var xe=this.createEdgeSetIntersector(),x=this._parentGeom instanceof hi||this._parentGeom instanceof ii||this._parentGeom instanceof Bo,a=N||!x;return xe.computeIntersections(this._edges,le,a),this.addSelfIntersectionNodes(this._argIndex),le}},c.prototype.computeSplitEdges=function(g){for(var v=this._edges.iterator();v.hasNext();)v.next().eiList.addSplitEdges(g)},c.prototype.computeEdgeIntersections=function(g,v,A){var N=new Ai(v,A,!0);return N.setBoundaryNodes(this.getBoundaryNodes(),g.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,g._edges,N),N},c.prototype.getGeometry=function(){return this._parentGeom},c.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},c.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},c.prototype.addPoint=function(){if(arguments[0]instanceof Vr){var g=arguments[0].getCoordinate();this.insertPoint(this._argIndex,g,ae.INTERIOR)}else if(arguments[0]instanceof J){var v=arguments[0];this.insertPoint(this._argIndex,v,ae.INTERIOR)}},c.prototype.addPolygon=function(g){this.addPolygonRing(g.getExteriorRing(),ae.EXTERIOR,ae.INTERIOR);for(var v=0;v<g.getNumInteriorRing();v++){var A=g.getInteriorRingN(v);this.addPolygonRing(A,ae.INTERIOR,ae.EXTERIOR)}},c.prototype.addEdge=function(g){this.insertEdge(g);var v=g.getCoordinates();this.insertPoint(this._argIndex,v[0],ae.BOUNDARY),this.insertPoint(this._argIndex,v[v.length-1],ae.BOUNDARY)},c.prototype.addLineString=function(g){var v=ne.removeRepeatedPoints(g.getCoordinates());if(v.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=v[0],null;var A=new ta(v,new Xr(this._argIndex,ae.INTERIOR));this._lineEdgeMap.put(g,A),this.insertEdge(A),ce.isTrue(v.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,v[0]),this.insertBoundaryPoint(this._argIndex,v[v.length-1])},c.prototype.getInvalidPoint=function(){return this._invalidPoint},c.prototype.getBoundaryPoints=function(){for(var g=this.getBoundaryNodes(),v=new Array(g.size()).fill(null),A=0,N=g.iterator();N.hasNext();){var G=N.next();v[A++]=G.getCoordinate().copy()}return v},c.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},c.prototype.addSelfIntersectionNode=function(g,v,A){if(this.isBoundaryNode(g,v))return null;A===ae.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(g,v):this.insertPoint(g,v,A)},c.prototype.addPolygonRing=function(g,v,A){if(g.isEmpty())return null;var N=ne.removeRepeatedPoints(g.getCoordinates());if(N.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=N[0],null;var G=v,le=A;Qe.isCCW(N)&&(G=A,le=v);var xe=new ta(N,new Xr(this._argIndex,ae.BOUNDARY,G,le));this._lineEdgeMap.put(g,xe),this.insertEdge(xe),this.insertPoint(this._argIndex,N[0],ae.BOUNDARY)},c.prototype.insertPoint=function(g,v,A){var N=this._nodes.addNode(v),G=N.getLabel();G===null?N._label=new Xr(g,A):G.setLocation(g,A)},c.prototype.createEdgeSetIntersector=function(){return new Ch},c.prototype.addSelfIntersectionNodes=function(g){for(var v=this._edges.iterator();v.hasNext();)for(var A=v.next(),N=A.getLabel().getLocation(g),G=A.eiList.iterator();G.hasNext();){var le=G.next();this.addSelfIntersectionNode(g,le.coord,N)}},c.prototype.add=function(){if(arguments.length!==1)return o.prototype.add.apply(this,arguments);var g=arguments[0];if(g.isEmpty())return null;if(g instanceof Bo&&(this._useBoundaryDeterminationRule=!1),g instanceof ii)this.addPolygon(g);else if(g instanceof Fr)this.addLineString(g);else if(g instanceof Vr)this.addPoint(g);else if(g instanceof ci)this.addCollection(g);else if(g instanceof Ur)this.addCollection(g);else if(g instanceof Bo)this.addCollection(g);else{if(!(g instanceof Ht))throw new Error(g.getClass().getName());this.addCollection(g)}},c.prototype.addCollection=function(g){for(var v=0;v<g.getNumGeometries();v++){var A=g.getGeometryN(v);this.add(A)}},c.prototype.locate=function(g){return Pe(this._parentGeom,vi)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Iu(this._parentGeom)),this._areaPtLocator.locate(g)):this._ptLocator.locate(g,this._parentGeom)},c.prototype.findEdge=function(){if(arguments.length===1){var g=arguments[0];return this._lineEdgeMap.get(g)}return o.prototype.findEdge.apply(this,arguments)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c.determineBoundary=function(g,v){return g.isInBoundary(v)?ae.BOUNDARY:ae.INTERIOR},c}(Yr),Us=function(){if(this._li=new Xe,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var o=arguments[0];this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Nl(0,o)}else if(arguments.length===2){var c=arguments[0],g=arguments[1],v=Ir.OGC_SFS_BOUNDARY_RULE;c.getPrecisionModel().compareTo(g.getPrecisionModel())>=0?this.setComputationPrecision(c.getPrecisionModel()):this.setComputationPrecision(g.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Nl(0,c,v),this._arg[1]=new Nl(1,g,v)}else if(arguments.length===3){var A=arguments[0],N=arguments[1],G=arguments[2];A.getPrecisionModel().compareTo(N.getPrecisionModel())>=0?this.setComputationPrecision(A.getPrecisionModel()):this.setComputationPrecision(N.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Nl(0,A,G),this._arg[1]=new Nl(1,N,G)}};Us.prototype.getArgGeometry=function(o){return this._arg[o].getGeometry()},Us.prototype.setComputationPrecision=function(o){this._resultPrecisionModel=o,this._li.setPrecisionModel(this._resultPrecisionModel)},Us.prototype.interfaces_=function(){return[]},Us.prototype.getClass=function(){return Us};var $n=function(){};$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n.map=function(){if(arguments[0]instanceof it&&Pe(arguments[1],$n.MapOp)){for(var o=arguments[0],c=arguments[1],g=new Et,v=0;v<o.getNumGeometries();v++){var A=c.map(o.getGeometryN(v));A!==null&&g.add(A)}return o.getFactory().buildGeometry(g)}if(Pe(arguments[0],qr)&&Pe(arguments[1],$n.MapOp)){for(var N=arguments[0],G=arguments[1],le=new Et,xe=N.iterator();xe.hasNext();){var x=xe.next(),a=G.map(x);a!==null&&le.add(a)}return le}},$n.MapOp=function(){};var Kt=function(o){function c(){var g=arguments[0],v=arguments[1];o.call(this,g,v),this._ptLocator=new Io,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new vo,this._resultPolyList=new Et,this._resultLineList=new Et,this._resultPointList=new Et,this._graph=new Yr(new nl),this._geomFact=g.getFactory()}return o&&(c.__proto__=o),c.prototype=Object.create(o&&o.prototype),c.prototype.constructor=c,c.prototype.insertUniqueEdge=function(g){var v=this._edgeList.findEqualEdge(g);if(v!==null){var A=v.getLabel(),N=g.getLabel();v.isPointwiseEqual(g)||(N=new Xr(g.getLabel())).flip();var G=v.getDepth();G.isNull()&&G.add(A),G.add(N),A.merge(N)}else this._edgeList.add(g)},c.prototype.getGraph=function(){return this._graph},c.prototype.cancelDuplicateResultEdges=function(){for(var g=this._graph.getEdgeEnds().iterator();g.hasNext();){var v=g.next(),A=v.getSym();v.isInResult()&&A.isInResult()&&(v.setInResult(!1),A.setInResult(!1))}},c.prototype.isCoveredByLA=function(g){return!!this.isCovered(g,this._resultLineList)||!!this.isCovered(g,this._resultPolyList)},c.prototype.computeGeometry=function(g,v,A,N){var G=new Et;return G.addAll(g),G.addAll(v),G.addAll(A),G.isEmpty()?c.createEmptyResult(N,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(G)},c.prototype.mergeSymLabels=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();)g.next().getEdges().mergeSymLabels()},c.prototype.isCovered=function(g,v){for(var A=v.iterator();A.hasNext();){var N=A.next();if(this._ptLocator.locate(g,N)!==ae.EXTERIOR)return!0}return!1},c.prototype.replaceCollapsedEdges=function(){for(var g=new Et,v=this._edgeList.iterator();v.hasNext();){var A=v.next();A.isCollapsed()&&(v.remove(),g.add(A.getCollapsedEdge()))}this._edgeList.addAll(g)},c.prototype.updateNodeLabelling=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();){var v=g.next(),A=v.getEdges().getLabel();v.getLabel().merge(A)}},c.prototype.getResultGeometry=function(g){return this.computeOverlay(g),this._resultGeom},c.prototype.insertUniqueEdges=function(g){for(var v=g.iterator();v.hasNext();){var A=v.next();this.insertUniqueEdge(A)}},c.prototype.computeOverlay=function(g){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var v=new Et;this._arg[0].computeSplitEdges(v),this._arg[1].computeSplitEdges(v),this.insertUniqueEdges(v),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Za.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(g),this.cancelDuplicateResultEdges();var A=new Mi(this._geomFact);A.add(this._graph),this._resultPolyList=A.getPolygons();var N=new Ha(this,this._geomFact,this._ptLocator);this._resultLineList=N.build(g);var G=new Su(this,this._geomFact,this._ptLocator);this._resultPointList=G.build(g),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,g)},c.prototype.labelIncompleteNode=function(g,v){var A=this._ptLocator.locate(g.getCoordinate(),this._arg[v].getGeometry());g.getLabel().setLocation(v,A)},c.prototype.copyPoints=function(g){for(var v=this._arg[g].getNodeIterator();v.hasNext();){var A=v.next();this._graph.addNode(A.getCoordinate()).setLabel(g,A.getLabel().getLocation(g))}},c.prototype.findResultAreaEdges=function(g){for(var v=this._graph.getEdgeEnds().iterator();v.hasNext();){var A=v.next(),N=A.getLabel();N.isArea()&&!A.isInteriorAreaEdge()&&c.isResultOfOp(N.getLocation(0,Pt.RIGHT),N.getLocation(1,Pt.RIGHT),g)&&A.setInResult(!0)}},c.prototype.computeLabelsFromDepths=function(){for(var g=this._edgeList.iterator();g.hasNext();){var v=g.next(),A=v.getLabel(),N=v.getDepth();if(!N.isNull()){N.normalize();for(var G=0;G<2;G++)A.isNull(G)||!A.isArea()||N.isNull(G)||(N.getDelta(G)===0?A.toLine(G):(ce.isTrue(!N.isNull(G,Pt.LEFT),"depth of LEFT side has not been initialized"),A.setLocation(G,Pt.LEFT,N.getLocation(G,Pt.LEFT)),ce.isTrue(!N.isNull(G,Pt.RIGHT),"depth of RIGHT side has not been initialized"),A.setLocation(G,Pt.RIGHT,N.getLocation(G,Pt.RIGHT))))}}},c.prototype.computeLabelling=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();)g.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},c.prototype.labelIncompleteNodes=function(){for(var g=this._graph.getNodes().iterator();g.hasNext();){var v=g.next(),A=v.getLabel();v.isIsolated()&&(A.isNull(0)?this.labelIncompleteNode(v,0):this.labelIncompleteNode(v,1)),v.getEdges().updateLabelling(A)}},c.prototype.isCoveredByA=function(g){return!!this.isCovered(g,this._resultPolyList)},c.prototype.interfaces_=function(){return[]},c.prototype.getClass=function(){return c},c}(Us);Kt.overlayOp=function(o,c,g){return new Kt(o,c).getResultGeometry(g)},Kt.intersection=function(o,c){if(o.isEmpty()||c.isEmpty())return Kt.createEmptyResult(Kt.INTERSECTION,o,c,o.getFactory());if(o.isGeometryCollection()){var g=c;return iu.map(o,{interfaces_:function(){return[$n.MapOp]},map:function(v){return v.intersection(g)}})}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(c),Jn.overlayOp(o,c,Kt.INTERSECTION)},Kt.symDifference=function(o,c){if(o.isEmpty()||c.isEmpty()){if(o.isEmpty()&&c.isEmpty())return Kt.createEmptyResult(Kt.SYMDIFFERENCE,o,c,o.getFactory());if(o.isEmpty())return c.copy();if(c.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(c),Jn.overlayOp(o,c,Kt.SYMDIFFERENCE)},Kt.resultDimension=function(o,c,g){var v=c.getDimension(),A=g.getDimension(),N=-1;switch(o){case Kt.INTERSECTION:N=Math.min(v,A);break;case Kt.UNION:N=Math.max(v,A);break;case Kt.DIFFERENCE:N=v;break;case Kt.SYMDIFFERENCE:N=Math.max(v,A)}return N},Kt.createEmptyResult=function(o,c,g,v){var A=null;switch(Kt.resultDimension(o,c,g)){case-1:A=v.createGeometryCollection(new Array(0).fill(null));break;case 0:A=v.createPoint();break;case 1:A=v.createLineString();break;case 2:A=v.createPolygon()}return A},Kt.difference=function(o,c){return o.isEmpty()?Kt.createEmptyResult(Kt.DIFFERENCE,o,c,o.getFactory()):c.isEmpty()?o.copy():(o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(c),Jn.overlayOp(o,c,Kt.DIFFERENCE))},Kt.isResultOfOp=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1],g=o.getLocation(0),v=o.getLocation(1);return Kt.isResultOfOp(g,v,c)}if(arguments.length===3){var A=arguments[0],N=arguments[1],G=arguments[2];switch(A===ae.BOUNDARY&&(A=ae.INTERIOR),N===ae.BOUNDARY&&(N=ae.INTERIOR),G){case Kt.INTERSECTION:return A===ae.INTERIOR&&N===ae.INTERIOR;case Kt.UNION:return A===ae.INTERIOR||N===ae.INTERIOR;case Kt.DIFFERENCE:return A===ae.INTERIOR&&N!==ae.INTERIOR;case Kt.SYMDIFFERENCE:return A===ae.INTERIOR&&N!==ae.INTERIOR||A!==ae.INTERIOR&&N===ae.INTERIOR}return!1}},Kt.INTERSECTION=1,Kt.UNION=2,Kt.DIFFERENCE=3,Kt.SYMDIFFERENCE=4;var $s=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Io,this._seg=new or;var o=arguments[0],c=arguments[1];this._g=o,this._boundaryDistanceTolerance=c,this._linework=this.extractLinework(o)};$s.prototype.isWithinToleranceOfBoundary=function(o){for(var c=0;c<this._linework.getNumGeometries();c++)for(var g=this._linework.getGeometryN(c).getCoordinateSequence(),v=0;v<g.size()-1;v++)if(g.getCoordinate(v,this._seg.p0),g.getCoordinate(v+1,this._seg.p1),this._seg.distance(o)<=this._boundaryDistanceTolerance)return!0;return!1},$s.prototype.getLocation=function(o){return this.isWithinToleranceOfBoundary(o)?ae.BOUNDARY:this._ptLocator.locate(o,this._g)},$s.prototype.extractLinework=function(o){var c=new To;o.apply(c);var g=c.getLinework(),v=Rr.toLineStringArray(g);return o.getFactory().createMultiLineString(v)},$s.prototype.interfaces_=function(){return[]},$s.prototype.getClass=function(){return $s};var To=function(){this._linework=null,this._linework=new Et};To.prototype.getLinework=function(){return this._linework},To.prototype.filter=function(o){if(o instanceof ii){var c=o;this._linework.add(c.getExteriorRing());for(var g=0;g<c.getNumInteriorRing();g++)this._linework.add(c.getInteriorRingN(g))}},To.prototype.interfaces_=function(){return[jt]},To.prototype.getClass=function(){return To};var Qa=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var o=arguments[0];this._g=o};Qa.prototype.extractPoints=function(o,c,g){for(var v=o.getCoordinates(),A=0;A<v.length-1;A++)this.computeOffsetPoints(v[A],v[A+1],c,g)},Qa.prototype.setSidesToGenerate=function(o,c){this._doLeft=o,this._doRight=c},Qa.prototype.getPoints=function(o){for(var c=new Et,g=Kr.getLines(this._g).iterator();g.hasNext();){var v=g.next();this.extractPoints(v,o,c)}return c},Qa.prototype.computeOffsetPoints=function(o,c,g,v){var A=c.x-o.x,N=c.y-o.y,G=Math.sqrt(A*A+N*N),le=g*A/G,xe=g*N/G,x=(c.x+o.x)/2,a=(c.y+o.y)/2;if(this._doLeft){var d=new J(x-xe,a+le);v.add(d)}if(this._doRight){var b=new J(x+xe,a-le);v.add(b)}},Qa.prototype.interfaces_=function(){return[]},Qa.prototype.getClass=function(){return Qa};var lo=function o(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=o.TOLERANCE,this._testCoords=new Et;var c=arguments[0],g=arguments[1],v=arguments[2];this._boundaryDistanceTolerance=o.computeBoundaryDistanceTolerance(c,g),this._geom=[c,g,v],this._locFinder=[new $s(this._geom[0],this._boundaryDistanceTolerance),new $s(this._geom[1],this._boundaryDistanceTolerance),new $s(this._geom[2],this._boundaryDistanceTolerance)]},Fl={TOLERANCE:{configurable:!0}};lo.prototype.reportResult=function(o,c,g){pt.out.println("Overlay result invalid - A:"+ae.toLocationSymbol(c[0])+" B:"+ae.toLocationSymbol(c[1])+" expected:"+(g?"i":"e")+" actual:"+ae.toLocationSymbol(c[2]))},lo.prototype.isValid=function(o){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var c=this.checkValid(o);return c},lo.prototype.checkValid=function(){if(arguments.length===1){for(var o=arguments[0],c=0;c<this._testCoords.size();c++){var g=this._testCoords.get(c);if(!this.checkValid(o,g))return this._invalidLocation=g,!1}return!0}if(arguments.length===2){var v=arguments[0],A=arguments[1];return this._location[0]=this._locFinder[0].getLocation(A),this._location[1]=this._locFinder[1].getLocation(A),this._location[2]=this._locFinder[2].getLocation(A),!!lo.hasLocation(this._location,ae.BOUNDARY)||this.isValidResult(v,this._location)}},lo.prototype.addTestPts=function(o){var c=new Qa(o);this._testCoords.addAll(c.getPoints(5*this._boundaryDistanceTolerance))},lo.prototype.isValidResult=function(o,c){var g=Kt.isResultOfOp(c[0],c[1],o),v=!(g^c[2]===ae.INTERIOR);return v||this.reportResult(o,c,g),v},lo.prototype.getInvalidLocation=function(){return this._invalidLocation},lo.prototype.interfaces_=function(){return[]},lo.prototype.getClass=function(){return lo},lo.hasLocation=function(o,c){for(var g=0;g<3;g++)if(o[g]===c)return!0;return!1},lo.computeBoundaryDistanceTolerance=function(o,c){return Math.min(oi.computeSizeBasedSnapTolerance(o),oi.computeSizeBasedSnapTolerance(c))},lo.isValid=function(o,c,g,v){return new lo(o,c,v).isValid(g)},Fl.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(lo,Fl);var co=function o(c){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=o.extractFactory(c),this._inputGeoms=c};co.prototype.extractElements=function(o,c){if(o===null)return null;for(var g=0;g<o.getNumGeometries();g++){var v=o.getGeometryN(g);this._skipEmpty&&v.isEmpty()||c.add(v)}},co.prototype.combine=function(){for(var o=new Et,c=this._inputGeoms.iterator();c.hasNext();){var g=c.next();this.extractElements(g,o)}return o.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(o)},co.prototype.interfaces_=function(){return[]},co.prototype.getClass=function(){return co},co.combine=function(){if(arguments.length===1){var o=arguments[0];return new co(o).combine()}if(arguments.length===2){var c=arguments[0],g=arguments[1];return new co(co.createList(c,g)).combine()}if(arguments.length===3){var v=arguments[0],A=arguments[1],N=arguments[2];return new co(co.createList(v,A,N)).combine()}},co.extractFactory=function(o){return o.isEmpty()?null:o.iterator().next().getFactory()},co.createList=function(){if(arguments.length===2){var o=arguments[0],c=arguments[1],g=new Et;return g.add(o),g.add(c),g}if(arguments.length===3){var v=arguments[0],A=arguments[1],N=arguments[2],G=new Et;return G.add(v),G.add(A),G.add(N),G}};var ti=function(){this._inputPolys=null,this._geomFactory=null;var o=arguments[0];this._inputPolys=o,this._inputPolys===null&&(this._inputPolys=new Et)},Fu={STRTREE_NODE_CAPACITY:{configurable:!0}};ti.prototype.reduceToGeometries=function(o){for(var c=new Et,g=o.iterator();g.hasNext();){var v=g.next(),A=null;Pe(v,Lr)?A=this.unionTree(v):v instanceof it&&(A=v),c.add(A)}return c},ti.prototype.extractByEnvelope=function(o,c,g){for(var v=new Et,A=0;A<c.getNumGeometries();A++){var N=c.getGeometryN(A);N.getEnvelopeInternal().intersects(o)?v.add(N):g.add(N)}return this._geomFactory.buildGeometry(v)},ti.prototype.unionOptimized=function(o,c){var g=o.getEnvelopeInternal(),v=c.getEnvelopeInternal();if(!g.intersects(v))return co.combine(o,c);if(o.getNumGeometries()<=1&&c.getNumGeometries()<=1)return this.unionActual(o,c);var A=g.intersection(v);return this.unionUsingEnvelopeIntersection(o,c,A)},ti.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var o=new el(ti.STRTREE_NODE_CAPACITY),c=this._inputPolys.iterator();c.hasNext();){var g=c.next();o.insert(g.getEnvelopeInternal(),g)}this._inputPolys=null;var v=o.itemsTree();return this.unionTree(v)},ti.prototype.binaryUnion=function(){if(arguments.length===1){var o=arguments[0];return this.binaryUnion(o,0,o.size())}if(arguments.length===3){var c=arguments[0],g=arguments[1],v=arguments[2];if(v-g<=1){var A=ti.getGeometry(c,g);return this.unionSafe(A,null)}if(v-g==2)return this.unionSafe(ti.getGeometry(c,g),ti.getGeometry(c,g+1));var N=Math.trunc((v+g)/2),G=this.binaryUnion(c,g,N),le=this.binaryUnion(c,N,v);return this.unionSafe(G,le)}},ti.prototype.repeatedUnion=function(o){for(var c=null,g=o.iterator();g.hasNext();){var v=g.next();c=c===null?v.copy():c.union(v)}return c},ti.prototype.unionSafe=function(o,c){return o===null&&c===null?null:o===null?c.copy():c===null?o.copy():this.unionOptimized(o,c)},ti.prototype.unionActual=function(o,c){return ti.restrictToPolygons(o.union(c))},ti.prototype.unionTree=function(o){var c=this.reduceToGeometries(o);return this.binaryUnion(c)},ti.prototype.unionUsingEnvelopeIntersection=function(o,c,g){var v=new Et,A=this.extractByEnvelope(g,o,v),N=this.extractByEnvelope(g,c,v),G=this.unionActual(A,N);return v.add(G),co.combine(v)},ti.prototype.bufferUnion=function(){if(arguments.length===1){var o=arguments[0];return o.get(0).getFactory().buildGeometry(o).buffer(0)}if(arguments.length===2){var c=arguments[0],g=arguments[1];return c.getFactory().createGeometryCollection([c,g]).buffer(0)}},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ti.restrictToPolygons=function(o){if(Pe(o,vi))return o;var c=Di.getPolygons(o);return c.size()===1?c.get(0):o.getFactory().createMultiPolygon(Rr.toPolygonArray(c))},ti.getGeometry=function(o,c){return c>=o.size()?null:o.get(c)},ti.union=function(o){return new ti(o).union()},Fu.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(ti,Fu);var bs=function(){};bs.prototype.interfaces_=function(){return[]},bs.prototype.getClass=function(){return bs},bs.union=function(o,c){if(o.isEmpty()||c.isEmpty()){if(o.isEmpty()&&c.isEmpty())return Kt.createEmptyResult(Kt.UNION,o,c,o.getFactory());if(o.isEmpty())return c.copy();if(c.isEmpty())return o.copy()}return o.checkNotGeometryCollection(o),o.checkNotGeometryCollection(c),Jn.overlayOp(o,c,Kt.UNION)},t.GeoJSONReader=Zs,t.GeoJSONWriter=Qu,t.OverlayOp=Kt,t.UnionOp=bs,t.BufferOp=Vi,Object.defineProperty(t,"__esModule",{value:!0})})})(Jb,Jb.exports);var wY=Jb.exports;function Cc(){return new qm}function qm(){this.reset()}qm.prototype={constructor:qm,reset:function(){this.s=this.t=0},add:function(e){FO(sm,e,this.t),FO(this,sm.s,this.s),this.s?this.t+=sm.t:this.s=sm.t},valueOf:function(){return this.s}};var sm=new qm;function FO(e,r,t){var n=e.s=r+t,i=n-r,l=n-i;e.t=r-l+(t-i)}var Dr=1e-6,kO=1e-12,Vn=Math.PI,Go=Vn/2,Vm=Vn/4,Vs=Vn*2,Wi=180/Vn,jr=Vn/180,si=Math.abs,Df=Math.atan,Ms=Math.atan2,Mr=Math.cos,um=Math.ceil,YD=Math.exp,Xm=Math.log,H1=Math.pow,wr=Math.sin,ud=Math.sign||function(e){return e>0?1:e<0?-1:0},sa=Math.sqrt,oS=Math.tan;function WD(e){return e>1?0:e<-1?Vn:Math.acos(e)}function vu(e){return e>1?Go:e<-1?-Go:Math.asin(e)}function BO(e){return(e=wr(e/2))*e}function go(){}function Ym(e,r){e&&jO.hasOwnProperty(e.type)&&jO[e.type](e,r)}var zO={Feature:function(e,r){Ym(e.geometry,r)},FeatureCollection:function(e,r){for(var t=e.features,n=-1,i=t.length;++n<i;)Ym(t[n].geometry,r)}},jO={Sphere:function(e,r){r.sphere()},Point:function(e,r){e=e.coordinates,r.point(e[0],e[1],e[2])},MultiPoint:function(e,r){for(var t=e.coordinates,n=-1,i=t.length;++n<i;)e=t[n],r.point(e[0],e[1],e[2])},LineString:function(e,r){Kb(e.coordinates,r,0)},MultiLineString:function(e,r){for(var t=e.coordinates,n=-1,i=t.length;++n<i;)Kb(t[n],r,0)},Polygon:function(e,r){UO(e.coordinates,r)},MultiPolygon:function(e,r){for(var t=e.coordinates,n=-1,i=t.length;++n<i;)UO(t[n],r)},GeometryCollection:function(e,r){for(var t=e.geometries,n=-1,i=t.length;++n<i;)Ym(t[n],r)}};function Kb(e,r,t){var n=-1,i=e.length-t,l;for(r.lineStart();++n<i;)l=e[n],r.point(l[0],l[1],l[2]);r.lineEnd()}function UO(e,r){var t=-1,n=e.length;for(r.polygonStart();++t<n;)Kb(e[t],r,1);r.polygonEnd()}function qu(e,r){e&&zO.hasOwnProperty(e.type)?zO[e.type](e,r):Ym(e,r)}var Wm=Cc(),Zm=Cc(),ZD,HD,Qb,ex,tx,bl={point:go,lineStart:go,lineEnd:go,polygonStart:function(){Wm.reset(),bl.lineStart=EY,bl.lineEnd=SY},polygonEnd:function(){var e=+Wm;Zm.add(e<0?Vs+e:e),this.lineStart=this.lineEnd=this.point=go},sphere:function(){Zm.add(Vs)}};function EY(){bl.point=PY}function SY(){JD(ZD,HD)}function PY(e,r){bl.point=JD,ZD=e,HD=r,e*=jr,r*=jr,Qb=e,ex=Mr(r=r/2+Vm),tx=wr(r)}function JD(e,r){e*=jr,r*=jr,r=r/2+Vm;var t=e-Qb,n=t>=0?1:-1,i=n*t,l=Mr(r),p=wr(r),u=tx*p,_=ex*l+u*Mr(i),m=u*n*wr(i);Wm.add(Ms(m,_)),Qb=e,ex=l,tx=p}function AY(e){return Zm.reset(),qu(e,bl),Zm*2}function Hm(e){return[Ms(e[1],e[0]),vu(e[2])]}function ih(e){var r=e[0],t=e[1],n=Mr(t);return[n*Mr(r),n*wr(r),wr(t)]}function lm(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function gf(e,r){return[e[1]*r[2]-e[2]*r[1],e[2]*r[0]-e[0]*r[2],e[0]*r[1]-e[1]*r[0]]}function J1(e,r){e[0]+=r[0],e[1]+=r[1],e[2]+=r[2]}function cm(e,r){return[e[0]*r,e[1]*r,e[2]*r]}function Jm(e){var r=sa(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=r,e[1]/=r,e[2]/=r}var wo,du,Fo,Ru,$c,KD,QD,ff,Yp=Cc(),mc,Zl,Xl={point:rx,lineStart:$O,lineEnd:GO,polygonStart:function(){Xl.point=tN,Xl.lineStart=IY,Xl.lineEnd=OY,Yp.reset(),bl.polygonStart()},polygonEnd:function(){bl.polygonEnd(),Xl.point=rx,Xl.lineStart=$O,Xl.lineEnd=GO,Wm<0?(wo=-(Fo=180),du=-(Ru=90)):Yp>Dr?Ru=90:Yp<-Dr&&(du=-90),Zl[0]=wo,Zl[1]=Fo}};function rx(e,r){mc.push(Zl=[wo=e,Fo=e]),r<du&&(du=r),r>Ru&&(Ru=r)}function eN(e,r){var t=ih([e*jr,r*jr]);if(ff){var n=gf(ff,t),i=[n[1],-n[0],0],l=gf(i,n);Jm(l),l=Hm(l);var p=e-$c,u=p>0?1:-1,_=l[0]*Wi*u,m,S=si(p)>180;S^(u*$c<_&&_<u*e)?(m=l[1]*Wi,m>Ru&&(Ru=m)):(_=(_+360)%360-180,S^(u*$c<_&&_<u*e)?(m=-l[1]*Wi,m<du&&(du=m)):(r<du&&(du=r),r>Ru&&(Ru=r))),S?e<$c?pu(wo,e)>pu(wo,Fo)&&(Fo=e):pu(e,Fo)>pu(wo,Fo)&&(wo=e):Fo>=wo?(e<wo&&(wo=e),e>Fo&&(Fo=e)):e>$c?pu(wo,e)>pu(wo,Fo)&&(Fo=e):pu(e,Fo)>pu(wo,Fo)&&(wo=e)}else mc.push(Zl=[wo=e,Fo=e]);r<du&&(du=r),r>Ru&&(Ru=r),ff=t,$c=e}function $O(){Xl.point=eN}function GO(){Zl[0]=wo,Zl[1]=Fo,Xl.point=rx,ff=null}function tN(e,r){if(ff){var t=e-$c;Yp.add(si(t)>180?t+(t>0?360:-360):t)}else KD=e,QD=r;bl.point(e,r),eN(e,r)}function IY(){bl.lineStart()}function OY(){tN(KD,QD),bl.lineEnd(),si(Yp)>Dr&&(wo=-(Fo=180)),Zl[0]=wo,Zl[1]=Fo,ff=null}function pu(e,r){return(r-=e)<0?r+360:r}function CY(e,r){return e[0]-r[0]}function qO(e,r){return e[0]<=e[1]?e[0]<=r&&r<=e[1]:r<e[0]||e[1]<r}function TY(e){var r,t,n,i,l,p,u;if(Ru=Fo=-(wo=du=1/0),mc=[],qu(e,Xl),t=mc.length){for(mc.sort(CY),r=1,n=mc[0],l=[n];r<t;++r)i=mc[r],qO(n,i[0])||qO(n,i[1])?(pu(n[0],i[1])>pu(n[0],n[1])&&(n[1]=i[1]),pu(i[0],n[1])>pu(n[0],n[1])&&(n[0]=i[0])):l.push(n=i);for(p=-1/0,t=l.length-1,r=0,n=l[t];r<=t;n=i,++r)i=l[r],(u=pu(n[1],i[0]))>p&&(p=u,wo=i[0],Fo=n[1])}return mc=Zl=null,wo===1/0||du===1/0?[[NaN,NaN],[NaN,NaN]]:[[wo,du],[Fo,Ru]]}var Np,Km,Qm,ev,tv,rv,nv,iv,nx,ix,ox,rN,nN,Is,Os,Cs,Vu={sphere:go,point:aS,lineStart:VO,lineEnd:XO,polygonStart:function(){Vu.lineStart=RY,Vu.lineEnd=DY},polygonEnd:function(){Vu.lineStart=VO,Vu.lineEnd=XO}};function aS(e,r){e*=jr,r*=jr;var t=Mr(r);Md(t*Mr(e),t*wr(e),wr(r))}function Md(e,r,t){++Np,Qm+=(e-Qm)/Np,ev+=(r-ev)/Np,tv+=(t-tv)/Np}function VO(){Vu.point=MY}function MY(e,r){e*=jr,r*=jr;var t=Mr(r);Is=t*Mr(e),Os=t*wr(e),Cs=wr(r),Vu.point=LY,Md(Is,Os,Cs)}function LY(e,r){e*=jr,r*=jr;var t=Mr(r),n=t*Mr(e),i=t*wr(e),l=wr(r),p=Ms(sa((p=Os*l-Cs*i)*p+(p=Cs*n-Is*l)*p+(p=Is*i-Os*n)*p),Is*n+Os*i+Cs*l);Km+=p,rv+=p*(Is+(Is=n)),nv+=p*(Os+(Os=i)),iv+=p*(Cs+(Cs=l)),Md(Is,Os,Cs)}function XO(){Vu.point=aS}function RY(){Vu.point=NY}function DY(){iN(rN,nN),Vu.point=aS}function NY(e,r){rN=e,nN=r,e*=jr,r*=jr,Vu.point=iN;var t=Mr(r);Is=t*Mr(e),Os=t*wr(e),Cs=wr(r),Md(Is,Os,Cs)}function iN(e,r){e*=jr,r*=jr;var t=Mr(r),n=t*Mr(e),i=t*wr(e),l=wr(r),p=Os*l-Cs*i,u=Cs*n-Is*l,_=Is*i-Os*n,m=sa(p*p+u*u+_*_),S=vu(m),P=m&&-S/m;nx+=P*p,ix+=P*u,ox+=P*_,Km+=S,rv+=S*(Is+(Is=n)),nv+=S*(Os+(Os=i)),iv+=S*(Cs+(Cs=l)),Md(Is,Os,Cs)}function FY(e){Np=Km=Qm=ev=tv=rv=nv=iv=nx=ix=ox=0,qu(e,Vu);var r=nx,t=ix,n=ox,i=r*r+t*t+n*n;return i<kO&&(r=rv,t=nv,n=iv,Km<Dr&&(r=Qm,t=ev,n=tv),i=r*r+t*t+n*n,i<kO)?[NaN,NaN]:[Ms(t,r)*Wi,vu(n/sa(i))*Wi]}function Hh(e){return function(){return e}}function oN(e,r){function t(n,i){return n=e(n,i),r(n[0],n[1])}return e.invert&&r.invert&&(t.invert=function(n,i){return n=r.invert(n,i),n&&e.invert(n[0],n[1])}),t}function ax(e,r){return[e>Vn?e-Vs:e<-Vn?e+Vs:e,r]}ax.invert=ax;function sS(e,r,t){return(e%=Vs)?r||t?oN(WO(e),ZO(r,t)):WO(e):r||t?ZO(r,t):ax}function YO(e){return function(r,t){return r+=e,[r>Vn?r-Vs:r<-Vn?r+Vs:r,t]}}function WO(e){var r=YO(e);return r.invert=YO(-e),r}function ZO(e,r){var t=Mr(e),n=wr(e),i=Mr(r),l=wr(r);function p(u,_){var m=Mr(_),S=Mr(u)*m,P=wr(u)*m,O=wr(_),M=O*t+S*n;return[Ms(P*i-M*l,S*t-O*n),vu(M*i+P*l)]}return p.invert=function(u,_){var m=Mr(_),S=Mr(u)*m,P=wr(u)*m,O=wr(_),M=O*i-P*l;return[Ms(P*i+O*l,S*t+M*n),vu(M*t-S*n)]},p}function aN(e){e=sS(e[0]*jr,e[1]*jr,e.length>2?e[2]*jr:0);function r(t){return t=e(t[0]*jr,t[1]*jr),t[0]*=Wi,t[1]*=Wi,t}return r.invert=function(t){return t=e.invert(t[0]*jr,t[1]*jr),t[0]*=Wi,t[1]*=Wi,t},r}function sN(e,r,t,n,i,l){if(t){var p=Mr(r),u=wr(r),_=n*t;i==null?(i=r+n*Vs,l=r-_/2):(i=HO(p,i),l=HO(p,l),(n>0?i<l:i>l)&&(i+=n*Vs));for(var m,S=i;n>0?S>l:S<l;S-=_)m=Hm([p,-u*Mr(S),-u*wr(S)]),e.point(m[0],m[1])}}function HO(e,r){r=ih(r),r[0]-=e,Jm(r);var t=WD(-r[1]);return((-r[2]<0?-t:t)+Vs-Dr)%Vs}function kY(){var e=Hh([0,0]),r=Hh(90),t=Hh(6),n,i,l={point:p};function p(_,m){n.push(_=i(_,m)),_[0]*=Wi,_[1]*=Wi}function u(){var _=e.apply(this,arguments),m=r.apply(this,arguments)*jr,S=t.apply(this,arguments)*jr;return n=[],i=sS(-_[0]*jr,-_[1]*jr,0).invert,sN(l,m,S,1),_={type:"Polygon",coordinates:[n]},n=i=null,_}return u.center=function(_){return arguments.length?(e=typeof _=="function"?_:Hh([+_[0],+_[1]]),u):e},u.radius=function(_){return arguments.length?(r=typeof _=="function"?_:Hh(+_),u):r},u.precision=function(_){return arguments.length?(t=typeof _=="function"?_:Hh(+_),u):t},u}function uN(){var e=[],r;return{point:function(t,n){r.push([t,n])},lineStart:function(){e.push(r=[])},lineEnd:go,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var t=e;return e=[],r=null,t}}}function BY(e,r,t,n,i,l){var p=e[0],u=e[1],_=r[0],m=r[1],S=0,P=1,O=_-p,M=m-u,B;if(B=t-p,!(!O&&B>0)){if(B/=O,O<0){if(B<S)return;B<P&&(P=B)}else if(O>0){if(B>P)return;B>S&&(S=B)}if(B=i-p,!(!O&&B<0)){if(B/=O,O<0){if(B>P)return;B>S&&(S=B)}else if(O>0){if(B<S)return;B<P&&(P=B)}if(B=n-u,!(!M&&B>0)){if(B/=M,M<0){if(B<S)return;B<P&&(P=B)}else if(M>0){if(B>P)return;B>S&&(S=B)}if(B=l-u,!(!M&&B<0)){if(B/=M,M<0){if(B>P)return;B>S&&(S=B)}else if(M>0){if(B<S)return;B<P&&(P=B)}return S>0&&(e[0]=p+S*O,e[1]=u+S*M),P<1&&(r[0]=p+P*O,r[1]=u+P*M),!0}}}}}function Im(e,r){return si(e[0]-r[0])<Dr&&si(e[1]-r[1])<Dr}function hm(e,r,t,n){this.x=e,this.z=r,this.o=t,this.e=n,this.v=!1,this.n=this.p=null}function lN(e,r,t,n,i){var l=[],p=[],u,_;if(e.forEach(function(B){if(!(($=B.length-1)<=0)){var $,q=B[0],X=B[$],R;if(Im(q,X)){for(i.lineStart(),u=0;u<$;++u)i.point((q=B[u])[0],q[1]);i.lineEnd();return}l.push(R=new hm(q,B,null,!0)),p.push(R.o=new hm(q,null,R,!1)),l.push(R=new hm(X,B,null,!1)),p.push(R.o=new hm(X,null,R,!0))}}),!!l.length){for(p.sort(r),JO(l),JO(p),u=0,_=p.length;u<_;++u)p[u].e=t=!t;for(var m=l[0],S,P;;){for(var O=m,M=!0;O.v;)if((O=O.n)===m)return;S=O.z,i.lineStart();do{if(O.v=O.o.v=!0,O.e){if(M)for(u=0,_=S.length;u<_;++u)i.point((P=S[u])[0],P[1]);else n(O.x,O.n.x,1,i);O=O.n}else{if(M)for(S=O.p.z,u=S.length-1;u>=0;--u)i.point((P=S[u])[0],P[1]);else n(O.x,O.p.x,-1,i);O=O.p}O=O.o,S=O.z,M=!M}while(!O.v);i.lineEnd()}}}function JO(e){if(r=e.length){for(var r,t=0,n=e[0],i;++t<r;)n.n=i=e[t],i.p=n,n=i;n.n=i=e[0],i.p=n}}function cN(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function zY(e){return e.length===1&&(e=jY(e)),{left:function(r,t,n,i){for(n==null&&(n=0),i==null&&(i=r.length);n<i;){var l=n+i>>>1;e(r[l],t)<0?n=l+1:i=l}return n},right:function(r,t,n,i){for(n==null&&(n=0),i==null&&(i=r.length);n<i;){var l=n+i>>>1;e(r[l],t)>0?i=l:n=l+1}return n}}}function jY(e){return function(r,t){return cN(e(r),t)}}zY(cN);function sf(e,r,t){e=+e,r=+r,t=(i=arguments.length)<2?(r=e,e=0,1):i<3?1:+t;for(var n=-1,i=Math.max(0,Math.ceil((r-e)/t))|0,l=new Array(i);++n<i;)l[n]=e+n*t;return l}function hN(e){for(var r=e.length,t,n=-1,i=0,l,p;++n<r;)i+=e[n].length;for(l=new Array(i);--r>=0;)for(p=e[r],t=p.length;--t>=0;)l[--i]=p[t];return l}var Fp=1e9,fm=-Fp;function uS(e,r,t,n){function i(m,S){return e<=m&&m<=t&&r<=S&&S<=n}function l(m,S,P,O){var M=0,B=0;if(m==null||(M=p(m,P))!==(B=p(S,P))||_(m,S)<0^P>0)do O.point(M===0||M===3?e:t,M>1?n:r);while((M=(M+P+4)%4)!==B);else O.point(S[0],S[1])}function p(m,S){return si(m[0]-e)<Dr?S>0?0:3:si(m[0]-t)<Dr?S>0?2:1:si(m[1]-r)<Dr?S>0?1:0:S>0?3:2}function u(m,S){return _(m.x,S.x)}function _(m,S){var P=p(m,1),O=p(S,1);return P!==O?P-O:P===0?S[1]-m[1]:P===1?m[0]-S[0]:P===2?m[1]-S[1]:S[0]-m[0]}return function(m){var S=m,P=uN(),O,M,B,$,q,X,R,k,U,H,ue,ie={point:ee,lineStart:Oe,lineEnd:Ae,polygonStart:J,polygonEnd:be};function ee(ct,Pe){i(ct,Pe)&&S.point(ct,Pe)}function W(){for(var ct=0,Pe=0,V=M.length;Pe<V;++Pe)for(var Q=M[Pe],he=1,fe=Q.length,ye=Q[0],se,De,ke=ye[0],We=ye[1];he<fe;++he)se=ke,De=We,ye=Q[he],ke=ye[0],We=ye[1],De<=n?We>n&&(ke-se)*(n-De)>(We-De)*(e-se)&&++ct:We<=n&&(ke-se)*(n-De)<(We-De)*(e-se)&&--ct;return ct}function J(){S=P,O=[],M=[],ue=!0}function be(){var ct=W(),Pe=ue&&ct,V=(O=hN(O)).length;(Pe||V)&&(m.polygonStart(),Pe&&(m.lineStart(),l(null,null,1,m),m.lineEnd()),V&&lN(O,u,ct,l,m),m.polygonEnd()),S=m,O=M=B=null}function Oe(){ie.point=ae,M&&M.push(B=[]),H=!0,U=!1,R=k=NaN}function Ae(){O&&(ae($,q),X&&U&&P.rejoin(),O.push(P.result())),ie.point=ee,U&&S.lineEnd()}function ae(ct,Pe){var V=i(ct,Pe);if(M&&B.push([ct,Pe]),H)$=ct,q=Pe,X=V,H=!1,V&&(S.lineStart(),S.point(ct,Pe));else if(V&&U)S.point(ct,Pe);else{var Q=[R=Math.max(fm,Math.min(Fp,R)),k=Math.max(fm,Math.min(Fp,k))],he=[ct=Math.max(fm,Math.min(Fp,ct)),Pe=Math.max(fm,Math.min(Fp,Pe))];BY(Q,he,e,r,t,n)?(U||(S.lineStart(),S.point(Q[0],Q[1])),S.point(he[0],he[1]),V||S.lineEnd(),ue=!1):V&&(S.lineStart(),S.point(ct,Pe),ue=!1)}R=ct,k=Pe,U=V}return ie}}function UY(){var e=0,r=0,t=960,n=500,i,l,p;return p={stream:function(u){return i&&l===u?i:i=uS(e,r,t,n)(l=u)},extent:function(u){return arguments.length?(e=+u[0][0],r=+u[0][1],t=+u[1][0],n=+u[1][1],i=l=null,p):[[e,r],[t,n]]}}}var K1=Cc();function fN(e,r){var t=r[0],n=r[1],i=[wr(t),-Mr(t),0],l=0,p=0;K1.reset();for(var u=0,_=e.length;u<_;++u)if(S=(m=e[u]).length)for(var m,S,P=m[S-1],O=P[0],M=P[1]/2+Vm,B=wr(M),$=Mr(M),q=0;q<S;++q,O=R,B=U,$=H,P=X){var X=m[q],R=X[0],k=X[1]/2+Vm,U=wr(k),H=Mr(k),ue=R-O,ie=ue>=0?1:-1,ee=ie*ue,W=ee>Vn,J=B*U;if(K1.add(Ms(J*ie*wr(ee),$*H+J*Mr(ee))),l+=W?ue+ie*Vs:ue,W^O>=t^R>=t){var be=gf(ih(P),ih(X));Jm(be);var Oe=gf(i,be);Jm(Oe);var Ae=(W^ue>=0?-1:1)*vu(Oe[2]);(n>Ae||n===Ae&&(be[0]||be[1]))&&(p+=W^ue>=0?1:-1)}}return(l<-Dr||l<Dr&&K1<-Dr)^p&1}var sx=Cc(),ux,Om,Cm,mf={sphere:go,point:go,lineStart:$Y,lineEnd:go,polygonStart:go,polygonEnd:go};function $Y(){mf.point=qY,mf.lineEnd=GY}function GY(){mf.point=mf.lineEnd=go}function qY(e,r){e*=jr,r*=jr,ux=e,Om=wr(r),Cm=Mr(r),mf.point=VY}function VY(e,r){e*=jr,r*=jr;var t=wr(r),n=Mr(r),i=si(e-ux),l=Mr(i),p=wr(i),u=n*p,_=Cm*t-Om*n*l,m=Om*t+Cm*n*l;sx.add(Ms(sa(u*u+_*_),m)),ux=e,Om=t,Cm=n}function pN(e){return sx.reset(),qu(e,mf),+sx}var lx=[null,null],XY={type:"LineString",coordinates:lx};function Wp(e,r){return lx[0]=e,lx[1]=r,pN(XY)}var KO={Feature:function(e,r){return ov(e.geometry,r)},FeatureCollection:function(e,r){for(var t=e.features,n=-1,i=t.length;++n<i;)if(ov(t[n].geometry,r))return!0;return!1}},QO={Sphere:function(){return!0},Point:function(e,r){return eC(e.coordinates,r)},MultiPoint:function(e,r){for(var t=e.coordinates,n=-1,i=t.length;++n<i;)if(eC(t[n],r))return!0;return!1},LineString:function(e,r){return tC(e.coordinates,r)},MultiLineString:function(e,r){for(var t=e.coordinates,n=-1,i=t.length;++n<i;)if(tC(t[n],r))return!0;return!1},Polygon:function(e,r){return rC(e.coordinates,r)},MultiPolygon:function(e,r){for(var t=e.coordinates,n=-1,i=t.length;++n<i;)if(rC(t[n],r))return!0;return!1},GeometryCollection:function(e,r){for(var t=e.geometries,n=-1,i=t.length;++n<i;)if(ov(t[n],r))return!0;return!1}};function ov(e,r){return e&&QO.hasOwnProperty(e.type)?QO[e.type](e,r):!1}function eC(e,r){return Wp(e,r)===0}function tC(e,r){var t=Wp(e[0],e[1]),n=Wp(e[0],r),i=Wp(r,e[1]);return n+i<=t+Dr}function rC(e,r){return!!fN(e.map(YY),dN(r))}function YY(e){return e=e.map(dN),e.pop(),e}function dN(e){return[e[0]*jr,e[1]*jr]}function WY(e,r){return(e&&KO.hasOwnProperty(e.type)?KO[e.type]:ov)(e,r)}function nC(e,r,t){var n=sf(e,r-Dr,t).concat(r);return function(i){return n.map(function(l){return[i,l]})}}function iC(e,r,t){var n=sf(e,r-Dr,t).concat(r);return function(i){return n.map(function(l){return[l,i]})}}function gN(){var e,r,t,n,i,l,p,u,_=10,m=_,S=90,P=360,O,M,B,$,q=2.5;function X(){return{type:"MultiLineString",coordinates:R()}}function R(){return sf(um(n/S)*S,t,S).map(B).concat(sf(um(u/P)*P,p,P).map($)).concat(sf(um(r/_)*_,e,_).filter(function(k){return si(k%S)>Dr}).map(O)).concat(sf(um(l/m)*m,i,m).filter(function(k){return si(k%P)>Dr}).map(M))}return X.lines=function(){return R().map(function(k){return{type:"LineString",coordinates:k}})},X.outline=function(){return{type:"Polygon",coordinates:[B(n).concat($(p).slice(1),B(t).reverse().slice(1),$(u).reverse().slice(1))]}},X.extent=function(k){return arguments.length?X.extentMajor(k).extentMinor(k):X.extentMinor()},X.extentMajor=function(k){return arguments.length?(n=+k[0][0],t=+k[1][0],u=+k[0][1],p=+k[1][1],n>t&&(k=n,n=t,t=k),u>p&&(k=u,u=p,p=k),X.precision(q)):[[n,u],[t,p]]},X.extentMinor=function(k){return arguments.length?(r=+k[0][0],e=+k[1][0],l=+k[0][1],i=+k[1][1],r>e&&(k=r,r=e,e=k),l>i&&(k=l,l=i,i=k),X.precision(q)):[[r,l],[e,i]]},X.step=function(k){return arguments.length?X.stepMajor(k).stepMinor(k):X.stepMinor()},X.stepMajor=function(k){return arguments.length?(S=+k[0],P=+k[1],X):[S,P]},X.stepMinor=function(k){return arguments.length?(_=+k[0],m=+k[1],X):[_,m]},X.precision=function(k){return arguments.length?(q=+k,O=nC(l,i,90),M=iC(r,e,q),B=nC(u,p,90),$=iC(n,t,q),X):q},X.extentMajor([[-180,-90+Dr],[180,90-Dr]]).extentMinor([[-180,-80-Dr],[180,80+Dr]])}function ZY(){return gN()()}function HY(e,r){var t=e[0]*jr,n=e[1]*jr,i=r[0]*jr,l=r[1]*jr,p=Mr(n),u=wr(n),_=Mr(l),m=wr(l),S=p*Mr(t),P=p*wr(t),O=_*Mr(i),M=_*wr(i),B=2*vu(sa(BO(l-n)+p*_*BO(i-t))),$=wr(B),q=B?function(X){var R=wr(X*=B)/$,k=wr(B-X)/$,U=k*S+R*O,H=k*P+R*M,ue=k*u+R*m;return[Ms(H,U)*Wi,Ms(ue,sa(U*U+H*H))*Wi]}:function(){return[t*Wi,n*Wi]};return q.distance=B,q}function Hc(e){return e}var Q1=Cc(),cx=Cc(),mN,vN,hx,fx,Wl={point:go,lineStart:go,lineEnd:go,polygonStart:function(){Wl.lineStart=JY,Wl.lineEnd=QY},polygonEnd:function(){Wl.lineStart=Wl.lineEnd=Wl.point=go,Q1.add(si(cx)),cx.reset()},result:function(){var e=Q1/2;return Q1.reset(),e}};function JY(){Wl.point=KY}function KY(e,r){Wl.point=yN,mN=hx=e,vN=fx=r}function yN(e,r){cx.add(fx*e-hx*r),hx=e,fx=r}function QY(){yN(mN,vN)}var vf=1/0,av=vf,ld=-vf,sv=ld,uv={point:eW,lineStart:go,lineEnd:go,polygonStart:go,polygonEnd:go,result:function(){var e=[[vf,av],[ld,sv]];return ld=sv=-(av=vf=1/0),e}};function eW(e,r){e<vf&&(vf=e),e>ld&&(ld=e),r<av&&(av=r),r>sv&&(sv=r)}var px=0,dx=0,kp=0,lv=0,cv=0,uf=0,gx=0,mx=0,Bp=0,_N,bN,ml,vl,Du={point:oh,lineStart:oC,lineEnd:aC,polygonStart:function(){Du.lineStart=nW,Du.lineEnd=iW},polygonEnd:function(){Du.point=oh,Du.lineStart=oC,Du.lineEnd=aC},result:function(){var e=Bp?[gx/Bp,mx/Bp]:uf?[lv/uf,cv/uf]:kp?[px/kp,dx/kp]:[NaN,NaN];return px=dx=kp=lv=cv=uf=gx=mx=Bp=0,e}};function oh(e,r){px+=e,dx+=r,++kp}function oC(){Du.point=tW}function tW(e,r){Du.point=rW,oh(ml=e,vl=r)}function rW(e,r){var t=e-ml,n=r-vl,i=sa(t*t+n*n);lv+=i*(ml+e)/2,cv+=i*(vl+r)/2,uf+=i,oh(ml=e,vl=r)}function aC(){Du.point=oh}function nW(){Du.point=oW}function iW(){xN(_N,bN)}function oW(e,r){Du.point=xN,oh(_N=ml=e,bN=vl=r)}function xN(e,r){var t=e-ml,n=r-vl,i=sa(t*t+n*n);lv+=i*(ml+e)/2,cv+=i*(vl+r)/2,uf+=i,i=vl*e-ml*r,gx+=i*(ml+e),mx+=i*(vl+r),Bp+=i*3,oh(ml=e,vl=r)}function wN(e){this._context=e}wN.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,r){switch(this._point){case 0:{this._context.moveTo(e,r),this._point=1;break}case 1:{this._context.lineTo(e,r);break}default:{this._context.moveTo(e+this._radius,r),this._context.arc(e,r,this._radius,0,Vs);break}}},result:go};var vx=Cc(),eb,EN,SN,zp,jp,cd={point:go,lineStart:function(){cd.point=aW},lineEnd:function(){eb&&PN(EN,SN),cd.point=go},polygonStart:function(){eb=!0},polygonEnd:function(){eb=null},result:function(){var e=+vx;return vx.reset(),e}};function aW(e,r){cd.point=PN,EN=zp=e,SN=jp=r}function PN(e,r){zp-=e,jp-=r,vx.add(sa(zp*zp+jp*jp)),zp=e,jp=r}function AN(){this._string=[]}AN.prototype={_radius:4.5,_circle:sC(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,r){switch(this._point){case 0:{this._string.push("M",e,",",r),this._point=1;break}case 1:{this._string.push("L",e,",",r);break}default:{this._circle==null&&(this._circle=sC(this._radius)),this._string.push("M",e,",",r,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function sC(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function sW(e,r){var t=4.5,n,i;function l(p){return p&&(typeof t=="function"&&i.pointRadius(+t.apply(this,arguments)),qu(p,n(i))),i.result()}return l.area=function(p){return qu(p,n(Wl)),Wl.result()},l.measure=function(p){return qu(p,n(cd)),cd.result()},l.bounds=function(p){return qu(p,n(uv)),uv.result()},l.centroid=function(p){return qu(p,n(Du)),Du.result()},l.projection=function(p){return arguments.length?(n=p==null?(e=null,Hc):(e=p).stream,l):e},l.context=function(p){return arguments.length?(i=p==null?(r=null,new AN):new wN(r=p),typeof t!="function"&&i.pointRadius(t),l):r},l.pointRadius=function(p){return arguments.length?(t=typeof p=="function"?p:(i.pointRadius(+p),+p),l):t},l.projection(e).context(r)}function IN(e,r,t,n){return function(i,l){var p=r(l),u=i.invert(n[0],n[1]),_=uN(),m=r(_),S=!1,P,O,M,B={point:$,lineStart:X,lineEnd:R,polygonStart:function(){B.point=k,B.lineStart=U,B.lineEnd=H,O=[],P=[]},polygonEnd:function(){B.point=$,B.lineStart=X,B.lineEnd=R,O=hN(O);var ue=fN(P,u);O.length?(S||(l.polygonStart(),S=!0),lN(O,lW,ue,t,l)):ue&&(S||(l.polygonStart(),S=!0),l.lineStart(),t(null,null,1,l),l.lineEnd()),S&&(l.polygonEnd(),S=!1),O=P=null},sphere:function(){l.polygonStart(),l.lineStart(),t(null,null,1,l),l.lineEnd(),l.polygonEnd()}};function $(ue,ie){var ee=i(ue,ie);e(ue=ee[0],ie=ee[1])&&l.point(ue,ie)}function q(ue,ie){var ee=i(ue,ie);p.point(ee[0],ee[1])}function X(){B.point=q,p.lineStart()}function R(){B.point=$,p.lineEnd()}function k(ue,ie){M.push([ue,ie]);var ee=i(ue,ie);m.point(ee[0],ee[1])}function U(){m.lineStart(),M=[]}function H(){k(M[0][0],M[0][1]),m.lineEnd();var ue=m.clean(),ie=_.result(),ee,W=ie.length,J,be,Oe;if(M.pop(),P.push(M),M=null,!!W){if(ue&1){if(be=ie[0],(J=be.length-1)>0){for(S||(l.polygonStart(),S=!0),l.lineStart(),ee=0;ee<J;++ee)l.point((Oe=be[ee])[0],Oe[1]);l.lineEnd()}return}W>1&&ue&2&&ie.push(ie.pop().concat(ie.shift())),O.push(ie.filter(uW))}}return B}}function uW(e){return e.length>1}function lW(e,r){return((e=e.x)[0]<0?e[1]-Go-Dr:Go-e[1])-((r=r.x)[0]<0?r[1]-Go-Dr:Go-r[1])}const uC=IN(function(){return!0},cW,fW,[-Vn,-Go]);function cW(e){var r=NaN,t=NaN,n=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(l,p){var u=l>0?Vn:-Vn,_=si(l-r);si(_-Vn)<Dr?(e.point(r,t=(t+p)/2>0?Go:-Go),e.point(n,t),e.lineEnd(),e.lineStart(),e.point(u,t),e.point(l,t),i=0):n!==u&&_>=Vn&&(si(r-n)<Dr&&(r-=n*Dr),si(l-u)<Dr&&(l-=u*Dr),t=hW(r,t,l,p),e.point(n,t),e.lineEnd(),e.lineStart(),e.point(u,t),i=0),e.point(r=l,t=p),n=u},lineEnd:function(){e.lineEnd(),r=t=NaN},clean:function(){return 2-i}}}function hW(e,r,t,n){var i,l,p=wr(e-t);return si(p)>Dr?Df((wr(r)*(l=Mr(n))*wr(t)-wr(n)*(i=Mr(r))*wr(e))/(i*l*p)):(r+n)/2}function fW(e,r,t,n){var i;if(e==null)i=t*Go,n.point(-Vn,i),n.point(0,i),n.point(Vn,i),n.point(Vn,0),n.point(Vn,-i),n.point(0,-i),n.point(-Vn,-i),n.point(-Vn,0),n.point(-Vn,i);else if(si(e[0]-r[0])>Dr){var l=e[0]<r[0]?Vn:-Vn;i=t*l/2,n.point(-l,i),n.point(0,i),n.point(l,i)}else n.point(r[0],r[1])}function pW(e,r){var t=Mr(e),n=t>0,i=si(t)>Dr;function l(S,P,O,M){sN(M,e,r,O,S,P)}function p(S,P){return Mr(S)*Mr(P)>t}function u(S){var P,O,M,B,$;return{lineStart:function(){B=M=!1,$=1},point:function(q,X){var R=[q,X],k,U=p(q,X),H=n?U?0:m(q,X):U?m(q+(q<0?Vn:-Vn),X):0;if(!P&&(B=M=U)&&S.lineStart(),U!==M&&(k=_(P,R),(!k||Im(P,k)||Im(R,k))&&(R[0]+=Dr,R[1]+=Dr,U=p(R[0],R[1]))),U!==M)$=0,U?(S.lineStart(),k=_(R,P),S.point(k[0],k[1])):(k=_(P,R),S.point(k[0],k[1]),S.lineEnd()),P=k;else if(i&&P&&n^U){var ue;!(H&O)&&(ue=_(R,P,!0))&&($=0,n?(S.lineStart(),S.point(ue[0][0],ue[0][1]),S.point(ue[1][0],ue[1][1]),S.lineEnd()):(S.point(ue[1][0],ue[1][1]),S.lineEnd(),S.lineStart(),S.point(ue[0][0],ue[0][1])))}U&&(!P||!Im(P,R))&&S.point(R[0],R[1]),P=R,M=U,O=H},lineEnd:function(){M&&S.lineEnd(),P=null},clean:function(){return $|(B&&M)<<1}}}function _(S,P,O){var M=ih(S),B=ih(P),$=[1,0,0],q=gf(M,B),X=lm(q,q),R=q[0],k=X-R*R;if(!k)return!O&&S;var U=t*X/k,H=-t*R/k,ue=gf($,q),ie=cm($,U),ee=cm(q,H);J1(ie,ee);var W=ue,J=lm(ie,W),be=lm(W,W),Oe=J*J-be*(lm(ie,ie)-1);if(!(Oe<0)){var Ae=sa(Oe),ae=cm(W,(-J-Ae)/be);if(J1(ae,ie),ae=Hm(ae),!O)return ae;var ct=S[0],Pe=P[0],V=S[1],Q=P[1],he;Pe<ct&&(he=ct,ct=Pe,Pe=he);var fe=Pe-ct,ye=si(fe-Vn)<Dr,se=ye||fe<Dr;if(!ye&&Q<V&&(he=V,V=Q,Q=he),se?ye?V+Q>0^ae[1]<(si(ae[0]-ct)<Dr?V:Q):V<=ae[1]&&ae[1]<=Q:fe>Vn^(ct<=ae[0]&&ae[0]<=Pe)){var De=cm(W,(-J+Ae)/be);return J1(De,ie),[ae,Hm(De)]}}}function m(S,P){var O=n?e:Vn-e,M=0;return S<-O?M|=1:S>O&&(M|=2),P<-O?M|=4:P>O&&(M|=8),M}return IN(p,u,l,n?[0,-e]:[-Vn,e-Vn])}function dW(e){return{stream:Jv(e)}}function Jv(e){return function(r){var t=new yx;for(var n in e)t[n]=e[n];return t.stream=r,t}}function yx(){}yx.prototype={constructor:yx,point:function(e,r){this.stream.point(e,r)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Kv(e,r,t){var n=r[1][0]-r[0][0],i=r[1][1]-r[0][1],l=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),l!=null&&e.clipExtent(null),qu(t,e.stream(uv));var p=uv.result(),u=Math.min(n/(p[1][0]-p[0][0]),i/(p[1][1]-p[0][1])),_=+r[0][0]+(n-u*(p[1][0]+p[0][0]))/2,m=+r[0][1]+(i-u*(p[1][1]+p[0][1]))/2;return l!=null&&e.clipExtent(l),e.scale(u*150).translate([_,m])}function lS(e,r,t){return Kv(e,[[0,0],r],t)}var lC=16,gW=Mr(30*jr);function cC(e,r){return+r?vW(e,r):mW(e)}function mW(e){return Jv({point:function(r,t){r=e(r,t),this.stream.point(r[0],r[1])}})}function vW(e,r){function t(n,i,l,p,u,_,m,S,P,O,M,B,$,q){var X=m-n,R=S-i,k=X*X+R*R;if(k>4*r&&$--){var U=p+O,H=u+M,ue=_+B,ie=sa(U*U+H*H+ue*ue),ee=vu(ue/=ie),W=si(si(ue)-1)<Dr||si(l-P)<Dr?(l+P)/2:Ms(H,U),J=e(W,ee),be=J[0],Oe=J[1],Ae=be-n,ae=Oe-i,ct=R*Ae-X*ae;(ct*ct/k>r||si((X*Ae+R*ae)/k-.5)>.3||p*O+u*M+_*B<gW)&&(t(n,i,l,p,u,_,be,Oe,W,U/=ie,H/=ie,ue,$,q),q.point(be,Oe),t(be,Oe,W,U,H,ue,m,S,P,O,M,B,$,q))}}return function(n){var i,l,p,u,_,m,S,P,O,M,B,$,q={point:X,lineStart:R,lineEnd:U,polygonStart:function(){n.polygonStart(),q.lineStart=H},polygonEnd:function(){n.polygonEnd(),q.lineStart=R}};function X(ee,W){ee=e(ee,W),n.point(ee[0],ee[1])}function R(){P=NaN,q.point=k,n.lineStart()}function k(ee,W){var J=ih([ee,W]),be=e(ee,W);t(P,O,S,M,B,$,P=be[0],O=be[1],S=ee,M=J[0],B=J[1],$=J[2],lC,n),n.point(P,O)}function U(){q.point=X,n.lineEnd()}function H(){R(),q.point=ue,q.lineEnd=ie}function ue(ee,W){k(i=ee,W),l=P,p=O,u=M,_=B,m=$,q.point=k}function ie(){t(P,O,S,M,B,$,l,p,i,u,_,m,lC,n),q.lineEnd=U,U()}return q}}var yW=Jv({point:function(e,r){this.stream.point(e*jr,r*jr)}});function ec(e){return cS(function(){return e})()}function cS(e){var r,t=150,n=480,i=250,l,p,u=0,_=0,m=0,S=0,P=0,O,M,B=null,$=uC,q=null,X,R,k,U=Hc,H=.5,ue=cC(be,H),ie,ee;function W(ae){return ae=M(ae[0]*jr,ae[1]*jr),[ae[0]*t+l,p-ae[1]*t]}function J(ae){return ae=M.invert((ae[0]-l)/t,(p-ae[1])/t),ae&&[ae[0]*Wi,ae[1]*Wi]}function be(ae,ct){return ae=r(ae,ct),[ae[0]*t+l,p-ae[1]*t]}W.stream=function(ae){return ie&&ee===ae?ie:ie=yW($(O,ue(U(ee=ae))))},W.clipAngle=function(ae){return arguments.length?($=+ae?pW(B=ae*jr,6*jr):(B=null,uC),Ae()):B*Wi},W.clipExtent=function(ae){return arguments.length?(U=ae==null?(q=X=R=k=null,Hc):uS(q=+ae[0][0],X=+ae[0][1],R=+ae[1][0],k=+ae[1][1]),Ae()):q==null?null:[[q,X],[R,k]]},W.scale=function(ae){return arguments.length?(t=+ae,Oe()):t},W.translate=function(ae){return arguments.length?(n=+ae[0],i=+ae[1],Oe()):[n,i]},W.center=function(ae){return arguments.length?(u=ae[0]%360*jr,_=ae[1]%360*jr,Oe()):[u*Wi,_*Wi]},W.rotate=function(ae){return arguments.length?(m=ae[0]%360*jr,S=ae[1]%360*jr,P=ae.length>2?ae[2]%360*jr:0,Oe()):[m*Wi,S*Wi,P*Wi]},W.precision=function(ae){return arguments.length?(ue=cC(be,H=ae*ae),Ae()):sa(H)},W.fitExtent=function(ae,ct){return Kv(W,ae,ct)},W.fitSize=function(ae,ct){return lS(W,ae,ct)};function Oe(){M=oN(O=sS(m,S,P),r);var ae=r(u,_);return l=n-ae[0]*t,p=i+ae[1]*t,Ae()}function Ae(){return ie=ee=null,W}return function(){return r=e.apply(this,arguments),W.invert=r.invert&&J,Oe()}}function hS(e){var r=0,t=Vn/3,n=cS(e),i=n(r,t);return i.parallels=function(l){return arguments.length?n(r=l[0]*jr,t=l[1]*jr):[r*Wi,t*Wi]},i}function _W(e){var r=Mr(e);function t(n,i){return[n*r,wr(i)/r]}return t.invert=function(n,i){return[n/r,vu(i*r)]},t}function ON(e,r){var t=wr(e),n=(t+wr(r))/2;if(si(n)<Dr)return _W(e);var i=1+t*(2*n-t),l=sa(i)/n;function p(u,_){var m=sa(i-2*n*wr(_))/n;return[m*wr(u*=n),l-m*Mr(u)]}return p.invert=function(u,_){var m=l-_;return[Ms(u,si(m))/n*ud(m),vu((i-(u*u+m*m)*n*n)/(2*n))]},p}function hv(){return hS(ON).scale(155.424).center([0,33.6442])}function CN(){return hv().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function bW(e){var r=e.length;return{point:function(t,n){for(var i=-1;++i<r;)e[i].point(t,n)},sphere:function(){for(var t=-1;++t<r;)e[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)e[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)e[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)e[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)e[t].polygonEnd()}}}function xW(){var e,r,t=CN(),n,i=hv().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l,p=hv().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,_,m={point:function(O,M){_=[O,M]}};function S(O){var M=O[0],B=O[1];return _=null,n.point(M,B),_||(l.point(M,B),_)||(u.point(M,B),_)}S.invert=function(O){var M=t.scale(),B=t.translate(),$=(O[0]-B[0])/M,q=(O[1]-B[1])/M;return(q>=.12&&q<.234&&$>=-.425&&$<-.214?i:q>=.166&&q<.234&&$>=-.214&&$<-.115?p:t).invert(O)},S.stream=function(O){return e&&r===O?e:e=bW([t.stream(r=O),i.stream(O),p.stream(O)])},S.precision=function(O){return arguments.length?(t.precision(O),i.precision(O),p.precision(O),P()):t.precision()},S.scale=function(O){return arguments.length?(t.scale(O),i.scale(O*.35),p.scale(O),S.translate(t.translate())):t.scale()},S.translate=function(O){if(!arguments.length)return t.translate();var M=t.scale(),B=+O[0],$=+O[1];return n=t.translate(O).clipExtent([[B-.455*M,$-.238*M],[B+.455*M,$+.238*M]]).stream(m),l=i.translate([B-.307*M,$+.201*M]).clipExtent([[B-.425*M+Dr,$+.12*M+Dr],[B-.214*M-Dr,$+.234*M-Dr]]).stream(m),u=p.translate([B-.205*M,$+.212*M]).clipExtent([[B-.214*M+Dr,$+.166*M+Dr],[B-.115*M-Dr,$+.234*M-Dr]]).stream(m),P()},S.fitExtent=function(O,M){return Kv(S,O,M)},S.fitSize=function(O,M){return lS(S,O,M)};function P(){return e=r=null,S}return S.scale(1070)}function TN(e){return function(r,t){var n=Mr(r),i=Mr(t),l=e(n*i);return[l*i*wr(r),l*wr(t)]}}function Ld(e){return function(r,t){var n=sa(r*r+t*t),i=e(n),l=wr(i),p=Mr(i);return[Ms(r*l,n*p),vu(n&&t*l/n)]}}var fS=TN(function(e){return sa(2/(1+e))});fS.invert=Ld(function(e){return 2*vu(e/2)});function wW(){return ec(fS).scale(124.75).clipAngle(180-.001)}var pS=TN(function(e){return(e=WD(e))&&e/wr(e)});pS.invert=Ld(function(e){return e});function EW(){return ec(pS).scale(79.4188).clipAngle(180-.001)}function Rd(e,r){return[e,Xm(oS((Go+r)/2))]}Rd.invert=function(e,r){return[e,2*Df(YD(r))-Go]};function SW(){return MN(Rd).scale(961/Vs)}function MN(e){var r=ec(e),t=r.center,n=r.scale,i=r.translate,l=r.clipExtent,p=null,u,_,m;r.scale=function(P){return arguments.length?(n(P),S()):n()},r.translate=function(P){return arguments.length?(i(P),S()):i()},r.center=function(P){return arguments.length?(t(P),S()):t()},r.clipExtent=function(P){return arguments.length?(P==null?p=u=_=m=null:(p=+P[0][0],u=+P[0][1],_=+P[1][0],m=+P[1][1]),S()):p==null?null:[[p,u],[_,m]]};function S(){var P=Vn*n(),O=r(aN(r.rotate()).invert([0,0]));return l(p==null?[[O[0]-P,O[1]-P],[O[0]+P,O[1]+P]]:e===Rd?[[Math.max(O[0]-P,p),u],[Math.min(O[0]+P,_),m]]:[[p,Math.max(O[1]-P,u)],[_,Math.min(O[1]+P,m)]])}return S()}function pm(e){return oS((Go+e)/2)}function LN(e,r){var t=Mr(e),n=e===r?wr(e):Xm(t/Mr(r))/Xm(pm(r)/pm(e)),i=t*H1(pm(e),n)/n;if(!n)return Rd;function l(p,u){i>0?u<-Go+Dr&&(u=-Go+Dr):u>Go-Dr&&(u=Go-Dr);var _=i/H1(pm(u),n);return[_*wr(n*p),i-_*Mr(n*p)]}return l.invert=function(p,u){var _=i-u,m=ud(n)*sa(p*p+_*_);return[Ms(p,si(_))/n*ud(_),2*Df(H1(i/m,1/n))-Go]},l}function PW(){return hS(LN).scale(109.5).parallels([30,30])}function hd(e,r){return[e,r]}hd.invert=hd;function AW(){return ec(hd).scale(152.63)}function RN(e,r){var t=Mr(e),n=e===r?wr(e):(t-Mr(r))/(r-e),i=t/n+e;if(si(n)<Dr)return hd;function l(p,u){var _=i-u,m=n*p;return[_*wr(m),i-_*Mr(m)]}return l.invert=function(p,u){var _=i-u;return[Ms(p,si(_))/n*ud(_),i-ud(n)*sa(p*p+_*_)]},l}function IW(){return hS(RN).scale(131.154).center([0,13.9389])}function dS(e,r){var t=Mr(r),n=Mr(e)*t;return[t*wr(e)/n,wr(r)/n]}dS.invert=Ld(Df);function OW(){return ec(dS).scale(144.049).clipAngle(60)}function dm(e,r,t,n){return e===1&&r===1&&t===0&&n===0?Hc:Jv({point:function(i,l){this.stream.point(i*e+t,l*r+n)}})}function CW(){var e=1,r=0,t=0,n=1,i=1,l=Hc,p=null,u,_,m,S=Hc,P,O,M;function B(){return P=O=null,M}return M={stream:function($){return P&&O===$?P:P=l(S(O=$))},clipExtent:function($){return arguments.length?(S=$==null?(p=u=_=m=null,Hc):uS(p=+$[0][0],u=+$[0][1],_=+$[1][0],m=+$[1][1]),B()):p==null?null:[[p,u],[_,m]]},scale:function($){return arguments.length?(l=dm((e=+$)*n,e*i,r,t),B()):e},translate:function($){return arguments.length?(l=dm(e*n,e*i,r=+$[0],t=+$[1]),B()):[r,t]},reflectX:function($){return arguments.length?(l=dm(e*(n=$?-1:1),e*i,r,t),B()):n<0},reflectY:function($){return arguments.length?(l=dm(e*n,e*(i=$?-1:1),r,t),B()):i<0},fitExtent:function($,q){return Kv(M,$,q)},fitSize:function($,q){return lS(M,$,q)}}}function gS(e,r){var t=r*r,n=t*t;return[e*(.8707-.131979*t+n*(-.013791+n*(.003971*t-.001529*n))),r*(1.007226+t*(.015085+n*(-.044475+.028874*t-.005916*n)))]}gS.invert=function(e,r){var t=r,n=25,i;do{var l=t*t,p=l*l;t-=i=(t*(1.007226+l*(.015085+p*(-.044475+.028874*l-.005916*p)))-r)/(1.007226+l*(.015085*3+p*(-.044475*7+.028874*9*l-.005916*11*p)))}while(si(i)>Dr&&--n>0);return[e/(.8707+(l=t*t)*(-.131979+l*(-.013791+l*l*l*(.003971-.001529*l)))),t]};function TW(){return ec(gS).scale(175.295)}function mS(e,r){return[Mr(r)*wr(e),wr(r)]}mS.invert=Ld(vu);function MW(){return ec(mS).scale(249.5).clipAngle(90+Dr)}function vS(e,r){var t=Mr(r),n=1+Mr(e)*t;return[t*wr(e)/n,wr(r)/n]}vS.invert=Ld(function(e){return 2*Df(e)});function LW(){return ec(vS).scale(250).clipAngle(142)}function yS(e,r){return[Xm(oS((Go+r)/2)),-e]}yS.invert=function(e,r){return[-r,2*Df(YD(e))-Go]};function RW(){var e=MN(yS),r=e.center,t=e.rotate;return e.center=function(n){return arguments.length?r([-n[1],n[0]]):(n=r(),[n[1],-n[0]])},e.rotate=function(n){return arguments.length?t([n[0],n[1],n.length>2?n[2]+90:90]):(n=t(),[n[0],n[1],n[2]-90])},t([0,0,90]).scale(159.155)}const DW=Object.freeze(Object.defineProperty({__proto__:null,geoAlbers:CN,geoAlbersUsa:xW,geoArea:AY,geoAzimuthalEqualArea:wW,geoAzimuthalEqualAreaRaw:fS,geoAzimuthalEquidistant:EW,geoAzimuthalEquidistantRaw:pS,geoBounds:TY,geoCentroid:FY,geoCircle:kY,geoClipExtent:UY,geoConicConformal:PW,geoConicConformalRaw:LN,geoConicEqualArea:hv,geoConicEqualAreaRaw:ON,geoConicEquidistant:IW,geoConicEquidistantRaw:RN,geoContains:WY,geoDistance:Wp,geoEquirectangular:AW,geoEquirectangularRaw:hd,geoGnomonic:OW,geoGnomonicRaw:dS,geoGraticule:gN,geoGraticule10:ZY,geoIdentity:CW,geoInterpolate:HY,geoLength:pN,geoMercator:SW,geoMercatorRaw:Rd,geoNaturalEarth1:TW,geoNaturalEarth1Raw:gS,geoOrthographic:MW,geoOrthographicRaw:mS,geoPath:sW,geoProjection:ec,geoProjectionMutator:cS,geoRotation:aN,geoStereographic:LW,geoStereographicRaw:vS,geoStream:qu,geoTransform:dW,geoTransverseMercator:RW,geoTransverseMercatorRaw:yS},Symbol.toStringTag,{value:"Module"})),NW=Ef(DW);var FW=Af,tb=wY,Tm=nr,kW=NW,Vc=zt;function BW(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var zW=BW(FW);function DN(e,r,t){t=t||{};var n=t.units||"kilometers",i=t.steps||8;if(!e)throw new Error("geojson is required");if(typeof t!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(r===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var l=[];switch(e.type){case"GeometryCollection":return Tm.geomEach(e,function(p){var u=Mm(p,r,n,i);u&&l.push(u)}),Vc.featureCollection(l);case"FeatureCollection":return Tm.featureEach(e,function(p){var u=Mm(p,r,n,i);u&&Tm.featureEach(u,function(_){_&&l.push(_)})}),Vc.featureCollection(l)}return Mm(e,r,n,i)}function Mm(e,r,t,n){var i=e.properties||{},l=e.type==="Feature"?e.geometry:e;if(l.type==="GeometryCollection"){var p=[];return Tm.geomEach(e,function($){var q=Mm($,r,t,n);q&&p.push(q)}),Vc.featureCollection(p)}var u=jW(l),_={type:l.type,coordinates:FN(l.coordinates,u)},m=new tb.GeoJSONReader,S=m.read(_),P=Vc.radiansToLength(Vc.lengthToRadians(r,t),"meters"),O=tb.BufferOp.bufferOp(S,P,n),M=new tb.GeoJSONWriter;if(O=M.write(O),!NN(O.coordinates)){var B={type:O.type,coordinates:kN(O.coordinates,u)};return Vc.feature(B,i)}}function NN(e){return Array.isArray(e[0])?NN(e[0]):isNaN(e[0])}function FN(e,r){return typeof e[0]!="object"?r(e):e.map(function(t){return FN(t,r)})}function kN(e,r){return typeof e[0]!="object"?r.invert(e):e.map(function(t){return kN(t,r)})}function jW(e){var r=zW.default(e).geometry.coordinates,t=[-r[0],-r[1]];return kW.geoAzimuthalEquidistant().rotate(t).scale(Vc.earthRadius)}iS.exports=DN;iS.exports.default=DN;var UW=iS.exports,_S={},$W=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_S,"__esModule",{value:!0});var GW=$W(Td),hC=vr,fC=zt;function qW(e,r,t){t===void 0&&(t={});var n=hC.getGeom(e),i=hC.getGeom(r),l=GW.default.union(n.coordinates,i.coordinates);return l.length===0?null:l.length===1?fC.polygon(l[0],t.properties):fC.multiPolygon(l,t.properties)}_S.default=qW;var Dd={},VW=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Dd,"__esModule",{value:!0});var pC=zt,dC=vr,XW=VW(Td);function YW(e,r,t){t===void 0&&(t={});var n=dC.getGeom(e),i=dC.getGeom(r),l=XW.default.intersection(n.coordinates,i.coordinates);return l.length===0?null:l.length===1?pC.polygon(l[0],t.properties):pC.multiPolygon(l,t.properties)}Dd.default=YW;var bS={exports:{}},gm=zt,WW=vr,ZW=nr,HW=HL,JW=Td;function BN(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var gC=BN(HW),mC=BN(JW);function zN(e,r){if(r=r||{},!gm.isObject(r))throw new Error("options is invalid");var t=r.propertyName;WW.collectionOf(e,"Polygon","dissolve");var n=[];if(r.propertyName){var i={};ZW.featureEach(e,function(_){Object.prototype.hasOwnProperty.call(i,_.properties[t])||(i[_.properties[t]]=[]),i[_.properties[t]].push(_)});for(var l=Object.keys(i),p=0;p<l.length;p++){var u=gm.multiPolygon(mC.default.union.apply(null,i[l[p]].map(function(_){return _.geometry.coordinates})));u.properties[t]=l[p],n.push(u)}}else return gC.default(gm.multiPolygon(mC.default.union.apply(null,e.features.map(function(_){return _.geometry.coordinates}))));return gC.default(gm.featureCollection(n))}bS.exports=zN;bS.exports.default=zN;var KW=bS.exports,Qv={},jN=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qv,"__esModule",{value:!0});var vC=jN(Vo),yC=jN(Dd),xS=zt;function QW(e,r,t){t===void 0&&(t={});var n=JSON.stringify(t.properties||{}),i=e[0],l=e[1],p=e[2],u=e[3],_=(l+u)/2,m=(i+p)/2,S=r*2/vC.default([i,_],[p,_],t),P=S*(p-i),O=r*2/vC.default([m,l],[m,u],t),M=O*(u-l),B=P/2,$=B*2,q=Math.sqrt(3)/2*M,X=p-i,R=u-l,k=3/4*$,U=q,H=(X-$)/($-B/2),ue=Math.floor(H),ie=(ue*k-B/2-X)/2-B/2+k/2,ee=Math.floor((R-q)/q),W=(R-ee*q)/2,J=ee*q-R>q/2;J&&(W-=q/4);for(var be=[],Oe=[],Ae=0;Ae<6;Ae++){var ae=2*Math.PI/6*Ae;be.push(Math.cos(ae)),Oe.push(Math.sin(ae))}for(var ct=[],Pe=0;Pe<=ue;Pe++)for(var V=0;V<=ee;V++){var Q=Pe%2===1;if(!(V===0&&Q)&&!(V===0&&J)){var he=Pe*k+i-ie,fe=V*U+l+W;if(Q&&(fe-=q/2),t.triangles===!0)tZ([he,fe],P/2,M/2,JSON.parse(n),be,Oe).forEach(function(se){t.mask?yC.default(t.mask,se)&&ct.push(se):ct.push(se)});else{var ye=eZ([he,fe],P/2,M/2,JSON.parse(n),be,Oe);t.mask?yC.default(t.mask,ye)&&ct.push(ye):ct.push(ye)}}}return xS.featureCollection(ct)}function eZ(e,r,t,n,i,l){for(var p=[],u=0;u<6;u++){var _=e[0]+r*i[u],m=e[1]+t*l[u];p.push([_,m])}return p.push(p[0].slice()),xS.polygon([p],n)}function tZ(e,r,t,n,i,l){for(var p=[],u=0;u<6;u++){var _=[];_.push(e),_.push([e[0]+r*i[u],e[1]+t*l[u]]),_.push([e[0]+r*i[(u+1)%6],e[1]+t*l[(u+1)%6]]),_.push(e),p.push(xS.polygon([_],n))}return p}Qv.default=QW;var wS={exports:{}},UN=zt,rZ=Td;function nZ(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Lm=nZ(rZ);function $N(e,r){var t=oZ(r),n=null;return e.type==="FeatureCollection"?n=iZ(e):n=GN(Lm.default.union(e.geometry.coordinates)),n.geometry.coordinates.forEach(function(i){t.geometry.coordinates.push(i[0])}),t}function iZ(e){var r=e.features.length===2?Lm.default.union(e.features[0].geometry.coordinates,e.features[1].geometry.coordinates):Lm.default.union.apply(Lm.default,e.features.map(function(t){return t.geometry.coordinates}));return GN(r)}function GN(e){return UN.multiPolygon(e)}function oZ(e){var r=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],t=e&&e.geometry.coordinates||r;return UN.polygon(t)}wS.exports=$N;wS.exports.default=$N;var aZ=wS.exports,ey={},ES={},qN=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ES,"__esModule",{value:!0});var sZ=qN(Vv),_C=qN(Vo),bC=zt;function uZ(e,r,t,n){n===void 0&&(n={});for(var i=[],l=e[0],p=e[1],u=e[2],_=e[3],m=r/_C.default([l,p],[u,p],n),S=m*(u-l),P=t/_C.default([l,p],[l,_],n),O=P*(_-p),M=u-l,B=_-p,$=Math.floor(M/S),q=Math.floor(B/O),X=(M-$*S)/2,R=(B-q*O)/2,k=l+X,U=0;U<$;U++){for(var H=p+R,ue=0;ue<q;ue++){var ie=bC.polygon([[[k,H],[k,H+O],[k+S,H+O],[k+S,H],[k,H]]],n.properties);n.mask?sZ.default(n.mask,ie)&&i.push(ie):i.push(ie),H+=O}k+=S}return bC.featureCollection(i)}ES.default=uZ;var lZ=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ey,"__esModule",{value:!0});var cZ=lZ(ES);function hZ(e,r,t){return t===void 0&&(t={}),cZ.default(e,r,r,t)}ey.default=hZ;var ty={},VN=we&&we.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ty,"__esModule",{value:!0});var xC=VN(Vo),wC=VN(Dd),Gl=zt;function fZ(e,r,t){t===void 0&&(t={});for(var n=[],i=r/xC.default([e[0],e[1]],[e[2],e[1]],t),l=i*(e[2]-e[0]),p=r/xC.default([e[0],e[1]],[e[0],e[3]],t),u=p*(e[3]-e[1]),_=0,m=e[0];m<=e[2];){for(var S=0,P=e[1];P<=e[3];){var O=null,M=null;_%2===0&&S%2===0?(O=Gl.polygon([[[m,P],[m,P+u],[m+l,P],[m,P]]],t.properties),M=Gl.polygon([[[m,P+u],[m+l,P+u],[m+l,P],[m,P+u]]],t.properties)):_%2===0&&S%2===1?(O=Gl.polygon([[[m,P],[m+l,P+u],[m+l,P],[m,P]]],t.properties),M=Gl.polygon([[[m,P],[m,P+u],[m+l,P+u],[m,P]]],t.properties)):S%2===0&&_%2===1?(O=Gl.polygon([[[m,P],[m,P+u],[m+l,P+u],[m,P]]],t.properties),M=Gl.polygon([[[m,P],[m+l,P+u],[m+l,P],[m,P]]],t.properties)):S%2===1&&_%2===1&&(O=Gl.polygon([[[m,P],[m,P+u],[m+l,P],[m,P]]],t.properties),M=Gl.polygon([[[m,P+u],[m+l,P+u],[m+l,P],[m,P+u]]],t.properties)),t.mask?(wC.default(t.mask,O)&&n.push(O),wC.default(t.mask,M)&&n.push(M)):(n.push(O),n.push(M)),P+=u,S++}_++,m+=l}return Gl.featureCollection(n)}ty.default=fZ;var SS={exports:{}},pZ=ja,dZ=Qv,gZ=Lv,mZ=Vo,vZ=Kl,yZ=ey,_Z=ty,bZ=ua,xZ=zt,EC=nr,wZ=vr;function Tc(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var EZ=Tc(pZ),SZ=Tc(dZ),PZ=Tc(gZ),AZ=Tc(mZ),IZ=Tc(vZ),OZ=Tc(yZ),CZ=Tc(_Z),TZ=Tc(bZ);function XN(e,r,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.gridType,i=t.property,l=t.weight;if(!e)throw new Error("points is required");if(wZ.collectionOf(e,"Point","input must contain Points"),!r)throw new Error("cellSize is required");if(l!==void 0&&typeof l!="number")throw new Error("weight must be a number");i=i||"elevation",n=n||"square",l=l||1;var p=EZ.default(e),u;switch(n){case"point":case"points":u=PZ.default(p,r,t);break;case"square":case"squares":u=OZ.default(p,r,t);break;case"hex":case"hexes":u=SZ.default(p,r,t);break;case"triangle":case"triangles":u=CZ.default(p,r,t);break;default:throw new Error("invalid gridType")}var _=[];return EC.featureEach(u,function(m){var S=0,P=0;EC.featureEach(e,function(M){var B=n==="point"?m:IZ.default(m),$=AZ.default(B,M,t),q;if(i!==void 0&&(q=M.properties[i]),q===void 0&&(q=M.geometry.coordinates[2]),q===void 0)throw new Error("zValue is missing");$===0&&(S=q);var X=1/Math.pow($,l);P+=X,S+=X*q});var O=TZ.default(m);O.properties[i]=S/P,_.push(O)}),xZ.featureCollection(_)}SS.exports=XN;SS.exports.default=XN;var MZ=SS.exports;(function(e){Object.defineProperty(e,"__esModule",{value:!0});var r=w4,t=bv,n=ZM,i=ow,l=gw,p=yj,u=Rj,_=bw,m=Vj,S=Wj,P=yL,O=bL,M=bd,B=m6,$=Af,q=Ow,X=Kl,R=Cw,k=Vo,U=Pv,H=ja,ue=Z6,ie=_d,ee=ps,W=xd,J=If,be=Nw,Oe=AU,Ae=wv,ae=Pc,ct=Jl,Pe=kw,V=zU,Q=wd,he=zw,fe=Mv,ye=t$,se=VL,De=Lv,ke=Dv,We=HL,He=Ac,dt=T$,yt=U$,Lt=$$,pt=fh,Ct=r8,mt=Nv,Ye=Ic,Zt=tE,hr=rE,$t=kv,yr=lq,nn=dh,rt=Of,Se=gh,ce=wq,ge=Oq,Be=DV,Xe=VR,$e=WR,ht=m9,Qe=P9,Vt=PE,ir=$v,it=_u,Tt=DE,Nt=jv,Ar=NE,Ir=Cf,Rt=kE,sn=Rv,un=Vv,Gn=ua,rn=hh,qr=BE,Fn=jE,Lr=Cv,Et=$E,li=tX,Le=AX,ne=TD,pe=Od,Ie=WE,Ne=UX,Ue=KE,et=VX,Ve=tS,qe=Cd,Ke=Zv,gt=Rf,vt=Ql,ft=zt,Ot=vr,ur=nr,jt=xY,Xt=UW,Ht=_S,Ur=Dd,$r=KW,zr=Qv,Cr=aZ,Zi=ey,Ut=ty,Fr=MZ;function _t(Or){return Or&&typeof Or=="object"&&"default"in Or?Or:{default:Or}}function Vr(Or){if(Or&&Or.__esModule)return Or;var Ao=Object.create(null);return Or&&Object.keys(Or).forEach(function(Ta){if(Ta!=="default"){var da=Object.getOwnPropertyDescriptor(Or,Ta);Object.defineProperty(Ao,Ta,da.get?da:{enumerable:!0,get:function(){return Or[Ta]}})}}),Ao.default=Or,Object.freeze(Ao)}var vi=_t(r),ii=_t(t),ci=_t(n),hi=_t(i),Bo=_t(l),ji=_t(p),Qn=_t(u),Eo=_t(_),Xo=_t(m),Xn=_t(S),kn=_t(P),Ui=_t(O),mo=_t(M),zo=_t(B),Ls=_t($),er=_t(q),Rs=_t(X),$i=_t(R),ha=_t(k),Rr=_t(U),Ds=_t(H),Il=_t(ue),Ws=_t(ie),Hi=_t(ee),Yo=_t(W),Zs=_t(J),Qu=_t(be),Pt=_t(Oe),Hs=_t(Ae),io=_t(ae),Wo=_t(ct),Js=_t(Pe),fi=_t(V),an=_t(Q),Xr=_t(he),Bn=_t(fe),So=_t(ye),Ks=_t(se),Ci=_t(De),Ua=_t(ke),Ji=_t(We),Zr=_t(He),Oa=_t(dt),Yn=_t(yt),Ns=_t(Lt),Ti=_t(pt),Yr=_t(Ct),Mi=_t(mt),fa=_t(Ye),wi=_t(Zt),oo=_t(hr),Gr=_t($t),pa=_t(yr),Wn=_t(nn),bu=_t(rt),Ki=_t(Se),Zn=_t(ce),pi=_t(ge),Ca=_t(Be),Ol=_t(Xe),Fs=_t($e),el=_t(ht),ds=_t(Qe),di=_t(Vt),Gi=_t(ir),qn=_t(it),$a=_t(Tt),Zo=_t(Nt),Qs=_t(Ar),zn=_t(Ir),or=_t(Rt),Cl=_t(sn),eu=_t(un),_i=_t(Gn),Ho=_t(rn),Jo=_t(qr),Ga=_t(Fn),tl=_t(Lr),rl=_t(Et),tr=_t(li),Ko=_t(Le),ei=_t(ne),xu=_t(pe),Ei=_t(Ie),nc=_t(Ne),Wr=_t(Ue),ks=_t(et),Un=_t(Ve),Hn=_t(qe),Li=Vr(Ke),Br=Vr(gt),wu=Vr(vt),ln=Vr(ft),dr=Vr(Ot),Ri=Vr(ur),qa=_t(jt),Qo=_t(Xt),Po=_t(Ht),Si=_t(Ur),Nc=_t($r),nl=_t(zr),ea=_t(Cr),vo=_t(Zi),Va=_t(Ut),Qi=_t(Fr);Object.keys(Ke).forEach(function(Or){Or!=="default"&&Object.defineProperty(e,Or,{enumerable:!0,get:function(){return Ke[Or]}})}),Object.keys(gt).forEach(function(Or){Or!=="default"&&Object.defineProperty(e,Or,{enumerable:!0,get:function(){return gt[Or]}})}),Object.keys(vt).forEach(function(Or){Or!=="default"&&Object.defineProperty(e,Or,{enumerable:!0,get:function(){return vt[Or]}})}),Object.keys(ft).forEach(function(Or){Or!=="default"&&Object.defineProperty(e,Or,{enumerable:!0,get:function(){return ft[Or]}})}),Object.keys(Ot).forEach(function(Or){Or!=="default"&&Object.defineProperty(e,Or,{enumerable:!0,get:function(){return Ot[Or]}})}),Object.keys(ur).forEach(function(Or){Or!=="default"&&Object.defineProperty(e,Or,{enumerable:!0,get:function(){return ur[Or]}})}),Object.defineProperty(e,"isolines",{enumerable:!0,get:function(){return vi.default}}),Object.defineProperty(e,"convex",{enumerable:!0,get:function(){return ii.default}}),Object.defineProperty(e,"pointsWithinPolygon",{enumerable:!0,get:function(){return ci.default}}),Object.defineProperty(e,"within",{enumerable:!0,get:function(){return ci.default}}),Object.defineProperty(e,"concave",{enumerable:!0,get:function(){return hi.default}}),Object.defineProperty(e,"collect",{enumerable:!0,get:function(){return Bo.default}}),Object.defineProperty(e,"flip",{enumerable:!0,get:function(){return ji.default}}),Object.defineProperty(e,"simplify",{enumerable:!0,get:function(){return Qn.default}}),Object.defineProperty(e,"bezier",{enumerable:!0,get:function(){return Eo.default}}),Object.defineProperty(e,"bezierSpline",{enumerable:!0,get:function(){return Eo.default}}),Object.defineProperty(e,"tag",{enumerable:!0,get:function(){return Xo.default}}),Object.defineProperty(e,"sample",{enumerable:!0,get:function(){return Xn.default}}),Object.defineProperty(e,"envelope",{enumerable:!0,get:function(){return kn.default}}),Object.defineProperty(e,"square",{enumerable:!0,get:function(){return Ui.default}}),Object.defineProperty(e,"circle",{enumerable:!0,get:function(){return mo.default}}),Object.defineProperty(e,"midpoint",{enumerable:!0,get:function(){return zo.default}}),Object.defineProperty(e,"center",{enumerable:!0,get:function(){return Ls.default}}),Object.defineProperty(e,"centerOfMass",{enumerable:!0,get:function(){return er.default}}),Object.defineProperty(e,"centroid",{enumerable:!0,get:function(){return Rs.default}}),Object.defineProperty(e,"combine",{enumerable:!0,get:function(){return $i.default}}),Object.defineProperty(e,"distance",{enumerable:!0,get:function(){return ha.default}}),Object.defineProperty(e,"explode",{enumerable:!0,get:function(){return Rr.default}}),Object.defineProperty(e,"bbox",{enumerable:!0,get:function(){return Ds.default}}),Object.defineProperty(e,"tesselate",{enumerable:!0,get:function(){return Il.default}}),Object.defineProperty(e,"bboxPolygon",{enumerable:!0,get:function(){return Ws.default}}),Object.defineProperty(e,"booleanPointInPolygon",{enumerable:!0,get:function(){return Hi.default}}),Object.defineProperty(e,"inside",{enumerable:!0,get:function(){return Hi.default}}),Object.defineProperty(e,"nearest",{enumerable:!0,get:function(){return Yo.default}}),Object.defineProperty(e,"nearestPoint",{enumerable:!0,get:function(){return Yo.default}}),Object.defineProperty(e,"nearestPointOnLine",{enumerable:!0,get:function(){return Zs.default}}),Object.defineProperty(e,"pointOnLine",{enumerable:!0,get:function(){return Zs.default}}),Object.defineProperty(e,"nearestPointToLine",{enumerable:!0,get:function(){return Qu.default}}),Object.defineProperty(e,"planepoint",{enumerable:!0,get:function(){return Pt.default}}),Object.defineProperty(e,"tin",{enumerable:!0,get:function(){return Hs.default}}),Object.defineProperty(e,"bearing",{enumerable:!0,get:function(){return io.default}}),Object.defineProperty(e,"destination",{enumerable:!0,get:function(){return Wo.default}}),Object.defineProperty(e,"kinks",{enumerable:!0,get:function(){return Js.default}}),Object.defineProperty(e,"pointOnFeature",{enumerable:!0,get:function(){return fi.default}}),Object.defineProperty(e,"pointOnSurface",{enumerable:!0,get:function(){return fi.default}}),Object.defineProperty(e,"area",{enumerable:!0,get:function(){return an.default}}),Object.defineProperty(e,"along",{enumerable:!0,get:function(){return Xr.default}}),Object.defineProperty(e,"length",{enumerable:!0,get:function(){return Bn.default}}),Object.defineProperty(e,"lineDistance",{enumerable:!0,get:function(){return Bn.default}}),Object.defineProperty(e,"lineSlice",{enumerable:!0,get:function(){return So.default}}),Object.defineProperty(e,"lineSliceAlong",{enumerable:!0,get:function(){return Ks.default}}),Object.defineProperty(e,"pointGrid",{enumerable:!0,get:function(){return Ci.default}}),Object.defineProperty(e,"truncate",{enumerable:!0,get:function(){return Ua.default}}),Object.defineProperty(e,"flatten",{enumerable:!0,get:function(){return Ji.default}}),Object.defineProperty(e,"lineIntersect",{enumerable:!0,get:function(){return Zr.default}}),Object.defineProperty(e,"lineChunk",{enumerable:!0,get:function(){return Oa.default}}),Object.defineProperty(e,"unkinkPolygon",{enumerable:!0,get:function(){return Yn.default}}),Object.defineProperty(e,"greatCircle",{enumerable:!0,get:function(){return Ns.default}}),Object.defineProperty(e,"lineSegment",{enumerable:!0,get:function(){return Ti.default}}),Object.defineProperty(e,"lineSplit",{enumerable:!0,get:function(){return Yr.default}}),Object.defineProperty(e,"lineArc",{enumerable:!0,get:function(){return Mi.default}}),Object.defineProperty(e,"polygonToLine",{enumerable:!0,get:function(){return fa.default}}),Object.defineProperty(e,"polygonToLineString",{enumerable:!0,get:function(){return fa.default}}),Object.defineProperty(e,"lineStringToPolygon",{enumerable:!0,get:function(){return wi.default}}),Object.defineProperty(e,"lineToPolygon",{enumerable:!0,get:function(){return wi.default}}),Object.defineProperty(e,"bboxClip",{enumerable:!0,get:function(){return oo.default}}),Object.defineProperty(e,"lineOverlap",{enumerable:!0,get:function(){return Gr.default}}),Object.defineProperty(e,"sector",{enumerable:!0,get:function(){return pa.default}}),Object.defineProperty(e,"rhumbBearing",{enumerable:!0,get:function(){return Wn.default}}),Object.defineProperty(e,"rhumbDistance",{enumerable:!0,get:function(){return bu.default}}),Object.defineProperty(e,"rhumbDestination",{enumerable:!0,get:function(){return Ki.default}}),Object.defineProperty(e,"polygonTangents",{enumerable:!0,get:function(){return Zn.default}}),Object.defineProperty(e,"rewind",{enumerable:!0,get:function(){return pi.default}}),Object.defineProperty(e,"isobands",{enumerable:!0,get:function(){return Ca.default}}),Object.defineProperty(e,"transformRotate",{enumerable:!0,get:function(){return Ol.default}}),Object.defineProperty(e,"transformScale",{enumerable:!0,get:function(){return Fs.default}}),Object.defineProperty(e,"transformTranslate",{enumerable:!0,get:function(){return el.default}}),Object.defineProperty(e,"lineOffset",{enumerable:!0,get:function(){return ds.default}}),Object.defineProperty(e,"polygonize",{enumerable:!0,get:function(){return di.default}}),Object.defineProperty(e,"booleanDisjoint",{enumerable:!0,get:function(){return Gi.default}}),Object.defineProperty(e,"booleanContains",{enumerable:!0,get:function(){return qn.default}}),Object.defineProperty(e,"booleanCrosses",{enumerable:!0,get:function(){return $a.default}}),Object.defineProperty(e,"booleanClockwise",{enumerable:!0,get:function(){return Zo.default}}),Object.defineProperty(e,"booleanOverlap",{enumerable:!0,get:function(){return Qs.default}}),Object.defineProperty(e,"booleanPointOnLine",{enumerable:!0,get:function(){return zn.default}}),Object.defineProperty(e,"booleanEqual",{enumerable:!0,get:function(){return or.default}}),Object.defineProperty(e,"booleanWithin",{enumerable:!0,get:function(){return Cl.default}}),Object.defineProperty(e,"booleanIntersects",{enumerable:!0,get:function(){return eu.default}}),Object.defineProperty(e,"clone",{enumerable:!0,get:function(){return _i.default}}),Object.defineProperty(e,"cleanCoords",{enumerable:!0,get:function(){return Ho.default}}),Object.defineProperty(e,"clustersDbscan",{enumerable:!0,get:function(){return Jo.default}}),Object.defineProperty(e,"clustersKmeans",{enumerable:!0,get:function(){return Ga.default}}),Object.defineProperty(e,"pointToLineDistance",{enumerable:!0,get:function(){return tl.default}}),Object.defineProperty(e,"booleanParallel",{enumerable:!0,get:function(){return rl.default}}),Object.defineProperty(e,"shortestPath",{enumerable:!0,get:function(){return tr.default}}),Object.defineProperty(e,"voronoi",{enumerable:!0,get:function(){return Ko.default}}),Object.defineProperty(e,"ellipse",{enumerable:!0,get:function(){return ei.default}}),Object.defineProperty(e,"centerMean",{enumerable:!0,get:function(){return xu.default}}),Object.defineProperty(e,"centerMedian",{enumerable:!0,get:function(){return Ei.default}}),Object.defineProperty(e,"standardDeviationalEllipse",{enumerable:!0,get:function(){return nc.default}}),Object.defineProperty(e,"angle",{enumerable:!0,get:function(){return Wr.default}}),Object.defineProperty(e,"polygonSmooth",{enumerable:!0,get:function(){return ks.default}}),Object.defineProperty(e,"moranIndex",{enumerable:!0,get:function(){return Un.default}}),Object.defineProperty(e,"distanceWeight",{enumerable:!0,get:function(){return Hn.default}}),e.projection=Li,e.random=Br,e.clusters=wu,Object.defineProperty(e,"bearingToAngle",{enumerable:!0,get:function(){return ft.bearingToAzimuth}}),Object.defineProperty(e,"convertDistance",{enumerable:!0,get:function(){return ft.convertLength}}),Object.defineProperty(e,"degrees2radians",{enumerable:!0,get:function(){return ft.degreesToRadians}}),Object.defineProperty(e,"distanceToDegrees",{enumerable:!0,get:function(){return ft.lengthToDegrees}}),Object.defineProperty(e,"distanceToRadians",{enumerable:!0,get:function(){return ft.lengthToRadians}}),e.helpers=ln,Object.defineProperty(e,"radians2degrees",{enumerable:!0,get:function(){return ft.radiansToDegrees}}),Object.defineProperty(e,"radiansToDistance",{enumerable:!0,get:function(){return ft.radiansToLength}}),e.invariant=dr,e.meta=Ri,Object.defineProperty(e,"difference",{enumerable:!0,get:function(){return qa.default}}),Object.defineProperty(e,"buffer",{enumerable:!0,get:function(){return Qo.default}}),Object.defineProperty(e,"union",{enumerable:!0,get:function(){return Po.default}}),Object.defineProperty(e,"intersect",{enumerable:!0,get:function(){return Si.default}}),Object.defineProperty(e,"dissolve",{enumerable:!0,get:function(){return Nc.default}}),Object.defineProperty(e,"hexGrid",{enumerable:!0,get:function(){return nl.default}}),Object.defineProperty(e,"mask",{enumerable:!0,get:function(){return ea.default}}),Object.defineProperty(e,"squareGrid",{enumerable:!0,get:function(){return vo.default}}),Object.defineProperty(e,"triangleGrid",{enumerable:!0,get:function(){return Va.default}}),Object.defineProperty(e,"interpolate",{enumerable:!0,get:function(){return Qi.default}})})(vd);var SC;function PS(){return SC||(SC=1,function(e){var r=we&&we.__assign||function(){return r=Object.assign||function(q){for(var X,R=1,k=arguments.length;R<k;R++){X=arguments[R];for(var U in X)Object.prototype.hasOwnProperty.call(X,U)&&(q[U]=X[U])}return q},r.apply(this,arguments)},t=we&&we.__awaiter||function(q,X,R,k){function U(H){return H instanceof R?H:new R(function(ue){ue(H)})}return new(R||(R=Promise))(function(H,ue){function ie(J){try{W(k.next(J))}catch(be){ue(be)}}function ee(J){try{W(k.throw(J))}catch(be){ue(be)}}function W(J){J.done?H(J.value):U(J.value).then(ie,ee)}W((k=k.apply(q,X||[])).next())})},n=we&&we.__generator||function(q,X){var R={label:0,sent:function(){if(H[0]&1)throw H[1];return H[1]},trys:[],ops:[]},k,U,H,ue;return ue={next:ie(0),throw:ie(1),return:ie(2)},typeof Symbol=="function"&&(ue[Symbol.iterator]=function(){return this}),ue;function ie(W){return function(J){return ee([W,J])}}function ee(W){if(k)throw new TypeError("Generator is already executing.");for(;ue&&(ue=0,W[0]&&(R=0)),R;)try{if(k=1,U&&(H=W[0]&2?U.return:W[0]?U.throw||((H=U.return)&&H.call(U),0):U.next)&&!(H=H.call(U,W[1])).done)return H;switch(U=0,H&&(W=[W[0]&2,H.value]),W[0]){case 0:case 1:H=W;break;case 4:return R.label++,{value:W[1],done:!1};case 5:R.label++,U=W[1],W=[0];continue;case 7:W=R.ops.pop(),R.trys.pop();continue;default:if(H=R.trys,!(H=H.length>0&&H[H.length-1])&&(W[0]===6||W[0]===2)){R=0;continue}if(W[0]===3&&(!H||W[1]>H[0]&&W[1]<H[3])){R.label=W[1];break}if(W[0]===6&&R.label<H[1]){R.label=H[1],H=W;break}if(H&&R.label<H[2]){R.label=H[2],R.ops.push(W);break}H[2]&&R.ops.pop(),R.trys.pop();continue}W=X.call(q,R)}catch(J){W=[6,J],U=0}finally{k=H=0}if(W[0]&5)throw W[1];return{value:W[0]?W[1]:void 0,done:!0}}},i=we&&we.__spreadArray||function(q,X,R){if(R||arguments.length===2)for(var k=0,U=X.length,H;k<U;k++)(H||!(k in X))&&(H||(H=Array.prototype.slice.call(X,0,k)),H[k]=X[k]);return q.concat(H||Array.prototype.slice.call(X))};Object.defineProperty(e,"__esModule",{value:!0}),e.deleteFeatures=e.updateFeature=e.addFeatures=e.getPois=e.getAmenities=e.getFeatures=void 0;var l=Wu,p=Ts,u=yv,_=jF(),m=vd,S=function(q){var X=q.initPolygons,R=q.autoLabelLines,k=q.hiddenAmenities,U=q.useTimerangeData,H=q.filter,ue=q.featuresMaxBounds;return t(void 0,void 0,void 0,function(){var ie,ee,W,J,be;return n(this,function(Oe){switch(Oe.label){case 0:return ie="/v5/geo/features",ue&&(ie+="/".concat(ue[0][0],",").concat(ue[0][1],",").concat(ue[1][0],",").concat(ue[1][1])),[4,l.axios.get(ie)];case 1:return ee=Oe.sent(),X&&(W=[],U&&(ee.data.features=ee.data.features.map(function(Ae){var ae,ct;return Ae.properties&&(!((ae=Ae.properties.metadata)===null||ae===void 0)&&ae.dateStart)&&(!((ct=Ae.properties.metadata)===null||ct===void 0)&&ct.dateEnd)?Ae.properties.metadata.dateStart<=Date.now()&&Ae.properties.metadata.dateEnd>=Date.now()?Ae:void 0:Ae}).filter(function(Ae){return Ae!==void 0})),H&&H.key&&H.value&&(ee.data.features=ee.data.features.map(function(Ae){return(0,l.getNestedObjectValue)(Ae,H.key)?(0,l.getNestedObjectValue)(Ae,H.key)===H.value?Ae:void 0:Ae}).filter(function(Ae){return Ae!==void 0})),J=ee.data.features.filter(function(Ae){return Ae.properties.type==="shop"&&Ae.geometry.type==="MultiPolygon"}),be=ee.data.features.filter(function(Ae){return Ae.properties.type==="label-line"}),ee.data.features=ee.data.features.map(function(Ae,ae){var ct,Pe,V;if(k&&k.length>0&&k.includes(Ae.properties.amenity)&&(Ae.properties.hideIcon="hide"),Ae.properties.type==="poi"){Ae.id=Ae.id?Ae.id.replace(/\{|\}/g,""):null,Ae.properties.id=Ae.properties.id?Ae.properties.id.replace(/\{|\}/g,""):null;var Q,he;if(J.forEach(function(Ye){var Zt,hr;Ye.properties.id||(Ye.properties.id=Ye.id),((Zt=Ae.properties)===null||Zt===void 0?void 0:Zt.level)===((hr=Ye.properties)===null||hr===void 0?void 0:hr.level)&&(0,m.booleanPointInPolygon)(Ae,Ye)&&(Q=Ye)}),!Q&&Ae.properties.metadata&&Ae.properties.metadata.polygon_id&&(Q=ee.data.features.find(function(Ye){var Zt,hr;return((Zt=Ye.properties.id)===null||Zt===void 0?void 0:Zt.replace(/\{|\}/g,""))===((hr=Ae.properties.metadata.polygon_id)===null||hr===void 0?void 0:hr.replace(/\{|\}/g,""))})),Q&&(Ae.properties._dynamic=Ae.properties._dynamic?Ae.properties._dynamic:{},Ae.properties._dynamic.id=Ae.id,Ae.properties._dynamic.type="poi-custom",Ae.properties._dynamic.amenity=Ae.properties.amenity,Ae.properties._dynamic.polygon_id=(ct=Q.properties.id)===null||ct===void 0?void 0:ct.replace(/\{|\}/g,""),Q.properties._dynamic=Q.properties._dynamic?Q.properties._dynamic:{},Q.properties._dynamic.id=(Pe=Q.properties.id)===null||Pe===void 0?void 0:Pe.replace(/\{|\}/g,""),Q.properties._dynamic.type="shop-custom",Q.properties._dynamic.poi_id=Ae.properties.id,Q.properties._dynamic.amenity=Ae.properties.amenity,Q.id=JSON.stringify(ae),be.forEach(function(Ye){var Zt,hr;((Zt=Q.properties)===null||Zt===void 0?void 0:Zt.level)===((hr=Ye.properties)===null||hr===void 0?void 0:hr.level)&&(0,m.booleanPointInPolygon)((0,m.pointOnFeature)(Ye),Q)&&(he=Ye)}),he&&(he.id=JSON.stringify(ae+9999),Ae.properties._dynamic.label_id=he.id,Q.properties._dynamic.label_id=he.id,he.properties._dynamic=he.properties._dynamic?he.properties._dynamic:{},he.properties._dynamic.id=(V=he.properties.id)===null||V===void 0?void 0:V.replace(/\{|\}/g,""),he.properties._dynamic.type="shop-label",he.properties._dynamic.poi_id=Ae.properties.id,he.properties._dynamic.amenity=Ae.properties.amenity,he.properties._dynamic.polygon_id=Q.properties._dynamic.id,he.properties._dynamic.length=Math.ceil((0,m.length)(he)*1e3),he.properties.title=Ae.properties.title,he.properties.title_i18n=Ae.properties.title_i18n),!he)){var fe=Q.properties["label-line"]?JSON.parse(JSON.stringify(Q.properties["label-line"])):Q.properties.metadata&&Q.properties.metadata["label-line"]?JSON.parse(JSON.stringify(Q.properties.metadata["label-line"])):Ae.properties.metadata&&Ae.properties.metadata["label-line"]?JSON.parse(JSON.stringify(Ae.properties.metadata["label-line"])):void 0;if(fe&&fe!==void 0&&fe.length>0){var ye=typeof fe=="string"?JSON.parse(fe):fe;if(ye[0]instanceof Array&&ye[1]instanceof Array){var se=JSON.parse(JSON.stringify(Ae));se.geometry={coordinates:ye,type:"LineString"},se.properties.id=JSON.stringify(ae+9999),se.id=JSON.stringify(ae+9999),se.properties.type="shop-label",se.properties._dynamic.type="shop-label",se.properties._dynamic.length=Math.ceil((0,m.length)(se)*1e3),Q.properties._dynamic.label_id=se.properties.id,W.push(se)}}else if(R){for(var De=void 0,ke=void 0,We=0;We<Q.geometry.coordinates[0][0].length;We++){var He=Q.geometry.coordinates[0][0][We],dt=Q.geometry.coordinates[0][0][We+1];if(dt){var yt=(0,m.lineString)([He,dt],r({},Ae.properties)),Lt=(0,m.length)(yt);yt.properties._dynamic=r(r({},yt.properties._dynamic),{length:Math.ceil(Lt*1e3)}),De?Lt>De.properties._dynamic.length&&(De=yt):De=yt}}var pt=(0,m.pointToLineDistance)((0,m.centroid)(Q),De);ke=(0,m.lineOffset)(De,pt),ke=(0,m.transformScale)(ke,10);var Ct=(0,m.lineIntersect)(Q,ke);if(Ct.features.length>1){var mt=(0,m.lineString)([Ct.features[0].geometry.coordinates,Ct.features[Ct.features.length-1].geometry.coordinates]);ke.geometry=mt.geometry}ke.properties.id=JSON.stringify(ae+9999),ke.id=JSON.stringify(ae+9999),ke.properties.type="shop-label",ke.properties._dynamic.type="shop-label",Q.properties._dynamic.label_id=ke.properties.id,W.push(ke)}}}return Ae}),ee.data.features=ee.data.features.concat(W)),[2,new p.FeatureCollection(ee.data)]}})})};e.getFeatures=S;var P=function(q){return t(void 0,void 0,void 0,function(){var X,R;return n(this,function(k){switch(k.label){case 0:return X="/v5/geo/amenities",[4,l.axios.get(X)];case 1:return R=k.sent(),[2,R.data.map(function(U){return q&&U[q]&&U.category!=="default"&&(U.id=U[q].toLowerCase()),new u.AmenityModel(U)})]}})})};e.getAmenities=P;var O=function(){return t(void 0,void 0,void 0,function(){var q,X,R,k;return n(this,function(U){switch(U.label){case 0:return q="/v5/geo/features",[4,l.axios.get(q)];case 1:return X=U.sent(),R=_.globalState.dynamicFeatures,k=i(i([],X.data.features,!0),R.features,!0).filter(function(H){return H.properties.usecase==="poi"||H.properties.type==="poi"}).sort(function(H,ue){return H.properties.title>ue.properties.title?-1:1}).sort(function(H,ue){return H.properties.level>ue.properties.level?1:-1}).map(function(H){return new p.default(H)}),[2,k]}})})};e.getPois=O;var M=function(q){return t(void 0,void 0,void 0,function(){var X,R;return n(this,function(k){switch(k.label){case 0:X="/v5/geo/features",k.label=1;case 1:return k.trys.push([1,3,,4]),[4,l.axios.post(X,q)];case 2:return k.sent(),[3,4];case 3:throw R=k.sent(),new Error(R.message);case 4:return[2]}})})};e.addFeatures=M;var B=function(q,X){return t(void 0,void 0,void 0,function(){var R,k;return n(this,function(U){switch(U.label){case 0:R="/v5/geo/features/"+X,U.label=1;case 1:return U.trys.push([1,3,,4]),[4,l.axios.put(R,q)];case 2:return U.sent(),[3,4];case 3:throw k=U.sent(),new Error(k.message);case 4:return[2]}})})};e.updateFeature=B;var $=function(q){return t(void 0,void 0,void 0,function(){var X,R;return n(this,function(k){switch(k.label){case 0:X="/v5/geo/features/delete",k.label=1;case 1:return k.trys.push([1,3,,4]),[4,l.axios.post(X,q)];case 2:return k.sent(),[3,4];case 3:throw R=k.sent(),new Error(R.message);case 4:return[2]}})})};e.deleteFeatures=$,e.default={getFeatures:e.getFeatures,addFeatures:e.addFeatures,updateFeature:e.updateFeature,deleteFeatures:e.deleteFeatures,getAmenities:e.getAmenities,getPois:e.getPois}}(_1)),_1}var PC;function LZ(){return PC||(PC=1,function(e){var r=we&&we.__awaiter||function(_,m,S,P){function O(M){return M instanceof S?M:new S(function(B){B(M)})}return new(S||(S=Promise))(function(M,B){function $(R){try{X(P.next(R))}catch(k){B(k)}}function q(R){try{X(P.throw(R))}catch(k){B(k)}}function X(R){R.done?M(R.value):O(R.value).then($,q)}X((P=P.apply(_,m||[])).next())})},t=we&&we.__generator||function(_,m){var S={label:0,sent:function(){if(M[0]&1)throw M[1];return M[1]},trys:[],ops:[]},P,O,M,B;return B={next:$(0),throw:$(1),return:$(2)},typeof Symbol=="function"&&(B[Symbol.iterator]=function(){return this}),B;function $(X){return function(R){return q([X,R])}}function q(X){if(P)throw new TypeError("Generator is already executing.");for(;B&&(B=0,X[0]&&(S=0)),S;)try{if(P=1,O&&(M=X[0]&2?O.return:X[0]?O.throw||((M=O.return)&&M.call(O),0):O.next)&&!(M=M.call(O,X[1])).done)return M;switch(O=0,M&&(X=[X[0]&2,M.value]),X[0]){case 0:case 1:M=X;break;case 4:return S.label++,{value:X[1],done:!1};case 5:S.label++,O=X[1],X=[0];continue;case 7:X=S.ops.pop(),S.trys.pop();continue;default:if(M=S.trys,!(M=M.length>0&&M[M.length-1])&&(X[0]===6||X[0]===2)){S=0;continue}if(X[0]===3&&(!M||X[1]>M[0]&&X[1]<M[3])){S.label=X[1];break}if(X[0]===6&&S.label<M[1]){S.label=M[1],M=X;break}if(M&&S.label<M[2]){S.label=M[2],S.ops.push(X);break}M[2]&&S.ops.pop(),S.trys.pop();continue}X=m.call(_,S)}catch(R){X=[6,R],O=0}finally{P=M=0}if(X[0]&5)throw X[1];return{value:X[0]?X[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getPackage=void 0;var n=pd,i=Pf,l=yc,p=PS(),u=function(_){var m=_.initPolygons,S=_.autoLabelLines,P=_.amenityIdProperty,O=_.hiddenAmenities,M=_.useTimerangeData,B=_.filter,$=_.featuresMaxBounds;return r(void 0,void 0,void 0,function(){var q,X;return t(this,function(R){switch(R.label){case 0:return q={},X=[(0,n.getPlaces)().then(function(k){return q.places=k.data}),(0,i.getFloors)().then(function(k){return q.floors=k.data}),(0,l.getStyle)().then(function(k){return q.style=k}),(0,l.getStyles)().then(function(k){return q.styles=k}),(0,p.getFeatures)({initPolygons:m,autoLabelLines:S,hiddenAmenities:O,useTimerangeData:M,filter:B,featuresMaxBounds:$}).then(function(k){return q.features=k}),(0,p.getAmenities)(P).then(function(k){return q.amenities=k})],[4,Promise.all(X)];case 1:return R.sent(),[2,q]}})})};e.getPackage=u,e.default={getPackage:e.getPackage}}(y1)),y1}var AS={},Nf={},IS={},Nd={};Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Eventable=void 0;var RZ=function(){function e(){this._observers=[]}return e.prototype.on=function(r){this._observers&&this._observers.push(r)},e.prototype.off=function(r){var t=this._observers?this._observers.findIndex(function(n){return n===r}):0;t>=0&&this._observers&&this._observers.splice(t,1)},e.prototype.notify=function(r,t){var n=this;this._observers&&this._observers.forEach(function(i){return i(r,t,n)})},e}();Nd.Eventable=RZ;var DZ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(IS,"__esModule",{value:!0});var NZ=Nd,FZ=function(e){DZ(r,e);function r(t,n){var i=e.call(this)||this;return i.id=t,i.type=n,i}return Object.defineProperty(r.prototype,"source",{get:function(){return{type:this.type}},enumerable:!1,configurable:!0}),r}(NZ.Eventable);IS.default=FZ;var kZ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Nf,"__esModule",{value:!0});var BZ=IS,zZ=Ts,jZ=function(e){kZ(r,e);function r(t,n){var i=e.call(this,t,"geojson")||this;return i.cluster=!1,i.clusterRadius=50,i.clusterMaxZoom=19,i.isEditable=!0,i.data=n||new zZ.FeatureCollection({}),i}return Object.defineProperty(r.prototype,"source",{get:function(){return{type:this.type,data:this.data,cluster:this.cluster,clusterMaxZoom:this.clusterMaxZoom,clusterRadius:this.clusterRadius}},enumerable:!1,configurable:!0}),r}(BZ.default);Nf.default=jZ;var UZ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(AS,"__esModule",{value:!0});var $Z=Nf,GZ=Ts,qZ=function(e){UZ(r,e);function r(t){var n=e.call(this,"main")||this;return n.language="en",n}return r.prototype.fetch=function(t){this.data=new GZ.FeatureCollection(t),this.mapLanguage()},r.prototype.create=function(t){this.data.features.push(t)},r.prototype.update=function(t){var n=this.data.features.findIndex(function(i){return i.id===t.id||i.properties.id===t.id});this.data.features[n]=t},r.prototype.delete=function(t){var n=this.data.features.findIndex(function(i){return i.id===t||i.properties.id===t});this.data.features.splice(n,1)},r.prototype.mapLanguage=function(){var t=this,n=this.data.features.filter(function(i){return typeof i.properties.title_i18n=="object"});n.forEach(function(i){return t.mapFeatureLanguage(i,t.language)})},r.prototype.mapFeatureLanguage=function(t,n){typeof t.properties.title_i18n=="string"&&(t.properties.title_i18n=JSON.parse(t.properties.title_i18n)),typeof t.properties.title_i18n=="object"&&(t.properties.title=t.properties.title_i18n[n]?t.properties.title_i18n[n]:t.properties.title)},r.prototype.query=function(t,n){return this.data.features.filter(function(i){return i.properties.title&&i.properties.title.toLowerCase().match(t.toLowerCase())})},r.prototype.get=function(t){return this.data.features.find(function(n){return n.id===t})},r.prototype.getInternal=function(t){return this.data.features.find(function(n){return n.properties.id===t})},Object.defineProperty(r.prototype,"collection",{get:function(){return{type:"FeatureCollection",features:this.data.features.map(function(t){return t.json})}},enumerable:!1,configurable:!0}),r}($Z.default);AS.default=qZ;var OS={},VZ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(OS,"__esModule",{value:!0});var XZ=Nf,YZ=Ts,WZ=function(e){VZ(r,e);function r(t){var n=e.call(this,"synthetic")||this;return n.data=t||new YZ.FeatureCollection({}),n}return r.prototype.get=function(t){return this.data.features.find(function(n){return n.properties.id===t})},r}(XZ.default);OS.default=WZ;var CS={},TS={},ry={};Object.defineProperty(ry,"__esModule",{value:!0});ry.Wayfinding=void 0;var Sr=ZZ(vd);function YN(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(YN=function(i){return i?t:r})(e)}function ZZ(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||yf(e)!="object"&&typeof e!="function")return{default:e};var t=YN(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(l!=="default"&&Object.prototype.hasOwnProperty.call(e,l)){var p=i?Object.getOwnPropertyDescriptor(e,l):null;p&&(p.get||p.set)?Object.defineProperty(n,l,p):n[l]=e[l]}return n.default=e,t&&t.set(e,n),n}function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yf(e)}function Fa(e){return QZ(e)||KZ(e)||JZ(e)||HZ()}function HZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JZ(e,r){if(e){if(typeof e=="string")return _x(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _x(e,r)}}function KZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QZ(e){if(Array.isArray(e))return _x(e)}function _x(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function eH(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function AC(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WN(n.key),n)}}function tH(e,r,t){return r&&AC(e.prototype,r),t&&AC(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ea(e,r,t){return r=WN(r),r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function WN(e){var r=rH(e,"string");return yf(r)==="symbol"?r:String(r)}function rH(e,r){if(yf(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}ry.Wayfinding=function(){function e(r){var t=this;eH(this,e),Ea(this,"configuration",{avoidElevators:!1,avoidEscalators:!1,avoidStaircases:!1,avoidRamps:!1,avoidNarrowPaths:!1,avoidRevolvingDoors:!1,avoidTicketGates:!1,avoidBarriers:!1,avoidHills:!1}),Ea(this,"POI_TYPE",{ELEVATOR:"elevator",ESCALATOR:"escalator",STAIRCASE:"staircase",RAMP:"ramp",HILL:"hill",NARROW_PATH:"narrow_path",REVOLVING_DOOR:"door",TICKET_GATE:"ticket_gate",BARRIER:"barrier"}),Ea(this,"ACCESSIBILITY_POI_TYPE",["door","ticket_gate"]),Ea(this,"LEVEL_CHANGER_TYPE",["elevator","escalator","staircase","ramp","hill"]),Ea(this,"PATH_TYPE","path"),Ea(this,"LINE_STRING_TYPE","LineString"),Ea(this,"DIRECTION_UP","up"),Ea(this,"DIRECTION_DOWN","down"),Ea(this,"ROUTABLE_TYPE",["MultiPolygon","Polygon"]),Ea(this,"UNIT_TYPE","meters"),Ea(this,"pathFixDistance",1),Ea(this,"wallOffsetDistance",.5),Ea(this,"walkingSpeed",1.4),Ea(this,"floorHeight",4.5),Ea(this,"elevatorSpeed",.9),Ea(this,"elevatorWaiting",55),Ea(this,"escalatorSpeed",.24),Ea(this,"staircasesSpeed",.3);var n=r.features,i=this.extractMinMaxLevel(n),l=i.minLevel,p=i.maxLevel;if(l===void 0)throw"No feature with level was supplied!";for(var u=n.filter(function(O){return O.properties.routable&&t.ROUTABLE_TYPE.includes(O.geometry.type)}),_=new Map,m=function(M){var B=u.filter(function($){return $.properties.level===M});_.set(M,Sr.featureCollection(B!==void 0?B:[]))},S=l;S<=p;S++)m(S);this.floorList=_,this.corridors=n.filter(function(O){return O.properties.class===t.PATH_TYPE&&O.geometry.type===t.LINE_STRING_TYPE});var P=n.filter(function(O){return t.LEVEL_CHANGER_TYPE.includes(O.properties.type)});P.forEach(function(O){O.id===void 0&&(O.id=O.properties.id)}),P.forEach(function(O){if(O.properties.levels===void 0&&(O.properties.levels=[],O.properties.level_min!==void 0&&O.properties.level_max!==void 0))for(var M=O.properties.level_min;M<=O.properties.level_max;M++)O.properties.levels.push(M)}),this.levelChangerList=P,this.accessibilityPoi=n.filter(function(O){return t.ACCESSIBILITY_POI_TYPE.includes(O.properties.type)}),this.rebuildData()}return tH(e,[{key:"setConfiguration",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Object.keys(t).forEach(function(l){n.configuration.hasOwnProperty(l)&&(n.configuration[l]=t[l])}),this.pathFixDistance=i}},{key:"extractMinMaxLevel",value:function(t){var n=void 0,i=void 0;return t.forEach(function(l){var p=l.properties.level;(n===void 0||p<n)&&(n=p),(i===void 0||i<p)&&(i=p),l.properties.levels!==void 0&&l.properties.levels.forEach(function(u){(n===void 0||u<n)&&(n=u),(i===void 0||i<u)&&(i=u)})}),{minLevel:n,maxLevel:i}}},{key:"rebuildData",value:function(){var t=this,n=new Map;this.floorList.forEach(function(U,H){var ue=[],ie=[],ee=[];U.features.forEach(function(W){var J=Sr.flatten(Sr.polygonToLine(W)).features.map(function(be){return be.geometry});J.forEach(function(be){for(var Oe,Ae,ae=0;ae<be.coordinates.length-1;ae++){var ct=void 0;ae===0?(Oe=Sr.point(be.coordinates[ae]),Oe.properties.level=H,Oe.properties.neighbours=[],Oe.properties.walkableAreaId=W.id,ct=Oe):ct=Ae,ae===be.coordinates.length-2?Ae=Oe:(Ae=Sr.point(be.coordinates[ae+1]),Ae.properties.level=H,Ae.properties.neighbours=[],Ae.properties.walkableAreaId=W.id),ct.properties.neighbours.push(Ae),Ae.properties.neighbours.push(ct),ue.push(ct),ie.push([ct,Ae])}}),ee=ee.concat(Sr.flatten(W).features)}),n.set(H,{areas:ee,points:ue,walls:ie,wallFeatures:ie.map(function(W){return Sr.lineString([W[0].geometry.coordinates,W[1].geometry.coordinates])})})}),this.bearingCache=new Map,this.floorData=n,this.floorData.forEach(function(U,H){var ue=t.accessibilityPoi.filter(function(ie){return H===ie.properties.level}).filter(function(ie){return U.areas.filter(function(ee){return Sr.booleanContains(ee,ie)}).length>0});ue.forEach(function(ie){var ee=[Sr.destination(ie.geometry.coordinates,ie.properties.radius+t.wallOffsetDistance,0,{units:t.UNIT_TYPE}),Sr.destination(ie.geometry.coordinates,ie.properties.radius+t.wallOffsetDistance,60,{units:t.UNIT_TYPE}),Sr.destination(ie.geometry.coordinates,ie.properties.radius+t.wallOffsetDistance,120,{units:t.UNIT_TYPE}),Sr.destination(ie.geometry.coordinates,ie.properties.radius+t.wallOffsetDistance,180,{units:t.UNIT_TYPE}),Sr.destination(ie.geometry.coordinates,ie.properties.radius+t.wallOffsetDistance,-120,{units:t.UNIT_TYPE}),Sr.destination(ie.geometry.coordinates,ie.properties.radius+t.wallOffsetDistance,-60,{units:t.UNIT_TYPE})].filter(function(W){return U.areas.filter(function(J){return Sr.booleanContains(J,W)}).length>0});ee.forEach(function(W){W.properties.level=H,W.properties.isDetourPoint=!0}),U.points=U.points.concat(ee),t.detourPointList=ee})});var i=[],l=[];this.corridors.forEach(function(U,H){for(var ue=U.geometry.coordinates,ie=null,ee=0;ee<ue.length-1;ee++){var W=void 0;ie!=null?W=ie:(W=Sr.point(ue[ee]),W.properties.neighbours=[],W.properties.level=U.properties.level);var J=Sr.point(ue[ee+1]);J.properties.level=U.properties.level,J.properties.neighbours=[];var be=t._checkTimeBased(U)&&t._checkAvailablePath(U),Oe=U.properties.bidirectional===void 0||U.properties.bidirectional===!0,Ae=U.properties.swapDirection!==void 0&&U.properties.swapDirection===!0;be&&((Oe||!Ae)&&W.properties.neighbours.push(J),(Oe||Ae)&&J.properties.neighbours.push(W));var ae=Sr.lineString([W.geometry.coordinates,J.geometry.coordinates]);ae.properties.level=U.properties.level,ae.properties.isAvailableNow=be,ae.properties.bidirectional=Oe,ae.properties.swapDirection=Ae;var ct=U.properties.narrowPath===!0;ct===!0&&(W.properties.narrowPath=!0,J.properties.narrowPath=!0,ae.properties.narrowPath=!0);var Pe=U.properties.ramp===!0;Pe===!0&&(W.properties.ramp=!0,J.properties.ramp=!0,ae.properties.ramp=!0);var V=U.properties.ramp===!0;V===!0&&(W.properties.hill=!0,J.properties.hill=!0,ae.properties.hill=!0),i.push([W,J]),l.push(ae),ie=J}});var p=[],u=new Map,_=0;for(_=0;_<i.length;){var m=i[_],S=l[_];u.has(_)||u.set(_,[]);for(var P=_+1;P<i.length;P++){u.has(P)||u.set(P,[]);var O=i[P];if(S.properties.level===l[P].properties.level&&!(O.includes(m[0])||O.includes(m[1]))){var M=l[P],B=Sr.lineIntersect(S,M).features;if(B.length>0){var $=B[0];$.properties.level=m[0].properties.level,$.properties.isCorridorPoint=!0,(S.properties.narrowPath||M.properties.narrowPath)&&($.properties.narrowPath=!0),(S.properties.ramp||M.properties.ramp)&&($.properties.ramp=!0),(S.properties.hill||M.properties.hill)&&($.properties.hill=!0),u.get(_).push($),u.get(P).push($),p.push($)}}}_++}_=0;for(var q=function(){var H=i[_],ue=l[_],ie=H[0],ee=H[1],W=u.get(_);W.sort(function(J,be){return t._comparePointsByDistanceFromReference(ie,J,be)}),W?(W.forEach(function(J){t._setNeighbourhoodBasedOnCorridorDirectionality(ue,ie,ee,J);var be=ue.properties.isAvailableNow,Oe=ue.properties.bidirectional===void 0||ue.properties.bidirectional===!0,Ae=ue.properties.swapDirection!==void 0&&ue.properties.swapDirection===!0;if(be)if(Oe)J.properties.neighbours=J.properties.neighbours.concat(W.filter(function(Q){return Q!==J}));else if(Ae){var Pe,V=W.slice(0,W.indexOf(J));(Pe=J.properties.neighbours).push.apply(Pe,Fa(V))}else{var ae,ct=W.slice(W.indexOf(J));(ae=J.properties.neighbours).push.apply(ae,Fa(ct))}}),l[_].properties.intersectionPointList=W):l[_].properties.intersectionPointList=[],_++};_<i.length;)q();var X=[];_=0;for(var R=function(){var H,ue,ie=i[_],ee=l[_],W=[],J=(H=t.floorData.get(ie[0].properties.level))===null||H===void 0?void 0:H.walls,be=(ue=t.floorData.get(ie[0].properties.level))===null||ue===void 0?void 0:ue.wallFeatures;if((be==null?void 0:be.length)>0&&be.forEach(function(ae,ct){var Pe=Sr.lineIntersect(ee,ae).features;if(Pe.length>0){var V=Pe[0];V.properties.level=ie[0].properties.level,V.properties.neighbours=[],V.properties.bordersArea=!0,V.properties.walkableAreaId=J[0][0].properties.walkableAreaId,ee.properties.narrowPath&&(V.properties.narrowPath=!0),ee.properties.ramp&&(V.properties.ramp=!0),ee.properties.hill&&(V.properties.hill=!0);var Q=t._distance(ie[0],V);W.push({point:V,distance:Q,wallIndex:ct})}}),W.length>0){W.sort(function(ae,ct){return ae.distance-ct.distance});var Oe=ie[0];W.forEach(function(ae,ct){var Pe;Oe.properties.neighbours.push(ae.point),J[ae.wallIndex][0].properties.neighbours.push(ae.point),J[ae.wallIndex][1].properties.neighbours.push(ae.point),ae.point.properties.neighbours.push(Oe,J[ae.wallIndex][0],J[ae.wallIndex][1]),(Pe=ae.point.properties.neighbours).push.apply(Pe,Fa(l[_].properties.intersectionPointList)),l[_].properties.intersectionPointList.forEach(function(V){return V.properties.neighbours.push(ae.point)}),Oe=ae.point,l[_].properties.intersectionPointList.push(ae.point)});var Ae=Sr.lineString([Oe.geometry.coordinates,ie[1].geometry.coordinates]);Ae.properties.level=Oe.properties.level,ie[1].properties.neighbours.push(Oe),Oe.properties.neighbours.push(ie[1]),X.push.apply(X,Fa(W.map(function(ae){return ae.point})))}_++};_<i.length;)R();X.forEach(function(U){t.floorData.get(U.properties.level).points.push(U)}),X.forEach(function(U){var H,ue=t._findNeighbours(U,null,null,t.floorData.get(U.properties.level).points);(H=U.properties.neighbours).push.apply(H,Fa(ue))}),this.corridorLinePointPairs=i,this.corridorLineFeatures=l,this.corridorLinePoints=[],this.corridorLinePointPairs.forEach(function(U){U[0].properties.isCorridorPoint=!0,U[1].properties.isCorridorPoint=!0,t.corridorLinePoints.includes(U[0])||t.corridorLinePoints.push(U[0]),t.corridorLinePoints.includes(U[1])||t.corridorLinePoints.push(U[1])}),this.corridorLinePoints=this.corridorLinePoints.concat(p);var k=new Map;this.levelChangerList.forEach(function(U){if(U.properties.group!==void 0){var H=U.properties.group;k.has(H)||k.set(H,[]);var ue=k.get(H);ue.push(U)}else k.set(U.id,[U]);U.properties.fixedPointMap=new Map,U.properties.levels.forEach(function(ie){var ee=t._copyPoint(U);ee.properties.level=ie;var W=t._getFixPointInArea(ee);W.id=U.id,W.properties.amenity=U.properties.amenity,W.properties.direction=U.properties.direction,W.properties.id=U.properties.id,W.properties.level=ie,W.properties.type=U.properties.type,W.properties.neighbours===void 0&&(W.properties.neighbours=[]),!(t._distance(ee,W)>5)&&(U.properties.fixedPointMap.set(ie,W),W.properties.onCorridor&&W.properties.neighboursLeadingTo!==void 0&&(W.properties.neighboursLeadingTo.forEach(function(J){J.properties.neighbours===void 0&&(J.properties.neighbours=[]),J.properties.neighbours.push(W)}),t.corridorLineFeatures[W.properties.corridorIndex].properties.intersectionPointList.push(W)))})}),k.forEach(function(U,H){var ue=U.map(function(ee){return ee.properties.direction}).find(function(ee){return ee!==void 0}),ie=[];U.forEach(function(ee){ie.push.apply(ie,Fa(ee.properties.fixedPointMap.values()))}),ie.forEach(function(ee){if(ee.properties.neighbours==null&&(ee.properties.neighbours=[]),ue===t.DIRECTION_UP){var W;(W=ee.properties.neighbours).push.apply(W,Fa(ie.filter(function(Oe){return Oe.properties.level>ee.properties.level})))}else if(ue===t.DIRECTION_DOWN){var J;(J=ee.properties.neighbours).push.apply(J,Fa(ie.filter(function(Oe){return Oe.properties.level<ee.properties.level})))}else{var be;(be=ee.properties.neighbours).push.apply(be,Fa(ie.filter(function(Oe){return Oe.properties.level!==ee.properties.level})))}})})}},{key:"_removeItemFromList",value:function(t,n){var i=t.indexOf(n);i>=0&&t.splice(i,1)}},{key:"load",value:function(t,n){var i=this;this.neighbourMap=t,this.rebuildData(),this.wallOffsets=n,this.wallOffsetLineList=[],this._getPointList().forEach(function(l,p){var u=i.wallOffsets[p];if(u){var _=Sr.lineString([l.geometry.coordinates,u.geometry.coordinates]);_.properties.level=l.properties.level,i.wallOffsetLineList.push(_)}})}},{key:"_isPointOnLevel",value:function(t,n){return t.properties.fixedPointMap!==void 0?t.properties.fixedPointMap.has(n):t.properties.level===n}},{key:"_getPointList",value:function(){var t=[];return this.floorData.forEach(function(n,i){t=t.concat(n.points)}),this.levelChangerList.forEach(function(n){var i;return(i=t).push.apply(i,Fa(n.properties.fixedPointMap.values()))}),t=t.concat(),t=t.concat(this.corridorLinePoints),t}},{key:"preprocess",value:function(){return{neighbourhood:this._generateNeighbourhoodMap(),wallOffsets:this._generateWallOffsets()}}},{key:"_generateNeighbourhoodMap",value:function(){var t=this,n=this._getPointList(),i={};return this.floorData.forEach(function(l,p){var u={},_=l.points.concat(t.levelChangerList.filter(function(m){return t._isPointOnLevel(m,p)}).map(function(m){return m.properties.fixedPointMap.get(p)}));_.forEach(function(m){var S=n.indexOf(m),P=t._unwrapLevelChangerPoint(m,p),O=P===m?null:P,M=t._findNeighbours(P,O,null,_);u[S]=M.map(function(B){return n.indexOf(B)})}),i[p]=u}),this.corridorLinePoints.forEach(function(l){var p=n.indexOf(l),u=l.properties.level,_,m=i[u];if(l.properties.bordersArea){var S=t.floorData.get(u).points.concat(t.levelChangerList.filter(function(P){return t._isPointOnLevel(P,u)})).concat(t.corridorLinePoints.filter(function(P){return P.properties.bordersArea&&t._isPointOnLevel(P,u)}));_=t._findNeighbours(l,l,null,S),_.forEach(function(P){var O=n.indexOf(P);m&&(m[O]===void 0&&(m[O]=[]),m[O].includes(p)||m[O].push(p))})}else _=l.properties.neighbours;m[p]===void 0?m[p]=_.map(function(P){return n.indexOf(P)}):_.forEach(function(P){return m[p].push(n.indexOf(P))})}),this.neighbourMap=i,i}},{key:"_generateWallOffsets",value:function(){var t=this;this.wallOffsetLineList=[],this.wallOffsets={};var n=this._getPointList();return n.forEach(function(i){var l;if(i.properties.level!=null){var p=(l=t.floorData.get(i.properties.level))===null||l===void 0?void 0:l.walls.filter(function(ue){return ue.includes(i)});if(!(!p||p.length===0)){var u=p[0][0]===i?p[0][1]:p[0][0],_=p[1][0]===i?p[1][1]:p[1][0],m=Sr.bearing(i,u),S=Sr.bearing(i,_),P=t._averageBearing(m,S),O=P>0?P-180:P+180,M=Sr.destination(i.geometry.coordinates,.01,P,{units:t.UNIT_TYPE}),B=Sr.destination(i.geometry.coordinates,.01,O,{units:t.UNIT_TYPE}),$=null;for(var q in t.floorData.get(i.properties.level).areas){var X=t.floorData.get(i.properties.level).areas[q];if(Sr.booleanContains(X,M)){$=M;break}else if(Sr.booleanContains(X,B)){$=B;break}}if($!=null){var R=Sr.destination(i.geometry.coordinates,t.wallOffsetDistance*2,$===M?P:O,{units:t.UNIT_TYPE}),k=Sr.lineString([i.geometry.coordinates,R.geometry.coordinates]);t.floorData.get(i.properties.level).walls.forEach(function(ue,ie){if(!p.includes(ue)){var ee=t.floorData.get(i.properties.level).wallFeatures[ie],W=Sr.lineIntersect(k,ee);W.features.length>0&&(R=Sr.point(W.features[0].geometry.coordinates),k=Sr.lineString([i.geometry.coordinates,R.geometry.coordinates]))}});var U=Sr.midpoint(i.geometry.coordinates,R.geometry.coordinates);U.properties.level=i.properties.level,t.wallOffsets[n.indexOf(i)]=U;var H=Sr.lineString([i.geometry.coordinates,U.geometry.coordinates]);H.properties.level=i.properties.level,t.wallOffsetLineList.push(H)}}}}),this.wallOffsets}},{key:"reconstructPath",value:function(t){var n=this,i=[],l=t;do{var p=this._calculateWallOffsetPointList(t,i.length>0?i[i.length-1]:l);if(p.forEach(function(k){if(l===t||l.geometry.coordinates[0]!==k.geometry.coordinates[0]||l.geometry.coordinates[1]!==k.geometry.coordinates[1]){var U=n._copyPoint(k);U.properties.level=t.properties.level,U.properties.walkableAreaId=t.properties.walkableAreaId,U.properties.bordersArea=t.properties.bordersArea,i.push(U),l=k}}),t=t.properties.cameFrom,i.length>1e4)throw new Error("Too big route")}while(t!=null);i.reverse();for(var u=[],_=0;_<i.length-1;_++){var m=i[_],S=i[_+1];if(m.properties.level===S.properties.level){var P=this._distance(m,S);P<.7&&u.push(m)}}i=i.filter(function(k){return!u.includes(k)}),u=[];for(var O=1;O<i.length-1;O++){var M=i[O-1],B=i[O],$=i[O+1];if(!(M.properties.level!==B.properties.level||M.properties.level!==$.properties.level)){var q=this.bearing(M.geometry.coordinates,B.geometry.coordinates),X=this.bearing(B.geometry.coordinates,$.geometry.coordinates),R=Math.abs(q-X);R>Math.PI&&(R-=Math.PI),R<.03488888&&u.push(B)}}return i=i.filter(function(k){return!u.includes(k)}),i}},{key:"_calculateWallOffsetPointList",value:function(t,n){var i=this,l=this._getPointList(),p=l.indexOf(t),u=l.indexOf(n),_=[],m=t;p>=0&&this.wallOffsets[p]&&(m=this.wallOffsets[p]),_.push(m);var S,P=function(){var M=Sr.lineString([n.geometry.coordinates,m.geometry.coordinates]);S=[],i.wallOffsetLineList.forEach(function(B,$){if(B.properties.level===t.properties.level&&!($===u||$===p)){var q=Sr.lineIntersect(M,B);if(q.features.length>0){var X=i.wallOffsets[$];X.properties.distance=i._distance(q.features[0],m),X.properties.offsetIndex=$,S.push(X)}}}),S.length>0&&(S.sort(function(B,$){return B.properties.distance-$.properties.distance}),m=S[0],p=m.properties.offsetIndex,_.push(m))};do P();while(S.length>0);return _.reverse()}},{key:"_getIntersectingOffsetPoints",value:function(t,n){var i=this;if(t===n||t.properties.level!==n.properties.level)return[];var l=Sr.lineString([t.geometry.coordinates,n.geometry.coordinates]),p=[];return this.wallOffsetLineList.forEach(function(u,_){if(u.properties.level===t.properties.level&&Sr.lineIntersect(l,u).features.length>0){var m=i.wallOffsets[_];m.properties.distance=Sr.pointToLineDistance(t.geometry.coordinates,u,{units:i.UNIT_TYPE}),p.push(m)}}),p.sort(function(u,_){return _.properties.distance-_.properties.distance}),p}},{key:"clearData",value:function(){this.floorData.forEach(function(t,n){for(var i in t.points){var l=t.points[i];delete l.properties.cameFrom,delete l.properties.gscore,delete l.properties.fscore}}),this.levelChangerList.forEach(function(t){t.properties.fixedPointMap.forEach(function(n,i){delete n.properties.cameFrom,delete n.properties.gscore,delete n.properties.fscore})}),this.corridorLinePoints.forEach(function(t){delete t.properties.cameFrom,delete t.properties.gscore,delete t.properties.fscore})}},{key:"runAStar",value:function(t,n){var i=this.calculatePath(t,n);if(i!==void 0&&i.length==2){var l=this._checkShortPath(i[0],i[1]);if(!l)return}return i}},{key:"runAStarWithDetails",value:function(t,n){var i=this.runAStar(t,n),l=this.calculateDistance(i),p=this.calculateTime(i,l);return{path:i,distance:l,duration:p}}},{key:"isPathElevator",value:function(t,n){return t[n].properties.type==this.POI_TYPE.ELEVATOR&&t[n+1].properties.type==this.POI_TYPE.ELEVATOR}},{key:"isPathEscalator",value:function(t,n){return t[n].properties.type==this.POI_TYPE.ESCALATOR&&t[n+1].properties.type==this.POI_TYPE.ESCALATOR}},{key:"isPathStaircase",value:function(t,n){return t[n].properties.type==this.POI_TYPE.STAIRCASE&&t[n+1].properties.type==this.POI_TYPE.STAIRCASE}},{key:"isPathFlat",value:function(t,n){return!this.isPathElevator(t,n)&&!this.isPathEscalator(t,n)&&!this.isPathStaircase(t,n)}},{key:"calculateDistance",value:function(t){var n=this,i=0;return t===void 0||t.length===0||t.forEach(function(l,p){t[p+1]!==void 0&&(i+=Sr.distance(t[p],t[p+1],{units:n.UNIT_TYPE}))}),i}},{key:"calculateTime",value:function(t,n){var i=this,l=n/this.walkingSpeed,p=0,u=0,_=0;t===void 0&&(t=[]),t.forEach(function(S,P){if(i.isPathElevator(t,P)){var O=Math.abs(t[P].properties.level-t[P+1].properties.level);p+=O*i.floorHeight/i.elevatorSpeed+i.elevatorWaiting}if(i.isPathEscalator(t,P)){var M=Math.abs(t[P].properties.level-t[P+1].properties.level),B=i.floorHeight*i.floorHeight;u+=M*Math.sqrt(B+B)/i.escalatorSpeed}if(i.isPathStaircase(t,P)){var $=Math.abs(t[P].properties.level-t[P+1].properties.level),q=i.floorHeight*i.floorHeight;_+=$*Math.sqrt(q+q)/i.staircasesSpeed}});var m=l+p+u+_;return{shortest:l,elevator:p,escalator:u,staircase:_,realistic:m}}},{key:"calculatePath",value:function(t,n){var i=this;this.clearData(),this.nbLines=[],this.bearingCache=new Map;var l=this._getFixPointInArea(t,!0),p=this._getFixEndPoint(n,t.properties.level),u=[l],_=[];l.properties.gscore=0,l.properties.fscore=this._heuristic(l,p);for(var m=function(){var O=i._getMinFScore(u,_);if(O===null)return 0;if(O===p){var M=void 0;try{M=i.reconstructPath(O)}catch{return{v:void 0}}return p!==n&&(!p.properties.onCorridor||i._distance(p,n)>i.pathFixDistance)&&(n.properties.fixed=!0,M.push(n)),l!==t&&(!l.properties.onCorridor||i._distance(l,t)>i.pathFixDistance)&&(t.properties.fixed=!0,M.unshift(t)),M[M.length-1].properties.gscore=O.properties.gscore,{v:M}}_.push(u.splice(u.indexOf(O),1));var B=i._getNeighbours(O,l,p);B.forEach(function($){return i.nbLines.push(Sr.lineString([O.geometry.coordinates,$.geometry.coordinates]))}),B.forEach(function($){if(_.indexOf($)<=-1){var q=O.properties.gscore+i._distance(O,$),X=$.properties.gscore!=null?$.properties.gscore:1/0;q<X&&($.properties.cameFrom=O,$.properties.gscore=q+.2,$.properties.fscore=q+i._heuristic($,p),u.indexOf($)<0&&u.push($))}})},S;u.length>0&&(S=m(),S!==0);)if(S)return S.v}},{key:"_checkIfCrossingTwoPolygon",value:function(t,n){var i=t.properties||{},l=n.properties||{};return l.walkableAreaId!==void 0&&i.walkableAreaId!==void 0&&(l.walkableAreaId!==i.walkableAreaId||l.bordersArea===void 0)?!0:i.walkableAreaId!==void 0&&l.walkableAreaId===void 0?l.isCorridorPoint!==!0:!1}},{key:"_getNeighbours",value:function(t,n,i){var l=this,p=[];if(t===n){var u=this._getPointList().filter(function($){return l._isPointOnLevel($,t.properties.level)});p=this._findNeighbours(t,n,i,u),p=p.filter(function($){var q=t.properties.level,X=l.configuration.avoidRevolvingDoors&&l._testAccessibilityPoiNeighbourhood(t,$,q,l.POI_TYPE.REVOLVING_DOOR),R=l.configuration.avoidTicketGates&&l._testAccessibilityPoiNeighbourhood(t,$,q,l.POI_TYPE.TICKET_GATE),k=l._checkIfCrossingTwoPolygon(t,$);return!X&&!R&&!k})}else{var _=this._getPointList(),m=_.indexOf(t);if(m>=0&&this.floorData.forEach(function($,q){var X=l.neighbourMap[q];X.hasOwnProperty(m)&&X[m].forEach(function(R){var k=_[R],U=l.configuration.avoidRevolvingDoors&&l._testAccessibilityPoiNeighbourhood(t,k,q,l.POI_TYPE.REVOLVING_DOOR),H=l.configuration.avoidTicketGates&&l._testAccessibilityPoiNeighbourhood(t,k,q,l.POI_TYPE.TICKET_GATE),ue=l._checkIfCrossingTwoPolygon(t,k);!p.includes(k)&&!U&&!H&&!ue&&p.push(k)})}),t.properties.level!==void 0&&t.properties.level===i.properties.level||t.properties.fixedPointMap!=null&&t.properties.fixedPointMap.has(i.properties.level)){var S=this.configuration.avoidRevolvingDoors&&this._testAccessibilityPoiNeighbourhood(t,i,i.properties.level,this.POI_TYPE.REVOLVING_DOOR),P=this.configuration.avoidTicketGates&&this._testAccessibilityPoiNeighbourhood(t,i,i.properties.level,this.POI_TYPE.TICKET_GATE),O=this._checkIfCrossingTwoPolygon(t,i);if(!S&&!P&&!O)if(i.properties.onCorridor)(i.properties.neighbours.includes(t)||i.properties.neighboursLeadingTo!==void 0&&i.properties.neighboursLeadingTo.includes(t))&&p.push(i);else{var M=this._unwrapLevelChangerPoint(t,i.properties.level),B=1;(M.properties.isCorridorPoint||M.properties.onCorridor)&&B--,this._countIntersections(M,i,B)&&p.push(i)}}}return p.filter(function($){return l.configuration.avoidElevators&&$.properties.type===l.POI_TYPE.ELEVATOR||l.configuration.avoidEscalators&&$.properties.type===l.POI_TYPE.ESCALATOR||l.configuration.avoidStaircases&&$.properties.type===l.POI_TYPE.STAIRCASE||l.configuration.avoidNarrowPaths&&$.properties.narrowPath||l.configuration.avoidRamps&&$.properties.ramp?!1:!(l.configuration.avoidHills&&$.properties.hill)})}},{key:"_testAccessibilityPoiNeighbourhood",value:function(t,n,i,l){var p=this,u=!1;if(l===this.POI_TYPE.REVOLVING_DOOR&&this.configuration.avoidRevolvingDoors){var _=Sr.lineString([t.geometry.coordinates,n.geometry.coordinates]),m=this.accessibilityPoi.filter(function(S){return S.properties.level===i&&S.properties.type===l});m.forEach(function(S){var P=Sr.pointToLineDistance(S.geometry.coordinates,_,{units:p.UNIT_TYPE});P<=S.properties.radius&&(u=!0)})}return u}},{key:"_findNeighbours",value:function(t,n,i,l){var p=[];if(t.properties.neighbours!=null&&(p=Fa(t.properties.neighbours)),t===n&&t.properties.onCorridor||t.properties.isCorridorPoint&&!t.properties.bordersArea)return i&&i.properties.onCorridor&&n.properties.corridorIndex===i.properties.corridorIndex&&p.push(i),p;var u=0;i&&this._isPointOnLevel(i,t.properties.level)&&l.push(i);var _=this._unwrapLevelChangerPoint(t,t.properties.level);for(var m in l){var S=l[m];if(t!==S&&!(p.indexOf(S)>=0)){var P=this._unwrapLevelChangerPoint(S,t.properties.level);u=2,t===n&&u--,S===n&&u--,t!==_&&u--,S!==P&&u--,(S.properties.isCorridorPoint||S.properties.onCorridor)&&u--;var O=this._countIntersections(t,P,u);if(O){var M=Sr.midpoint(t.geometry.coordinates,S.geometry.coordinates);for(var B in this.floorData.get(t.properties.level).areas){var $=this.floorData.get(t.properties.level).areas[B];if(Sr.booleanContains($,M)){p.push(S);break}}}}}return p}},{key:"_comparePointLevels",value:function(t,n){if(t.properties.levels==null&&n.properties.levels==null)return t.properties.level===n.properties.level;var i=t.properties.fixedPointMap!==void 0?Fa(t.properties.fixedPointMap.keys()):[t.properties.level],l=n.properties.fixedPointMap!==void 0?Fa(n.properties.fixedPointMap.keys()):[n.properties.level];return i.filter(function(p){return l.includes(p)}).length>0}},{key:"_unwrapLevelChangerPoint",value:function(t,n){var i=t.properties.fixedPointMap;if(i){var l=i.get(n);return l||t}else return t}},{key:"_countIntersections",value:function(t,n,i){var l=t.geometry.coordinates,p=n.geometry.coordinates,u=this.bearing(l,p),_=0,m=[],S=this.floorData.get(t.properties.level).walls,P=this.floorData.get(t.properties.level).wallFeatures;for(var O in S){var M=S[O],B=!1,$=!1;if(t==M[0]||t==M[1])B=!0,$=!0;else{var q=this.bearing(l,M[0].geometry.coordinates),X=this.bearing(l,M[1].geometry.coordinates);if(q>X){var R=q;q=X,X=R}var k=X-q;k<Math.PI?q<=u&&u<=X&&(B=!0):(q>=u||u>=X)&&(B=!0)}if(B){if($)this._testIdenticalPointInList(t,m)||(m.push(t),_++);else{var U=Sr.lineIntersect(Sr.lineString([l,p]),P[O]).features;U.length>0&&(this._testIdenticalPointInList(U[0],m)||(m.push(U[0]),_++))}if(_>i)return!1}}return!0}},{key:"_averageBearing",value:function(t,n){if(t>n){var i=t;t=n,n=i}n-t>180&&(n-=360);var l=(n+t)/2;return l<=-180?360+l:l}},{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"bearing",value:function(t,n){var i=this.bearingCache.get(t);if(i){var l=i.get(n);if(l!=null)return l}var p=this.toRadians(t[0]),u=this.toRadians(t[1]),_=this.toRadians(n[0]),m=this.toRadians(n[1]),S=Math.cos(m),P=Math.sin(_-p)*S,O=Math.cos(u)*Math.sin(m)-Math.sin(u)*S*Math.cos(_-p),M=Math.atan2(P,O);return this._storeBearingCache(t,n,M),M}},{key:"_storeBearingCache",value:function(t,n,i){var l=this.bearingCache.get(t);l||(l=new Map,this.bearingCache.set(t,l)),l.set(n,i),l=this.bearingCache.get(n),l||(l=new Map,this.bearingCache.set(n,l)),i<=0?i+=Math.PI:i-=Math.PI,l.set(t,i)}},{key:"_testIdenticalPointInList",value:function(t,n){return n.find(function(i){return i.geometry.coordinates[0]===t.geometry.coordinates[0]&&i.geometry.coordinates[1]===t.geometry.coordinates[1]})!==void 0}},{key:"_getMinFScore",value:function(t,n){var i=null,l=1/0;return(n.slice(-1).properties||{}).walkableAreaId,(n.slice(-2).properties||{}).walkableAreaId,t.forEach(function(p){var u=p.properties;u.fscore<l&&(i=p,l=u.fscore)}),i}},{key:"_heuristic",value:function(t,n){var i=this;if(this._comparePointLevels(t,n)){var l=0;return(t.properties.levels!==void 0||n.properties.levels!==void 0)&&(l=20),this._distance(t,n)+l}else{var p=this.levelChangerList.filter(function(_){return _!==t&&_!==n&&i._comparePointLevels(_,t)&&i._comparePointLevels(_,n)}),u=1/0;return p.forEach(function(_){var m=i._distance(t,_)+i._distance(_,n)+10;m<u&&(u=m)}),u<1/0?u:2e3}}},{key:"_distance",value:function(t,n){var i=0;return n.properties.level!==t.properties.level&&(i=10),Sr.distance(t,n,{units:this.UNIT_TYPE})+i}},{key:"_getFixEndPoint",value:function(t,n){var i=this.levelChangerList.find(function(p){return p.id===t.id});if(i!==void 0&&i.properties.fixedPointMap!==void 0){var l=void 0;i.properties.fixedPointMap.forEach(function(p,u){(l===void 0||Math.abs(l-n)>Math.abs(u-n))&&(l=u)}),t=this._copyPoint(t),t.properties.level=l}return this._getFixPointInArea(t)}},{key:"_getFixPointInArea",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.floorData.get(t.properties.level),p=void 0;if((l==null?void 0:l.areas.length)>0&&l.areas.forEach(function(ae){if(Sr.booleanContains(ae,t)){p=t;return}}),p!==void 0)return p;var u=null,_=1/0;(l==null?void 0:l.wallFeatures.length)>0&&l.wallFeatures.forEach(function(ae){var ct=Sr.pointToLineDistance(t.geometry.coordinates,ae,{units:n.UNIT_TYPE});ct<=_&&(u=ae,_=ct)});var m=this.corridorLineFeatures.filter(function(ae){return ae.properties.level===t.properties.level}),S=null,P=1/0;if(m.forEach(function(ae){var ct=n.corridorLineFeatures.indexOf(ae),Pe=Sr.pointToLineDistance(t.geometry.coordinates,ae,{units:n.UNIT_TYPE});Pe<P&&(S=ct,P=Pe)}),u===null&&S===null)return t;var O;if(S!==void 0&&P<_){var M=this.corridorLineFeatures[S];O=Sr.nearestPointOnLine(M,t),O.properties.onCorridor=!0,O.properties.corridorIndex=S,O.properties.neighbours||(O.properties.neighbours=[]);var B=this.corridorLineFeatures[S].properties.isAvailableNow,$=this.corridorLineFeatures[S].properties.bidirectional===void 0||this.corridorLineFeatures[S].properties.bidirectional===!0,q=this.corridorLineFeatures[S].properties.swapDirection!==void 0&&this.corridorLineFeatures[S].properties.swapDirection===!0;if(B)if($){var X;O.properties.neighbours.push(this.corridorLinePointPairs[S][0],this.corridorLinePointPairs[S][1]),(X=O.properties.neighbours).push.apply(X,Fa(M.properties.intersectionPointList)),O.properties.neighboursLeadingTo=[this.corridorLinePointPairs[S][0],this.corridorLinePointPairs[S][1]].concat(Fa(M.properties.intersectionPointList))}else if(!q&&!i){var R,k=this.corridorLinePointPairs[S][0];O.properties.neighbours.push(k);var U=this._distance(O,k),H=M.properties.intersectionPointList.filter(function(ae){return n._distance(ae,k)<U}),ue=M.properties.intersectionPointList.filter(function(ae){return n._distance(ae,k)>=U});(R=O.properties.neighbours).push.apply(R,Fa(ue)),O.properties.neighboursLeadingTo=H}else{var ie,ee=this.corridorLinePointPairs[S][1];O.properties.neighbours.push(ee);var W=this._distance(O,ee),J=M.properties.intersectionPointList.filter(function(ae){return n._distance(ae,ee)<=W}),be=M.properties.intersectionPointList.filter(function(ae){return n._distance(ae,ee)>W});(ie=O.properties.neighbours).push.apply(ie,Fa(J)),O.properties.neighboursLeadingTo=be}}else if(u!==null){var Oe=Sr.nearestPointOnLine(u,t),Ae=Sr.bearing(t,Oe);O=Sr.destination(t.geometry.coordinates,_+.05,Ae,{units:this.UNIT_TYPE})}return O.properties.level=t.properties.level,O}},{key:"_copyPoint",value:function(t){var n=Sr.point([t.geometry.coordinates[0],t.geometry.coordinates[1]]);return t.id!==void 0&&(n.id=t.id),t.properties.id!==void 0&&(n.properties.id=t.properties.id),t.properties.amenity!==void 0&&(n.properties.amenity=t.properties.amenity),t.properties.type!==void 0&&(n.properties.type=t.properties.type),n}},{key:"_setNeighbourhoodBasedOnCorridorDirectionality",value:function(t,n,i,l){l.properties.neighbours===void 0&&(l.properties.neighbours=[]);var p=t.properties.isAvailableNow,u=t.properties.bidirectional===void 0||t.properties.bidirectional===!0,_=t.properties.swapDirection!==void 0&&t.properties.swapDirection===!0;p&&(u?(l.properties.neighbours.push(n,i),n.properties.neighbours.push(l),i.properties.neighbours.push(l)):_?(i.properties.neighbours.push(l),l.properties.neighbours.push(n)):(n.properties.neighbours.push(l),l.properties.neighbours.push(i)))}},{key:"_comparePointsByDistanceFromReference",value:function(t,n,i){var l=Sr.distance(t,n),p=Sr.distance(t,i);return l>p?1:p>l?-1:0}},{key:"_checkShortPath",value:function(t,n){var i=this._getFixPointInArea(t,!0),l=this._getFixPointInArea(n,!0);if(i.properties.corridorIndex===l.properties.corridorIndex){var p=i.properties.corridorIndex,u=this.corridorLineFeatures[p],_=u.properties.isAvailableNow;if(!_)return!1;var m=u.properties.bidirectional===void 0||u.properties.bidirectional===!0;if(m)return!0;var S=u.geometry.coordinates,P=Sr.bearing(S[0],S[1]),O=Sr.bearing(t,n),M=parseInt(P-O),B=u.properties.swapDirection!==void 0&&u.properties.swapDirection;return B?M!==0:M===0}return!0}},{key:"_checkTimeBased",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Date,i=!0;if(t.properties.workingHours!==void 0){var l=n.getDay(),p=t.properties.workingHours[l],u=parseInt(n.getHours()),_=parseInt(n.getMinutes()),m=u*60+_;if(p.length===0)return!1;var S=p[0].split(":"),P=parseInt(S[0]),O=parseInt(S[1]),M=P*60+O,B=p[1].split(":"),$=parseInt(B[0]),q=parseInt(B[1]),X=$*60+q;if(M===0&&M===X)return!0;i=m>=M&&m<=X}return i}},{key:"_checkAvailablePath",value:function(t){var n=!0;return t.properties.available!==void 0&&(n=t.properties.available),n}}]),e}();Object.defineProperty(TS,"__esModule",{value:!0});var nH=ry,Jh=Ts,mm=zt,iH=function(){function e(){this.data=new Jh.FeatureCollection({})}return e.prototype.setData=function(r){this.data=r,this.wayfinding=new nH.Wayfinding(this.data),this.wayfinding.preprocess()},e.prototype.toggleOnlyAccessible=function(r){r?this.wayfinding.setConfiguration({avoidElevators:!1,avoidRamps:!1,avoidEscalators:!0,avoidStaircases:!0,avoidNarrowPaths:!0,avoidRevolvingDoors:!0,avoidTicketGates:!0,avoidBarriers:!0,avoidHills:!0}):this.wayfinding.setConfiguration({avoidElevators:!0,avoidRamps:!0,avoidEscalators:!1,avoidStaircases:!1,avoidNarrowPaths:!1,avoidRevolvingDoors:!1,avoidTicketGates:!1,avoidBarriers:!1,avoidHills:!1})},e.prototype.setConfig=function(r){this.wayfinding.setConfiguration(r)},e.prototype.route=function(r,t){var n=this,i=null,l=null;if(this.routeWithDetails){var p=this.wayfinding.runAStarWithDetails(r,t);i=p.path,l={distance:p.distance,duration:p.duration}}else i=this.wayfinding.runAStar(r,t);if(!i)return null;i=i.map(function(H){return new Jh.default(H)});var u={},_=0;i.forEach(function(H,ue){n.forceFloorLevel!==null&&n.forceFloorLevel!==void 0?(typeof u["path-part-".concat(_)]>"u"&&(u["path-part-".concat(_)]=[]),u["path-part-".concat(_)].push(H),H.isLevelChanger&&i[ue+1].isLevelChanger&&H.level!==i[ue+1].level&&_++):(typeof u["path-part-".concat(_)]>"u"&&(u["path-part-".concat(_)]=[]),u["path-part-".concat(_)].push(H),H.isLevelChanger&&H.properties.level!==i[ue+1].properties.level&&_++)});for(var m={},S=0,P=Object.entries(u);S<P.length;S++){var O=P[S],M=O[0],B=O[1];this.forceFloorLevel!==null&&this.forceFloorLevel!==void 0?B.length>1?m[M]=new Jh.default((0,mm.lineString)(B.map(function(H){return H.geometry.coordinates}))):m[M]=new Jh.default((0,mm.point)(B[0].geometry.coordinates)):B.length>1?m[M]=new Jh.default((0,mm.lineString)(B.map(function(H){return H.geometry.coordinates}))):m[M]=new Jh.default((0,mm.point)(B[0].geometry.coordinates)),m[M].id=M,m[M].properties={level:B[B.length-1].properties.level,amenity:"chevron_right"}}for(var $={},q=0,X=Object.entries(m);q<X.length;q++){var R=X[q],M=R[0],k=R[1];typeof $[k.properties.level]>"u"?$[k.properties.level]={level:k.properties.level,paths:[k]}:$[k.properties.level].paths.push(k)}var U={};return i.forEach(function(H){typeof U[H.properties.level]>"u"&&(U[H.properties.level]=[]),U[H.properties.level].push(H)}),{paths:m,points:i,levelPaths:$,levelPoints:U,details:l}},e}();TS.default=iH;var MS={};Object.defineProperty(MS,"__esModule",{value:!0});var rb=Ts,Pp=vd,Pa;(function(e){e.Start="START",e.Finish="FINISH",e.Exit="EXIT",e.Up="UP",e.Down="DOWN",e.Left="LEFT",e.Right="RIGHT",e.Straight="STRAIGHT",e.TurnAround="TURN_AROUND",e.HardLeft="HARD_LEFT",e.SlightLeft="SLIGHT_LEFT",e.HardRight="HARD_RIGHT",e.SlightRight="SLIGHT_RIGHT"})(Pa||(Pa={}));var Zp;(function(e){e.staircase="STAIRS",e.escalator="ESCALATOR",e.elevator="ELEVATOR",e.ramp="RAMP"})(Zp||(Zp={}));var oH=function(){function e(r){this.points=r,this.points&&this.points.length>0&&this.generateStepsFromPoints()}return e.prototype.generateStepsFromPoints=function(){var r=this;this.steps=this.points.map(function(t,n){var i=r.points[n-1]?new rb.default(r.points[n-1]):null,l=new rb.default(t),p=r.points[n+1]?new rb.default(r.points[n+1]):null,u={previousPoint:i,currentPoint:l,nextPoint:p};return{bearingFromLastStep:r.getBearingFromLastStep(u),coordinates:[t.geometry.coordinates[0],t.geometry.coordinates[1]],direction:r.getStepDirection(u),distanceFromLastStep:r.getDistanceFromLastStep(u),level:t.properties.level,levelChangerId:l.isLevelChanger?l.id:null,levelChangerType:l.isLevelChanger?l.properties.type:null,levelChangerDirection:l.isLevelChanger?r.getLevelChangerDirection(u):null,levelChangerDestinationLevel:l.isLevelChanger&&p.properties.level!==l.properties.level?p.properties.level:null,lineStringFeatureFromLastStep:r.getLineStringFeatureFromLastStep(u)}})},e.prototype.getBearingFromLastStep=function(r){var t=r.previousPoint,n=r.currentPoint;if(r.nextPoint,!t)return 0;var i=Pp.bearing(t.geometry.coordinates,n.geometry.coordinates);return i},e.prototype.getStepDirection=function(r){var t=r.previousPoint,n=r.currentPoint,i=r.nextPoint;if(!t)return Pa.Start;if(!i)return Pa.Finish;if(n.isLevelChanger&&i.properties.level>n.properties.level)return"".concat(Pa.Up,"_").concat(Zp[n.properties.type]);if(n.isLevelChanger&&i.properties.level<n.properties.level)return"".concat(Pa.Down,"_").concat(Zp[n.properties.type]);if(t.isLevelChanger&&n.isLevelChanger)return"".concat(Pa.Exit,"_").concat(Zp[n.properties.type]);var l=Pp.bearing(n.geometry.coordinates,i.geometry.coordinates)-Pp.bearing(t.geometry.coordinates,n.geometry.coordinates),p=this.degreeNormalized(l);return Math.abs(p)<22.5?Pa.Straight:Math.abs(p)>157.5?Pa.TurnAround:p<-112.5?Pa.HardLeft:p<=-67.5?Pa.Left:p<=-22.5?Pa.SlightLeft:p>157.5?Pa.HardLeft:p>=67.5?Pa.Right:p>=22.5?Pa.SlightRight:Pa.Straight},e.prototype.getDistanceFromLastStep=function(r){var t=r.previousPoint,n=r.currentPoint;if(r.nextPoint,!t||t.isLevelChanger&&n.isLevelChanger)return 0;var i=Pp.distance(t.geometry.coordinates,n.geometry.coordinates);return i*1e3},e.prototype.getLevelChangerDirection=function(r){r.previousPoint;var t=r.currentPoint,n=r.nextPoint;if(t.isLevelChanger&&n.properties.level>t.properties.level)return Pa.Up;if(t.isLevelChanger&&n.properties.level<t.properties.level)return Pa.Down},e.prototype.getLineStringFeatureFromLastStep=function(r){var t=r.previousPoint,n=r.currentPoint;if(r.nextPoint,!t||n.properties.level!==t.properties.level)return null;var i=Pp.lineString([t.geometry.coordinates,n.geometry.coordinates]);return i},e.prototype.degreeNormalized=function(r){return r>180?r-360:r<-180?r+360:r},e}();MS.default=oH;var aH=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),sH=we&&we.__awaiter||function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(p){p(l)})}return new(t||(t=Promise))(function(l,p){function u(S){try{m(n.next(S))}catch(P){p(P)}}function _(S){try{m(n.throw(S))}catch(P){p(P)}}function m(S){S.done?l(S.value):i(S.value).then(u,_)}m((n=n.apply(e,r||[])).next())})},uH=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;p&&(p=0,m[0]&&(t=0)),t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(CS,"__esModule",{value:!0});var lH=Nf,nb=Ts,cH=TS,hH=MS,fH=function(e){aH(r,e);function r(){var t=e.call(this,"route")||this;return t.isEditable=!1,t.changes=[],t.routing=new cH.default,t}return r.prototype.toggleAccessible=function(t){this.routing.toggleOnlyAccessible(t)},r.prototype.setConfig=function(t){this.routing.setConfig(t)},r.prototype.update=function(t,n){return sH(this,void 0,void 0,function(){var i,l,p,u,_,m,S,P;return uH(this,function(O){if(this.start=t,this.finish=n,this.data=new nb.FeatureCollection({features:[this.start,this.finish].concat(this.lines||[]).filter(function(M){return M})}),this.notify("feature-updated"),t&&n){if(this.notify("loading-start"),i=this.routing.route(t,n),l=i==null?void 0:i.paths,this.route=i==null?void 0:i.paths,this.points=i==null?void 0:i.points,this.levelPaths=i==null?void 0:i.levelPaths,this.levelPoints=i==null?void 0:i.levelPoints,this.details=i==null?void 0:i.details,p=new hH.default(i==null?void 0:i.points),this.steps=p.steps,l){for(u=[],_=0,m=Object.entries(l);_<m.length;_++)S=m[_],S[0],P=S[1],u.push(P);this.lines=u}else this.lines=[],this.notify("route-undefined");this.data=new nb.FeatureCollection({features:[this.start,this.finish].concat(this.lines||[]).filter(function(M){return M})}),this.notify("loading-finished"),this.notify("feature-updated")}return[2]})})},r.prototype.cancel=function(){this.start=void 0,this.finish=void 0,this.lines=void 0,this.route=void 0,this.points=void 0,this.levelPaths=void 0,this.levelPoints=void 0,this.details=void 0,this.steps=void 0,this.data=new nb.FeatureCollection({features:[this.start,this.finish].concat(this.lines||[]).filter(function(t){return t})}),this.notify("feature-updated")},r}(lH.default);CS.default=fH;var LS={},pH=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(LS,"__esModule",{value:!0});var dH=Nf,gH=Ts,mH=function(e){pH(r,e);function r(){var t=e.call(this,"clusters")||this;return t.cluster=!0,t.data=new gH.FeatureCollection({}),t}return r}(dH.default);LS.default=mH;var RS={},vH=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),yH=we&&we.__awaiter||function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(p){p(l)})}return new(t||(t=Promise))(function(l,p){function u(S){try{m(n.next(S))}catch(P){p(P)}}function _(S){try{m(n.throw(S))}catch(P){p(P)}}function m(S){S.done?l(S.value):i(S.value).then(u,_)}m((n=n.apply(e,r||[])).next())})},_H=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;p&&(p=0,m[0]&&(t=0)),t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(RS,"__esModule",{value:!0});var bH=Nd,xH=Pf,wH=function(e){vH(r,e);function r(){var t=e.call(this)||this;return t.sources=[],t.layers=[],t.floors={data:[],total:0},t.belowLayer="proximiio-floors",t.enabled=!0,t}return r.prototype.initialize=function(){return yH(this,void 0,void 0,function(){var t;return _H(this,function(n){switch(n.label){case 0:return t=this,[4,(0,xH.getFloors)()];case 1:return t.floors=n.sent(),[2]}})})},r.prototype.setLevel=function(t,n,i){var l=this;if(this.layers.forEach(function(u){try{i.style.getLayer(u)&&i.style.removeLayer(u)}catch{}}),this.sources.forEach(function(u){try{i.style.getSource(u)&&i.style.removeSource(u)}catch{}}),this.enabled){var p=this.floors.data.filter(function(u){return u.hasFloorplan&&u.level===n});p.forEach(function(u){var _={type:"image",url:u.floorplanImageUrl,coordinates:u.anchors},m="image-source-".concat(u.id);i.style.addSource(m,_),l.sources.push(m);var S={id:"image-layer-".concat(u.id),type:"raster",source:m,layout:{visibility:"visible"}};i.style.addLayer(S,l.belowLayer),l.layers.push(S.id)}),t.setStyle(i.style)}},r}(bH.Eventable);RS.default=wH;var ZN={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.pulsingDot=e.popupImage=e.floorchangeUpImage=e.floorchangeDownImage=e.person=e.chevron=e.defaultIcon=e.marker=e.routeB=e.routeA=e.door=e.ticketGate=e.staircase=e.poi=e.landmark=e.decision=e.hazard=e.entrance=e.escalator=e.elevator=void 0,e.elevator="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFfgAABX4BPgLDIQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA+pSURBVHic7Z17fFTlmce/z5kzyWQyl1yogqJQEESoYne9QAhoRC2tq36Uql01Vru6ih9dFfGylUrBov1YqLrqqrS1FuxWi7eq9W6jkASs3YqyyFWRikiEkJnJ5Doz590/kmAucznnzCUJ5PvfnHPe53ny/vKe857nvRxhgNNQVVSkOY0JorSJhqgJgkwENVxBvoAb8ADOzssjQFhBs0AbIl8qpTZqSjYpjA2xAsemkhMagv3316RG+juA3tSvLRmpR6IVSuQUgVOBsRl2sU3BOyLqXac4q9xl9V9k2H5aDAhBwrXFx0YNo1LgPOConDoXtgo8J8qxwlu+b0NOfccNp59oWuUeEZO8ixFVqWByf8XRi3Ugyx2RyB88FU27+yOAnAsSqvVOQGmLlGI2oOXav0kiiDwlKrbYV964OZeOcyZIYJX/n8QhC1HqewxcIXpjIPKKIdxZXBb4IBcOsy5I/doSnx6LLkLJdYAj2/6yRFQJD7S35/30kIo94Ww6ypogSiHBav9VItwDlGTLT46pQ8mtvvLAChFUNhxkRZD6tSUj9WjsV8CsbNgfALyi47yqsHzvrkwbzrgggWr/RQLLAF+mbQ8wQkpxZdH04MpMGs2YIKp2ZEFIhR9DqcpM2RwMiLDMGwz+h3yPtozYy4SR8NrCQ2NR/XlgaibsDT6kRjOi53lnhPekbSldA6Fa7wRlaK8Bo9K1Ncj5TDBmpfvektb7QGiVd5oytBqGxAAYrdBqQ7XesnSM2G4hDauLTtVEvQh40wngACSkiZztnRZYZaewLUFC1cXlBsYbAgV2yifCMOCmJS28Wh1hbqWLay7IS8verj0GF97azPqtMVvljxvv4I/3uhkxzPKNpFk04wxfWWOt1YKWPTWsLpqsMF7OtBgAi5a18sSL7dTtU9z+Xy38qSqSlr2//l/MthgAH22J8df1tsq7laG92LjGc4zVgpYEaVhTNFoT4xXAb9VRKp56PcJ9T37dc1QKrl7cwodb7FfozJN0xoy0/5gcO1Jj5sm63eKlsZjjzYaaIkvPV9PRqipcWkw9B3KY9diSs/rvUa67p7nP8ZZWxQXzmvjiK8OWXW+h8MJ9hQwrsn5nHlYkPH9fIR63/Y6owOGaUivVBkzfe00LEnT6HwS+bSuyJHy606ByfjORaPzzdfsUF93WTHOrvdTRqBEaKxa7yXOmvraLPCesWOxm1IiMJKVPDDX47zd7sSmPwRrfpQJX2o8pgd2w4qLbmmgIJa/s9Vtj/PuiFgx7DYWyyTr3zTP/yLtvXgFlk23fquIxJ1jtu9jMhSkF6RhQkkfSj6kn0RhcsaCZLTvM1fJLqyIs/k2rbX+XnpVnqtc254J8Lj0rvd5dfOSxULX36FRXJRVEKQRDe4SOmR0Z5c7/buXt9xLcpxKwdHkbT79uv+d19/UFzCpL/J8/q0xn8fUu2/ZT4FFoD6W6KKkgjbVFP1QdMz8yylOvR3j4aeu5OKXghl/Y73k5NHh0vjtuz2vsSI1H57txZHcs8/Rgje/SZBck7EKE3vOWqoi2GSjNdFTjzwlRt8/++M6sMp2n7y20XX7LDoPTrw4TDHfE4PcIbz3mYfyonIws1xkRmVBcEQjEO5kwAhXR7iILYgBMHJveSG665ceP0nhikZsCl+B2Cb+7y50rMQAO1ZwsSnQybgsJvusbh0M+BjLa1ejCMGBnnYFho5Hk52EnlRGXUGcL8XlyPvkmohQTiqYHP+19In6F69pPUCorYgBoGhyZmT5+WvSDEF04gfnAj3qf6BNRZ+vYyOCdITJYiKgYRxedEtze/WCfViCa3KIsiLFrj8HCR1upej/K3oAiZvPlbbDi0OAbxULFiU4WXJNv5XbqFAe3AnO6H+zRQjqHYncA+WYs7tpjcPrV9nNNBxojD9V4e5mH4aWmb4WtmhE7svvQbw85jaheiUkxABb/um1IjG7srDO421o2wWVoeo/3kh6CKNTlVqy9VpPeeMWByKvVVuuk5yyd/YI01BQdDzLJiqm9gaxM3hvUfGX9hffb4driY7t+7H+oa4ZRiWS/G1jgEqYe58BXKOzea/D+hlhaHYEjR2hMHt/RB1m3Ocbnu+0bc2hw0rd0Di0VQk2KNR/FaLGZ9reCoYxLgNuhey9L5NxsOy4/XufxRW4OLfla+PVbY1zy42Z2fGmtIjUN7rrWxbUX5qN1tvOYAQ8/3caCR1otp+pHH6bxP/e4mdQtC7C7XvGjBc3UrLOWBLWKUpxLpyACnUOzMbU9aak4+MvNL9cbM1Kj+rceCgv6tsJtnxuUXdZIm4Xb721X5PPjf4ufmV20rJWly80nLwvyhTXLPXzz8L5d1nCzouyHYUv/MMFq6yPcUd1xROmUfTs1AEeU0yxbsMg138+PKwbAUUdonHea+SG9fCdc/4PEncEbLs63NEJ4/kxnXDEAPG5hzoXZGB/piR4xToPOh7oSKrLtcPLRyd81U53vzpiRDryFiZ93fo8krOB4HDcuRWzjc5C0EKMC9vey1CnZ9tfUnPzhGO47xyEhjSlsdVxj3l5TS+Zis4+cCqA11ngOAY7ItrtXU7yzpDrfnZ11Bhs+STxI9eGWGLssvLBmMrY0GB16z1uqKeUcnwtvy19qZ81H8Xsry55t5+8brY0C3rSkJW6XtKVVMXdJiyVb72+I8fgL7XHP1ayL8uSf45/LOFHGa2CkHHjPBG0ROG9uM/c+0cb2LwxiRsfMwBvubeHW+61VIMB762OcMaeJP1VFaGpRhJsVL1RFmHl1E3/72PoQ79ylLdy0pIX1Wzvei7Z/YfDzx9uYfXMz7TlLSDiOlkC1/16BW+wUt9LtPZiw0+0FEPi5hjAuw/EMYZ9xuiiG59Kj7oBSv1DgEsLNivqgQqWRnXC7hNLOqaL1AWV7hiOASEdsHrfQ0toRW9T+1GLLKGS4Dsqbi/0DhpcKd1zl4pxTnBR5v/a3s87gD69FWLq8jZY285X5nTKdGy/JZ8qxeo/UyZqPotz/ZBtvrjWf7ihwCfMq8/nX7zo5/JCv318aQooX343ws1+12kkaWkZQXglW+z/D5goos8+Qf57o4NklhRT7Egu/cXuMc29oMjU9aOEcFzdeknzY5pcr2lj4WOqxieGlwosPeDh6dOIXyfqgYvbNTXywyVxzsfsMAbZrZHkF1IhhWkoxAI75poOVSwrRU7wUX3NBXkoxAOZW5nPV+clTHk4dnllSmFQM6LiNPbe0sEdSNEt4NbIwTbQ7C+e4UorRxeTxDi4/J3ElDisSFlxtfqrnT69J7vvK8/I5NkXapIsSv3CnBd828Wpk8QHi9wjnVljI8kFSQWaf7sTtMh+uxy3MnpnY/2VnW4tt9kxn0hxaJtCAxmwZn3a8jstiovTYcY6Et4bTTrJWgR1l4k8vGzFMY+IYa0nDApdQNjmricbGrAoycay9yXDHJKioSWOs25uUYNqp3disimiRRk1lUZBSv73m/Y3i+OXsLE07JEFrs2MLEseWCQQaNcmiIFbu9z3KJRjIKrBhL1EMrnx7sSUaZMsEChXSlFCXNQ82ycWM2wGx+2cvBKnTNMWm/g5kiA6UYpOGyJb+DmSILmSLhsRyuuvmEMkwNms4GBJkgGBEtc2a7+TGeuDz/g5mCD4rrggEuqYBvdnf0RzsiOrQQOv4of7Sv+EMYQhvQ6cguhH9C2RnH9ohTKEcEquCTkEKZzR/CZl/uJvdNqM7SsHWf8QvZ8fe5s/il9mWwIdde+mgYIN3Wvgr6L5gR8nTmXb0yMo27niolT0N5hrflh0Gl/0k8Wzz2fOaePatiKmZ7YYBz7wVYfa8prjnq9dFqZxvfq+VPQ2KOx5q5dFnMrIbbA9Eqf11vz+DEKjxjxXFVixkFcwO4Ra4hOrfejjqiMQZ1pdWRbhsfrOpyj5zqs7KXyTfyeGCW5p4Y03qcXVNg+U/c3P2jMSp/W2fG5RfETa9VsTiEK5hiIwpnhbYAd1aSNG04CcoWWPFkllaWjsmsiWjPqBMr+kwM+HA7KQEw+jwnYxws8rawh0F1V1iQO81hqJWZMXrEAnRYEWv391+OI2VQE7meg8BQJOheLb7gR6C+E5urFdCxjcrGyI+SvFw0fRgQ/djfZ6yent0iQLrs5+HsISCFt0Z/WXv430E8VQ07Rb4XW7COngR5DeeKU19Bgfj90M1tRTI7tLTg5uIiqk+rQMSCOIvC21TYHpr0yGsIbC09y5AXSR8U2uP5C0Uxc7shXXQ8lnYVXhXopMJBTmkYk/YgLnZiengRZTMPeyEXQlfLZLOFvOXB58ReCfjUR28vOWbHng+2QVJBRFBRXRHJbA33Ug++Tx5XiRRhjceu/YYSdeStLQqS9tGpYptW4rzJtntiERTfp/LVCIxWO37LsjL9BLQyhrDwgLh9Cl6XIetbYo31kYt7U8yaayDcUfG/3/assPg40/NL33SNPjOVCf5ceYhK+DNNVFLK7PiJBdjSjizaFow5UCg6cxuqNp/t4L/7H5saNFnfPoKIov85YEFZsqannHsdQUXgNR0P5bNea6Dld51omCVLxJI2KvqjWlB5AQiMZecJfBR17FzTrW+POBA58ypPepkXUx3nC0V5l+yLf+LN9eWHh4xorXAkYFGxfk3N/G/NhbqH4gUFgjvrfBwxHANYIeOs8zq51lt3XMaq0smGcRWA8XtEfj9K+38eXWEDzbFDtpt/0aN0Pj1AjcnfcsBsE8zYtO9M8IfW7Uz9Nm8zJP7z+Z10bjKM9HQHK+Rg92EBgn/0ByxWd6p4Y12DaS1Abt3RvhjHecUBevTsXMgIPChjnNqOmJAmoIAFJbv3aXr0TOArEyQGBxIjRixMzLxffWMfKLAM6WpzrcrOB0lC4GDqcsVU4rbfdMC0zPxpWjIwsquhuqiCg1+D2pEpm0PLNQuzdAu9s4IvJtJqxn/iEdxeaAqqmsnAa9l2vYA4hWdvBMzLQZkee1jaLX3X5RoDwKjs+knh2xWwrVmkoR2yepnbnzTG1+O6o7JiHqAwf1siSphaVsk74RsigE5XB0criocbuTpNyrFdYD9T6zlliBK7nc4I4/EmyGSDXKerg1VeYcp3XEdoq4HSnLt3yT7UPKg5MUe7FzylzP6LX++72/Ffq3FuEiEy4Gp/RVHT6RGUE9EdMcfS6fsC/VLBP3htDcd39vVLleK2cBROXUubBXFMyjjCd/0xn5fsz8gBOlO/dqSkXokWqFETpGOz76OzbCLbQreEVHvOsVZ5S6r/yLD9tNiwAnSm4aqoiLNaUwQpU00RE0QZCKo4Qg+lHg6NvHcvyteGKQRUWEUIUS+VEpt1JRsUhgbYgWOTSUnNAzocef/B67bg9Z9wGWWAAAAAElFTkSuQmCC",e.escalator="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFfgAABX4BPgLDIQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA3ZSURBVHic7Z15lBXVncc/v6p6vb9+vciikgQYwaZPXMhBZWmUdsKMBycyJpPjDIIhi+OMh6g5Z2KYxIxBQpRFhWA0alSQQBQScFBBo4GwdANncmYUDwpoRnFklV7e6/Vt9Zs/mu50N72896re0t1+/ntVdX/3V/V999ZdfveWkOHU7SwqMjx2mahRbouWCVIOOlIhWyAPKAA85y4PA40KzQJBRE6q6nuGymHFPhTNNQ+XTKrzp+9u+kfS7UB3avaXjLLCkUoVuU5gBvBXLmfxgcIfRXSXRzw786bWHHfZviMyQpDG6uLLIrY9T+Bm4JKUZi68L7BZ1Fznrag9lNK8e3QnTTTtzrswKllzEJ2ncEW6/OjGWyDPm+Hwbwoqm06lw4GUCxKo9pahxgOqfA0wUp1/jIQReUE0uqSwouFIKjNOmSD1u31fElMWoTqLzBWiOzYi22zhP4qn1v9PKjJMuiA1+0sKrWjkAVQWAGay80sSERVWhUJZPxle+WljMjNKmiCqiH+v73YRHgRKkpVPijmNyr2FFfXrRNBkZJAUQWr2l4yyItGngRuSYT8D2GbhuT2/4uwJtw27Lkj9Xt8tAk8BhW7bzjACqnynaLp/k5tGXRNEq0flBrTxSVTnuWVzICDCU16//y6ZRdAVe24YadyfPyIasbYAU9ywN/CQKsOO3Oy9tvFTx5acGghUe8vUNl4DvuDU1gDnI8G+wWm/xVF/ILDbO01to4rPxAAYrRjVgWrvVCdGEi4hdXuKZhiiWwGvEwcGIQFD5CveafW7E0mckCCBvcUVNvbvBXITST8EaBbDnlk4taE63oRxC1K3p+gKQ3QX4Is37RCjxjCj071TGt+LJ1FcgtTtKxptRO0qkIvi821oonBcRaYVT6s/FmuamF/qupMcI6qbPxMjdgQuNlQ36SGyYk0TsyB+j281MDEhz4Y2VwXqfCtjvTimKstfVTgXlXWJ+/QZoLf6KgIb+ruqX0HOdfz+i7ZggpQRjsD6bSE2bA9x8KhNMKyMGmEwq8Lirn/K5uLhA2VKpYNGwZ7UX8exT0FUkYYq3w5tCzZIGcfP2PzjwmYOHo32eD43W1i9MJevz/T0eD6DedNX4Z/Z1wV9/s0aqou+kWox6huU2fc09SoGQEtQ+efFzWzdFU6hZ67wZX9V4dy+Lui1hAQOeEs1bBwBSl13qw9+uLqVX7wY28Dp8BLh7Y1e8nIyIngmVk7bYSkrrqyv7+lkryVEw8ZiUixGS1BZszUU8/VnapXNfxhwpWSE4eGB3k72KIh/V+E44PakudQLh/5s09QS38zogXd6r9oyF/2X+j2+sT2dsXq83jJ+jGrP55JIrT/+aeqaBNK00xJUqt6K8tEJm1NnbcKRnq/z5gnDioXLx5tcPt7EdN7A8wD3Ad/qfuK8h+7fVTgO1TmOs0yAEl/874LSBNIcO2mz9Lkgm3eEaWmNT9ARJcI3bsri7jnZFOQl/u4SYW79Lt/iouv8H3Y+fp7WYsj3SVO4zmXjzLhvcuqV8bn66p4wV9/awPptobjFADhdqyxbE2TybY386V1H1aVHTO7tfrCLII3780eocJuTXJyQ7YFvzY552IeLhhnMnhF7X+TF18Pcdl8zrbG3G3rl/07Z3HR3E/sO9lLPxcb8ht0Fwzof6CKIHbHmAdlOcnDKD76ZTdno/itpw4BV9+bG3OR94fUw/7qkmYiLbYCmFmXej5o5edZO1ESObVhd+iVd7lzR+YladouCPGHzI/lcPr73qig3W3jqx3n8zZTY2h2/eS3EnUuaiSb83Hrn0zpl0S+dBJx0jdLp+HvVVRVdaaimJH41Ftway9qwPcSCB1uSIkY7hgGHXypkREliL3nTMC4vmFr3DnRqZRm2PQ/JnB6vx4L5N2Ux/6bY3yndWb8txIKHWrCTKAaAbcMb+8LMvTExX221bwUWQudmr8hsV7xzkZNnbbbsCHPwqE3UVsaOMrixwtNnddbOr18N8d2lyRejnY9PJZ6RKrPpLEjdvqLRRNXtpWMJY9uwfG2QR38dpCXYtWn60LNBvnyNxeM/yuu1ilj3aoi7UigGtA2KOqCsZn/JqNLJtZ8YAGaE691xyzmqsOChFn72TOt5YrTz5oEIM77TyKma888//0rqxQAYXuys+26F7evhXCtLhUoXfHKFDdtDrN/Wf0fhxBmbnz3T2uXY2pdD3L0s9WIAXPJ5h+MpYldCxztEr3PqkFuseD62JuRl40x+ckdOx++1W0PcsyI9YuRmC399tdOhP5kBYDRUFQwHPufYKxc4eszmfz/p/4leNs5k68r8jrGvtVtD3L08PWIA/H2lB2++4xbq6MABb6mh6hnvhlNuEEtLpbsYa86JoUlZz9Q/JT5h0Z05/V8YCxHGG2Bf6o4157SG+n6q3cV47j9D3JNGMbI98OR9vbf24se81LAhYwTpi+5iPLMlxPdWpE8MX4HwwtL8mIdvYkL1UgthXHKWL7pHdzF+tSXEvz2SHjGyPDB7hoefLshlZKnrIxvjLFFGum3VTbqL8fTmEN9/NLli5OUIV3/R5KJhBlnnRvcvvMCgbIzB9VdZFBYkZ4hJkZEWqDdDtjw5j+5iPPW7EPeuTJ4YpT7h37+dw9wbPeRmp/6ZCOq1QFIakRgr3cV48rchfrAqeWKUjzXZuCyPz41MX0SkgtciA1dATSo32fJIfkfVsGJtkMVPt/aTKnG+NMHkpUfz8SWpKooDr0WKY3b7o7sYy9cG+enQEAPAK/69vhB/2ZEtrbz3YZQRJUZHNfX4xiA/XN2a1Grq5Z/nc0FRRogBELSABjJkL5IJY/4yz7FsTZAlvxoyJaOdBoM2QTKKISoGQIOl0JBJbi19LnjesLqbZLAYCDRYkkEl5KFngzz47NAUA0DRgKHC6XQ7AskXY2JZZosBIMhpw1AOp9uRleuTK0b5WJNNyzNbDABVDluIHE3XkKm/UbnvsVaef8WF2M5eKB9rsnVVPsOKM1uMNuSohUSPoMkdLjhxxuZsvVIbaBM+0Kjs/u8Im94IO43W6JMJYwaSGAD2EQuTIyRh6vP9j20e3xhk+96Ik9jXhJkwpq3TN3DEADtiHBEA/17fx7g0rx4Mw5KnW3nshWBSwzf7YiCKAXzkq/CPaQ8DesMNi60hmLOwiVUbPhMjXkTbNDDafugOpwZV4dv3N/PmAUfrJRwxsczk9ScGnhgAtvAHOCeIZUd2gLOJ3Jd3h3llT/pWxE4YMzCatr2gpkR3wjlB8q9tPgk42itwxVpXNuVMiIHXmuqKwiHvtMYz0HnBjsqLiRr88LjN233svJBM2qup4a6F4qQeUe149h2CqKHrSLDaeueD9IhRNtpg47IBW021Y9uG0bHTUocgRdP8f0ZlXyIWT/cQhZ5sJpaZ/P6XBQO6ZAAo7O2841zXNYaiCe2JleqRl0FSMgAwYF23351+eOxNQHO8Rr9wYeoiNdreGQO/ZJyjyVZ+1/lAlydZeE1DjQpPxGt1YpmJlYKtBtpLRpF3UIiBKr8omu6v63zsvL+2FYqsUGiJx/DwEuF6x+sj+qZstMHLPx80JQOFFssTeaT78fMEKahsOiWwNt4M7r8jB0+SNLny0kFVTQEgyDMFk5vOmxzsufI39GEgrjGQL15icsc/uL8JRNlog03LB081dY6wRvW80gG9COKbGvhAIeatTdtZfGcO8xJcq90TE8vMQVVNtSPwcPddgNrptXkUCmctEuWTeDIyDFi9MJfl38t1tMTLNOCbs7PY/tjA7oH3wkeNOfmLezvZ593W7/F9XYSNieR6ulZ5aUeY7VVhjhyzOfmp3Wd/JT9XGH2RwczJFrf8rYfysQP1g259IypfLZxev6XX830lTtc2sYMYZ9vEiqBhy5wHnHXVraHJKTMc6ff7XP12sUsn134CehskY+Z9yBBV4dZYvq8b05iHryKwXWCpc7+GKrKkaJo/plnZmAehvDn++0GqEndqaKKwuzBc32urqjsxCyKTCEdz5EaBg4m5NiR5K2qZX5HK2DvZcTfym6tLLw7bkWrg8/GmHWIcs/BMjffzrHGPm+dNrTluYM4C6vq9eOhSa9jRWYl8KzehiQxvRe0hW+WrZNBShgwiYIjc7L228d1EEjsal2jYXVBuG+ZrZMhuQhnAx4YZvSHeL7N1xtFUn/faxnctPJMV3nFiZzAg8LaFZ4oTMcChIAD5FWdPWFZkJpBQgMTgQKrEjs504/vqrkyGF0xuOl14wj8dlUXAQPx+RKJEVVlYOK1+uhtfioYkbHJSt7eo0oD1oBe6bTuz0BOGbczxXlu/y02rroeLFFfU74xYxtXAa27bziC2WWRd5bYYkORtgAJ7vH+nYqwGRicznxRyRIU7Yx2XSoSkBlQVTm94JWKZVyC6ioH9bomo8HAwnDUpmWJACjfKatyZP9LOsu5RZQGQn6p8HeJHZaXpCT/RU4RIMkj5hHVgp/cCtcwFiH6XDNljpQdqUVktWdHVhdc01KQy47RFENT+qdhntNi3iDAfmJIuP7oiVYKuCVvmxtLJtYG0eJCOTLsTqPaWocZ8Vb4GXJLSzIX3Rfktaq8pnN5wNKV59+hOhlGzv2SUFY5Uqsh10hZc4fZXGz5Q+KOI7vKIZ2fe1JrjLtt3RMYJ0p26nUVFhscuEzXKbdEyQcpBRyIUolLQtolnx654jSANiDaiBBA5qarvGSqHFftQNNc8XDKpzp/O++mP/wfhZ//KTP56sQAAAABJRU5ErkJggg==",e.entrance="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAVfElEQVR4nO2da2yU15nH/+e9zNX3GXvswTYQTAAbbAdIG2ySEichJbtZ7a6UzWplqqYfVknVqlVX6YdUimijNl1ppSStyJckYLXeJi1VUEW47G5Ci8EYDMbhYsAXDDg2vt8Ye8bzXs7ZD6/fmXfGlxmPZ+wx4S8dzYwv7zxzfvOc51yfF3ioh3qoh3qoh3qoB0JkuQ2IQWSO57O91sXmeR3+u2VVsgMhCNpIong9n5jhkUXxelmUjECMFcwZCjE8zldmE4tQ6PSjGvZ6ycHEFQhjsdtPCDFWKgeAKykpEUtLSy25ubnm8vJyR3Fx8Vqn07nGYrHkW63WfEEQcjmOS+U4zkIIsXAcZwYASqmfMTZFKZ1SVXVCkqR+n8/3lcfjudfX19fV3Nx8p6GhYay/v99/8+ZNaWBgQIEGw1goDGBYFB9O+wiL07IDmQUED0D48MMPcysrK7+RlZVVbrVat5jN5kc4jkshhJgJIabpRzGKz8AYYzKlVGKMSZRSP6V00uv13h4bG7ve1dV17c9//vOl/fv3DwBQAMjTj0ZIUYFZ0UDCQPAA+I8//ti1c+fO5zIyMr4limIxx3FOnufTOY5Li6edulRV9ciyfF9RlJHx8fEbnZ2dpw8cOHCmpqZmEICEIByj58wJZkUCmQ3EyZMnH9m8efM/2u32XaIobhBFMT/etkUSY4xOTU31eL3ezr6+voZPP/30xJtvvnkLGhQJM71mBpgVBYQErdWDtNDU1FRWWFi4x263V5rN5q0cx2XG055YpSjK2NjYWMvAwMD5U6dOnfz+979/FRoUo9coCMYZMMbYigFi8AoOgHDhwoVNa9eufcFut1eZzeYKQoglnnbES5RS/+joaFNPT0/9F1988flPfvKTmwD8mB3MsnaXZxVjLKQgtGky7du3z9nV1fWvk5OTRyilMlshopTKfX19Xxw7duwH27dv3wwgH0A2gHQANgCm6c84X9d76cVmwuAACAAsly9f/ubIyMivFUW5u8z1G7O8Xm/31atX3//lL3/5dwAeAeAGkAUgBYBl+rPqY6XlF5sJQ9y3b19WZ2fnSz6fr265KzRe6u/vP/XJJ5/8+2OPPVYGoBCat6QBsAIQkSxQWBiMDz74wDU4OPgfiqJ0LnclxluTk5PdDQ0Nv3766ae/CWAtgFwAGdCasKSBEogXH330kXt8fPwdVVXvL3flJUqyLHuuXbtWU1VVVQGgCMEmzI7QuLK8ME6cOFE0MTFxkFI6tdyVlmipqurv6Og4XF1d/RyAR6EF/Jih8HGEwUEb5K3dsWPHWzab7V8IIeY4XT9pRQjhMzIy1m3bti3X4/G0Nzc3Txp+veCucDyA6F094cSJE4UVFRW/stls/0QIMcXh2itChBA+LS1tdXl5uaurq+v6zZs3pxA6nU8RJZjFAgmMM2pra127d+9+0263vzw96fe10jSUNVu3bk1ra2u7cevWLT+WeJ3F2LXNGR0d/a+vQ8yIJFVV/c3NzTUlJSWVADYgGFMS3vviAAivvfZaZm9v7w9UVR1d7spIFkmSNH706NFf5efnfxNaoHdD6xJboQ0e5wQSa5NFAPD5+fni/v37d61atepNQRBWxXitB048z5tdLldhWlraV8eOHetFMI5EnPOKBUhgSuTIkSObNm3a9IbFYvlGLIY/yDKbzRlutzvD5/O1X7x4cRxBIPNCEWJ4LwKA27dvX/rmzZv/zWaz7Y7VaMoAr6RCVqnh0ksvjgBWEw8TH9/3z8/P3/HKK6+0nz59erClpUVFcD1FB6OG/89CLSAAeLfbbTpz5sw/FxYW/ifP8+5YDR71qmjt98InqRA4LtbLLEoMgKRQbMi1oSAz/j11r9c7ePjw4feqq6v/B4BnukxCm8aXEdYlXoiHBNY0amtr12dnZ7+0GBiMAWM+BT6ZwW41I9Uigi5ik0QsIkTz0lt9Hkz6aeR/iEE2my27oqLi2e9+97ttNTU17QhdFjbCYMDCmyzO5XKJxcXFL9rt9ucXaywDIPIc7BYBdqsASpcHiEngtRcJUmFhYUV1dfX12trabkVRZMyEEmi6FhLUOQBCQ0PDN/Ly8l4VRXHtYg0d96mY8FNYTALMIo8ldhAQon0phj1+ZNoFOO2xhNTI4jiOt9vtos1m6/rb3/42BA2CvtIYWJ8HtEqORoG5Krfb/YLFYtmWALsfaDmdzuJnn322AoAZ2mKWGdpAMWRRa0FA6uvrS+x2e8XXYdIw3uJ53rR27drS1157rQgaDDO02eAFAwnMVz366KMvmEym0gTZ/MArOzv70ZdeeqkSGggjkMB6fLRAuP379zttNltFojatfR0kiqK9qKhoy9atWzMRBBLSbEULhN+9e/cOURSLEmdudIYksDO0JMrIyMj/3ve+twUaDL3w0yUikEAwz87Ofobn+byEWhtBKgM4QsBzK5eK1WrNrqysfByaZ+geImIhQN5//33X9M5Ca2LNnV9+WUVn/wTGvFLcpzmWSoIgmN1u94YdO3ZkYWZw5+cDQqANBIVdu3Y9zvN8zhLYO7cxBFBUiv9tvofPL/fB61chCisTis1my3r55Zc3CYKgN1l6HIkIhFRVVVkdDsc2nuczlsLY+UQAeKYUnLh0D59f7YPPTyGswObLbDanlpeXb8zKyrIgGEdERAACAHxBQYHFZrOVchyXmnBLoxQvCjjfMYb/u3wPkkLBr7BIL4qibfXq1UUZGRn6KmLUTRYpKytzmkymdUiCTV8AQKmKtatykJebjTOtwzh26R78ioplmiyOVSQjIyN/48aN6dBA6CVyDNm8efO6hIw9CCAKBGaRB6dPKkUpkyigqNCJXFc2GtpHcPzSPcgy066zQmQymew7d+5cBQMMANxcs2mBQzXp6emPJGIXCQFgNwnItPMA4RZ0+kpVKUSBQ1GBC4wB59qHABC8sM0Nk8CBUpZk5wJmiud5saioyI3geZl5gegiNpstP1F7rASewCJykNWFV6CqAKLAY32hCwTAubZBEMLw7cfcsJp5yEpyI+F5XsjNzc1G2Gnj+YAQAJzFYilIFBCRJxB4AIREHIETAogCB2OnSvMUHutXa1Aa2gZBQLC7PA92Cw8piaFwHCdmZWWFAyERmyxBEFyEzPl380pWKca9Crx+fco/VBMyg0cCVBq5x0AIMDmlXctuGJ6qKoXA8ygqdAFgOHNzCDxH8GxZLuwWHn45OaFwHMenpqZmIfSMfUQPIdMBPaZoOTop42TLENr7vLCa+RlMZMYgqdpybjRvIFMGz5QKh0kIuZSqUvA8h3WFuWAMOH1zCIQwVG3JQ4o1aaEQk8lkR+iR8IjffLKYtQ+PT0VL9wRaByXk52TMWDMnWPjeylyXE1npdqhhS+CUMggch6LVuQAY6m4Og4HgmS0u2C1CUjZfgiCYscAmCxzH2WJ/SwZR4ODOzsSmonyo4bWIGF0PmPValDHwHIf1q/PAcRxO3xwCAOwqccFqXvol4kgSRVEHEgwREf6HLPaELIG274kjAIvTOGG+LjKbhlK0Ohcqpfj8ygA4EHx7qxtAcnWHp+ey9EqJuEBFwh5XjPRKJ4RoGWUY1ZrL5P0kgbqO2HtijPkW804MAKXadpvF7ruKpj4JIVBVFbe6+jA4PILny1x4siRb22GSTO4BQFEUyfCSAFHsy6KUemN/SwJZoejuHwFlCljYvitGALLASqKUIT/PiZysNChhcYQjBCpl6OzuR0//MJ7cmIWnt+QgxSIkZU9LlmV/+M+iATLjn6JVuk3A1rXpSLdNwjzL5IusApI6nZsigggAWaFo6RqDzW5DnjMNimFnLMdxUCnFra/60N07hJ0bHagqzYU9SWEAM4BE3LnIAIBS6pl+vuAWOMMuoqrYgYr1mbOONTySNjBUomjetYGhjK+GPPBLSsjveI6DpKrouNuHgcFhPFXsxDNbXEhNYhgAmCRJeusT2E4ayUOYJEl9VqtViWWCUeAI0m0i0uf4fZoKjE8BCo28eYEQwOMVYDGFbrbkeQ6yrKB9GsaTmxx4riwXNhMPfxKOPXRRSlWPxzOCsCNvcwEJbG30er3daWlpUiJmfBWVQaUEihrZRQjRpmKMnsbzHCRZQcfdPgwOjeDJTU48V5YLi5jcMABAVVV5cHCwH2HpBiMt6zCPx9NDKZUTYZSsMvhkFVHwmCFeAKRpzxgcGsbOjQ48X+6GSeAhq8kNAwAopXJvb+8Qwk5XzQeEAWADAwN3oaUjiqsYgElJwciEBElRF5T8i+c5yJIWM4aGhlG50Ynd5W7wnNbLWglSVVVpb2/vQ1gizrmABFzo0qVLtxRFmYi7RQxQFAZZURc4aCPTnjGIgUEdRh4EbvHjnKWU3++fbGho0M8fBrwkkofQ+vr6Ua/X24EkSc7FEQ537w2if3AYFRsceK4sDyLHYYU4hi42NDTU3draqvdgA+cOI8aQrq6uqZGRkRZVVePvJTGKqgoqN2Th+ce0JVt1BXkGAEiSNHn79u1bo6OjMkJjyJweEmiyWlpapK6urquyLN9fInvnFAOQlWrG329fhae35MAicismZhjl9/snm5qaOsfGxox5G1VE02RNTEyoBw8evOT3+/uXwtg5jWGAwHOoKnXhWyU5sIgrozc1mzwez3BtbW27qqr6ydzA8baIvSwAam1t7fDo6OgVVVUXNdG4WJlFHmtyUpBmNSXlglM0UhTFd+fOnfbr1697oEFQDEWNBETPUatcv369brm9hCfaesdKbKZ0eTye4ZMnTzZDq1f9AKieF3heIEAQilxTU3PR5/PdSaSxkaRlLl5OCxavsbGx3t/97nftCAIx5gOO6CF6sFEOHTo00tfX16goiifRRj+okiRpsqWl5Vp7e7sHod4ROCYdrYcoAKTjx48fv3///uVEGv0gq7e3t/XAgQONCHqHH8HEzFEDCTRbr7/+ese9e/fOUUqXNbivRCmK4r9+/frVw4cP38P0FxxhzRWiGBgChmYLgFxfX//X0dHR5ngZqp8bXO6SaPX09LQcOnToErS61EHo+U4C3d5odyTqUKRXX3312uOPP/7XjIyMrTzPL2pHirYBQes1qZQtW2oNRWUJ7SwoiuK7ePHixYMHD95BMG4Ymys9xUZUuU6MzZYCwP/73//+eHZ29paCgoJ/iNlKou0M80kq6IQEWWHLlnzGO6WA0cQknwGAGzdunP3Nb35zHkHvmBE7EGGBKlwhwf3dd9/tqqqqOuZ0OsutVmthLEYSABk2AQ67iCmZQpYTsuQSlfIyTEi3JSbPyf379+8dP378XF1d3RCCMKamSziQqLMB6V6ijyilt99+++y6deuOFRcXvxqrsWkWHsV5Vm3FcBnFcQTmBB0gvXDhwun33nvvKkKbKh2GHj8CK7Qx51zs7u6mKSkpQyUlJbmpqanrYroI0Y4kmAVuWYuJJwk5fdXa2nrmF7/4xZGmpqYRaCC8huJDMH4EvpELBaJbzQEg9fX1E8XFxWPr168vM5vNSXF3nGTRyMjI3d/+9rd/rKmp6YQGwwcNxOT0cz9CbwYDYHGJlAkA0t7ePl5eXq4UFBRs029b93WXJEkTn3766R/ffvvtZp/Pp8cLHYYXwSZrxsGZRQMZGhqira2tPU888YTF6XRu4jjua5fV2ihFUXx1dXWf/ehHP/q8v79/Elrl+wBMIOgdejCfkYI81jSxIa97enrUCxcutD311FPpDodjAyEkXkn+V5RUVfU3NjaeqK6uPtzd3T2BYFM1iaB36IPBGRlJgTjeHaG3t1ft7OzsqKyszJ0+ubuyTo4vUpRS5erVq6f27t37ye3btz2YHUZ4UzWjexnXb3JHR4ff5/N1lJaWOlJTUws4LuIp3wdCiqL4b9y4Uf/666//qbGxcRgzg3jEpkrXYmOIUQwALl26NHn58uUr27dvtzocjqIHPabIsuxtbGw88Z3vfOfj8+fPRwtjTsXDQ4yuxwDgzp07/rNnz9544oknRIfD8chi57ySVVNTU+Nnzpw5unfv3sO3bt26D63S9WYqPIgHZnQR59zvs2kGlP7+fvnLL79sdzqdvS6XK89msznj9F5Jod7e3hu1tbX//bOf/azu7t27HoTCCA/i88YNo+IZQ0J2cQNAT0+PfPTo0S6bzXY7Ly/PnJmZ+QiJx/1Jl1GMMbWlpeXUu++++6ef//znV0ZHR/VBnrGJ0kfjC4IBxDmo6zYbiyzL7OTJk4NjY2Odbrfbl5WV5RZFMSUB75tweTye/rq6us/eeuutz/7whz/oe56Ngz4dhg5pQTCAxAIBDFskr1y54jl37lx7enr6V1arVUpPT8/jeX5F3KdKkqSJa9eunTp06NBnb7zxxummpiY9eM8GI3ysETUMIM7nUhljxhsR8wgm57JAu7uMFYBtz549eT/84Q+fKSsr2+lyubYkKxhVVaWenp6WxsbGxnfeeef82bNnhxGctdVH4HqPyugVIWscC3nPuAMBEA5FgAZGT7Gtg7H89Kc/LX7xxRcr16xZU5aTk7PBZDIlRdY6v9/v6evr62htbW05dOhQ04cfftiJ0KVX4/yUb/q5cTk25rtHJwQIEAJFzwWle4sRjAWAee/evatfeeWVXWvWrNmclpbmSktLc4uiuIgMEguXJEme8fHxgfHx8cHW1tabH3zwwbm//OUvvQjdP6Wv9OkQjAtNehOljzNiWuRJGJDAG2hgdCi6t+hgdDgWAOaUlBTLj3/840179uzZsWbNms2pqak5ZrM5xWQypcTbVmjnJyempqYmxsbG+tva2lqOHDny5YEDB25PTEzowdi4d8q40uc3FKNXRH2/wrmUcCDArN5ibMb0GGPMYWsqLS1Nr66u3rht27aNq1evXu9wOApEUbQLgiByHCfyPC9OT81E+gyMUqqoqipTSmVFUWRJkryDg4NfdXZ2dl68eLG9tra2c/qsRmDrLEJ3FeqVP2V4PduNWRa99LkkQIAAFCA0pZ3RY4xeE0idmpOTY83MzLSuX78+tbKyMr+oqMidm5vrdDgcOampqQ6LxWIXBMFqMpmsoihaGGNEURSfJEk+WZan/H7/xPj4+OjQ0FB/b2/vcFtbW199fX1vZ2fnxOjoqDw8PKx7gxHEbDCMe6jC7yUFxhiLxxBrOQZpIQm7EJqV05h625gb3ZiOm0fw9g6zldnE5ijGPWfhXqFXvnEztF5o2HXipuUcNRsrkTcUHY4RjP5cMPxdIOmX4RGY+ZmMMwjU8Gg8KGOEIRuK8eyGXhICQlcyTGOEe8xscEJy28KQNBLzQ4kEI9xDwkvgZBMSDEJXMgDRZaxMY5zhMROU8W8iNVtzNVV6JRu//TTs+Yy7qCVa/w+SVb5l2/X/uwAAAABJRU5ErkJggg==",e.hazard="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAKJUlEQVR4nO2ce3CU1RXAf+fbjTFREdC2IAX70Grk4dhBrLUqtlaG1kdGpNraarWVZ7KbVVo66tg4gmV8kI0bxOgf0vEP/2Aq2td0asfpUx2nVsAirfZh65gEFYKxiiS73+kfWSWw90vu3f32keH7/cNk77nnHs7dc797zr37QURERERERERERERERERFkWobUAzaSj0e64Br8x9tYhI/kHYGq2lXMcSrbUBReKwHVoz4JEU/9cDKKllUNOMuAjTJWcDTgHdIk49wnqT5UxXMKppD/xM1jbYTR+jGbLeH0q1LqKu0XaUwriaAvXwP5fRRJGbSwE0VsycExs0SpCs5kTg7gKPGEN2Hxyzp4F+VsKtUxk8ExOlibOcDNOBzf7nNCYtxMQGa5ErgYocuCzTB18plT5jU/BKkrUzA4yVgmmPXPoQmSbO3HHaFRe1HwHDC5ep8gCkoa8M2J2xqOgI0yZnAM0CsSBU+whckzTMhmhUqNRsB2k4c6KZ458M4yA1qdgLoJwWcEYKm2RxJMgQ9ZaEmlyBNMgPYARwdksr3yDFLuvh3SPpCo1YjIEN4zgdoJMaGEPWFRs1NgCZZBFxaBtULtY3Ly6C3JGpqCSpiz789/+8cS/nX8TlNMgy4W1ceaisCYqzB3vk+ynI8bgB8yz7T8LijOOPKQ81MgKaYix50yDIW3XIfT0sHzwEPOvRr0VY+52he2aiJCdDFxPCd9vy7GOSWD//yWQ30WPb18OjO5xlVpyYmgBNIAJ+1llfaZCP9H/wpGQYQVjmMOIe9tDjIl42qP4T1RqaTYwdwjFUH4deSZoFRV5KfA1+1HPpdhFmS5lVL+bJQ/QjwyWDrfNhHbpTnhNACvGup6yiUDkvZslHVCdAEX0G5zLqDcIdk+Gdg8/C3+U4HE5o14TB+GajaBOgSGhGn7HQHE7l3TKlJ3IWwzVqrkNEVoWbdTlQvAhpYA3zCUloRWmwuXkk7WZQWQC11TyfO7ZayoVOVh7AmmQM8j/3FsIekkyVOYyR4COG7luI5hHmS5i8uY4RBxSNA2/EYrvPbOv8t4txsati9kAm7FzLB2CvGauANyzFiKN26uKSzh6Ko/BK0h5XglImm5F7eMjUMNrB2sJ41pjbpYA/qlBvM5QSWO8iHQkWXIG1jKspLwESrDsLvSHOBGNbznkXMxedZQDzhnCmP8axxzARPIlxoaeIAHqdJB69bypdMZSNAyWDrfNhPlmUm5x9SuvBU6db5gUvaCuB9yzEnkCNtKRsKFZsAbWMhsMi+A2uli7+ZmnqzJBlRulCY0zuJVpOs3McrwI+sxxWu0BSXWMuXSEWWIF1CIw38FfikXQdeZoDTZVPhN/f1y5guw2cGh+7d3xNl5tTHC0sL2s4R9LMVaLI0+b8MMVPu53+W8kVTmQho5HZsnQ+Kx3KT8wHECzyubFTMiV0+f1iGfW4wgzpus5QtibJHgKaYjc/zYH015GHp5HpTQ08zzQhbRh0Pmqdt4QljW5KHgW9b2pHFZ55keMFSvijKGgHajpd/WNo6f3e+tl9A30UchYxdPBPIvHlpQHEvyyrgTUtb4vlzg7L6qLxLUD/LgLOt5YVVkjE7yG+0Ll1MH4qZSwuygd2oeYIDOJO9LHWQd6ZsS5CuYAp17MR+2/l7Oplv2na+tog5Md+pdJFDmHfCY4WlBQUhyW+AL1rqGiBHk3RZn7g5Ub4IqCONvfMHkYA9fzue5zuVLoDhPMFUWhBQYizHJTeIWVRhi6QsE6BJFgBXOnRZJ2l2mhp6t9EibqWLYYS5PQGHN7KelxHudtB2lbZZn7Q5EfoSpCka8HkR+LRll1d4mzmmbeeblzN1SNkJHFukOe/k4jRN31xYWsj/1ngrcKqVJuE/xJkp91ifuFkRfgT43Ia988FjRdCef2j4imKxzgc4JpY1lxYkw358h9xAOfGgmxghEWoEaIqZ+LyA7bZTeETSXGNq6m1moQq/DMUun0unPcHPjG1JHgG+aakqi89cyTicuI1BaBGgII57/j3EzeXinktoVC+8y7QidL2xOODYMU4KzOVuo3TIuUF4S1CCG4BzrOWF1XKP+cBE49yOWpcubMaaMZQ1lxbyZw3GA58AzqKf74RjWEhLkN7E8WTZCRxv2eWPdHKeadvZdxmzfc+pdGFLVj3mTftJYWkhnxs8Bcy31NUPNEknu0o1KpwIyNKJvfOz+LQE7fnVc1rGXIiLb14+ZLgA2ALWb1uZhIaTG5Q8AdrGfODrDl3uCnqI9W1nmbqULtw5s2+rubQgHexwcqpwtSb5cqkGlbQE5ffS24BTLLu8Sh2zTHvpNxYzJZt1Kl0Uy0A2R9OMnxaWForIYf7B28wO2kbbUFoEeNyKvfNBaAlKZHJDTqWLUphQF1BakA724TtdkT+JiU4P8MIxi+2oN/IZcmwH6i27PCqdfMPU0LOIBfj8qlhbikGEi6c+xi9MbZrkUeAqS1WD+JwhGV4qxo6iIkBByLERe+cPkDPv+V9bTAN+5X9Ap8qGvosCX/7RBgeuv4/BEQgPaJFf5uKWoDauw76cC8rqoHJuLOtYugiPE/2jzaUF6WQX4lB2EM4lYX3SdkhXR3QlxxFnJ/ARuw48x2TOlvbC33H1LmKmupQuwifrw9yPbynclWk7Hv38Afi8pa491NEUlFwG4R4BcdZj63zI4rHU5HwFUbfSRTmIexKQG7Tj47EMGLLUNZksd7ka4DQB2sr5wLesOwjrJc1WU1Nvs2PpolwoZ/VuM5cWpIMXweGilnKNJviSy/DWS1CYd2t6LuH4/DJmmz2Xm34PTp2ypXD5yN9pehH4lKWuwPMNE/YRsJebsXc+eLQEXmyKk6Z2nA8wyScgN3iQ91Cn95GezAT7g3+rCNAEJyNsB4601LtZOs2vDOttZr4KT9mOXUkULpq2hSeNbQk2I1xhqWo/whlBx6wjsTvoFjZi7/wBPFJBjVMf57fUwo8DXcnSSh0XYpet1wMbFfPN7pGM6QhNcC04PVhuqeT17koh99OHOlxXVM4nOfaGZdQJ0BSTEaet1Z/pYaOD/PhiMhvA/DuEANbrTaM/60aPgBx3Ax+1HCyHsFQ2k7OUH3fk85ml2OcGx5Fl3WgCgROgKc5FuM7aOqWzGj9yqzTSyXagy6HL9ZrggqBG4wRoO0fg8wD2O5XXyPJDB6PGN/u4FaxfcSAIG7XVXLg074L6+T5wmoNJ06njHa3ZV+NVnVOIsQoK32Na8A3XFCfhsx1oqIRlhxH7gdOlk7+P/LBwCRp+8XXk/PCph8Jzg4MmQNu4Gko/aI4IZD7Jgy8wfDgbuppjeZ+dwNSKm3V4sYtBmj544dSBCNjPHUTOrwQfo/7AL3gOTIBaX1CNKBU9cDlh5DPA9tWPESEyMgJ+XEU7Di9G+Do+4sPhC0bCtcBxFTfq8GA3sInJpV3mioiIiIiIiIiIiIiIiIiIiIgYn/wfm7XBpi1H58YAAAAASUVORK5CYII=",e.decision="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAJm0lEQVR4nO2de4wdVR3HP7ttt7uVvgu0sq1tqVQeLY8isTw0BUQsKSiiIqFqojEhWBXUajFqiTFogkUwUXkEHzESTUhbXxF8BKGhpEsrtKgElRYK2yJuC1tp2bLb8Y/fvb1zfjP37rzOOXPv7ieZZM/mzvl9z5yZM+fx+52BUUYZpT5tvgUk5K3AEmA+MK9yzAS6gMlAR+V3A0A/cAjYA+wEnq0cPZV0qSlrhZwIXAlcALwDOLagfPcAm4GHgPXACwXl25KcAKwBtgKBg2MI2AR8BpjuoHxNw+nAnUgz46Ii4o7XgZ8CJ1ku67D4bLJOBtYBlyb4bbWp2YG8B3YCLwL7kPfGwcrvJgDjgWlAN/KumQ8sBpYCxw1jZwj4GfBlYG/yojQ3E4FbgcPUv2MPARuBjwFzC7S9APgk8ADwRgP7rwCrgDEF2i4lFyAv0noXYguwEpjkQMsM4Drg6QZ6epCnrOVoA75I/bvyV8A7PWlrB94HPFZHWx/wXk/arNAJ3E98Yf8OXORPmkEb8FHk3RHXI7vJn7Ti6ELaa13AN5Au7jh/0uoyBbiH+BvoZo+6cjMB+APRQr0EXOhRV1JWAq8R1f9tn6Ky0g78mmhhHmX4rmeZOAvpcuty3OBTVBZuJlqITbjpPRXNQmTMo5tcX52Q1FyGvATDBXgEOManqJycQvRl34tMcJaamcjoOSx8J60xV3Q+0cHsg14VJeAnREfcS7wqKpYbiTbFV3lV1IBzgSOYYj/hVVHxtCHT9uEy7kJ6lKWiHdhG9L1R1vWWPMwG/kfJxycrMAUOAmd4VWSXr2CWt5+S9SD1APAHfuVYpxPprITLvMqrohCnYr47hpAl2FbnBswKeQZpur3zQ0xhG/3KccZk4ABm2b3PCrcTHTAt86rILd/DLPu9fuWIR0hY0G5as2dVj7Mxy7+XnM1W3jZvhUr/BhE2UtiKzHNVOR54e54M81bIZSr925z5NRsB8Dv1P32TOuMYzN7VQUo4YnXA5ZjN1l98CVmqhDzmS4hnpmFeh/3keI/mabIWq/T2HHk1M/sw3yNTkOmVTOSpkEUqvSNHXs3Okyp9etaMxuYQcYpKP5UjryyMBc5EPBSnA68i6/VbkbVwl2wHlofSpyFL2E55CrPtnOvI7qnAj5EKiPMMGUA8XS5xpAdkmSGs4Q6Hto/Sq0RMtGxvDDLNPUh8RcQdG5A23TZXKLs/z5pRniZraujvQWSNwBbtyFNxbeh/h4E/IeswBxAfsEWI493kym+uQNZlzkOmyG3xX5WeYdFWLBMw74j/WLb3VWXvPmBWnd9OBL6B+SRtsKzvbUrfNsv2IsxSAv5p0dZJSPxG1da6hOddjen9YtNldQbm9dhl0VYsx+OuQr4fsrOFdCECYaeL+4uXdpSpmNfjOYu2YpmiBDxvyc4YJFYj63rDktC5/djzJT4O83r825KdunQqAS9ZsnOWspF2INuG6ZCQeQQ9DG/GvB5PZ80o60j9sEqPzypgGF4Ffo9MTWxEJjPTEAAvh9K2ej+6tzpoyU5DBqjdEa/7EJCQ/dR0zrdkYz7mE/JE1ozyzGXtD/09HnNcUhZmURuTHMFeIKd2lT2QNaM8FaJf5HNz5GWLD1CbCn+UWrRu0XSr9Iuxv0pAK1fIm4DVofQvLNrSFbIna0atXCFfo9ar2gncbdHWCSrtpUJ6VXpujryKZjnwhcrfAfBZpBNii8IqJCuzic72lsVBbh4SylzV9R0HNv+MeS224TBAaRwSUK+nusvgz9sJPE5N0ybcRPpuIHo9bL6zDNbEGF9HOfxa76KmqQ94iyO7XcjmB/q6fMi24elE/Vl/ZNtoQq6hpmkIeI9j+x3Aw5jXZjf2ZjEA+Loy+BzlCOZchBlT7iuAZg7RG/ZTtoy1EY2JKEPIWifiZFDV9Ef87uKjb9oeW4bOUYb6sPw4JuTT1DTtRdZqfDINc0EtQPaMTESaF/G7VHo9dvv2Sfl46O9vYW8pICn7iPr7Jl6tTFMhZ6v0QynOtUUHplPael9CFA+o9NKkJ6apEL0fofbW88FkamsRR7C3cpmWrSq90IYRvQlLGaJOZ1PT49pbsRF6jT3x7G+aJyTcvQ2w64eVhcC3gBBVr8oqiZ0I0zjKDWBWSgf+Vwr3IUFC4/EwodeADpXWS96F8ATmYzgSQp+zsgDzWv016YlpmqzdKn1OinNHGjrOMPGW5mkq5BGV/mCKc0ca71fph20YmYcZU3iYFCPQEcQcoiN1a1uYb1aGfmnLUELOAL5UOVZTjh3e7sa8Ro/bNLZMGQswQwRcc5vScrVHLSA7d+v4lcttG31QGexHopp8oCvkI550gHzj5HmlZwsOdrZYgOkAHSATejrm0AVlqZBJmEvH1Xdsrl0d0nAV0aZrDxKp5JJblQYfPb+ZxO8bv7rRSTbQCzEBMpr/HO4WiI4FLq4cFyKLVS5ZSrSZqjo4ePEx+GaMmGrb2QzbiWelG/Gy0fsTB8haiJ46ccrnqf8Ziu046GU4ZBmy41G9SOD7EA8U71xE/Gceqo4QrbCHVhtSlrgyDiIbY5aqnFMRvyi9d29AihWzEnMu8ZXRQ8k3i16MeAyGRSeNnC0zd2CW6W9IN7spvlN1Kab4vZSkbc1IFxKLHy6Ta0e8XIwluuR7vVdF+ViFWZZemuTJCHMTZiF24X6cUASdRMcaa7wqysgkzIDLAAmiaTbWYpbhFdxsaGOFtZiFOYjMhTULeluPZr2pjtKF7GqgR/FeR7IJGUd0/WcXErvY1OgvJwTILG3Z0d3cgBJsJV4U9xIt3HVeFTXmeqJ67/GqqGAmIAMpPd1Qxs8FfZjopOEOWnBP4pMxgzEDZFLyGp+iFCuJTpT2Yck3twycj/S0wgUeQtZQfHMj0SfjNWQOq6VZQbQrGSDvGR8Dx06iX5cLKhqXNzivpVhGNBavOmF3pkMdpxF1ka0+GS63mS0F5yHOEXF35lrsPi2TgFswt5iqHntojeWCTMwh+rm96vEvJM67yEWfMUhUbL3FtB6iG8mMOLqA24lf2AqQCruWfAGmncjH68PRuuHjCDJYbcbJT2tcAjxL/AULkPWIW0i3K9yJSCDoyw3yfQbxWhklhi5kE+RD1L+AAfAP5KlagWxi3FU5Flb+d3vlN43y6EO62y72Qml6uoE7iX6duYhjAPguEk8+SkpmIp7t9bw90hy9SPNla6vYEcVYZN5rI/Hjl3pHP7J10pXk+/CAM0rlR5SQcch0xrsRD5dual3VFyrHk8j3eTcjc1OjjDJKS/B/+/QdvZ909d8AAAAASUVORK5CYII=",e.landmark="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABmJLR0QA/wD/AP+gvaeTAAAEf0lEQVR4nO3cTU8bRxjA8WddBKkgH6BSVfUb9JSPUKnqB+AYKcUJxwoCJS+0uG820Cio5BKh9hCl6aW3tE0r9dCSYhtsY4yJnRq7OLFbB+OYuN5d7+7szk4P1SJTiirv7K537fkdDZ4Z/Q/WwywAwDAM07+4Tt9w6eoSOe1rK6GJjtfzugEzb3r7rTdPvPbgx5+oD+NFvm4fwOtYQEodf2Zd+eyLUz8DzwwNbksKen9hauw74LhTv6+XmAp47d2xE68TQqDwpAy/rCUEXhDriqrNDQmle4FAQLPkpC5lWcB25UoVVqPJ5v5BTdEwDkkwcntpclQyfUoXsyWgoXpQh4cbSaFYqhAAfXkAuBuBiQuNjk/pYrYGNNTqLyC8kZLyxacEA3cHQPk4ODH+rNO93ciRgIa/mgJEN9NSOrPLAcfd14h2fX7SXzC1mEs4GtAgtiRIpLMotpXBLwH3QFG1D0JT72SpFu2SrgQ0IKTCViaHw7EthRAuJqny1cXLF9ctWdwhXQ1o0DCGx7tFshqOt5CmFbw0S7oioIEQAr8VnsDP4URLVpR9SUIf7r1+9t43o6PYlg0t4KqABgIAhWIJVqNJsdHgBRWr80O873YgcEG2dWMTXBmwXblShV83kvyflQOMdX0R6QPLN6bPi44d4H+4PqCh+vwQIrGUkC+WCYC+LBL95tKk/9Dxg/yLZwIaGk0eovEd6VEuTwhwd5GCPlmcufhHt87juYAGsSVBYjuLYqkM9gF8L8na7OLMWM7pc3g2oAEhFRLprBZNbGsEuChC8sz81KW4U/t7PqBBVTVIZXJkLbYlaVjPIaTOLUz7v7V7354JaMBYh+zuHlmNbIqKivZkBc3aOZT3XEDD0QVvOCHwvH0XvD0bsF25UoWH68nms2oNaRgHrbzg7YuAhupBHSLxbeH3p2VdJ/otKy54+yqgoVZ/AWuxlFzYKxHg4A4mykdmL3j7MqChyQsQSaTldCYPHAf3VRMXvH39XHhkZBhee/WVM8PDL+vg486BTs51uoapX+3wuqNRJ5oQFaRSjTp9FdC4AY/EUgoBiCmSMht6zx8GAIBpv6k1+yJg+zMYH+F+UFU0F5z2P7Ji7Z4O2GjysL65I+08zhPgfF8hSf504cp4yco9ejJgtfbPvJcvlgnhyC295bsZuna+bsdePRXw6CeO/RrSdBxEeGDF7ttrzwc89jOvINYVpM3Vz6pfr4yPq07s79mAVo4iNDwX8NgoQiCuyMp12lGEhmcCGqNIPJnFHIClowgN1wc8MYrIkuWjCA3XBnRyFKHhuoDdGEVouCJg2yjC84J46PQoQqOrAd0yitDoSkC3jSI0HA3o1lGEhiMB3T6K0LA1oFdGERq2BPTaKELDsoBeHkVomAoY/PzL/3x9aHAwLSPvjSI0Og54eMif+gfXK6GJNwDAc6MIjb5+LmwFFpASC0iJBaTEAlJiASmxgJRYQEosICUWkBILSIkFpMQCUmIBKbGAlFhASiwgJRaQEgtIiQWkZOqpXL/+x16GYRjmuL8BujV+3sKfOScAAAAASUVORK5CYII=",e.poi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA0YSURBVHic7ZxrcFzFlcf/3fcxGs2MpNHbSLItG5AJibEtIfmxWSJjp9YFdgi78CGuFDFFUvshGwIhZLOPrIvKPtjAVliKbAhV2bAphy0egSCgXJKMVVnHGGswfgB62EiypPHMaEYzo3nfV/d+wKYc0OPe8b2jpOLfV3Wf0/PX7e5zT5++wFWucpWr/OlClnsAAHD4C18QywjpopK0SxCELYzzNs6YH5x/ND5COIAEoXSYGcZRZhgHFcaOdw8M6Ms78mUW8K3u7i4iSd8knN8hezyGt67O462qEl0+H2SX6/faqoUClEwGmWRSz0SjWTWbFYggvKRp2lPbDh0aXKafsDwCHt2+vVOUpCcJpZ+tX7OmzN/URCW325INrVBAIhhkkXPnFDB2imnaNzcfPvyOQ0NekJIKGNi9u9xQ1ScJsHdFW5tcvWoVoZRekU3GGGYnJnh4ZEQFIf+jp1L3b33rrbxNQ16Skgl47NZbP0NE8XVPbW39qvXry0VZttW+riiYPHUqm5mdjRjAbVt7e4dtdbAAJRHw4lrX13TDDZ7a1auv7JFbguj4OAsND2d0w9hRirXRcQGPbt/eKUhS/+r2dl9FXZ3T7gAAqUgEE+++mwZj27v6+gJO+nJUwCPd3W2SJB1fvWlTRUVDg5OuPkUqEuETJ06kOOc3b+7rO+uUH8emU2D37nJJlg+uWLfOV2rxAKCioYE0trVVUEE4eHTLFmtbvAUcE1BXlB/7amrq61pbly3WrG9tJZ7q6kbB53vcKR+OCPj2zp0dhJCvttx0U7kT9k1DCFauX18OYN/vdu7c4IQL0QmjoPQ/r2lrk4sJVVLRKOYiEWSSSeiKAgAQXS54/X5U1dfDZ3EjEl0uNK5bJ0dGRp4AcIvlAS2B7dPrWHd3Oy0r+78bd+xwWwmSC+k0Jj/4AEySUHX7Hng3dUCs8gMAtGQC2RMBJHpehWjoaLnxRpR5PKZtM8PAe/39ed0wtm7r6ztp+Uctgv1PoCzf37BmjWxFvEw8jomTJ1F7z72ovn0PyCf6CpWVKFu1GtVfuhOJV1/BuV/+Aq0bNsBTXW3KPhUENLS2yuGxsW8BuNfKz1nStp3G3ti1y0U4v9Pf3CyY7aNks5g4fRrNf/9PqNlzx6fEuxxCKarvuBNNf/cDjJ86DSWbNT226pUrBcLYXe/fdZetr0C2ClitqltdHo8ulZWZ7jM1NIT6fffBs6nddB9vewfq7tmHqWHzb2tSWRlkj8fIxONdpjuZwFYBObDDV19veudNR6PQBQH+XbdZ9uW/bTc0EGRiMdN9Kurq3JzSnZadLYKtAoqyvM1TVSWZbZ+YmYF/zx0Asb6XEUpRvedLSMzMmO7j8ftlURS3WXa2CPY+gZxf67KwO2aTSXg2mp+6n6R8YzuyiYTp9rLXC4Pz64p2OA/2CmgYfivrn57NQqotPsEg19VDzeXMt3e5wBnzF+1wHmwVkHHuoqL5yIhzDlLE9C0WIooAY+b/wyawVUACMM656faS1ws1an4N+yRadAZyuYW3Rc7BAfMDNIGtAlJBSBuqarq91+9HJnC8aH+Z42/D6zc/Iw1VhSAIqaIdzoO9yQRC5nRNM928qq4Oidd6wBmz7IobBhKv96Cqvt50H13TQChNWna2CHZnY0aVdNp0Y19dHSRmIPHqy5YdxV9+ERIl8NbWmu5TyGQAzkcsO1sEe3dhXT+UTSbNz2EALTfcgOgvn0X2HfOZ90xgELHnDqBl3TpL48smEophGG9a6rQE9u7CwGA2HjcfVwBweTxYfdNNmP63H2L21VcWnc6cMcRf+TWCj/4zWjdsgJWYEwBys7N5Bth6RmJrNqac0sFcKuU2dB2ChXDGW1OD6zs7MfXKS0j+5tcfpbPab4bUuAIAoIUuIHMxnSUT4PrOTmu7LwBD15HPZMo8hNgqoO1B2OCuXQMt69ffUtnYWFT/dDSKZCSCdCIBPZMBAIheL3zV1ahqaIDPwpp3OXOhECZPn36z8+DBW4sysAC25wOZrj83Fwp1VDY2WptfF/HV1VnOOpshEQpldE37ld12bT8TIZr2m0QoJDDDsNt00TDDwFwkInJB6LHbtu0Cdg4MhIkgvDUXDtttumiSoRAXKP3ttt7e4l97FsCRUzlDVZ+cnZiwNeK/EmYnJtKGrv/ECduOCKgw1pNLp418avk1zCWTyKfT2qTf/5oT9h0RsHtgQOeG8dTM+LilmNAJomNjWc75T+5+4QVHFmXHKhNEXX8iGQySS2e7y4GWzyMZDlPC2BNO+XBMwI6BgRil9Ofhs2eXTcHw2bMKBOGZrkOHZp3y4WitnmoY/x6fnGRWUlx2oSsKEsEgo4w95qQfRwX8s/7+SVB6IHzuXMmfwvDoqALOn+3s7Z1y0o+jAgKAoCjfj50/b1g5BL9SCuk04tPThqBp/+i0L8cF7BgYiMEwngp+8EHGaV+XCA4NZcDYkx0DA+YPjYvEcQEBIG8Yj2RiMTUbjzvuKx2LIRuLFQS3+xHHnaFEAnYPDGQMxv5m+syZNCwcOhVD8MyZtGEY3+ro6SlJDFoSAQFgS3//c1o+P54Mhx1TMHHhAlcVZXzLm2/+r1M+PknJBCQAVznfGzxzJmfl4MksuqYheOZMjqjqV4jNR5eLUTIBAWBbb+97HHgpPDJie2AYGhpSGSEvdh4+/L7dthejpAICQCGd/vbs1JRi54aSjccRDwYVNZ1+wDajJim5gJ8/ciTBGfve1KlTaStVDAvBGcPkyZMZzvnDnz9yxHylkU2UXEAA2NLf/19aoXAicvbsFU/l8OioqqtqYEtf30/tGJtVlkVAAODAvpkPP1Sv5A2lkM0iOjamcs5trXu2wrIJ2NXbO06Ah8cCgXxRpR2cY+L48RyAh7p6e8ftH6E5lk1AALi5t/enej4fiJw7ZzmuCY+OqpqiBDr7+n7mxNjMUpLivOefP+rOe6V1BLSZAo0AXyEIpAmEtErJREvzfz/edn1XJ3FXVpqyl0smMToY4FP3PjisV/inCefjhsGDnOICZyTCwabdGW347ru3On7x2lYB9+/ndO3mdz/HudFBKL1RoqSDgVzPDKNWEoW8LIsokyUqS6LLJYmCLImQJQH8dwPA6y+jratr0WsOwEdTd/jYMdDb7wS23gJVM6BqOhRVN1RdVwqqxlTVgKbrbioIMcoxojEjQBh/3yA0MP72pvf27yfW14wFuCIBnw4EJM8M7wQhf04F+heMsQ5ZFNUKr5t4y12+8jKZustkuF0SCF3cVeKxf4UvPYdrrlu8hDk4OopspR9V3/nbRdtxxpFXNOQKKvIFlWVyhXQ6W+CKpsuU0kFmsIOcst82y9nj3d3dRX/9oygBn31jcKMsCt9gnH9FFkXir/TI/kq3q8JbDlk0fcfm92CFAuLfvR9Nq1ZiobKQuVAI05NTqPnRE6AWarEvR9UNpNI5JFJ5JZnKqYqqcSqQA0zVf7b3tk7L18BMC/h0T6DcI5FvCJR+RyCkuqG20tVQ6xPcZfZd/NHGPkT8hz9A2+bNnyoeUnM5jBw7hup/eATSmrW2+cwXVERiaSMym1QYR8xg/HFprvCM2fVzSQH37+f02i3v/DUFebTSWy62XFNdVul17P4yMi+/AP3wIVzX0f7xesgZw+jgIKTtX4T3y3/lmO+5dB7nQ/FCKp3TCMd3R9/e9MxS6+WiAv6qJ1DLZfq6t1z+zNrmeq/Pa2uB+/xwjsSP/gWeVBLNFwsop4eGka3yw//Q94u6lGOVVKaAD6dmMtmC8p5O9dvv2dG14KnegqM58NppP5WME00rqq5ZtaLG3m+ULAHLZjH7vQfQvGolQAimJydR++iPQSx+nOdKmQjOqsFoclrJoH3flzfOW1u9YMxAZeM/6ut8JRcPAKjHg8oHHsbk8DAmh4ZQ9e2HSy4eAKxuqpHr/d7msnK+4NHogvWBjLG/XNlYXXLxLiGvvRa+vV8DAFs3DausXFEjR2bTdwG4b76/L1xgSQlx+PhiScq371jeAQAAOD7+itw8LDyFQV6cDMdLX1LwB8b5UFylhDy/0N8XFJCpwoPRWPrC+Quzqh2Jzz82OOeYCMbUaCIzXciRhxZqZyqMcZdJn13bXFdeVbG8XzEpFYlUFmPT0Vxe0U4XHcZc4vJA2utxC6ubatxOBtLLyVw6j/ELsXwmU9BtCaQv5+meQLlXxn2UCA8SQmoba32uxtpK0c5XueUgX1ARmU1poeicyhmPGpw/JqeUn9v2Kjcfz74xuFGk5OsgZK9dyYRS8alkgqYzDnaA6OwZR5MJ82FnOstu/qDTWQtRbEJVkkQQAgiUglICSigEgXx8m51zDsPgYJyBMQ6DMXAOaJr+x51QNcullL4g0CbGUEuAOgLeIklCC4AGzkktAJFx7gGYzDhkMO7igHBxkAYoUSiBClCVEpLlnOuUIMYIwoZmTHOQKQ5ECeFRxviFUqX0r3KVq1zlT5n/B4HKFM4hiX7YAAAAAElFTkSuQmCC",e.staircase="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFfgAABX4BPgLDIQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABTESURBVHic7Z15YBTl+cc/78xsSDbZ7CYoIAJyCRErqKCGHEAUFUFQqq3W++dZLR5VW+tVRWs9ilWqLWqrpfJTq2Bp8aKCRszBZeUwyCEqqIQzJLs5dpOdmbd/TLK7OTbZZA8S7PefZOd43nfm+77vc7zP+46gm6Oy0OVSbGaWkMooU8gsgRgFsp+EXgLsQBpga7zcD9RIqBNQjxC7pZSbFSm2SMxNRoq6JXNcpfvQPU3HEIe6Ai1RsSpzgObXC6QQEwVMAobFuIjtEj4SQq6wCVuhPadiV4zlR4VuQUhNacYJumleLmAmMDyhhQu+EPAPIdUFjryDmxJadpvVOUSo/dh+lCGSLkHIyyWMOVT1aIH1IF5W/f7X0gpq9xyKCiScEE+pIwupPCQlFwBKosuPEH6E+LuQxiPpedVbE1lwwgip+th5slDFbKScSvcloiVMhHjXFPw6I6dqXSIKjDshFasy0zVDfwgpZgFqvMuLE3QpmNvQkPRgn4L9NfEsKG6ESIlwFzuvE4JHgcx4lZNg7EWKX6bnVS0QAhmPAuJCSMWqzAGabvwZmBIP+d0A72rYrkvNO1Aea8ExJ6Sq2HmRgBeA9FjL7mbwSMm1rnz3wlgKjRkhsnRAikfWPI+Ul8dKZk+AELzgcLtvEVOpj4m8WAipWZXa19C1xcD4WMjreRAliqnPdEyo2R+1pGgFeEodWdJUlgLHRCurh2OHwJwSrd8SlT/g+diRK02lhP+RATBYopR6Sh050Qjpcg+pLHJNUoRcAjiiqcBhCI8ixHRHbtXHXbm5S4R4ijPyTMz3BaR05f5IcaBK8uLiBpaW+vl2jwnAwH4KU3JsXDMziSNc3SI22hbqhGKemZ5TXdrZGzv9RJVFrjGKkCsAZ2fv7Qz+8YGfWY95qfW27X+lpgie/VUKPzzD1ub5boAKRTXyHeNrNnfmpk4RUrnSNVgxzBIQ/TtXt85hyQo/V9xXh2zkQlHg6D4KQsB3e01Mq7MgBLz8GzszJnZPUiTskkLkZuRW7Yz0nogJkYUke2zOUuCkLtUuQhx0S8ZcVI2nxmLjx2fZeGRWCn0yrarur5Tc+6yX1//tB8CZJlj/uoNMZ7cdvtamZ7jzxPE0RHJxxFaW2+Z8hjiTAfD8m/UBMi6cbOOF++0BMgCOzBC8cL+dH59l9Qp3jeS5RTHxyeKFUzyVzqcjvTgiQtwl6ZcJuLbrdYoc7xTpgDVMPXxTMiJMw599YzKK0vyebowb3cXpl0RyYYeEWBNKYl70dYoMO3dbCmJwf4X+fcJXr/+RCsMGWOe/3mUmpG7RQTzvKXaM7OiqdgmREoGpzMPK7EgI/F1o7DIugfCYI02iPNvRRe0SUl3qulJamR8Jw/CBVpV2lJuU7wvf8sv3m3z5nXV+6ICeMgHJZHdJ+mXtXRD2STyrHb2llHNiX6f2ceFkS1mbJtz/J1/Y1v/APF/A/J2WryWodjGAFHMqC12ucKfDEiL9ysNA77hUqh1cOzOJ3o0m7KLlfq5/uI59B4Os7K+UXP9wHW+8HzR7f3phr0RXMxr0VWw8FO5kmzaMe0X6sajic+CQNL3i9ToX3F6Lr9Fy76mOYTvwS0mWK9/9VcsTbRNS4no5kRNN3+4xWVNm8N0+EylhUD8FU8KDz/kCMayWyEgXPHt3Cufm9zgyAJCSv7ry3Ve3PN6KkMbesZk4ZYjoBpRtN1i10WB1mc6qjQbl+1u/dEWBYwcpfPmtycB+CuX7TBRVcNwQhXNybVx/QRIuR7f1ziOBXxqMdE10fx16sNWQJBTxCxlDMqprJWvKrJe/cqPBfz43wgYMQ2GasHWHRZSnRvLaY6mccVoPUt4dwyZUfgncGHqwWRNrnIrdCUStJYs+1bn/Tz7WbzXa9RN6OwXZozXGj1EZNkDhoFtStt2kZINO2XYjoC9SkgUr/pLGyME9xsSNBD7FNAaFTv02a3Kmrl1ODMgoXqcz8/baNp28wf0Vxo/WGD9aJXu0xohjlLDhkfJ9Jvf/ycei5X68PsnPHq3j/XlpgZDJYYBkU9EuA55qOtDsVbiL08tAHB9tKQXX1fDpZgOArMEKE8dpjB+tkT1a5agjOvc2fQ2Qd1U1X3xjdZXHbk3mxh/1KDO3I6xz5rlPbvoRIKSyxHWiImXU+atrNxlMvsHKthw1VKXor2lobWikmjrJN3tMRg3tWF2VbtCZdnMtpgn2ZMHqBWkMOurw6SaqooxOy6n8DEIcQ8U0Y2LmvvTPYNj/+guSAmTsPmCyaLmfXzzlJf/qGgZN8TD+ihoe/rOvQ5k5YzSuPi8JgDqf5JYnvD0lfhURTGle2vR/sJkJcV60gg+6JYs/tDxoR6oIzFn8q9DPCRdWc82DdbzwZgMbtxkYjcp681eRRWpn35jMgL5WdQvX6rz6XkTzPT0CUhJ49wpYU7PEYOnYK+814K23mu5PpthITbFGxEdfqg8bxc0ZE5mFnWYXPHVnMKfinmd87D7QmkyvT7J8tc78JQ2s+ETvKT0pq2JV5gBoJETVOT1aiVI2H66uPt8aYlZu1Nn8taXgR49QefsPqYwfHTTuJmdH7mmfNV7jJ1MsuVXVkjuetIY7XwO8XeTn6gfrGHpuNRfcUcutT3iZcVstZ91Yw56K7s+K5jdPh0ZCpKAgWoGFa3W+agyH552ocdwQq+XP/1eQpJsv7sW4USrrtljd5eg+Clnt+BW79plMvqGG839eG5jWfezW5ICl9k6Rnx/eUcvw6R4uvbuON5f7qfM1f/lrygwuu6c22seLP4RZAAEdIidGKy+0d1wz02rFlR7Jvz6yXn5GumDGJBtF64xA0HByB573XxY3sHaTQeFanbvmWr3B5RDM/WVw6PpgtU51bZAEl0Nw6dQkHr81JTDjuHaTQdl2I9pHjDPEJACtuiStjykZGI2oCrfkvRJLmffNFExvjL6+tjRUpySRnAQfrPEH7jvj1PYJKfo0qHhefa+BGZM0zsm1cXaOxuXTkljwjsVsplNwbr6N8wpsTByrYWsU62uQPDDPIvLbvSY/GN6tF3AN9qx29NaktI2A6Oakd5ab6I0NcEqeLfBC5i8J9porZ1i95oPV1kvWVJh0SnhCauok67Y0b9W3PeEle4FGRrpg7l0pTByncYRLkH+y1srXcddI3ikKkj+wbw/wW3RGaGB2OPHeEYYPVFAVMExYWuzns5lJrNtqBIKD40drZA1W2LnbDHjcY0epONPCR2tXbjQCJAthGQ17KiS/eMrLXx6woyrwozObGwRen+T9lTqLC/0sLdXxNuqTUUNVjh/WrXtHI9SRmgkjow1ip6cJrpyRxEv/bGDvQUne/zVfF3nbZVaoo6l3AEw+rX3rqnhd8Nr7r0vmdy/X4/VJFi7zc16Bn+kTrPu99ZJlTSSU6K2Ueka64Pn7UsLGy7oVpBypITg2FssXfzsrGXeN5M3l/mbHrzg3iSk51tAUSkiH+qORECGs4S49TXDn770AzHrUy8oNBrsPmPy7VG8znG9PFpw7QWP2jcn0P7IHDFcWjhXuYudKIDsW0qSEd4v9vPxWA0IILjrbxvkFNoSw0nuGTPNQXSvJdAq+fCs9bNS2ulYyeKoH3YDjhqisWpCGlHDZPXW8XeRv+yYsC+ucXBvTJ2qcfqpGSq+e0C1CIUo0kI5YLTUUAqbl25jWxrTq6rKgeVpwitZuCD1Uf+SdpAZkP3dfCjf8hmbKum+mYNoEGzMm2sg7KWhh9UQIpEMDkZAkuM4MV6H6IzQa7EgVvPqonW/3mHy9y6RPb4URg5TDZn5EgkMjQSugNm4LmrATx7ZPyMqNQUJ+PsfL7Od9nHCsygnDVU7KUjk7R2NCBzJigb8taeiUej12kELuiVHVy6GRoDTRfZXWo/WyWSGT9jCwn8KasiCBVdWSok/1gKPYywZP/DyFqxp9m3jhtjnewBRyJLhyelJMCEmI5ktrjPz6DfDVS1KSwxf73L12Lj1HZ90Wg/XbDDZsM/hmd/DN1Pvh1ie8pPSyDIfDCRpQTQL2IjkpS6V0g45pwivv+bl2ZvjWnWSDM07TmmWZVHokG7YZLC3ReeHNegwT7nnGy4Vn2lDjrEOOOUrhoZuSI7ouSlQnjJALzrDxx9ethTV3Pe1lZ7nJaaNVjh+qcsxRHSvmjHTBpHEak8ZpeOsl85c0cKBKsqZMbxbOjwecDsH5BQnpidWahOpEjFlfhazh0A34w2v18Jr1254syBqicPxQ1fo7TOW4oSr9erdds7GjVOYvsf4v224yfnS8a58YCKjWhNVD4o4lK4K+g6YS8DPAmif/dLMRyFRpQqZTMGqoZVXd8pNgpsmwkOUH27/t7mH1yCGRHk0K9oo4T6h5fZJlqywLyeUQlC1yULrBYP1Wg5f+WR92Ru+gW1K8Tqd4nc7Y49SABTNsYNA32f5N5yPVbxf5OVDZ8UMnevpXIPZqimRLvMtdtioYeZ2So+FIFZydo3Fmtsa8hZZecTkEb81N5bPtBp99YTb+NXA3zhR+9oVJ7omWvL6ZgjS7oKZOBhbtdAa/X1DPfz7vfj1LSrZoCLEt3k1hcWFwuJoxKagcN2wzqPRYZU8YqzF6hMroEcHWv2yVzoV3WtOvX5cHX6AQ1rC1YZvBzt0mvgZIjq9LkiCIbRrC2IqMn91Y6w0OVym9BAUhk1JFISGSvDYcqlAzcmd580YztJEQ07QmyLqa8zv/IXuHofn25m1iC3OrhsrWKCcMw8Lrk1x0V10gqHj6qRr2EIdwxSdBQiaMbT2BdEx/yxw2TWvNYSiGDQwS8OV3RpcJOW+SrdvEwkxd2aqkn1ZdAXwba+Fen+THd9UFwh0pvQSzLg6OK37diuqCpROyBrcmpJeNQIbJjt1ms5G1uaXVE5ZFd4gdGQVVVU1pQMtiKdlbL7n4V3V8/J9GMpIFrz9uJ2dMcFhaUxacWMo/WQs7bAzpb714r0+yN2St4bABIZbWYUCIkBYHmvVDfgii1fKqrsDXAJfcXcdHn4SQ8ZidieOCZJgmzH01uB3G5OzwnvbgoxWK11v/7yg36dfbIqLZkNVIyMqNemAevz3sj8DkTTRMwQfQSIhm6h/qik0SZaDR1wCX3l3Lh2uCZLzxuL1ZqNw04WePevl3qXXNkRmi3UWbTT0ELEKyT7AIOcIlcKYJ3DUyQMjCZX5eXNwjc36lKoxCaEyUS51QtxuIaq/Aej9cdk8ty1cHyVj4RNtkNCVK2zR47j57IAe4LQw+OoSQFltoDOxnndtT0bOHLAmbHLk1+yB0BZUUryPkA10RWO+Hy++tDZi39mTBwt/ZyTupfTJefMDeYfbiiEFBQj75XKdpgVe9n8Bi0bYWfz5wQ3JEOzx0h2wUIeXrTf8H3oZU5AIh+TVdGLbumBMcguzJgoVz7M38irbIeOlBezMnMRxOOFZlyNEKX+8yWbZK595nfZw4UuW1pQ0cdFu6oC1SJ47VGDuqJ+RiYZqKsqDpR6AJuXLdXyLFys5KK9tu8P/vWi861mSA1YIfvSW4FdOzf6/n2tl1gTn6NLvgnms6nqvorpBQHLrjXLM+LYVc0PqW9rFsVXANxr3X9mpFxk2/7ToZTTgn18a8e+2thqb+RyosmmPvSZvPtIICzd55s76u2MyF0q88ifWxrYhQXRc0IUPX/Rkm/Oy3Xl5bGh0ZANt2mvjqJbde0osPVut8t8/k+GEqBadobN1hsnWHVcbWr3uccq81JW+GHmhGSPpp1RVVJc55QnJHpBJD03T+8Go9OWM0nGmCmx+LDRlg+Re3PuFtdmxHudksP6snQkr+6Mp3V4Yea6UNtQZ9jm7Tbop0T95peRp9MwV7D0rWbjIYeZ6HXkki4IXbNHhpdo/cICaukODVbPrvWx5vRUhaQe0ed7Hzb8BPIxGckix4+ZFULr6rlkqPRDdAbyQjJVkw/yF7ILc3FrhyehKnd5BoB91/UzOBeDEtu3Zvy+NtP5kin8QU14Y93wLZJ6isfcXBYy/5+HCtZf38YLjKXVf1ivkimTEj1EQlHMQTfmnIVr0DwrxwZ45ne1Wx82kBd0ZawpEZgifviOvO44cNBDzpbLELUBPC9usGf9JsIfkuftX63mJHTXLqw+FOhh2S+hTsr6kqct4u4I341Mtam/jWio4tpZUbuv2+vBFDSHF7/3HldeHOt6sjnHnuRdUlzo/itTPprr1mK3P2MMfy9Pyqxe1d0K4pIgTSr6mXAwdiWq3vJ/aofr3D/WQ6tKJ6Zx/8zl2cfgWIt4njFzonjNW45vyOU0fGjOgRAcOWMKTg0ki+rxuRWevM87znKXY+LuHu6OvWNob0Vw4HczYMxCOu3KoPI7ky4hbvSHY/AKKk65X6fkLCx+n+qrBWVUtETIgYh99IFtMEbOxa1b6XWG9o6nRRQMRmYqd0Qua4SremaFOBbzpdte8fdmrYpvXOPujpzE2dVtL2nIpdCupUoLLDi7+/OKiYxtSufCv3f5/Niz0S/9m8JlR/nDbKVNSlEN1uQocRvlFUY0pnv8wWiqj8CseEms81bNkSPotGzuEAARs0bOOjIQNi4Oil5h0o1zT9TKDTCRKHD0SJMI0zY/F99Zh43mnZtXvTy935SDEb6H4rYeIHQ0p+lZ5blR+LL0VDHNaoVxa7ChR4BeRRsZbdvSDLFVO5xDGhakUspcY8NpWRV1Woa8qpwNJYy+5GeFcj6ZRYkwFx3sXBU+Q4VwrlGWBwPMtJILZKwU2uXHdEcamuIK6ZAOn51W/rmjoGIefSs3WLLgVP1vuTxsWTDEjQPicANYWp/cwk7TYpmQWkJqrcKOFGiqdVm39eWxki8UDCc789hY4jpKbOQsibScCWHl3EQaR4RiQZzzQu+UsYDlky/sFPMpyK17xICK4Cxh+qejSHKBHI+X5NfaOzQcGY1eBQFNoS1vd2lauk5AJgeEILF3whJIuQ5vz0/OptCS27zep0M1Ssyhyg+fUCKcREYSVXRP3VhhbYLuEjIeQKm7AV2nMqdsVYflTodoS0RGWhy6XYzCwhlVGmkFkCMQpkPwTpSJFmbeIZ2BWvBkQ1QtYg8SDEbinlZkWKLRJzk5GibskcV+k+lM/TEf4LUCv274bICPEAAAAASUVORK5CYII=",e.ticketGate="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABmJLR0QA/wD/AP+gvaeTAAADiUlEQVR4nO2cv2sUQRTHPyZGQ7QQUbG4axUUUQkWoqUgFloErMUUWgqC2IiCBFHwH/APMKKNYJFGEIKJlcZfhKBCCjH+Nmo0aiTJWcwcN3fs7e3evJ3dw/eBI5e3c9/35mXuO3vcbkBRFEVRFEVJwaoO0SwcW4HLwIcMtGeBa8DODLRzpRc4DowBFechjas9ZnP2ZpDHizJwA3gLzADDQClm/AAwTW1i38i+gW6OaVtDM9LOx4sS8Jn6v3TFxqKSXnLGTADHgD6yb2CfzTXhxIYixqedjzfDNsGITVCyzyv2mMuQjS8AJ4Au51jWDazSBZy0NVSAiw3j08xHhBkrXnZiZRubcWKHgGVb+OEInVANrHLE1rIMHHTiSecjRpKEG4B3Nna6iU7oBgKcoVbnehsL3kB3yZfto7rkr9sxV+3v96h/27rk0cAuYNQev2JjSeYjSglzrtVourP22GZgHvNW2RWjk0cDAfoxtf0ENtF6Polotkra4RRmB7wNPBHUleIRcAdYg6k1OHG71k3gjX2+t4VOXisQYJ8d8xpTc2F24UX780UCnTwbuAJ4RX3NwTaRZgW6/nHOQ8eXpLoXqK+5XZ3UJGngbg8dX5Lq7qGgDfwKdHvo+JJUtxtTq0gDJXfhUWBJUC8rloD7UmKSDXwmqJU1z6WEJBuYZAcuCmK1SjbwpaBW1hSygR8FtbLmk5SQZAN/CGplzVweSVtt+0m/Fcv7NAZgdcz4VPWtTDowhuqXRX8FtEKxQK3uYEitnCKsQDEdSQ/8L5Fo4DiCZ/YBEalbooHLBPYSIYLXrR4YgXqgJyE8MC+PDFJXCA/MyyMLV5d6YATqgZ6oB3qiHhgQ9cAI1AM90c/Cnuhn4YCoB0agHuiJeqAn6oEBUQ+MQD3QE/VAT9QDA6IeGIF6oCehPXCbQD6pHB3jgWuBQeABMCmQrxWTNtegzd2MwntgP+YW/Dnntd9tbL94dbAd8+8Evjj5fgG3gAMpdIJfpe+yDnN/8GNnfAV4aONxK0KKXuAocJfaKqsAU8BZYGOL1wdv4DjwFLOy5p1x1X8CsSOLYhKyBbMq3zt1/cGsyinMJW6NBG/gb+fYIuZ+swGgJ4si2qQHU9MItVu8KpjaGwnewGr8PPX3nRWVMqZWkStU0xA8YcaIzEdPpD3RBnqiDfSknav0O9Hv4vCaj65ARVEURVEURVGUjuMfWbTN9E0AqgAAAAAASUVORK5CYII=",e.door="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABmJLR0QA/wD/AP+gvaeTAAAC60lEQVR4nO3dMWsUQQCG4TcXLBRsooWdGAMWgphekYjlpcgfCNikPTtby5S2dtZpjFhqIZLGyoBa2CkkkICHRUBBNGcxJ5ybi7e7mZ395vI9sBBIMjObN7dzF9gcTI9zwArwFNgHdoFumws6jS4C94FN4DswKBw77S3t9LgMrAEvgJ8cjVA8rAGLwCNgm8kBHKQBs8AS8Bj4TPkf/rivtZrOAsvAE2CP8hE+AuvALWBmzOetgjlgFdgADigX4DewBTwEro0Z00EqqropD4AfwEugB1yaML6DlHCd8Bu9BRxSLkKf8MhZBc5XmGtSkKpPCo47snqdM0u4pq8Dnyh/kl8Ie8gycKbm3KmCDMjkdU6XapvyNuEp7WKk+VMGyeKSuMP/T+AX8Bp4AFxpYH4HKRi36Cqbcuz5cxs/uuKCVwh/+Gtr/qzGn4k9IEcX2cQcbc7f6PidmIPZyTmIGAcR4yBiHESMg4hxEDEOIsZBxDiIGAcR4yBiHESMg4hxEDEOIsZBxDiIGAcR4yBiHESMg4hxEDEOIsZBxDiIGAcR4yBiHESMg4hxEDEOIsZBxOQcZIHwbzU+AFdbXou0VDdFPh+Z41nC+bO/6bMp30bm6Cecv9Hxc75kTaWcg7w55mMrSHXJWiBs6O/5d1PP+pLl+9TFxs/5kjWVHESMg4hxEDEOIsZBxDiIGAcR4yBiHESMg4hxEDEOIsZBxDiIGAcR4yBiHESMg4hxEDEOIsZBxDiIGAcR4yBiHESMg4hxEDEOIsZBxDiIGAcR4yBiHESMg4hJEaQH3Ew0VxnSb9ed4qbPvw6At8Cr4fEOOEwwf/EcY/9QU9/UWtmkN7gf/e8Lm8R/BKV8g/udSGtuVBfYo/rJxQqUKsju8FyjavLhNg/cGx53gQsVv7/uJa7t++RPJOViUwVykJqaCpR1EBUdwr7RI+wjfervQUmfpsam+tvTAW4Ad4Al4DYwV3Ms1XPM3jywBmwAXxF5IRfbH0Ok4hC5QW8AAAAAAElFTkSuQmCC",e.routeA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABmJLR0QA/wD/AP+gvaeTAAAEbUlEQVRoge2aXYhVVRTHf3dIZ0zUsWZknBTHyYKocPzsQexFH0wpTWgSaxqDgqCExHzoKSIF3/RBMBQRCizFKEqajKGHCrMPFcY+xo8mR1KpMdNRtBzH48Nam31nvOfsve+cc6+Ifzjsc89Z6/9f+5x99l577wu3CXIZcg8H6oHR+rsXOAX0ZaiZCiqBpcBWoBMJOBp09AG/Au8CTwHDyhJpDGqBdcA5BgZ9DegGOvQ4qdfybf4G3gLGljzqPFQAK4Hz2MAOAGuAGUjTGoxK4DHgTaRyxu8s8BLZNvWCqAX25gWyB5hdBM9coD2P52OgOqUYnWgAjqjwX8CTKXAuwzbNDqSTyBT1QJcK/gSMT5G7AfhZuTuBmhS5B6AS+QYiYB8wKgONe4BDqvENcFcGGmxUgWMqmBXqkB4uAtamTT4T6Af+B6YF+C3CfsiLAvzmIF31VeDhAD8nTM+yPtBvJ7YiHwb6blK/zwL9YjFDCc8DYwL8qoEryJvs1/OQrrUGuARcBx51GVd4EL6o5TbgQkAgzwJVwKfIU60CmgP8zwLbkUFyRYBfQeSAM8gbmRro+636NSOVMj1RCGapX3eg3014SIlOBfpNQZpEL3A38jYuKNeDATw5ZNCNgAeSDF1Nq0nL7wLEAVo0iE+Ay8B/SBMDWB7AY8YsgOlJhq6KmKdwJEA8Bzyv5x/kXTfnrYQlh0Z7SpKRqyImve4JEH4caFSf9rzrXyJpewOSLPrCaCcOwq6KmFT8aoBwi5a7GDgbvAbsHmTjgytaViUZuSpyUUvfvGoE8Iyef4G80fyjTe81q60PzNiV2PW7krJzWtZ6ij6NnaMnjcijgSUM/IbiYLT/TTJyVeSolr75jmkyPdi3ORijkOBewK8iRrvTM4aCaMROoFw9TT12Tp6UWE5Tm37gPgdnDukgImCyR7yJ6FaiJofdGrX7zYPzF7V9w2E3Xe1Ough9cq29Wi522JmxY4cH504tVzjszDT6cw9OJ+YjT6WL+OZlnpwzlVDcj6QwSc0wBxxXm3kB8caiAjihhAtibDbo/f0BvN+rz4aY+wuwCaNPy/HCaiX9kdKtPe1XzdVpklYhGXAEPJEmcQwWqtYZJHtOFauwy0BZvxXT7F7PgnwEcFoFnstCQNGiGqfxT2OC0aoiPcC4DPjHIVPcCBn5M0Ubxa2K+MCsurS5DNPAJGQKGyGJX1pYrJwXVaMkeFVF/0lJtEG5IuC1FPi8kQM+UuFDDO2jrETGJ7MYV/I9kmpsCrF5CDxblOMEcO/QwyoOTcgqSQS8XIT/K+p7GXd2nTlMl9xHfC5WCAvV5zol6Gp98Q5SmV78nuwj2L3HtzOMKxg54H0ksD9Jns01YvO29yjDx+3CcOArJMDfKTyNnYDdumun8M7vLYGRwNdIoEeR3SeDWuTPAhGyBJvF1l2qGIMdFzqQLrUaOIgdd8r6B4EQ1GB3aH/AVuwwZRwrikUddj8+0vO6RI9bGBOBP/SYWOZYhoxGPe7ABzcANvIdFIEv9s4AAAAASUVORK5CYII=",e.routeB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABmJLR0QA/wD/AP+gvaeTAAAEWElEQVRoge3aXYhVVRQH8N9IOZqZWo5MljUNBUGGX30SQZCRCWVERBQWQUJQQSI9RA8RFfQSFAVF0Uu9VBA9KIlkRUXfljWJaOWofWhqmWkZaXp72Ptwrlfn7HNnzpmx6A+Hc+6cdf7/te7de6119h7+I+iokXs0puKE+Hk3fsT+GjUrQSeuw3NYJzjcaDn2Yy2ewTU4dkQ8HQBdeAQ7Her039iMvnh8F//WbLMdD2DSsHvdhFG4G7vkjn2GezFHGFqt6MSFuE8ILnvuZ9yu3qF+RHRhRZMjy3DBIHguxcomntcwsSIfk+jB+ii8DVdXwHmjfGj2CUmiVkxFfxRchZMr5O7Bmsi9DpMr5D4EncIcaOADjK9B40Ssjhrv4ZgaNDweBb6JgnWhW8hwDTxcNfl5OIC/MKvA7kWH147sOICfsFR6Xl0ipOp9OGcojrciyyyPJuyKAmk9nkhwPRXtlg7a6xbMiYS7MCFhmwWyFr0tx0VYLPwqWTBXFnBNxu84iHMH736O7Jt5rIRtFsgXBTYz5O3L8wm+J9vQLkQHtkayGSXsywRCnpmWJezOj3abU8KjEvfPFrLIFnyZImsDx8XzuoTdKqEfOw1nFRmmApkZzx8mXSuPBYJT+4QuuAhZzYLZRYapgpN9C+tT3rVgPOY2fR6HabhMCOQPLMS3Jbgy7TOLjFKBZO31jhKCzejFGwPc68dteLckV6ZdWIRTgWSt+L6Sohn24OOWv00SfpVevCMM15uwKcH1ZzyPKTJKBbInntvtqzbgigHuXS6k1YvxNqYLQ20gZLXrtyLB1GTfGc9dCbt28Cauj9c9uDlhn2n/WmSUCuTreK603xEq//Z4PSdhm2kXpupUIH3xPFu1r6Fj5ZO3aFWlQ96krikiTAXSL7TUU5Sr7GVxi3x+FnUBs4Sh9T02FhGWeXFZgUVC/k+1Hhk6hezUjOOFOXGD8GpLaH9eKeDJ2v3XS+oWYq5QYfulh1c7bfw2xQsWHULBbAiZbsgYJeT6BuYlbFOB/IL3cT9OSnDNkzeMqSlQGksi6aeGb+3po6i5pErSMcK6bQNXVUk8AOZHra3yTrkyLJYvA9X9q3wcte6pg3ys8F7SkK7GQ8HCqLElataCW6PIDqG2VI0pwjpwQ6g1tWJ5FHqpBu6XI/fyGrgPw+nCpk0D11bIuyBy7okaw4I75XWhCtGeyNXAXRXwlUYHXo3Cqw1tUnYK9SlbjBv2PZKJ8hbi6SHwPBs5NklX+9owE3ujI4sG8fwd8dm98hWbEUOWkvdL92LNmB+fOWgYUm1ZPCQEs1u5b3a6fO/xwRr9ahsd8s73B5xRYNsr79teMAKTO4XReEtwcANOOYLNqfKtu5WOvPN7VGCcsPDWEBYuupvudQmLDg1hTauOrbtKMUFeF/qElDoRn8vrzoj+g0A7mCzfof1EHthXRrBWDBbd8v34RrzuLnziKMY0YRlnY7z+VyPbQ/wfZfAP++My3madvrIAAAAASUVORK5CYII=",e.marker="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAABfklEQVRIie3WMU/CQBQH8NfaD+RgIuJEWP0c7C4aBpyMTIY4aVxNnB3UCLakTgxOJiY0aSElkVDUNoECLeVdz+kMKYYo7cEg/+nSXvq7XK7vHcCKIkQf5PIlysaXxf2Z99zgWjb7DW9I0guZTAqpavVWAKDRuYnDm3t7AADQ63aho2mDwPdtgng0RrzOqCpyh1mGjgOdet31XNenhBRHiOcZVfW5w9MLsHR9OHAcApSeSZSebslyjzvM4vX7YBnG0LUsAUTxAhBPthXF5g6zBKMRvDcantNuU6D0igbBcUpV37jDLDgew4dpBp/NJqGieEfCsJCuVDTuMAtBBNs0savrKAhCLUA83FWUZ+4wS0gI2K0WtQzDp2GohYQc7MiyPD1HjCXEiJTkx6JbPZmz1YnAM4cLoJAul+cerlhwnN9pITiJAvIn+MeSWS4vVDJ/BUebhJdAk5gLL70tsjHPi8BMcvkSvXl6pdNXIB5ZWeVaw2v4n8D3D4/LXsfy8gV9n0oC7aAw4wAAAABJRU5ErkJggg==",e.defaultIcon=e.poi,e.chevron="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABmJLR0QA/wD/AP+gvaeTAAABvElEQVRoge3YWUsCURiA4TPdVdBGli1E20XLr+gHB923WFdt0k6aQZlB+guCIHi7mCXBwY7fOJ5Pm/faYc7D6DnjZ0xWls6AEWAXeAE2XK9HVIDY57cGsOV6XR0VIA5orQFsul6fVQHiMAYRVlePCRBHbRBh78C66/XGBoxaIpoxa67X3RKw1wEi7A1YSXttQx1+/ktwjyVjTAFYFlybTsAw8TuVmidjHX/vWP8GU0XZ18x2G+4bTEGIeQYWXBui8M+WYyGmohFzkgAz79oQlRDzpA0zBpwJMWVgzrUhChgfNMy5EFMC8q4NUQHmYlAwEwkwt8C0a0MUMAVcCzFFwLO5T6ev8ZK+jTGfwmtnTW/W2D7838mp8Gk0gG3XhqSIOhrGSiQ7S3RMYPB3KukZomPykhBR04SQnhk1NIyNgEngUoh4GxTEqmuDAXL4rxKSqmiYqASIu35HzCRAvKJhghIg7oWICrDo2tANhI6JCfLX8TIpDxd6MY0vG2N2PM/7EFybTvhnRlHTkxCH/bZbQtNEJC4LjH5EWICJ28Ee0TQBsQl/O35oQtwAOdfrEgXkgSv8v7V6xjdZWd3pB9JxAjY9tg5oAAAAAElFTkSuQmCC",e.person="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAADICAYAAADFh+7jAAABG2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+Gkqr6gAAAYJpQ0NQc1JHQiBJRUM2MTk2Ni0yLjEAACiRdZG7SwNBEIc/EyU+UdDCwuIUtVKJEYI2Fgm+QC1iBF9NcsklQi4edycSbAXbgIJo46vQv0BbwVoQFEUQS7FWtFE554wQETPLzn7725lhdxY80YyqW+V+0LO2GRkJKTOzc4rvkTJqqKKb1phqGRNTw1FK2tuNRItddbu1Ssf9azWJpKVCWaXwoGqYtvCo8PiKbbi8KdykpmMJ4WPhLlMuKHzt6vECP7mcKvCHy2Y0EgZPg7CS+sXxX6ymTV1YXk67nllWf+7jvqQ2mZ2ekrVNZgsWEUYIoTDGEGGC9DIgPijdCdAjO0rk+7/zJ1mSXFW8QQ6TRVKksekSdVmqJ2XVRE/KyJBz+/+3r5bWFyhUrw1BxYPjvHSAbwM+847zvu84nwfgvYezbDF/aQ/6X0XPF7X2Xahfg5PzohbfgtN1aL4zYmbsW/LK9GgaPB9B3Sw0XkL1fKFnP+cc3kJ0Vb7qArZ3oFPi6xe+AG2WZ+kub0h6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAN0UlEQVR4nO2deYxdVR3HP2/KdJkWUloKWNtOK7QFLCVFFmFYRnaQsKhYQUwxhjQEjYCQiAsuJLIGRRSCiRZFwtKAAiIgQUeWshhBWorI0ilFsKW0pQsDnU5n/OM3r30zvPfm3nvO+Z1z7zuf5Jc2ad873/P7vnvPXc75nRKRNOwATAImAzsCLcBooBnoAt7v/3M1sBx4z4vKISj5FpATJgKzEMN3SPG594DXgSVAtwNdmYim12cccDByZJuwGXgOeAnYairKlGh6dUrAQcB+lr93A/AXYK3l703FMJ+NB8pw4FhgpoPvHgFMB9YB6x18fyKi6QMZBZwC7O6wjWHAnsCHyAWfOtH07QwDTgR2UWpvCvAuHo74aPp2jgRaldtsBVYAH2g22qTZWMDMBGZ4aLcZOA7lgy+aLvfdB3psfydgH80Go+kwG3my5pM5yF2DCo1u+nDs34tnYSSwr1ZjjW76ZGRcDYE9tBpqdNOn+hZQwdj+cE4jm96E+TN120zVaKSRTR+L4sVTQlQeDDWy6b6v2KsxWqORaHpYqGiKpodFNN0xPb4FVGGLRiONbPr7vgVUoUujkUY2XSXBKYmmO2ajbwFVUNHUyKZ3AWt8ixjECo1GGtl0kLnpodADvKXRUKOb3ulbQAVvonRH0eimrwVW+hbRz1KthhrddICnfQtAxvK3tRqLpsM7wDLPGp7VbCyaLjyNzEP3wb9QXvESp0AL3cAqZPWJ5lKvFcBjiu0B0fRKNiGPZqcqtbcOeBAPCxqj6QNZg5g/BbdH/ErgIWQ1qzrR9I+yBrmSbiXdWvSk/Ad4FI/r1aPp1dmEFBMYDexs6Tu7gEXAP4E+S9+Zibg+fWh2RQoTfCzj57cgV+hLCOQdfjQ9OeOQi7ypDD2BsRu5Ml+OPF5VmRyRlGh6NlqAMcjpv4XthYbKxYbWA73e1EUikUgkEolEIpFIJBKJRCKRSCQSUaXIL1xGIkUBpyJvyMbX+XMUMnninf5YXfH3l4C/I9ObCkGRTN8ZaAMOBw4DDsBeTZle5J343/rjMcJcAFl4xgBzgRuBxYgxfUrRgxz9c3EzpSpSwTDgeOD3yHtrLZPrxZvAt5GhImKR2cC1yIRF3ybXii7gV8BejnLQEOwOXAy8gH9D00Q38BPkQjKSkKOAhUjyfBtoEq/29yVSg3HARcDL+DfLdiwgjvcD+DTwW2Q7C9/muIxVQLudlOWTFmA+8Dz+zdCMzcBZFvKXK0YAFyDruHwb4Ct6ge+YJjIPNCNH9pv4T3oocTMFXVLWBMxD1oT5TnKI8QBy9isMuyHPqH0nNvT4XdYEh0YbUg/Nd0LzEt/NluZwuBBZrOc7kXmKXuALWZLtmx2Bu/CfwLxGF/IqODeMAf6B/8TlPd4m+xp4VZqBh/GfsKLEnenSr08JuBX/iSpaHJvGBG2uxn+Cihiv4Pj+PetToQuAH9sUEtnGeLZPxwqGQ9Gdj9aI8QGKe68OxQ7kbyZLXuOehJ445yL8J6NRYitSwNA6acb0jwN3E97+pEWlhFSmftSniIX4//U3WqzG45u4ExIIjOEmvpLAH+uUkCU9vjtfK4o+v876diNJdnY4FdjPdsOGdAO3I5MN7/ArxTkHA/trN1quWhxCvApcAkyo0NcZgC7XcU0df6xzsqNOpIlu5LXt0Xx0lW1rAPo0orOGP054xlEnksQy4FJk6lUt5nnUpx0q79uP8NS5DcD5JLveWOBJo4+4MkE+jPGR0PuASSk0dnrQ6CteS5GXTAxHtrTQ6lAvcqpOQ6uivlBiTsocVaXWKXQGUsBei2uRNW1paHegI3ScTqA8A71f7yKylfBYoKgxlHglQ54+Qq0jXasA0TrgTLJtaNNuV0oumI5U5TCilumdpl+ckMuANzJ8rhW9nRJD4wxXXzwe96eqt8j+Bmmegr5Q498Zc7aNWkf6GuR+2SVXkX3byXaLOvLGXkh1rekuvtzlAob/YVaIp9OhNpPQLHPWg9zxWJ1Ld6ZDwRca6Gp1qMs0vuehzS3Ab4BpBjndRgk3z947kVqsWZnnQJON6AF2Qp6c+Wi/G6ljNyV7aoU2y8J6MR+Pb7GsyVY826/vCs86NgM3YbguzubcuOtNhPSz3KIem3F1v779A9DShzwD+VqG/AJyylpkQcR9mJ3WQe7NfSezVpxUodPXKb5a3EbGlUxjgAcNGr6aZK9Kh+IcAw0uowdZo1/G9yl+cCzEoLDROcg9fNLGlmL3CdItKdrWjPJ4XmYm4S39OjdxlqvQAnwZeIjq9VtXIZWTTjBppAbLq7QXQpTH80oeCEBXZaxEztjGNAETkXKfcxh4irPNVPwnrlacWEXvMQHoGhyXJ0l0SJyN/6RViy3U/rEvDkBfZXQBk2xcXGmxp28BNXiO2vu5XKUpJAGjgNPyZLrxkyZHdNT5t9uAe5V0JGWPPJne6ltADTqG+PdzkYvbUPiEbwFpCOmBR5LxvJLPBqC1HEsS6A2CEvJM2XfCBsczKfpwbQB6+4CNeTm9TyDMYggdKf7vxcB1jnSkYa1vAUkZTnhPuPqofn8+FJd71vxwBs3e+C/+Ta6MpON5NS7F34/4soyavfAE/o2ujDTjeTXakXnsmpp7gWl5GdNBebluAjosfH42sjAxy7z/LDxCeHmsi++xcHBkGc9rsR/wV8d6N5Gze3QI6126yXhej3akPKgLzec50OucCYSzFafpeD4URwNPWtSb671i7sa/4X3ovUg5HqkulVVnLwXYI+Yk/Bveh93xPAknkX7xyTLgNGWdTmjC/6Z+rsbzJLQjCxs21NDWiwwLn6fOnDitJck2uRxZSeKLd5ClRJs8ahiJFI6Ygsxcehcpt/Y6MlGicExBd81YtXiEMN8FFJr5+B/X78TOtO5ICv6If+N/6byXkQHsgix59m38Dx33MzKIEwjjlev5rjsaGcg1+Dd9KzDXdUcj2ykhs059G7+ZwDfSKxrNmC2wtBUbgYMc9zVSQQvwFP6NX40UA4ooMQ5ZKevb+DdIV9i44ZmA2UOPSUjSfRu/FPkRRhJwFebP1mcip1nfxj+FbmHlXDIceaGxBVn+bMKByIWVb+MfRC40IzWYy/ZkvY75K8xjCGNlzG3k842mCoMnB9o4Ss5AHp74Nv7nhv0oJDNwd5ScV+O7tcPnPIAgqbfAz0b9uR/U+X7NmG+hL4VgBDL7o16ybEzwu2GINjRiKzKdqeE5i2QJMyqLhQwTtydsy2V8CBxl2Jfck3SCfw/wOcO2mpGVm76NX41h/dY8szfpj5LPGLY5Gr+7S5bjYRr0Vu6npE/WBsx3Gh6PbI3h2/gLDPuRO0aSruxoZazCvMzYZGBFxvZtxYfAvob9yBWmBQGXYT4u7s3Qdw6u40XMtjfJFY9jnrDFwFhDHQeju81otfiqYR9ywT7YS9jjmNeSPw6/q2KfMNSfC67HbtLuJ9v2nZV8Cb/P6Qs942YUst2E7aTdgvkt0Ncd6Eoa1UqIF4Z5uEvcNRb0/cihvnqxEvOzVbDY2BOmXlxiQeONjjXWilMtaA+O2egkz/RquAm4S0lrZdxkqDtIbG75VS96MN92egTwgpLechhvoBsac9Bbe7YO89s4gFnAB0qay7GbBd3B8Gf0EmdzetI3FXX3UaB1cba38BwqZlnUXkJ2p9LSXohxvQV4Hr2kLXLQh93Rm0v/kgP96tyJ7lF+jqN+aJ7md3XUBxW+j67hti7gqjEeeRWq0Y8vOuqDc05Hv1LEDY77dIdSP2503A8nHImf15WuJyQcq9SP3I3rvgx/SqFvJaRmukZ/nIzrLuqgHYFsLutjtebNCm30AQsU2gE5eILnCPzNQHF5ATeY/ZX6FHydOp+G9wG/cN/FbTThZj7A4Fiq1aEsHI7/OWbaM0rvs6i9XkywLdzGmH448kzdZ8WFe9HfTrJDqZ12pXYScxj+qz1sBT7puqNVaMhxPQTD+4BbXXe0Blrj+otaHRqKUAzvxu+2Uxrjei+Wx/UsY3obUhZkjE0hGbkCWeXiiw6FNkp4vl9vI4wjvA+p9+57xafWuK55OzqANmpvGKMdL+Jv85xKCj2uH0o4hq9FNs4JBa1xfRdbgpOM6YciU4VCOLI2AacgNeZCoUOhDdVxPaQjfCPyICg0tMZ11/MEADiEaHgStMZ1508co+HpyN24PphDgPUKnSiK4QAXoZMPJ/XnPkU0PAta47r1+rIjgZeVxBfJcNAb1xfbFn6lgugiGl5Ga1wfb0vwAcgqz2h4dr6FTo5MK2ZuQ3s5btEMB7ke0siTlXG9VUlskQ0HGdffw32urIzrpysIHcrww2x0JADux32+eoGdTEQ2YV5j1YRNwIkUp4Zah0IbJQxfOPk0vWiGg95kyWkmH27Cz2vKIhoOsgZ/vUI7k00+3IQUw9WkqIaDjLePK7Rj9MNqAt6yJCQJRTa8TIdCG2+bfoFWdYUiXaXXY1/cX70bbwPS6lhkIxlexmVFzKdtifyTQ5GNZjjAmbjL5/m2RE5EJhxGw+3QjIy7tvP5JJZrCphurRENH8h87ObzfWC6C6H3WBLY6IaXuQJ7pn/DlchxmBv/GrInSkT4NeaGL0BhNc/ZpJ8J0oNskqtVAiQvDAN+BmwhvdmrgNM0xU4k+VX9EuAgTXE5ZAbwB5IbvhBHs1+TnDKmIb+2NuSHMAFZYfJcRfhcOZo32oCTkYLFs5DnJCWkEmUnUtXjHtzUtwXg/0qsA4OTWMKaAAAAAElFTkSuQmCC",e.floorchangeDownImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6M0Y2MDk5Q0IyM0EyMTFFOEExQkQ5MDk1RDU5RTBCQ0UiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6M0Y2MDk5Q0MyM0EyMTFFOEExQkQ5MDk1RDU5RTBCQ0UiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozRjYwOTlDOTIzQTIxMUU4QTFCRDkwOTVENTlFMEJDRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozRjYwOTlDQTIzQTIxMUU4QTFCRDkwOTVENTlFMEJDRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsNnVNkAAAJISURBVHja7NxNSsNAGAbgxD+KUnWhUCi9hrtewWO51RMUFAaXQg/QhYuCV9CtpQtxZXelxG9kAjZN0kky881k8r7wUkpKJn0ozQ+ZREmSRNkyZEx9pa6piYGu1frGtjd8x8oB4C11Ywgu241af7CAx9SlJby0SzUOC+BBxJsb6sDyGAM1Dku4Aa8DG4cdMLgAEIAABCAAEQACEIAARAAIQAACEAEgAAEIQASAAAQgABEAAhCAAEQACEAAAhABIAABCEAkkyPNz/WphwbGO2P6XnKcSwPrkXf9/5R+ouQu/RH1mbqK7N5V73tXymGU51UEOKR+dhwuW+kx1AV8BFhun7JWcd7EmjiOv+jlCruInXyT15ZLEWACq8J9RqxzGPMBqty86x4H3sMqNw+6hzHyZzrBTmOrk/QvT3e2pjxwFoD7q0hPJKpOdwXiP7w6gF1HFNlT2LoTrruIKPLO/5vMWO8Soii6eNJ0yn8XEEXZlScTz0wIGVHsu2xn6qETISLuxTMJGBqiFp5pwBTxpeV4L1Wuttt4bswJddpSvKna/sglYFsRK+PZBGwbYi0824BtQayNxwHoO2IjPC5AXxEb43EC+oZoBI8b0BdEY3guAF0jGsVzBZgizpjxZqbxXALKnDIiztR4UUiAXIjW8HwAtI1oFc8XQFuI1vF8AjSNyILnG6ApRDY8HwGbIrLi+QpYF5Edz2fAqohO8HwHlDmnvu3Bk8v7rjbQd0CZC+q8AG+ulkcALE+PekddKLiFet9zvWFZq18BBgDKKe48BY2GvQAAAABJRU5ErkJggg==",e.floorchangeUpImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Mzc3ODM3OTQyM0EyMTFFODk5MzVCRjg5RkE3NDIwNEMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Mzc3ODM3OTUyM0EyMTFFODk5MzVCRjg5RkE3NDIwNEMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozNzc4Mzc5MjIzQTIxMUU4OTkzNUJGODlGQTc0MjA0QyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozNzc4Mzc5MzIzQTIxMUU4OTkzNUJGODlGQTc0MjA0QyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv4uuuEAAAJCSURBVHja7NxPasJAGAXwxP6hFGwP4L53cOEJeoXuixfxGF1V6E4Q6tJFF0KPULptcdEWCuJKavpNOwEdJzpJZr6ZJO/BI5CECfk5MirEVpIk0WYDyBl1QH2nJnI7kPu9RrX68woM8JI6k3BqZ/I4ADPSpj5n4KUVxy8AuJtz6vQAXtqpPB+ABfC8IoYIWATPG2JogGXwvCCGBGgDjx0xFECbeKyIIQC6wGND9A3oEo8F0ScgB55zRF+Ap4x4m4indQAUNzFmxks7to3IDegTzwkiJ2AIeNYRuQBDwrOKyAEYIp41RNeAIeNZQXQJWAW80oiuAKuEVwrRBWAV8Qoj2gY8oo4qipd2JO+DHVBcdFhxvLRDU0RbgHXCy4VoA7COeMaIZQHrjGeEWAawCXgHEYsCNglvL2IRwCbiZSLmBWwynhYxDyDwNIimgDH1DnBbFR6xKWAfYNr2dYCxunDEcfxCm6sIUfNKVjsuOsAEVpkfpGN1X0tz3heotPnU7dQBTmClzcTo+x2lQ33DorFV4dHRLSK6GSgeK+hSH6jLhs+6pXToSpfIZBFRz2nn+dV2T66p9ww3fUN9tDDOD3WhvlvVHBsMtLD4anLNmm+uKdrC2gBAAAIQgAgAAQhAACIABCAAAYgAEIAABCACQAACEIAIAAEIQAAiAAQgAAGIABCAAAQgAsDKAn7U7Dr/YfwL0BPqPHL7OMJcXofFKusxB1dZUW+pa0fjr+X4q7rOwDQ96pO8URuzbiXH63Fbif4KMAA5SHWvsbuuvQAAAABJRU5ErkJggg==",e.popupImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAACMCAYAAACuwEE+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Q0RCNzBCQjQ5QkNGMTFFRDg3QjVERTUyNTA3RDg4QTUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Q0RCNzBCQjU5QkNGMTFFRDg3QjVERTUyNTA3RDg4QTUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDREI3MEJCMjlCQ0YxMUVEODdCNURFNTI1MDdEODhBNSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDREI3MEJCMzlCQ0YxMUVEODdCNURFNTI1MDdEODhBNSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnxS85oAAARhSURBVHja7Js7axRRGIZ3QlQkUYyiQWMsVAwKNhrFJoXWdkr0F4iKdhaWgiixUAiiBNJYKYKlIKlE7byAlfFuYbxf8UaiSdb3w7NmncyevRt2zvPAy7LJZop3nnwzc2Y2ymazGYBSaaICQBioG835b6IoqlS6bqVH2aSsU5a737VR8Yzwyb0+V+4pt5Qbyh1lstyN/XPaYm9yKROT4oQyYpshDRETqE/pKFeYv45UIIxNjdPKKDugYWP7rl9ZUG9hepW3FJ6avFF21kOYWcoABac2Z90+rokwrcoQpaY+V5SWaoVpdhui0DByOX7lXK4wZygxuPRXKkwv5QWbHYWEifJFyVu4W6wMK4tYAwuSd8pa5UN84a7QrYHjyBI0NjCOJf0iacJ0Ko+V2fQWNGPKKuVFsQmzH1lAzFH2FZswze7eUDt9gXiprJAjE4UmzGZkgTyWKRvyfxAXZisdQYxtPmE20g/E6PYJs4Z+IEaXT5il9AM+J+LCtNIPxJjnu6zmOycwDTkSFZowAF4QBhAGEAYQBhAGEAYAYQBhAGEAYQBhAGEAEAYQBhAGEAYQBhAGAGEAYQBhAGEAYQAQBhAGEAYQBhAGEAYAYQBhAGEAYQBhAGEAEAYQBhAGEAYQBhAGAGEAYQBhAGEAYQAQBhAGEAYQBhAGEAYAYQBhAGEAYQBhAGEAEAYQBhAGEAYQBhAGAGEAYQBhAGEAYQAQBhAGEAYQBhAGEAYAYaD2wvyiEogx5hPmK/2Az4m4MK/oB3xOxIV5SD8Q44FPmDv0AzFu+4S5Sj/gcyLKZrNTb6LIBHqmrKAnEE+V1dk8SeITZlI5T0/guKBkfRPGXjqUJ8oc+gqaUWWlXSXlO5K00vtCGaSv4BnIJCyzJE0YY6FyX1lMb0HyVulSPtubYhPG+KgcoLdg2Z+TZRpmTy4JnHEnPSSc9HsdKSJMs3KFEoPJZbfPKxbGaFWGKDP1scHQUvQoVIIwxix31kyx6cxZt48ztRImR687g6bkdOS1sqPYTq9GGKNNOe0Wdii9MTPqTm4XlLLDqxUmx3LlhDLCDmiYPFf63Gp+yeQ7UmjhrhxsLadb6VE2KeucTG0sZ8won5wgw8pN5Ubmz+Mrk+Vu6J9hUsWEaQSOzMB/8eG0lVirQ1Ij0OTWFib+gyj2n3vJBjXCNDZ2YmfPdYzXUZZxd+9tXhoLDE0YY73yo06Txrb5zd2syyBMethdxwmzK83FhSqMcbIOspxKe2khC2M31q7V6NBk27ieSbhZhzDpYonyssqTYPtbexqtPYTCQhfG2Kz8dJfClVw+23fQt4RSFsL8YU8VE+ZgSEUhzBSDZU4Z++y50EpCmCnsqzS3Szyfsc/cVeYiTLjCGJ3K+yLS2BXRF2V1iAUhzHS2OmEmPYei7aGWgzDJHPJMmKMhF4MwhbkYmzJ2KLKHo5sQBmGSmK88cussFlvgWxJ6KQjjx54Y/J4JbHEOYarDnqTfSw3ThfktwAB+TNocUCnWeAAAAABJRU5ErkJggg==";var r=120;e.pulsingDot={width:r,height:r,data:new Uint8Array(r*r*4),onAdd:function(t,n){var i=document.createElement("canvas");i.width=this.width,i.height=this.height,this.context=i.getContext("2d"),this.map=t},render:function(t,n){var i=1e3,l=performance.now()%i/i,p=r/2*.3,u=r/2*.7*l+p,_=this.context,m=this.map;return _.clearRect(0,0,this.width,this.height),_.beginPath(),_.arc(this.width/2,this.height/2,u,0,Math.PI*2),_.fillStyle="rgba(189,82,255,"+(1-l)+")",_.fill(),_.beginPath(),_.arc(this.width/2,this.height/2,p,0,Math.PI*2),_.fillStyle="rgb(189,82,255)",_.strokeStyle="white",_.lineWidth=2+4*(1-l),_.fill(),_.stroke(),this.data=_.getImageData(0,0,this.width,this.height).data,m.triggerRepaint(),!0}}})(ZN);var DS={},mi={},Ff={},ui={};Object.defineProperty(ui,"__esModule",{value:!0});ui.isFunction=void 0;function EH(e){return typeof e=="function"}ui.isFunction=EH;var aa={},Fd={},wl={};Object.defineProperty(wl,"__esModule",{value:!0});wl.createErrorClass=void 0;function SH(e){var r=function(n){Error.call(n),n.stack=new Error().stack},t=e(r);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}wl.createErrorClass=SH;Object.defineProperty(Fd,"__esModule",{value:!0});Fd.UnsubscriptionError=void 0;var PH=wl;Fd.UnsubscriptionError=PH.createErrorClass(function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});var Zu={};Object.defineProperty(Zu,"__esModule",{value:!0});Zu.arrRemove=void 0;function AH(e,r){if(e){var t=e.indexOf(r);0<=t&&e.splice(t,1)}}Zu.arrRemove=AH;var IC=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},OC=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},CC=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(aa,"__esModule",{value:!0});aa.isSubscription=aa.EMPTY_SUBSCRIPTION=aa.Subscription=void 0;var Hp=ui,ib=Fd,TC=Zu,NS=function(){function e(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var r,t,n,i,l;if(!this.closed){this.closed=!0;var p=this._parentage;if(p)if(this._parentage=null,Array.isArray(p))try{for(var u=IC(p),_=u.next();!_.done;_=u.next()){var m=_.value;m.remove(this)}}catch($){r={error:$}}finally{try{_&&!_.done&&(t=u.return)&&t.call(u)}finally{if(r)throw r.error}}else p.remove(this);var S=this.initialTeardown;if(Hp.isFunction(S))try{S()}catch($){l=$ instanceof ib.UnsubscriptionError?$.errors:[$]}var P=this._finalizers;if(P){this._finalizers=null;try{for(var O=IC(P),M=O.next();!M.done;M=O.next()){var B=M.value;try{MC(B)}catch($){l=l??[],$ instanceof ib.UnsubscriptionError?l=CC(CC([],OC(l)),OC($.errors)):l.push($)}}}catch($){n={error:$}}finally{try{M&&!M.done&&(i=O.return)&&i.call(O)}finally{if(n)throw n.error}}}if(l)throw new ib.UnsubscriptionError(l)}},e.prototype.add=function(r){var t;if(r&&r!==this)if(this.closed)MC(r);else{if(r instanceof e){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(r)}},e.prototype._hasParent=function(r){var t=this._parentage;return t===r||Array.isArray(t)&&t.includes(r)},e.prototype._addParent=function(r){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(r),t):t?[t,r]:r},e.prototype._removeParent=function(r){var t=this._parentage;t===r?this._parentage=null:Array.isArray(t)&&TC.arrRemove(t,r)},e.prototype.remove=function(r){var t=this._finalizers;t&&TC.arrRemove(t,r),r instanceof e&&r._removeParent(this)},e.EMPTY=function(){var r=new e;return r.closed=!0,r}(),e}();aa.Subscription=NS;aa.EMPTY_SUBSCRIPTION=NS.EMPTY;function IH(e){return e instanceof NS||e&&"closed"in e&&Hp.isFunction(e.remove)&&Hp.isFunction(e.add)&&Hp.isFunction(e.unsubscribe)}aa.isSubscription=IH;function MC(e){Hp.isFunction(e)?e():e.unsubscribe()}var Mc={};Object.defineProperty(Mc,"__esModule",{value:!0});Mc.config=void 0;Mc.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var kd={},FS={};(function(e){var r=we&&we.__read||function(n,i){var l=typeof Symbol=="function"&&n[Symbol.iterator];if(!l)return n;var p=l.call(n),u,_=[],m;try{for(;(i===void 0||i-- >0)&&!(u=p.next()).done;)_.push(u.value)}catch(S){m={error:S}}finally{try{u&&!u.done&&(l=p.return)&&l.call(p)}finally{if(m)throw m.error}}return _},t=we&&we.__spreadArray||function(n,i){for(var l=0,p=i.length,u=n.length;l<p;l++,u++)n[u]=i[l];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.timeoutProvider=void 0,e.timeoutProvider={setTimeout:function(n,i){for(var l=[],p=2;p<arguments.length;p++)l[p-2]=arguments[p];var u=e.timeoutProvider.delegate;return u!=null&&u.setTimeout?u.setTimeout.apply(u,t([n,i],r(l))):setTimeout.apply(void 0,t([n,i],r(l)))},clearTimeout:function(n){var i=e.timeoutProvider.delegate;return((i==null?void 0:i.clearTimeout)||clearTimeout)(n)},delegate:void 0}})(FS);Object.defineProperty(kd,"__esModule",{value:!0});kd.reportUnhandledError=void 0;var OH=Mc,CH=FS;function TH(e){CH.timeoutProvider.setTimeout(function(){var r=OH.config.onUnhandledError;if(r)r(e);else throw e})}kd.reportUnhandledError=TH;var la={};Object.defineProperty(la,"__esModule",{value:!0});la.noop=void 0;function MH(){}la.noop=MH;var yl={};Object.defineProperty(yl,"__esModule",{value:!0});yl.createNotification=yl.nextNotification=yl.errorNotification=yl.COMPLETE_NOTIFICATION=void 0;yl.COMPLETE_NOTIFICATION=function(){return ny("C",void 0,void 0)}();function LH(e){return ny("E",void 0,e)}yl.errorNotification=LH;function RH(e){return ny("N",e,void 0)}yl.nextNotification=RH;function ny(e,r,t){return{kind:e,value:r,error:t}}yl.createNotification=ny;var wc={};Object.defineProperty(wc,"__esModule",{value:!0});wc.captureError=wc.errorContext=void 0;var HN=Mc,Xc=null;function DH(e){if(HN.config.useDeprecatedSynchronousErrorHandling){var r=!Xc;if(r&&(Xc={errorThrown:!1,error:null}),e(),r){var t=Xc,n=t.errorThrown,i=t.error;if(Xc=null,n)throw i}}else e()}wc.errorContext=DH;function NH(e){HN.config.useDeprecatedSynchronousErrorHandling&&Xc&&(Xc.errorThrown=!0,Xc.error=e)}wc.captureError=NH;(function(e){var r=we&&we.__extends||function(){var R=function(k,U){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,ue){H.__proto__=ue}||function(H,ue){for(var ie in ue)Object.prototype.hasOwnProperty.call(ue,ie)&&(H[ie]=ue[ie])},R(k,U)};return function(k,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");R(k,U);function H(){this.constructor=k}k.prototype=U===null?Object.create(U):(H.prototype=U.prototype,new H)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.EMPTY_OBSERVER=e.SafeSubscriber=e.Subscriber=void 0;var t=ui,n=aa,i=Mc,l=kd,p=la,u=yl,_=FS,m=wc,S=function(R){r(k,R);function k(U){var H=R.call(this)||this;return H.isStopped=!1,U?(H.destination=U,n.isSubscription(U)&&U.add(H)):H.destination=e.EMPTY_OBSERVER,H}return k.create=function(U,H,ue){return new B(U,H,ue)},k.prototype.next=function(U){this.isStopped?X(u.nextNotification(U),this):this._next(U)},k.prototype.error=function(U){this.isStopped?X(u.errorNotification(U),this):(this.isStopped=!0,this._error(U))},k.prototype.complete=function(){this.isStopped?X(u.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},k.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,R.prototype.unsubscribe.call(this),this.destination=null)},k.prototype._next=function(U){this.destination.next(U)},k.prototype._error=function(U){try{this.destination.error(U)}finally{this.unsubscribe()}},k.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},k}(n.Subscription);e.Subscriber=S;var P=Function.prototype.bind;function O(R,k){return P.call(R,k)}var M=function(){function R(k){this.partialObserver=k}return R.prototype.next=function(k){var U=this.partialObserver;if(U.next)try{U.next(k)}catch(H){$(H)}},R.prototype.error=function(k){var U=this.partialObserver;if(U.error)try{U.error(k)}catch(H){$(H)}else $(k)},R.prototype.complete=function(){var k=this.partialObserver;if(k.complete)try{k.complete()}catch(U){$(U)}},R}(),B=function(R){r(k,R);function k(U,H,ue){var ie=R.call(this)||this,ee;if(t.isFunction(U)||!U)ee={next:U??void 0,error:H??void 0,complete:ue??void 0};else{var W;ie&&i.config.useDeprecatedNextContext?(W=Object.create(U),W.unsubscribe=function(){return ie.unsubscribe()},ee={next:U.next&&O(U.next,W),error:U.error&&O(U.error,W),complete:U.complete&&O(U.complete,W)}):ee=U}return ie.destination=new M(ee),ie}return k}(S);e.SafeSubscriber=B;function $(R){i.config.useDeprecatedSynchronousErrorHandling?m.captureError(R):l.reportUnhandledError(R)}function q(R){throw R}function X(R,k){var U=i.config.onStoppedNotification;U&&_.timeoutProvider.setTimeout(function(){return U(R,k)})}e.EMPTY_OBSERVER={closed:!0,next:p.noop,error:q,complete:p.noop}})(Ff);var vh={};Object.defineProperty(vh,"__esModule",{value:!0});vh.observable=void 0;vh.observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();var Hl={},ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.identity=void 0;function FH(e){return e}ca.identity=FH;Object.defineProperty(Hl,"__esModule",{value:!0});Hl.pipeFromArray=Hl.pipe=void 0;var kH=ca;function BH(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return JN(e)}Hl.pipe=BH;function JN(e){return e.length===0?kH.identity:e.length===1?e[0]:function(t){return e.reduce(function(n,i){return i(n)},t)}}Hl.pipeFromArray=JN;Object.defineProperty(mi,"__esModule",{value:!0});mi.Observable=void 0;var bx=Ff,zH=aa,jH=vh,UH=Hl,$H=Mc,ob=ui,GH=wc,qH=function(){function e(r){r&&(this._subscribe=r)}return e.prototype.lift=function(r){var t=new e;return t.source=this,t.operator=r,t},e.prototype.subscribe=function(r,t,n){var i=this,l=XH(r)?r:new bx.SafeSubscriber(r,t,n);return GH.errorContext(function(){var p=i,u=p.operator,_=p.source;l.add(u?u.call(l,_):_?i._subscribe(l):i._trySubscribe(l))}),l},e.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(t){r.error(t)}},e.prototype.forEach=function(r,t){var n=this;return t=LC(t),new t(function(i,l){var p=new bx.SafeSubscriber({next:function(u){try{r(u)}catch(_){l(_),p.unsubscribe()}},error:l,complete:i});n.subscribe(p)})},e.prototype._subscribe=function(r){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(r)},e.prototype[jH.observable]=function(){return this},e.prototype.pipe=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return UH.pipeFromArray(r)(this)},e.prototype.toPromise=function(r){var t=this;return r=LC(r),new r(function(n,i){var l;t.subscribe(function(p){return l=p},function(p){return i(p)},function(){return n(l)})})},e.create=function(r){return new e(r)},e}();mi.Observable=qH;function LC(e){var r;return(r=e??$H.config.Promise)!==null&&r!==void 0?r:Promise}function VH(e){return e&&ob.isFunction(e.next)&&ob.isFunction(e.error)&&ob.isFunction(e.complete)}function XH(e){return e&&e instanceof bx.Subscriber||VH(e)&&zH.isSubscription(e)}var yh={},Bd={},Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.operate=Qt.hasLift=void 0;var YH=ui;function KN(e){return YH.isFunction(e==null?void 0:e.lift)}Qt.hasLift=KN;function WH(e){return function(r){if(KN(r))return r.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}Qt.operate=WH;var mr={},ZH=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(mr,"__esModule",{value:!0});mr.OperatorSubscriber=mr.createOperatorSubscriber=void 0;var HH=Ff;function JH(e,r,t,n,i){return new QN(e,r,t,n,i)}mr.createOperatorSubscriber=JH;var QN=function(e){ZH(r,e);function r(t,n,i,l,p,u){var _=e.call(this,t)||this;return _.onFinalize=p,_.shouldUnsubscribe=u,_._next=n?function(m){try{n(m)}catch(S){t.error(S)}}:e.prototype._next,_._error=l?function(m){try{l(m)}catch(S){t.error(S)}finally{this.unsubscribe()}}:e.prototype._error,_._complete=i?function(){try{i()}catch(m){t.error(m)}finally{this.unsubscribe()}}:e.prototype._complete,_}return r.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},r}(HH.Subscriber);mr.OperatorSubscriber=QN;Object.defineProperty(Bd,"__esModule",{value:!0});Bd.refCount=void 0;var KH=Qt,QH=mr;function eJ(){return KH.operate(function(e,r){var t=null;e._refCount++;var n=QH.createOperatorSubscriber(r,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount){t=null;return}var i=e._connection,l=t;t=null,i&&(!l||i===l)&&i.unsubscribe(),r.unsubscribe()});e.subscribe(n),n.closed||(t=e.connect())})}Bd.refCount=eJ;var tJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(yh,"__esModule",{value:!0});yh.ConnectableObservable=void 0;var rJ=mi,RC=aa,nJ=Bd,iJ=mr,oJ=Qt,aJ=function(e){tJ(r,e);function r(t,n){var i=e.call(this)||this;return i.source=t,i.subjectFactory=n,i._subject=null,i._refCount=0,i._connection=null,oJ.hasLift(t)&&(i.lift=t.lift),i}return r.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},r.prototype.getSubject=function(){var t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject},r.prototype._teardown=function(){this._refCount=0;var t=this._connection;this._subject=this._connection=null,t==null||t.unsubscribe()},r.prototype.connect=function(){var t=this,n=this._connection;if(!n){n=this._connection=new RC.Subscription;var i=this.getSubject();n.add(this.source.subscribe(iJ.createOperatorSubscriber(i,void 0,function(){t._teardown(),i.complete()},function(l){t._teardown(),i.error(l)},function(){return t._teardown()}))),n.closed&&(this._connection=null,n=RC.Subscription.EMPTY)}return n},r.prototype.refCount=function(){return nJ.refCount()(this)},r}(rJ.Observable);yh.ConnectableObservable=aJ;var iy={},eF={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.performanceTimestampProvider=void 0,e.performanceTimestampProvider={now:function(){return(e.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}})(eF);var kS={};(function(e){var r=we&&we.__read||function(i,l){var p=typeof Symbol=="function"&&i[Symbol.iterator];if(!p)return i;var u=p.call(i),_,m=[],S;try{for(;(l===void 0||l-- >0)&&!(_=u.next()).done;)m.push(_.value)}catch(P){S={error:P}}finally{try{_&&!_.done&&(p=u.return)&&p.call(u)}finally{if(S)throw S.error}}return m},t=we&&we.__spreadArray||function(i,l){for(var p=0,u=l.length,_=i.length;p<u;p++,_++)i[_]=l[p];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.animationFrameProvider=void 0;var n=aa;e.animationFrameProvider={schedule:function(i){var l=requestAnimationFrame,p=cancelAnimationFrame,u=e.animationFrameProvider.delegate;u&&(l=u.requestAnimationFrame,p=u.cancelAnimationFrame);var _=l(function(m){p=void 0,i(m)});return new n.Subscription(function(){return p==null?void 0:p(_)})},requestAnimationFrame:function(){for(var i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];var p=e.animationFrameProvider.delegate;return((p==null?void 0:p.requestAnimationFrame)||requestAnimationFrame).apply(void 0,t([],r(i)))},cancelAnimationFrame:function(){for(var i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];var p=e.animationFrameProvider.delegate;return((p==null?void 0:p.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,t([],r(i)))},delegate:void 0}})(kS);Object.defineProperty(iy,"__esModule",{value:!0});iy.animationFrames=void 0;var sJ=mi,uJ=eF,DC=kS;function lJ(e){return e?tF(e):cJ}iy.animationFrames=lJ;function tF(e){return new sJ.Observable(function(r){var t=e||uJ.performanceTimestampProvider,n=t.now(),i=0,l=function(){r.closed||(i=DC.animationFrameProvider.requestAnimationFrame(function(p){i=0;var u=t.now();r.next({timestamp:e?u:p,elapsed:u-n}),l()}))};return l(),function(){i&&DC.animationFrameProvider.cancelAnimationFrame(i)}})}var cJ=tF(),ko={},zd={};Object.defineProperty(zd,"__esModule",{value:!0});zd.ObjectUnsubscribedError=void 0;var hJ=wl;zd.ObjectUnsubscribedError=hJ.createErrorClass(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var rF=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fJ=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ko,"__esModule",{value:!0});ko.AnonymousSubject=ko.Subject=void 0;var NC=mi,xx=aa,pJ=zd,dJ=Zu,ab=wc,nF=function(e){rF(r,e);function r(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r.prototype.lift=function(t){var n=new wx(this,this);return n.operator=t,n},r.prototype._throwIfClosed=function(){if(this.closed)throw new pJ.ObjectUnsubscribedError},r.prototype.next=function(t){var n=this;ab.errorContext(function(){var i,l;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var p=fJ(n.currentObservers),u=p.next();!u.done;u=p.next()){var _=u.value;_.next(t)}}catch(m){i={error:m}}finally{try{u&&!u.done&&(l=p.return)&&l.call(p)}finally{if(i)throw i.error}}}})},r.prototype.error=function(t){var n=this;ab.errorContext(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var i=n.observers;i.length;)i.shift().error(t)}})},r.prototype.complete=function(){var t=this;ab.errorContext(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},r.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},r.prototype._innerSubscribe=function(t){var n=this,i=this,l=i.hasError,p=i.isStopped,u=i.observers;return l||p?xx.EMPTY_SUBSCRIPTION:(this.currentObservers=null,u.push(t),new xx.Subscription(function(){n.currentObservers=null,dJ.arrRemove(u,t)}))},r.prototype._checkFinalizedStatuses=function(t){var n=this,i=n.hasError,l=n.thrownError,p=n.isStopped;i?t.error(l):p&&t.complete()},r.prototype.asObservable=function(){var t=new NC.Observable;return t.source=this,t},r.create=function(t,n){return new wx(t,n)},r}(NC.Observable);ko.Subject=nF;var wx=function(e){rF(r,e);function r(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return r.prototype.next=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,t)},r.prototype.error=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,t)},r.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},r.prototype._subscribe=function(t){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&i!==void 0?i:xx.EMPTY_SUBSCRIPTION},r}(nF);ko.AnonymousSubject=wx;var jd={},gJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(jd,"__esModule",{value:!0});jd.BehaviorSubject=void 0;var mJ=ko,vJ=function(e){gJ(r,e);function r(t){var n=e.call(this)||this;return n._value=t,n}return Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),r.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},r.prototype.getValue=function(){var t=this,n=t.hasError,i=t.thrownError,l=t._value;if(n)throw i;return this._throwIfClosed(),l},r.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},r}(mJ.Subject);jd.BehaviorSubject=vJ;var kf={},oy={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.dateTimestampProvider=void 0,e.dateTimestampProvider={now:function(){return(e.dateTimestampProvider.delegate||Date).now()},delegate:void 0}})(oy);var yJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(kf,"__esModule",{value:!0});kf.ReplaySubject=void 0;var _J=ko,bJ=oy,xJ=function(e){yJ(r,e);function r(t,n,i){t===void 0&&(t=1/0),n===void 0&&(n=1/0),i===void 0&&(i=bJ.dateTimestampProvider);var l=e.call(this)||this;return l._bufferSize=t,l._windowTime=n,l._timestampProvider=i,l._buffer=[],l._infiniteTimeWindow=!0,l._infiniteTimeWindow=n===1/0,l._bufferSize=Math.max(1,t),l._windowTime=Math.max(1,n),l}return r.prototype.next=function(t){var n=this,i=n.isStopped,l=n._buffer,p=n._infiniteTimeWindow,u=n._timestampProvider,_=n._windowTime;i||(l.push(t),!p&&l.push(u.now()+_)),this._trimBuffer(),e.prototype.next.call(this,t)},r.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(t),i=this,l=i._infiniteTimeWindow,p=i._buffer,u=p.slice(),_=0;_<u.length&&!t.closed;_+=l?1:2)t.next(u[_]);return this._checkFinalizedStatuses(t),n},r.prototype._trimBuffer=function(){var t=this,n=t._bufferSize,i=t._timestampProvider,l=t._buffer,p=t._infiniteTimeWindow,u=(p?1:2)*n;if(n<1/0&&u<l.length&&l.splice(0,l.length-u),!p){for(var _=i.now(),m=0,S=1;S<l.length&&l[S]<=_;S+=2)m=S;m&&l.splice(0,m+1)}},r}(_J.Subject);kf.ReplaySubject=xJ;var Bf={},wJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Bf,"__esModule",{value:!0});Bf.AsyncSubject=void 0;var EJ=ko,SJ=function(e){wJ(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}return r.prototype._checkFinalizedStatuses=function(t){var n=this,i=n.hasError,l=n._hasValue,p=n._value,u=n.thrownError,_=n.isStopped,m=n._isComplete;i?t.error(u):(_||m)&&(l&&t.next(p),t.complete())},r.prototype.next=function(t){this.isStopped||(this._value=t,this._hasValue=!0)},r.prototype.complete=function(){var t=this,n=t._hasValue,i=t._value,l=t._isComplete;l||(this._isComplete=!0,n&&e.prototype.next.call(this,i),e.prototype.complete.call(this))},r}(EJ.Subject);Bf.AsyncSubject=SJ;var iF={},ay={},Lc={},sy={},PJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(sy,"__esModule",{value:!0});sy.Action=void 0;var AJ=aa,IJ=function(e){PJ(r,e);function r(t,n){return e.call(this)||this}return r.prototype.schedule=function(t,n){return this},r}(AJ.Subscription);sy.Action=IJ;var oF={};(function(e){var r=we&&we.__read||function(n,i){var l=typeof Symbol=="function"&&n[Symbol.iterator];if(!l)return n;var p=l.call(n),u,_=[],m;try{for(;(i===void 0||i-- >0)&&!(u=p.next()).done;)_.push(u.value)}catch(S){m={error:S}}finally{try{u&&!u.done&&(l=p.return)&&l.call(p)}finally{if(m)throw m.error}}return _},t=we&&we.__spreadArray||function(n,i){for(var l=0,p=i.length,u=n.length;l<p;l++,u++)n[u]=i[l];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.intervalProvider=void 0,e.intervalProvider={setInterval:function(n,i){for(var l=[],p=2;p<arguments.length;p++)l[p-2]=arguments[p];var u=e.intervalProvider.delegate;return u!=null&&u.setInterval?u.setInterval.apply(u,t([n,i],r(l))):setInterval.apply(void 0,t([n,i],r(l)))},clearInterval:function(n){var i=e.intervalProvider.delegate;return((i==null?void 0:i.clearInterval)||clearInterval)(n)},delegate:void 0}})(oF);var OJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Lc,"__esModule",{value:!0});Lc.AsyncAction=void 0;var CJ=sy,FC=oF,TJ=Zu,MJ=function(e){OJ(r,e);function r(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return r.prototype.schedule=function(t,n){var i;if(n===void 0&&(n=0),this.closed)return this;this.state=t;var l=this.id,p=this.scheduler;return l!=null&&(this.id=this.recycleAsyncId(p,l,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(p,this.id,n),this},r.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),FC.intervalProvider.setInterval(t.flush.bind(t,this),i)},r.prototype.recycleAsyncId=function(t,n,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&FC.intervalProvider.clearInterval(n)},r.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(t,n){var i=!1,l;try{this.work(t)}catch(p){i=!0,l=p||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),l},r.prototype.unsubscribe=function(){if(!this.closed){var t=this,n=t.id,i=t.scheduler,l=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,TJ.arrRemove(l,this),n!=null&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},r}(CJ.Action);Lc.AsyncAction=MJ;var aF={},_f={};Object.defineProperty(_f,"__esModule",{value:!0});_f.TestTools=_f.Immediate=void 0;var LJ=1,sb,fv={};function kC(e){return e in fv?(delete fv[e],!0):!1}_f.Immediate={setImmediate:function(e){var r=LJ++;return fv[r]=!0,sb||(sb=Promise.resolve()),sb.then(function(){return kC(r)&&e()}),r},clearImmediate:function(e){kC(e)}};_f.TestTools={pending:function(){return Object.keys(fv).length}};(function(e){var r=we&&we.__read||function(p,u){var _=typeof Symbol=="function"&&p[Symbol.iterator];if(!_)return p;var m=_.call(p),S,P=[],O;try{for(;(u===void 0||u-- >0)&&!(S=m.next()).done;)P.push(S.value)}catch(M){O={error:M}}finally{try{S&&!S.done&&(_=m.return)&&_.call(m)}finally{if(O)throw O.error}}return P},t=we&&we.__spreadArray||function(p,u){for(var _=0,m=u.length,S=p.length;_<m;_++,S++)p[S]=u[_];return p};Object.defineProperty(e,"__esModule",{value:!0}),e.immediateProvider=void 0;var n=_f,i=n.Immediate.setImmediate,l=n.Immediate.clearImmediate;e.immediateProvider={setImmediate:function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];var _=e.immediateProvider.delegate;return((_==null?void 0:_.setImmediate)||i).apply(void 0,t([],r(p)))},clearImmediate:function(p){var u=e.immediateProvider.delegate;return((u==null?void 0:u.clearImmediate)||l)(p)},delegate:void 0}})(aF);var RJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(ay,"__esModule",{value:!0});ay.AsapAction=void 0;var DJ=Lc,BC=aF,NJ=function(e){RJ(r,e);function r(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i}return r.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),i!==null&&i>0?e.prototype.requestAsyncId.call(this,t,n,i):(t.actions.push(this),t._scheduled||(t._scheduled=BC.immediateProvider.setImmediate(t.flush.bind(t,void 0))))},r.prototype.recycleAsyncId=function(t,n,i){var l;if(i===void 0&&(i=0),i!=null?i>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,i);var p=t.actions;n!=null&&((l=p[p.length-1])===null||l===void 0?void 0:l.id)!==n&&(BC.immediateProvider.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},r}(DJ.AsyncAction);ay.AsapAction=NJ;var uy={},Rc={},Ud={};Object.defineProperty(Ud,"__esModule",{value:!0});Ud.Scheduler=void 0;var FJ=oy,kJ=function(){function e(r,t){t===void 0&&(t=e.now),this.schedulerActionCtor=r,this.now=t}return e.prototype.schedule=function(r,t,n){return t===void 0&&(t=0),new this.schedulerActionCtor(this,r).schedule(n,t)},e.now=FJ.dateTimestampProvider.now,e}();Ud.Scheduler=kJ;var BJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(Rc,"__esModule",{value:!0});Rc.AsyncScheduler=void 0;var zC=Ud,zJ=function(e){BJ(r,e);function r(t,n){n===void 0&&(n=zC.Scheduler.now);var i=e.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return r.prototype.flush=function(t){var n=this.actions;if(this._active){n.push(t);return}var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}},r}(zC.Scheduler);Rc.AsyncScheduler=zJ;var jJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(uy,"__esModule",{value:!0});uy.AsapScheduler=void 0;var UJ=Rc,$J=function(e){jJ(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.flush=function(t){this._active=!0;var n=this._scheduled;this._scheduled=void 0;var i=this.actions,l;t=t||i.shift();do if(l=t.execute(t.state,t.delay))break;while((t=i[0])&&t.id===n&&i.shift());if(this._active=!1,l){for(;(t=i[0])&&t.id===n&&i.shift();)t.unsubscribe();throw l}},r}(UJ.AsyncScheduler);uy.AsapScheduler=$J;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.asap=e.asapScheduler=void 0;var r=ay,t=uy;e.asapScheduler=new t.AsapScheduler(r.AsapAction),e.asap=e.asapScheduler})(iF);var Ys={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.async=e.asyncScheduler=void 0;var r=Lc,t=Rc;e.asyncScheduler=new t.AsyncScheduler(r.AsyncAction),e.async=e.asyncScheduler})(Ys);var sF={},ly={},GJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(ly,"__esModule",{value:!0});ly.QueueAction=void 0;var qJ=Lc,VJ=function(e){GJ(r,e);function r(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i}return r.prototype.schedule=function(t,n){return n===void 0&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},r.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},r.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),i!=null&&i>0||i==null&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,i):(t.flush(this),0)},r}(qJ.AsyncAction);ly.QueueAction=VJ;var cy={},XJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(cy,"__esModule",{value:!0});cy.QueueScheduler=void 0;var YJ=Rc,WJ=function(e){XJ(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r}(YJ.AsyncScheduler);cy.QueueScheduler=WJ;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.queue=e.queueScheduler=void 0;var r=ly,t=cy;e.queueScheduler=new t.QueueScheduler(r.QueueAction),e.queue=e.queueScheduler})(sF);var uF={},hy={},ZJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(hy,"__esModule",{value:!0});hy.AnimationFrameAction=void 0;var HJ=Lc,jC=kS,JJ=function(e){ZJ(r,e);function r(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i}return r.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),i!==null&&i>0?e.prototype.requestAsyncId.call(this,t,n,i):(t.actions.push(this),t._scheduled||(t._scheduled=jC.animationFrameProvider.requestAnimationFrame(function(){return t.flush(void 0)})))},r.prototype.recycleAsyncId=function(t,n,i){var l;if(i===void 0&&(i=0),i!=null?i>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,i);var p=t.actions;n!=null&&((l=p[p.length-1])===null||l===void 0?void 0:l.id)!==n&&(jC.animationFrameProvider.cancelAnimationFrame(n),t._scheduled=void 0)},r}(HJ.AsyncAction);hy.AnimationFrameAction=JJ;var fy={},KJ=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(fy,"__esModule",{value:!0});fy.AnimationFrameScheduler=void 0;var QJ=Rc,eK=function(e){KJ(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.flush=function(t){this._active=!0;var n=this._scheduled;this._scheduled=void 0;var i=this.actions,l;t=t||i.shift();do if(l=t.execute(t.state,t.delay))break;while((t=i[0])&&t.id===n&&i.shift());if(this._active=!1,l){for(;(t=i[0])&&t.id===n&&i.shift();)t.unsubscribe();throw l}},r}(QJ.AsyncScheduler);fy.AnimationFrameScheduler=eK;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.animationFrame=e.animationFrameScheduler=void 0;var r=hy,t=fy;e.animationFrameScheduler=new t.AnimationFrameScheduler(r.AnimationFrameAction),e.animationFrame=e.animationFrameScheduler})(uF);var bf={},lF=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(bf,"__esModule",{value:!0});bf.VirtualAction=bf.VirtualTimeScheduler=void 0;var tK=Lc,rK=aa,nK=Rc,iK=function(e){lF(r,e);function r(t,n){t===void 0&&(t=cF),n===void 0&&(n=1/0);var i=e.call(this,t,function(){return i.frame})||this;return i.maxFrames=n,i.frame=0,i.index=-1,i}return r.prototype.flush=function(){for(var t=this,n=t.actions,i=t.maxFrames,l,p;(p=n[0])&&p.delay<=i&&(n.shift(),this.frame=p.delay,!(l=p.execute(p.state,p.delay))););if(l){for(;p=n.shift();)p.unsubscribe();throw l}},r.frameTimeFactor=10,r}(nK.AsyncScheduler);bf.VirtualTimeScheduler=iK;var cF=function(e){lF(r,e);function r(t,n,i){i===void 0&&(i=t.index+=1);var l=e.call(this,t,n)||this;return l.scheduler=t,l.work=n,l.index=i,l.active=!0,l.index=t.index=i,l}return r.prototype.schedule=function(t,n){if(n===void 0&&(n=0),Number.isFinite(n)){if(!this.id)return e.prototype.schedule.call(this,t,n);this.active=!1;var i=new r(this.scheduler,this.work);return this.add(i),i.schedule(t,n)}else return rK.Subscription.EMPTY},r.prototype.requestAsyncId=function(t,n,i){i===void 0&&(i=0),this.delay=t.frame+i;var l=t.actions;return l.push(this),l.sort(r.sortActions),1},r.prototype.recycleAsyncId=function(t,n,i){},r.prototype._execute=function(t,n){if(this.active===!0)return e.prototype._execute.call(this,t,n)},r.sortActions=function(t,n){return t.delay===n.delay?t.index===n.index?0:t.index>n.index?1:-1:t.delay>n.delay?1:-1},r}(tK.AsyncAction);bf.VirtualAction=cF;var py={},Yu={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.empty=e.EMPTY=void 0;var r=mi;e.EMPTY=new r.Observable(function(i){return i.complete()});function t(i){return i?n(i):e.EMPTY}e.empty=t;function n(i){return new r.Observable(function(l){return i.schedule(function(){return l.complete()})})}})(Yu);var zf={},qo={},_h={};Object.defineProperty(_h,"__esModule",{value:!0});_h.isScheduler=void 0;var oK=ui;function aK(e){return e&&oK.isFunction(e.schedule)}_h.isScheduler=aK;Object.defineProperty(qo,"__esModule",{value:!0});qo.popNumber=qo.popScheduler=qo.popResultSelector=void 0;var sK=ui,uK=_h;function BS(e){return e[e.length-1]}function lK(e){return sK.isFunction(BS(e))?e.pop():void 0}qo.popResultSelector=lK;function cK(e){return uK.isScheduler(BS(e))?e.pop():void 0}qo.popScheduler=cK;function hK(e,r){return typeof BS(e)=="number"?e.pop():r}qo.popNumber=hK;var Hu={},$d={},dy={},Tr={},jf={};Object.defineProperty(jf,"__esModule",{value:!0});jf.isArrayLike=void 0;jf.isArrayLike=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};var Gd={};Object.defineProperty(Gd,"__esModule",{value:!0});Gd.isPromise=void 0;var fK=ui;function pK(e){return fK.isFunction(e==null?void 0:e.then)}Gd.isPromise=pK;var qd={};Object.defineProperty(qd,"__esModule",{value:!0});qd.isInteropObservable=void 0;var dK=vh,gK=ui;function mK(e){return gK.isFunction(e[dK.observable])}qd.isInteropObservable=mK;var Vd={};Object.defineProperty(Vd,"__esModule",{value:!0});Vd.isAsyncIterable=void 0;var vK=ui;function yK(e){return Symbol.asyncIterator&&vK.isFunction(e==null?void 0:e[Symbol.asyncIterator])}Vd.isAsyncIterable=yK;var Xd={};Object.defineProperty(Xd,"__esModule",{value:!0});Xd.createInvalidObservableTypeError=void 0;function _K(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}Xd.createInvalidObservableTypeError=_K;var Yd={},ah={};Object.defineProperty(ah,"__esModule",{value:!0});ah.iterator=ah.getSymbolIterator=void 0;function hF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}ah.getSymbolIterator=hF;ah.iterator=hF();Object.defineProperty(Yd,"__esModule",{value:!0});Yd.isIterable=void 0;var bK=ah,xK=ui;function wK(e){return xK.isFunction(e==null?void 0:e[bK.iterator])}Yd.isIterable=wK;var Ec={},EK=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},pf=we&&we.__await||function(e){return this instanceof pf?(this.v=e,this):new pf(e)},SK=we&&we.__asyncGenerator||function(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(e,r||[]),i,l=[];return i={},p("next"),p("throw"),p("return"),i[Symbol.asyncIterator]=function(){return this},i;function p(O){n[O]&&(i[O]=function(M){return new Promise(function(B,$){l.push([O,M,B,$])>1||u(O,M)})})}function u(O,M){try{_(n[O](M))}catch(B){P(l[0][3],B)}}function _(O){O.value instanceof pf?Promise.resolve(O.value.v).then(m,S):P(l[0][2],O)}function m(O){u("next",O)}function S(O){u("throw",O)}function P(O,M){O(M),l.shift(),l.length&&u(l[0][0],l[0][1])}};Object.defineProperty(Ec,"__esModule",{value:!0});Ec.isReadableStreamLike=Ec.readableStreamLikeToAsyncGenerator=void 0;var PK=ui;function AK(e){return SK(this,arguments,function(){var t,n,i,l;return EK(this,function(p){switch(p.label){case 0:t=e.getReader(),p.label=1;case 1:p.trys.push([1,,9,10]),p.label=2;case 2:return[4,pf(t.read())];case 3:return n=p.sent(),i=n.value,l=n.done,l?[4,pf(void 0)]:[3,5];case 4:return[2,p.sent()];case 5:return[4,pf(i)];case 6:return[4,p.sent()];case 7:return p.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}Ec.readableStreamLikeToAsyncGenerator=AK;function IK(e){return PK.isFunction(e==null?void 0:e.getReader)}Ec.isReadableStreamLike=IK;var OK=we&&we.__awaiter||function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(p){p(l)})}return new(t||(t=Promise))(function(l,p){function u(S){try{m(n.next(S))}catch(P){p(P)}}function _(S){try{m(n.throw(S))}catch(P){p(P)}}function m(S){S.done?l(S.value):i(S.value).then(u,_)}m((n=n.apply(e,r||[])).next())})},CK=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},TK=we&&we.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e[Symbol.asyncIterator],t;return r?r.call(e):(e=typeof Ex=="function"?Ex(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(l){t[l]=e[l]&&function(p){return new Promise(function(u,_){p=e[l](p),i(u,_,p.done,p.value)})}}function i(l,p,u,_){Promise.resolve(_).then(function(m){l({value:m,done:u})},p)}},Ex=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.fromReadableStreamLike=Tr.fromAsyncIterable=Tr.fromIterable=Tr.fromPromise=Tr.fromArrayLike=Tr.fromInteropObservable=Tr.innerFrom=void 0;var MK=jf,LK=Gd,Uf=mi,RK=qd,DK=Vd,NK=Xd,FK=Yd,fF=Ec,kK=ui,BK=kd,zK=vh;function jK(e){if(e instanceof Uf.Observable)return e;if(e!=null){if(RK.isInteropObservable(e))return pF(e);if(MK.isArrayLike(e))return dF(e);if(LK.isPromise(e))return gF(e);if(DK.isAsyncIterable(e))return zS(e);if(FK.isIterable(e))return mF(e);if(fF.isReadableStreamLike(e))return vF(e)}throw NK.createInvalidObservableTypeError(e)}Tr.innerFrom=jK;function pF(e){return new Uf.Observable(function(r){var t=e[zK.observable]();if(kK.isFunction(t.subscribe))return t.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}Tr.fromInteropObservable=pF;function dF(e){return new Uf.Observable(function(r){for(var t=0;t<e.length&&!r.closed;t++)r.next(e[t]);r.complete()})}Tr.fromArrayLike=dF;function gF(e){return new Uf.Observable(function(r){e.then(function(t){r.closed||(r.next(t),r.complete())},function(t){return r.error(t)}).then(null,BK.reportUnhandledError)})}Tr.fromPromise=gF;function mF(e){return new Uf.Observable(function(r){var t,n;try{for(var i=Ex(e),l=i.next();!l.done;l=i.next()){var p=l.value;if(r.next(p),r.closed)return}}catch(u){t={error:u}}finally{try{l&&!l.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}r.complete()})}Tr.fromIterable=mF;function zS(e){return new Uf.Observable(function(r){UK(e,r).catch(function(t){return r.error(t)})})}Tr.fromAsyncIterable=zS;function vF(e){return zS(fF.readableStreamLikeToAsyncGenerator(e))}Tr.fromReadableStreamLike=vF;function UK(e,r){var t,n,i,l;return OK(this,void 0,void 0,function(){var p,u;return CK(this,function(_){switch(_.label){case 0:_.trys.push([0,5,6,11]),t=TK(e),_.label=1;case 1:return[4,t.next()];case 2:if(n=_.sent(),!!n.done)return[3,4];if(p=n.value,r.next(p),r.closed)return[2];_.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=_.sent(),i={error:u},[3,11];case 6:return _.trys.push([6,,9,10]),n&&!n.done&&(l=t.return)?[4,l.call(t)]:[3,8];case 7:_.sent(),_.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})}var bh={},Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.executeSchedule=void 0;function $K(e,r,t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var l=r.schedule(function(){t(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(l),!i)return l}Ju.executeSchedule=$K;Object.defineProperty(bh,"__esModule",{value:!0});bh.observeOn=void 0;var ub=Ju,GK=Qt,qK=mr;function VK(e,r){return r===void 0&&(r=0),GK.operate(function(t,n){t.subscribe(qK.createOperatorSubscriber(n,function(i){return ub.executeSchedule(n,e,function(){return n.next(i)},r)},function(){return ub.executeSchedule(n,e,function(){return n.complete()},r)},function(i){return ub.executeSchedule(n,e,function(){return n.error(i)},r)}))})}bh.observeOn=VK;var xh={};Object.defineProperty(xh,"__esModule",{value:!0});xh.subscribeOn=void 0;var XK=Qt;function YK(e,r){return r===void 0&&(r=0),XK.operate(function(t,n){n.add(e.schedule(function(){return t.subscribe(n)},r))})}xh.subscribeOn=YK;Object.defineProperty(dy,"__esModule",{value:!0});dy.scheduleObservable=void 0;var WK=Tr,ZK=bh,HK=xh;function JK(e,r){return WK.innerFrom(e).pipe(HK.subscribeOn(r),ZK.observeOn(r))}dy.scheduleObservable=JK;var gy={};Object.defineProperty(gy,"__esModule",{value:!0});gy.schedulePromise=void 0;var KK=Tr,QK=bh,eQ=xh;function tQ(e,r){return KK.innerFrom(e).pipe(eQ.subscribeOn(r),QK.observeOn(r))}gy.schedulePromise=tQ;var my={};Object.defineProperty(my,"__esModule",{value:!0});my.scheduleArray=void 0;var rQ=mi;function nQ(e,r){return new rQ.Observable(function(t){var n=0;return r.schedule(function(){n===e.length?t.complete():(t.next(e[n++]),t.closed||this.schedule())})})}my.scheduleArray=nQ;var Wd={};Object.defineProperty(Wd,"__esModule",{value:!0});Wd.scheduleIterable=void 0;var iQ=mi,oQ=ah,aQ=ui,UC=Ju;function sQ(e,r){return new iQ.Observable(function(t){var n;return UC.executeSchedule(t,r,function(){n=e[oQ.iterator](),UC.executeSchedule(t,r,function(){var i,l,p;try{i=n.next(),l=i.value,p=i.done}catch(u){t.error(u);return}p?t.complete():t.next(l)},0,!0)}),function(){return aQ.isFunction(n==null?void 0:n.return)&&n.return()}})}Wd.scheduleIterable=sQ;var Zd={};Object.defineProperty(Zd,"__esModule",{value:!0});Zd.scheduleAsyncIterable=void 0;var uQ=mi,$C=Ju;function lQ(e,r){if(!e)throw new Error("Iterable cannot be null");return new uQ.Observable(function(t){$C.executeSchedule(t,r,function(){var n=e[Symbol.asyncIterator]();$C.executeSchedule(t,r,function(){n.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}Zd.scheduleAsyncIterable=lQ;var vy={};Object.defineProperty(vy,"__esModule",{value:!0});vy.scheduleReadableStreamLike=void 0;var cQ=Zd,hQ=Ec;function fQ(e,r){return cQ.scheduleAsyncIterable(hQ.readableStreamLikeToAsyncGenerator(e),r)}vy.scheduleReadableStreamLike=fQ;Object.defineProperty($d,"__esModule",{value:!0});$d.scheduled=void 0;var pQ=dy,dQ=gy,gQ=my,mQ=Wd,vQ=Zd,yQ=qd,_Q=Gd,bQ=jf,xQ=Yd,wQ=Vd,EQ=Xd,SQ=Ec,PQ=vy;function AQ(e,r){if(e!=null){if(yQ.isInteropObservable(e))return pQ.scheduleObservable(e,r);if(bQ.isArrayLike(e))return gQ.scheduleArray(e,r);if(_Q.isPromise(e))return dQ.schedulePromise(e,r);if(wQ.isAsyncIterable(e))return vQ.scheduleAsyncIterable(e,r);if(xQ.isIterable(e))return mQ.scheduleIterable(e,r);if(SQ.isReadableStreamLike(e))return PQ.scheduleReadableStreamLike(e,r)}throw EQ.createInvalidObservableTypeError(e)}$d.scheduled=AQ;Object.defineProperty(Hu,"__esModule",{value:!0});Hu.from=void 0;var IQ=$d,OQ=Tr;function CQ(e,r){return r?IQ.scheduled(e,r):OQ.innerFrom(e)}Hu.from=CQ;Object.defineProperty(zf,"__esModule",{value:!0});zf.of=void 0;var TQ=qo,MQ=Hu;function LQ(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=TQ.popScheduler(e);return MQ.from(e,t)}zf.of=LQ;var Hd={};Object.defineProperty(Hd,"__esModule",{value:!0});Hd.throwError=void 0;var RQ=mi,DQ=ui;function NQ(e,r){var t=DQ.isFunction(e)?e:function(){return e},n=function(i){return i.error(t())};return new RQ.Observable(r?function(i){return r.schedule(n,0,i)}:n)}Hd.throwError=NQ;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.observeNotification=e.Notification=e.NotificationKind=void 0;var r=Yu,t=zf,n=Hd,i=ui;(function(u){u.NEXT="N",u.ERROR="E",u.COMPLETE="C"})(e.NotificationKind||(e.NotificationKind={}));var l=function(){function u(_,m,S){this.kind=_,this.value=m,this.error=S,this.hasValue=_==="N"}return u.prototype.observe=function(_){return p(this,_)},u.prototype.do=function(_,m,S){var P=this,O=P.kind,M=P.value,B=P.error;return O==="N"?_==null?void 0:_(M):O==="E"?m==null?void 0:m(B):S==null?void 0:S()},u.prototype.accept=function(_,m,S){var P;return i.isFunction((P=_)===null||P===void 0?void 0:P.next)?this.observe(_):this.do(_,m,S)},u.prototype.toObservable=function(){var _=this,m=_.kind,S=_.value,P=_.error,O=m==="N"?t.of(S):m==="E"?n.throwError(function(){return P}):m==="C"?r.EMPTY:0;if(!O)throw new TypeError("Unexpected notification kind "+m);return O},u.createNext=function(_){return new u("N",_)},u.createError=function(_){return new u("E",void 0,_)},u.createComplete=function(){return u.completeNotification},u.completeNotification=new u("C"),u}();e.Notification=l;function p(u,_){var m,S,P,O=u,M=O.kind,B=O.value,$=O.error;if(typeof M!="string")throw new TypeError('Invalid notification, missing "kind"');M==="N"?(m=_.next)===null||m===void 0||m.call(_,B):M==="E"?(S=_.error)===null||S===void 0||S.call(_,$):(P=_.complete)===null||P===void 0||P.call(_)}e.observeNotification=p})(py);var yy={};Object.defineProperty(yy,"__esModule",{value:!0});yy.isObservable=void 0;var FQ=mi,GC=ui;function kQ(e){return!!e&&(e instanceof FQ.Observable||GC.isFunction(e.lift)&&GC.isFunction(e.subscribe))}yy.isObservable=kQ;var _y={},El={};Object.defineProperty(El,"__esModule",{value:!0});El.EmptyError=void 0;var BQ=wl;El.EmptyError=BQ.createErrorClass(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});Object.defineProperty(_y,"__esModule",{value:!0});_y.lastValueFrom=void 0;var zQ=El;function jQ(e,r){var t=typeof r=="object";return new Promise(function(n,i){var l=!1,p;e.subscribe({next:function(u){p=u,l=!0},error:i,complete:function(){l?n(p):t?n(r.defaultValue):i(new zQ.EmptyError)}})})}_y.lastValueFrom=jQ;var by={};Object.defineProperty(by,"__esModule",{value:!0});by.firstValueFrom=void 0;var UQ=El,$Q=Ff;function GQ(e,r){var t=typeof r=="object";return new Promise(function(n,i){var l=new $Q.SafeSubscriber({next:function(p){n(p),l.unsubscribe()},error:i,complete:function(){t?n(r.defaultValue):i(new UQ.EmptyError)}});e.subscribe(l)})}by.firstValueFrom=GQ;var Jd={};Object.defineProperty(Jd,"__esModule",{value:!0});Jd.ArgumentOutOfRangeError=void 0;var qQ=wl;Jd.ArgumentOutOfRangeError=qQ.createErrorClass(function(e){return function(){e(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}});var Kd={};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.NotFoundError=void 0;var VQ=wl;Kd.NotFoundError=VQ.createErrorClass(function(e){return function(t){e(this),this.name="NotFoundError",this.message=t}});var Qd={};Object.defineProperty(Qd,"__esModule",{value:!0});Qd.SequenceError=void 0;var XQ=wl;Qd.SequenceError=XQ.createErrorClass(function(e){return function(t){e(this),this.name="SequenceError",this.message=t}});var pv={},$f={};Object.defineProperty($f,"__esModule",{value:!0});$f.isValidDate=void 0;function YQ(e){return e instanceof Date&&!isNaN(e)}$f.isValidDate=YQ;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.timeout=e.TimeoutError=void 0;var r=Ys,t=$f,n=Qt,i=Tr,l=wl,p=mr,u=Ju;e.TimeoutError=l.createErrorClass(function(S){return function(O){O===void 0&&(O=null),S(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=O}});function _(S,P){var O=t.isValidDate(S)?{first:S}:typeof S=="number"?{each:S}:S,M=O.first,B=O.each,$=O.with,q=$===void 0?m:$,X=O.scheduler,R=X===void 0?P??r.asyncScheduler:X,k=O.meta,U=k===void 0?null:k;if(M==null&&B==null)throw new TypeError("No timeout provided.");return n.operate(function(H,ue){var ie,ee,W=null,J=0,be=function(Oe){ee=u.executeSchedule(ue,R,function(){try{ie.unsubscribe(),i.innerFrom(q({meta:U,lastValue:W,seen:J})).subscribe(ue)}catch(Ae){ue.error(Ae)}},Oe)};ie=H.subscribe(p.createOperatorSubscriber(ue,function(Oe){ee==null||ee.unsubscribe(),J++,ue.next(W=Oe),B>0&&be(B)},void 0,void 0,function(){ee!=null&&ee.closed||ee==null||ee.unsubscribe(),W=null})),!J&&be(M!=null?typeof M=="number"?M:+M-R.now():B)})}e.timeout=_;function m(S){throw new e.TimeoutError(S)}})(pv);var xy={},eg={},Sl={},Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.map=void 0;var WQ=Qt,ZQ=mr;function HQ(e,r){return WQ.operate(function(t,n){var i=0;t.subscribe(ZQ.createOperatorSubscriber(n,function(l){n.next(e.call(r,l,i++))}))})}Pl.map=HQ;var JQ=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},KQ=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(Sl,"__esModule",{value:!0});Sl.mapOneOrManyArgs=void 0;var QQ=Pl,eee=Array.isArray;function tee(e,r){return eee(r)?e.apply(void 0,KQ([],JQ(r))):e(r)}function ree(e){return QQ.map(function(r){return tee(e,r)})}Sl.mapOneOrManyArgs=ree;var nee=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},qC=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(eg,"__esModule",{value:!0});eg.bindCallbackInternals=void 0;var iee=_h,oee=mi,aee=xh,see=Sl,uee=bh,lee=Bf;function Sx(e,r,t,n){if(t)if(iee.isScheduler(t))n=t;else return function(){for(var i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];return Sx(e,r,n).apply(this,i).pipe(see.mapOneOrManyArgs(t))};return n?function(){for(var i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];return Sx(e,r).apply(this,i).pipe(aee.subscribeOn(n),uee.observeOn(n))}:function(){for(var i=this,l=[],p=0;p<arguments.length;p++)l[p]=arguments[p];var u=new lee.AsyncSubject,_=!0;return new oee.Observable(function(m){var S=u.subscribe(m);if(_){_=!1;var P=!1,O=!1;r.apply(i,qC(qC([],nee(l)),[function(){for(var M=[],B=0;B<arguments.length;B++)M[B]=arguments[B];if(e){var $=M.shift();if($!=null){u.error($);return}}u.next(1<M.length?M:M[0]),O=!0,P&&u.complete()}])),O&&u.complete(),P=!0}return S})}}eg.bindCallbackInternals=Sx;Object.defineProperty(xy,"__esModule",{value:!0});xy.bindCallback=void 0;var cee=eg;function hee(e,r,t){return cee.bindCallbackInternals(!1,e,r,t)}xy.bindCallback=hee;var wy={};Object.defineProperty(wy,"__esModule",{value:!0});wy.bindNodeCallback=void 0;var fee=eg;function pee(e,r,t){return fee.bindCallbackInternals(!0,e,r,t)}wy.bindNodeCallback=pee;var Sc={},tg={};Object.defineProperty(tg,"__esModule",{value:!0});tg.argsArgArrayOrObject=void 0;var dee=Array.isArray,gee=Object.getPrototypeOf,mee=Object.prototype,vee=Object.keys;function yee(e){if(e.length===1){var r=e[0];if(dee(r))return{args:r,keys:null};if(_ee(r)){var t=vee(r);return{args:t.map(function(n){return r[n]}),keys:t}}}return{args:e,keys:null}}tg.argsArgArrayOrObject=yee;function _ee(e){return e&&typeof e=="object"&&gee(e)===mee}var rg={};Object.defineProperty(rg,"__esModule",{value:!0});rg.createObject=void 0;function bee(e,r){return e.reduce(function(t,n,i){return t[n]=r[i],t},{})}rg.createObject=bee;Object.defineProperty(Sc,"__esModule",{value:!0});Sc.combineLatestInit=Sc.combineLatest=void 0;var xee=mi,wee=tg,yF=Hu,_F=ca,Eee=Sl,VC=qo,See=rg,Pee=mr,Aee=Ju;function Iee(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=VC.popScheduler(e),n=VC.popResultSelector(e),i=wee.argsArgArrayOrObject(e),l=i.args,p=i.keys;if(l.length===0)return yF.from([],t);var u=new xee.Observable(bF(l,t,p?function(_){return See.createObject(p,_)}:_F.identity));return n?u.pipe(Eee.mapOneOrManyArgs(n)):u}Sc.combineLatest=Iee;function bF(e,r,t){return t===void 0&&(t=_F.identity),function(n){XC(r,function(){for(var i=e.length,l=new Array(i),p=i,u=i,_=function(S){XC(r,function(){var P=yF.from(e[S],r),O=!1;P.subscribe(Pee.createOperatorSubscriber(n,function(M){l[S]=M,O||(O=!0,u--),u||n.next(t(l.slice()))},function(){--p||n.complete()}))},n)},m=0;m<i;m++)_(m)},n)}}Sc.combineLatestInit=bF;function XC(e,r,t){e?Aee.executeSchedule(t,e,r):r()}var wh={},Gf={},Eh={},Ku={},qf={};Object.defineProperty(qf,"__esModule",{value:!0});qf.mergeInternals=void 0;var Oee=Tr,Cee=Ju,YC=mr;function Tee(e,r,t,n,i,l,p,u){var _=[],m=0,S=0,P=!1,O=function(){P&&!_.length&&!m&&r.complete()},M=function($){return m<n?B($):_.push($)},B=function($){l&&r.next($),m++;var q=!1;Oee.innerFrom(t($,S++)).subscribe(YC.createOperatorSubscriber(r,function(X){i==null||i(X),l?M(X):r.next(X)},function(){q=!0},void 0,function(){if(q)try{m--;for(var X=function(){var R=_.shift();p?Cee.executeSchedule(r,p,function(){return B(R)}):B(R)};_.length&&m<n;)X();O()}catch(R){r.error(R)}}))};return e.subscribe(YC.createOperatorSubscriber(r,M,function(){P=!0,O()})),function(){u==null||u()}}qf.mergeInternals=Tee;Object.defineProperty(Ku,"__esModule",{value:!0});Ku.mergeMap=void 0;var Mee=Pl,Lee=Tr,Ree=Qt,Dee=qf,Nee=ui;function xF(e,r,t){return t===void 0&&(t=1/0),Nee.isFunction(r)?xF(function(n,i){return Mee.map(function(l,p){return r(n,l,i,p)})(Lee.innerFrom(e(n,i)))},t):(typeof r=="number"&&(t=r),Ree.operate(function(n,i){return Dee.mergeInternals(n,i,e,t)}))}Ku.mergeMap=xF;Object.defineProperty(Eh,"__esModule",{value:!0});Eh.mergeAll=void 0;var Fee=Ku,kee=ca;function Bee(e){return e===void 0&&(e=1/0),Fee.mergeMap(kee.identity,e)}Eh.mergeAll=Bee;Object.defineProperty(Gf,"__esModule",{value:!0});Gf.concatAll=void 0;var zee=Eh;function jee(){return zee.mergeAll(1)}Gf.concatAll=jee;Object.defineProperty(wh,"__esModule",{value:!0});wh.concat=void 0;var Uee=Gf,$ee=qo,Gee=Hu;function qee(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Uee.concatAll()(Gee.from(e,$ee.popScheduler(e)))}wh.concat=qee;var Ey={},Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});Sh.defer=void 0;var Vee=mi,Xee=Tr;function Yee(e){return new Vee.Observable(function(r){Xee.innerFrom(e()).subscribe(r)})}Sh.defer=Yee;Object.defineProperty(Ey,"__esModule",{value:!0});Ey.connectable=void 0;var Wee=ko,Zee=mi,Hee=Sh,Jee={connector:function(){return new Wee.Subject},resetOnDisconnect:!0};function Kee(e,r){r===void 0&&(r=Jee);var t=null,n=r.connector,i=r.resetOnDisconnect,l=i===void 0?!0:i,p=n(),u=new Zee.Observable(function(_){return p.subscribe(_)});return u.connect=function(){return(!t||t.closed)&&(t=Hee.defer(function(){return e}).subscribe(p),l&&t.add(function(){return p=n()})),t},u}Ey.connectable=Kee;var Sy={};Object.defineProperty(Sy,"__esModule",{value:!0});Sy.forkJoin=void 0;var Qee=mi,ete=tg,tte=Tr,rte=qo,nte=mr,ite=Sl,ote=rg;function ate(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=rte.popResultSelector(e),n=ete.argsArgArrayOrObject(e),i=n.args,l=n.keys,p=new Qee.Observable(function(u){var _=i.length;if(!_){u.complete();return}for(var m=new Array(_),S=_,P=_,O=function(B){var $=!1;tte.innerFrom(i[B]).subscribe(nte.createOperatorSubscriber(u,function(q){$||($=!0,P--),m[B]=q},function(){return S--},void 0,function(){(!S||!$)&&(P||u.next(l?ote.createObject(l,m):m),u.complete())}))},M=0;M<_;M++)O(M)});return t?p.pipe(ite.mapOneOrManyArgs(t)):p}Sy.forkJoin=ate;var Py={},ste=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l};Object.defineProperty(Py,"__esModule",{value:!0});Py.fromEvent=void 0;var ute=Tr,lte=mi,cte=Ku,hte=jf,sh=ui,fte=Sl,pte=["addListener","removeListener"],dte=["addEventListener","removeEventListener"],gte=["on","off"];function Px(e,r,t,n){if(sh.isFunction(t)&&(n=t,t=void 0),n)return Px(e,r,t).pipe(fte.mapOneOrManyArgs(n));var i=ste(yte(e)?dte.map(function(u){return function(_){return e[u](r,_,t)}}):mte(e)?pte.map(WC(e,r)):vte(e)?gte.map(WC(e,r)):[],2),l=i[0],p=i[1];if(!l&&hte.isArrayLike(e))return cte.mergeMap(function(u){return Px(u,r,t)})(ute.innerFrom(e));if(!l)throw new TypeError("Invalid event target");return new lte.Observable(function(u){var _=function(){for(var m=[],S=0;S<arguments.length;S++)m[S]=arguments[S];return u.next(1<m.length?m:m[0])};return l(_),function(){return p(_)}})}Py.fromEvent=Px;function WC(e,r){return function(t){return function(n){return e[t](r,n)}}}function mte(e){return sh.isFunction(e.addListener)&&sh.isFunction(e.removeListener)}function vte(e){return sh.isFunction(e.on)&&sh.isFunction(e.off)}function yte(e){return sh.isFunction(e.addEventListener)&&sh.isFunction(e.removeEventListener)}var Ay={};Object.defineProperty(Ay,"__esModule",{value:!0});Ay.fromEventPattern=void 0;var _te=mi,bte=ui,xte=Sl;function wF(e,r,t){return t?wF(e,r).pipe(xte.mapOneOrManyArgs(t)):new _te.Observable(function(n){var i=function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];return n.next(p.length===1?p[0]:p)},l=e(i);return bte.isFunction(r)?function(){return r(i,l)}:void 0})}Ay.fromEventPattern=wF;var Iy={},wte=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(Iy,"__esModule",{value:!0});Iy.generate=void 0;var ZC=ca,Ete=_h,Ste=Sh,Pte=Wd;function Ate(e,r,t,n,i){var l,p,u,_;arguments.length===1?(l=e,_=l.initialState,r=l.condition,t=l.iterate,p=l.resultSelector,u=p===void 0?ZC.identity:p,i=l.scheduler):(_=e,!n||Ete.isScheduler(n)?(u=ZC.identity,i=n):u=n);function m(){var S;return wte(this,function(P){switch(P.label){case 0:S=_,P.label=1;case 1:return!r||r(S)?[4,u(S)]:[3,4];case 2:P.sent(),P.label=3;case 3:return S=t(S),[3,1];case 4:return[2]}})}return Ste.defer(i?function(){return Pte.scheduleIterable(m(),i)}:m)}Iy.generate=Ate;var Oy={};Object.defineProperty(Oy,"__esModule",{value:!0});Oy.iif=void 0;var Ite=Sh;function Ote(e,r,t){return Ite.defer(function(){return e()?r:t})}Oy.iif=Ote;var ng={},Al={};Object.defineProperty(Al,"__esModule",{value:!0});Al.timer=void 0;var Cte=mi,Tte=Ys,Mte=_h,Lte=$f;function Rte(e,r,t){e===void 0&&(e=0),t===void 0&&(t=Tte.async);var n=-1;return r!=null&&(Mte.isScheduler(r)?t=r:n=r),new Cte.Observable(function(i){var l=Lte.isValidDate(e)?+e-t.now():e;l<0&&(l=0);var p=0;return t.schedule(function(){i.closed||(i.next(p++),0<=n?this.schedule(void 0,n):i.complete())},l)})}Al.timer=Rte;Object.defineProperty(ng,"__esModule",{value:!0});ng.interval=void 0;var Dte=Ys,Nte=Al;function Fte(e,r){return e===void 0&&(e=0),r===void 0&&(r=Dte.asyncScheduler),e<0&&(e=0),Nte.timer(e,e,r)}ng.interval=Fte;var Cy={};Object.defineProperty(Cy,"__esModule",{value:!0});Cy.merge=void 0;var kte=Eh,Bte=Tr,zte=Yu,HC=qo,jte=Hu;function Ute(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=HC.popScheduler(e),n=HC.popNumber(e,1/0),i=e;return i.length?i.length===1?Bte.innerFrom(i[0]):kte.mergeAll(n)(jte.from(i,t)):zte.EMPTY}Cy.merge=Ute;var Ax={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.never=e.NEVER=void 0;var r=mi,t=la;e.NEVER=new r.Observable(t.noop);function n(){return e.NEVER}e.never=n})(Ax);var ig={},tc={};Object.defineProperty(tc,"__esModule",{value:!0});tc.argsOrArgArray=void 0;var $te=Array.isArray;function Gte(e){return e.length===1&&$te(e[0])?e[0]:e}tc.argsOrArgArray=Gte;Object.defineProperty(ig,"__esModule",{value:!0});ig.onErrorResumeNext=void 0;var qte=mi,Vte=tc,Xte=mr,JC=la,Yte=Tr;function Wte(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=Vte.argsOrArgArray(e);return new qte.Observable(function(n){var i=0,l=function(){if(i<t.length){var p=void 0;try{p=Yte.innerFrom(t[i++])}catch{l();return}var u=new Xte.OperatorSubscriber(n,void 0,JC.noop,JC.noop);p.subscribe(u),u.add(l)}else n.complete()};l()})}ig.onErrorResumeNext=Wte;var Ty={};Object.defineProperty(Ty,"__esModule",{value:!0});Ty.pairs=void 0;var Zte=Hu;function Hte(e,r){return Zte.from(Object.entries(e),r)}Ty.pairs=Hte;var My={},Ly={};Object.defineProperty(Ly,"__esModule",{value:!0});Ly.not=void 0;function Jte(e,r){return function(t,n){return!e.call(r,t,n)}}Ly.not=Jte;var rc={};Object.defineProperty(rc,"__esModule",{value:!0});rc.filter=void 0;var Kte=Qt,Qte=mr;function ere(e,r){return Kte.operate(function(t,n){var i=0;t.subscribe(Qte.createOperatorSubscriber(n,function(l){return e.call(r,l,i++)&&n.next(l)}))})}rc.filter=ere;Object.defineProperty(My,"__esModule",{value:!0});My.partition=void 0;var tre=Ly,KC=rc,QC=Tr;function rre(e,r,t){return[KC.filter(r,t)(QC.innerFrom(e)),KC.filter(tre.not(r,t))(QC.innerFrom(e))]}My.partition=rre;var uh={};Object.defineProperty(uh,"__esModule",{value:!0});uh.raceInit=uh.race=void 0;var nre=mi,EF=Tr,ire=tc,ore=mr;function are(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e=ire.argsOrArgArray(e),e.length===1?EF.innerFrom(e[0]):new nre.Observable(SF(e))}uh.race=are;function SF(e){return function(r){for(var t=[],n=function(l){t.push(EF.innerFrom(e[l]).subscribe(ore.createOperatorSubscriber(r,function(p){if(t){for(var u=0;u<t.length;u++)u!==l&&t[u].unsubscribe();t=null}r.next(p)})))},i=0;t&&!r.closed&&i<e.length;i++)n(i)}}uh.raceInit=SF;var Ry={};Object.defineProperty(Ry,"__esModule",{value:!0});Ry.range=void 0;var sre=mi,ure=Yu;function lre(e,r,t){if(r==null&&(r=e,e=0),r<=0)return ure.EMPTY;var n=r+e;return new sre.Observable(t?function(i){var l=e;return t.schedule(function(){l<n?(i.next(l++),this.schedule()):i.complete()})}:function(i){for(var l=e;l<n&&!i.closed;)i.next(l++);i.complete()})}Ry.range=lre;var Dy={};Object.defineProperty(Dy,"__esModule",{value:!0});Dy.using=void 0;var cre=mi,hre=Tr,fre=Yu;function pre(e,r){return new cre.Observable(function(t){var n=e(),i=r(n),l=i?hre.innerFrom(i):fre.EMPTY;return l.subscribe(t),function(){n&&n.unsubscribe()}})}Dy.using=pre;var Vf={},dre=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},gre=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(Vf,"__esModule",{value:!0});Vf.zip=void 0;var mre=mi,vre=Tr,yre=tc,_re=Yu,bre=mr,xre=qo;function wre(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=xre.popResultSelector(e),n=yre.argsOrArgArray(e);return n.length?new mre.Observable(function(i){var l=n.map(function(){return[]}),p=n.map(function(){return!1});i.add(function(){l=p=null});for(var u=function(m){vre.innerFrom(n[m]).subscribe(bre.createOperatorSubscriber(i,function(S){if(l[m].push(S),l.every(function(O){return O.length})){var P=l.map(function(O){return O.shift()});i.next(t?t.apply(void 0,gre([],dre(P))):P),l.some(function(O,M){return!O.length&&p[M]})&&i.complete()}},function(){p[m]=!0,!l[m].length&&i.complete()}))},_=0;!i.closed&&_<n.length;_++)u(_);return function(){l=p=null}}):_re.EMPTY}Vf.zip=wre;var PF={};Object.defineProperty(PF,"__esModule",{value:!0});var og={};Object.defineProperty(og,"__esModule",{value:!0});og.audit=void 0;var Ere=Qt,Sre=Tr,eT=mr;function Pre(e){return Ere.operate(function(r,t){var n=!1,i=null,l=null,p=!1,u=function(){if(l==null||l.unsubscribe(),l=null,n){n=!1;var m=i;i=null,t.next(m)}p&&t.complete()},_=function(){l=null,p&&t.complete()};r.subscribe(eT.createOperatorSubscriber(t,function(m){n=!0,i=m,l||Sre.innerFrom(e(m)).subscribe(l=eT.createOperatorSubscriber(t,u,_))},function(){p=!0,(!n||!l||l.closed)&&t.complete()}))})}og.audit=Pre;var Ny={};Object.defineProperty(Ny,"__esModule",{value:!0});Ny.auditTime=void 0;var Are=Ys,Ire=og,Ore=Al;function Cre(e,r){return r===void 0&&(r=Are.asyncScheduler),Ire.audit(function(){return Ore.timer(e,r)})}Ny.auditTime=Cre;var Fy={};Object.defineProperty(Fy,"__esModule",{value:!0});Fy.buffer=void 0;var Tre=Qt,Mre=la,tT=mr,Lre=Tr;function Rre(e){return Tre.operate(function(r,t){var n=[];return r.subscribe(tT.createOperatorSubscriber(t,function(i){return n.push(i)},function(){t.next(n),t.complete()})),Lre.innerFrom(e).subscribe(tT.createOperatorSubscriber(t,function(){var i=n;n=[],t.next(i)},Mre.noop)),function(){n=null}})}Fy.buffer=Rre;var ky={},lb=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ky,"__esModule",{value:!0});ky.bufferCount=void 0;var Dre=Qt,Nre=mr,Fre=Zu;function kre(e,r){return r===void 0&&(r=null),r=r??e,Dre.operate(function(t,n){var i=[],l=0;t.subscribe(Nre.createOperatorSubscriber(n,function(p){var u,_,m,S,P=null;l++%r===0&&i.push([]);try{for(var O=lb(i),M=O.next();!M.done;M=O.next()){var B=M.value;B.push(p),e<=B.length&&(P=P??[],P.push(B))}}catch(X){u={error:X}}finally{try{M&&!M.done&&(_=O.return)&&_.call(O)}finally{if(u)throw u.error}}if(P)try{for(var $=lb(P),q=$.next();!q.done;q=$.next()){var B=q.value;Fre.arrRemove(i,B),n.next(B)}}catch(X){m={error:X}}finally{try{q&&!q.done&&(S=$.return)&&S.call($)}finally{if(m)throw m.error}}},function(){var p,u;try{for(var _=lb(i),m=_.next();!m.done;m=_.next()){var S=m.value;n.next(S)}}catch(P){p={error:P}}finally{try{m&&!m.done&&(u=_.return)&&u.call(_)}finally{if(p)throw p.error}}n.complete()},void 0,function(){i=null}))})}ky.bufferCount=kre;var By={},Bre=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(By,"__esModule",{value:!0});By.bufferTime=void 0;var zre=aa,jre=Qt,Ure=mr,$re=Zu,Gre=Ys,qre=qo,rT=Ju;function Vre(e){for(var r,t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var l=(r=qre.popScheduler(n))!==null&&r!==void 0?r:Gre.asyncScheduler,p=(t=n[0])!==null&&t!==void 0?t:null,u=n[1]||1/0;return jre.operate(function(_,m){var S=[],P=!1,O=function($){var q=$.buffer,X=$.subs;X.unsubscribe(),$re.arrRemove(S,$),m.next(q),P&&M()},M=function(){if(S){var $=new zre.Subscription;m.add($);var q=[],X={buffer:q,subs:$};S.push(X),rT.executeSchedule($,l,function(){return O(X)},e)}};p!==null&&p>=0?rT.executeSchedule(m,l,M,p,!0):P=!0,M();var B=Ure.createOperatorSubscriber(m,function($){var q,X,R=S.slice();try{for(var k=Bre(R),U=k.next();!U.done;U=k.next()){var H=U.value,ue=H.buffer;ue.push($),u<=ue.length&&O(H)}}catch(ie){q={error:ie}}finally{try{U&&!U.done&&(X=k.return)&&X.call(k)}finally{if(q)throw q.error}}},function(){for(;S!=null&&S.length;)m.next(S.shift().buffer);B==null||B.unsubscribe(),m.complete(),m.unsubscribe()},void 0,function(){return S=null});_.subscribe(B)})}By.bufferTime=Vre;var zy={},Xre=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(zy,"__esModule",{value:!0});zy.bufferToggle=void 0;var Yre=aa,Wre=Qt,nT=Tr,cb=mr,iT=la,Zre=Zu;function Hre(e,r){return Wre.operate(function(t,n){var i=[];nT.innerFrom(e).subscribe(cb.createOperatorSubscriber(n,function(l){var p=[];i.push(p);var u=new Yre.Subscription,_=function(){Zre.arrRemove(i,p),n.next(p),u.unsubscribe()};u.add(nT.innerFrom(r(l)).subscribe(cb.createOperatorSubscriber(n,_,iT.noop)))},iT.noop)),t.subscribe(cb.createOperatorSubscriber(n,function(l){var p,u;try{for(var _=Xre(i),m=_.next();!m.done;m=_.next()){var S=m.value;S.push(l)}}catch(P){p={error:P}}finally{try{m&&!m.done&&(u=_.return)&&u.call(_)}finally{if(p)throw p.error}}},function(){for(;i.length>0;)n.next(i.shift());n.complete()}))})}zy.bufferToggle=Hre;var jy={};Object.defineProperty(jy,"__esModule",{value:!0});jy.bufferWhen=void 0;var Jre=Qt,Kre=la,oT=mr,Qre=Tr;function ene(e){return Jre.operate(function(r,t){var n=null,i=null,l=function(){i==null||i.unsubscribe();var p=n;n=[],p&&t.next(p),Qre.innerFrom(e()).subscribe(i=oT.createOperatorSubscriber(t,l,Kre.noop))};l(),r.subscribe(oT.createOperatorSubscriber(t,function(p){return n==null?void 0:n.push(p)},function(){n&&t.next(n),t.complete()},void 0,function(){return n=i=null}))})}jy.bufferWhen=ene;var Uy={};Object.defineProperty(Uy,"__esModule",{value:!0});Uy.catchError=void 0;var tne=Tr,rne=mr,nne=Qt;function AF(e){return nne.operate(function(r,t){var n=null,i=!1,l;n=r.subscribe(rne.createOperatorSubscriber(t,void 0,void 0,function(p){l=tne.innerFrom(e(p,AF(e)(r))),n?(n.unsubscribe(),n=null,l.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,l.subscribe(t))})}Uy.catchError=AF;var $y={},ag={},sg={},ug={},Dc={},lg={};Object.defineProperty(lg,"__esModule",{value:!0});lg.scanInternals=void 0;var ine=mr;function one(e,r,t,n,i){return function(l,p){var u=t,_=r,m=0;l.subscribe(ine.createOperatorSubscriber(p,function(S){var P=m++;_=u?e(_,S,P):(u=!0,S),n&&p.next(_)},i&&function(){u&&p.next(_),p.complete()}))}}lg.scanInternals=one;Object.defineProperty(Dc,"__esModule",{value:!0});Dc.reduce=void 0;var ane=lg,sne=Qt;function une(e,r){return sne.operate(ane.scanInternals(e,r,arguments.length>=2,!1,!0))}Dc.reduce=une;Object.defineProperty(ug,"__esModule",{value:!0});ug.toArray=void 0;var lne=Dc,cne=Qt,hne=function(e,r){return e.push(r),e};function fne(){return cne.operate(function(e,r){lne.reduce(hne,[])(e).subscribe(r)})}ug.toArray=fne;Object.defineProperty(sg,"__esModule",{value:!0});sg.joinAllInternals=void 0;var pne=ca,dne=Sl,gne=Hl,mne=Ku,vne=ug;function yne(e,r){return gne.pipe(vne.toArray(),mne.mergeMap(function(t){return e(t)}),r?dne.mapOneOrManyArgs(r):pne.identity)}sg.joinAllInternals=yne;Object.defineProperty(ag,"__esModule",{value:!0});ag.combineLatestAll=void 0;var _ne=Sc,bne=sg;function xne(e){return bne.joinAllInternals(_ne.combineLatest,e)}ag.combineLatestAll=xne;Object.defineProperty($y,"__esModule",{value:!0});$y.combineAll=void 0;var wne=ag;$y.combineAll=wne.combineLatestAll;var Gy={},qy={},aT=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},sT=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(qy,"__esModule",{value:!0});qy.combineLatest=void 0;var Ene=Sc,Sne=Qt,Pne=tc,Ane=Sl,Ine=Hl,One=qo;function IF(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=One.popResultSelector(e);return t?Ine.pipe(IF.apply(void 0,sT([],aT(e))),Ane.mapOneOrManyArgs(t)):Sne.operate(function(n,i){Ene.combineLatestInit(sT([n],aT(Pne.argsOrArgArray(e))))(i)})}qy.combineLatest=IF;var Cne=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},Tne=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(Gy,"__esModule",{value:!0});Gy.combineLatestWith=void 0;var Mne=qy;function Lne(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Mne.combineLatest.apply(void 0,Tne([],Cne(e)))}Gy.combineLatestWith=Lne;var cg={};Object.defineProperty(cg,"__esModule",{value:!0});cg.concatMap=void 0;var uT=Ku,Rne=ui;function Dne(e,r){return Rne.isFunction(r)?uT.mergeMap(e,r,1):uT.mergeMap(e,1)}cg.concatMap=Dne;var Vy={};Object.defineProperty(Vy,"__esModule",{value:!0});Vy.concatMapTo=void 0;var lT=cg,Nne=ui;function Fne(e,r){return Nne.isFunction(r)?lT.concatMap(function(){return e},r):lT.concatMap(function(){return e})}Vy.concatMapTo=Fne;var Xy={},Yy={},kne=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},Bne=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(Yy,"__esModule",{value:!0});Yy.concat=void 0;var zne=Qt,jne=Gf,Une=qo,$ne=Hu;function Gne(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=Une.popScheduler(e);return zne.operate(function(n,i){jne.concatAll()($ne.from(Bne([n],kne(e)),t)).subscribe(i)})}Yy.concat=Gne;var qne=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},Vne=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(Xy,"__esModule",{value:!0});Xy.concatWith=void 0;var Xne=Yy;function Yne(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Xne.concat.apply(void 0,Vne([],qne(e)))}Xy.concatWith=Yne;var Xf={},Wy={};Object.defineProperty(Wy,"__esModule",{value:!0});Wy.fromSubscribable=void 0;var Wne=mi;function Zne(e){return new Wne.Observable(function(r){return e.subscribe(r)})}Wy.fromSubscribable=Zne;Object.defineProperty(Xf,"__esModule",{value:!0});Xf.connect=void 0;var Hne=ko,Jne=Tr,Kne=Qt,Qne=Wy,eie={connector:function(){return new Hne.Subject}};function tie(e,r){r===void 0&&(r=eie);var t=r.connector;return Kne.operate(function(n,i){var l=t();Jne.innerFrom(e(Qne.fromSubscribable(l))).subscribe(i),i.add(n.subscribe(l))})}Xf.connect=tie;var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0});Zy.count=void 0;var rie=Dc;function nie(e){return rie.reduce(function(r,t,n){return!e||e(t,n)?r+1:r},0)}Zy.count=nie;var Hy={};Object.defineProperty(Hy,"__esModule",{value:!0});Hy.debounce=void 0;var iie=Qt,oie=la,cT=mr,aie=Tr;function sie(e){return iie.operate(function(r,t){var n=!1,i=null,l=null,p=function(){if(l==null||l.unsubscribe(),l=null,n){n=!1;var u=i;i=null,t.next(u)}};r.subscribe(cT.createOperatorSubscriber(t,function(u){l==null||l.unsubscribe(),n=!0,i=u,l=cT.createOperatorSubscriber(t,p,oie.noop),aie.innerFrom(e(u)).subscribe(l)},function(){p(),t.complete()},void 0,function(){i=l=null}))})}Hy.debounce=sie;var Jy={};Object.defineProperty(Jy,"__esModule",{value:!0});Jy.debounceTime=void 0;var uie=Ys,lie=Qt,cie=mr;function hie(e,r){return r===void 0&&(r=uie.asyncScheduler),lie.operate(function(t,n){var i=null,l=null,p=null,u=function(){if(i){i.unsubscribe(),i=null;var m=l;l=null,n.next(m)}};function _(){var m=p+e,S=r.now();if(S<m){i=this.schedule(void 0,m-S),n.add(i);return}u()}t.subscribe(cie.createOperatorSubscriber(n,function(m){l=m,p=r.now(),i||(i=r.schedule(_,e),n.add(i))},function(){u(),n.complete()},void 0,function(){l=i=null}))})}Jy.debounceTime=hie;var Ph={};Object.defineProperty(Ph,"__esModule",{value:!0});Ph.defaultIfEmpty=void 0;var fie=Qt,pie=mr;function die(e){return fie.operate(function(r,t){var n=!1;r.subscribe(pie.createOperatorSubscriber(t,function(i){n=!0,t.next(i)},function(){n||t.next(e),t.complete()}))})}Ph.defaultIfEmpty=die;var Ky={},hg={},Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});Ah.take=void 0;var gie=Yu,mie=Qt,vie=mr;function yie(e){return e<=0?function(){return gie.EMPTY}:mie.operate(function(r,t){var n=0;r.subscribe(vie.createOperatorSubscriber(t,function(i){++n<=e&&(t.next(i),e<=n&&t.complete())}))})}Ah.take=yie;var fg={};Object.defineProperty(fg,"__esModule",{value:!0});fg.ignoreElements=void 0;var _ie=Qt,bie=mr,xie=la;function wie(){return _ie.operate(function(e,r){e.subscribe(bie.createOperatorSubscriber(r,xie.noop))})}fg.ignoreElements=wie;var pg={};Object.defineProperty(pg,"__esModule",{value:!0});pg.mapTo=void 0;var Eie=Pl;function Sie(e){return Eie.map(function(){return e})}pg.mapTo=Sie;Object.defineProperty(hg,"__esModule",{value:!0});hg.delayWhen=void 0;var Pie=wh,hT=Ah,Aie=fg,Iie=pg,Oie=Ku,Cie=Tr;function OF(e,r){return r?function(t){return Pie.concat(r.pipe(hT.take(1),Aie.ignoreElements()),t.pipe(OF(e)))}:Oie.mergeMap(function(t,n){return Cie.innerFrom(e(t,n)).pipe(hT.take(1),Iie.mapTo(t))})}hg.delayWhen=OF;Object.defineProperty(Ky,"__esModule",{value:!0});Ky.delay=void 0;var Tie=Ys,Mie=hg,Lie=Al;function Rie(e,r){r===void 0&&(r=Tie.asyncScheduler);var t=Lie.timer(e,r);return Mie.delayWhen(function(){return t})}Ky.delay=Rie;var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0});Qy.dematerialize=void 0;var Die=py,Nie=Qt,Fie=mr;function kie(){return Nie.operate(function(e,r){e.subscribe(Fie.createOperatorSubscriber(r,function(t){return Die.observeNotification(t,r)}))})}Qy.dematerialize=kie;var e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.distinct=void 0;var Bie=Qt,fT=mr,zie=la,jie=Tr;function Uie(e,r){return Bie.operate(function(t,n){var i=new Set;t.subscribe(fT.createOperatorSubscriber(n,function(l){var p=e?e(l):l;i.has(p)||(i.add(p),n.next(l))})),r&&jie.innerFrom(r).subscribe(fT.createOperatorSubscriber(n,function(){return i.clear()},zie.noop))})}e_.distinct=Uie;var dg={};Object.defineProperty(dg,"__esModule",{value:!0});dg.distinctUntilChanged=void 0;var $ie=ca,Gie=Qt,qie=mr;function Vie(e,r){return r===void 0&&(r=$ie.identity),e=e??Xie,Gie.operate(function(t,n){var i,l=!0;t.subscribe(qie.createOperatorSubscriber(n,function(p){var u=r(p);(l||!e(i,u))&&(l=!1,i=u,n.next(p))}))})}dg.distinctUntilChanged=Vie;function Xie(e,r){return e===r}var t_={};Object.defineProperty(t_,"__esModule",{value:!0});t_.distinctUntilKeyChanged=void 0;var Yie=dg;function Wie(e,r){return Yie.distinctUntilChanged(function(t,n){return r?r(t[e],n[e]):t[e]===n[e]})}t_.distinctUntilKeyChanged=Wie;var r_={},Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.throwIfEmpty=void 0;var Zie=El,Hie=Qt,Jie=mr;function Kie(e){return e===void 0&&(e=Qie),Hie.operate(function(r,t){var n=!1;r.subscribe(Jie.createOperatorSubscriber(t,function(i){n=!0,t.next(i)},function(){return n?t.complete():t.error(e())}))})}Ih.throwIfEmpty=Kie;function Qie(){return new Zie.EmptyError}Object.defineProperty(r_,"__esModule",{value:!0});r_.elementAt=void 0;var pT=Jd,eoe=rc,toe=Ih,roe=Ph,noe=Ah;function ioe(e,r){if(e<0)throw new pT.ArgumentOutOfRangeError;var t=arguments.length>=2;return function(n){return n.pipe(eoe.filter(function(i,l){return l===e}),noe.take(1),t?roe.defaultIfEmpty(r):toe.throwIfEmpty(function(){return new pT.ArgumentOutOfRangeError}))}}r_.elementAt=ioe;var n_={},ooe=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},aoe=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(n_,"__esModule",{value:!0});n_.endWith=void 0;var soe=wh,uoe=zf;function loe(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return function(t){return soe.concat(t,uoe.of.apply(void 0,aoe([],ooe(e))))}}n_.endWith=loe;var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.every=void 0;var coe=Qt,hoe=mr;function foe(e,r){return coe.operate(function(t,n){var i=0;t.subscribe(hoe.createOperatorSubscriber(n,function(l){e.call(r,l,i++,t)||(n.next(!1),n.complete())},function(){n.next(!0),n.complete()}))})}i_.every=foe;var o_={},gg={},mg={};Object.defineProperty(mg,"__esModule",{value:!0});mg.exhaustMap=void 0;var poe=Pl,dT=Tr,doe=Qt,gT=mr;function CF(e,r){return r?function(t){return t.pipe(CF(function(n,i){return dT.innerFrom(e(n,i)).pipe(poe.map(function(l,p){return r(n,l,i,p)}))}))}:doe.operate(function(t,n){var i=0,l=null,p=!1;t.subscribe(gT.createOperatorSubscriber(n,function(u){l||(l=gT.createOperatorSubscriber(n,void 0,function(){l=null,p&&n.complete()}),dT.innerFrom(e(u,i++)).subscribe(l))},function(){p=!0,!l&&n.complete()}))})}mg.exhaustMap=CF;Object.defineProperty(gg,"__esModule",{value:!0});gg.exhaustAll=void 0;var goe=mg,moe=ca;function voe(){return goe.exhaustMap(moe.identity)}gg.exhaustAll=voe;Object.defineProperty(o_,"__esModule",{value:!0});o_.exhaust=void 0;var yoe=gg;o_.exhaust=yoe.exhaustAll;var a_={};Object.defineProperty(a_,"__esModule",{value:!0});a_.expand=void 0;var _oe=Qt,boe=qf;function xoe(e,r,t){return r===void 0&&(r=1/0),r=(r||0)<1?1/0:r,_oe.operate(function(n,i){return boe.mergeInternals(n,i,e,r,void 0,!0,t)})}a_.expand=xoe;var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.finalize=void 0;var woe=Qt;function Eoe(e){return woe.operate(function(r,t){try{r.subscribe(t)}finally{t.add(e)}})}s_.finalize=Eoe;var lh={};Object.defineProperty(lh,"__esModule",{value:!0});lh.createFind=lh.find=void 0;var Soe=Qt,Poe=mr;function Aoe(e,r){return Soe.operate(TF(e,r,"value"))}lh.find=Aoe;function TF(e,r,t){var n=t==="index";return function(i,l){var p=0;i.subscribe(Poe.createOperatorSubscriber(l,function(u){var _=p++;e.call(r,u,_,i)&&(l.next(n?_:u),l.complete())},function(){l.next(n?-1:void 0),l.complete()}))}}lh.createFind=TF;var u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.findIndex=void 0;var Ioe=Qt,Ooe=lh;function Coe(e,r){return Ioe.operate(Ooe.createFind(e,r,"index"))}u_.findIndex=Coe;var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.first=void 0;var Toe=El,Moe=rc,Loe=Ah,Roe=Ph,Doe=Ih,Noe=ca;function Foe(e,r){var t=arguments.length>=2;return function(n){return n.pipe(e?Moe.filter(function(i,l){return e(i,l,n)}):Noe.identity,Loe.take(1),t?Roe.defaultIfEmpty(r):Doe.throwIfEmpty(function(){return new Toe.EmptyError}))}}l_.first=Foe;var c_={};Object.defineProperty(c_,"__esModule",{value:!0});c_.groupBy=void 0;var koe=mi,Boe=Tr,zoe=ko,joe=Qt,mT=mr;function Uoe(e,r,t,n){return joe.operate(function(i,l){var p;!r||typeof r=="function"?p=r:(t=r.duration,p=r.element,n=r.connector);var u=new Map,_=function(B){u.forEach(B),B(l)},m=function(B){return _(function($){return $.error(B)})},S=0,P=!1,O=new mT.OperatorSubscriber(l,function(B){try{var $=e(B),q=u.get($);if(!q){u.set($,q=n?n():new zoe.Subject);var X=M($,q);if(l.next(X),t){var R=mT.createOperatorSubscriber(q,function(){q.complete(),R==null||R.unsubscribe()},void 0,void 0,function(){return u.delete($)});O.add(Boe.innerFrom(t(X)).subscribe(R))}}q.next(p?p(B):B)}catch(k){m(k)}},function(){return _(function(B){return B.complete()})},m,function(){return u.clear()},function(){return P=!0,S===0});i.subscribe(O);function M(B,$){var q=new koe.Observable(function(X){S++;var R=$.subscribe(X);return function(){R.unsubscribe(),--S===0&&P&&O.unsubscribe()}});return q.key=B,q}})}c_.groupBy=Uoe;var h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.isEmpty=void 0;var $oe=Qt,Goe=mr;function qoe(){return $oe.operate(function(e,r){e.subscribe(Goe.createOperatorSubscriber(r,function(){r.next(!1),r.complete()},function(){r.next(!0),r.complete()}))})}h_.isEmpty=qoe;var f_={},vg={},Voe=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(vg,"__esModule",{value:!0});vg.takeLast=void 0;var Xoe=Yu,Yoe=Qt,Woe=mr;function Zoe(e){return e<=0?function(){return Xoe.EMPTY}:Yoe.operate(function(r,t){var n=[];r.subscribe(Woe.createOperatorSubscriber(t,function(i){n.push(i),e<n.length&&n.shift()},function(){var i,l;try{for(var p=Voe(n),u=p.next();!u.done;u=p.next()){var _=u.value;t.next(_)}}catch(m){i={error:m}}finally{try{u&&!u.done&&(l=p.return)&&l.call(p)}finally{if(i)throw i.error}}t.complete()},void 0,function(){n=null}))})}vg.takeLast=Zoe;Object.defineProperty(f_,"__esModule",{value:!0});f_.last=void 0;var Hoe=El,Joe=rc,Koe=vg,Qoe=Ih,eae=Ph,tae=ca;function rae(e,r){var t=arguments.length>=2;return function(n){return n.pipe(e?Joe.filter(function(i,l){return e(i,l,n)}):tae.identity,Koe.takeLast(1),t?eae.defaultIfEmpty(r):Qoe.throwIfEmpty(function(){return new Hoe.EmptyError}))}}f_.last=rae;var p_={};Object.defineProperty(p_,"__esModule",{value:!0});p_.materialize=void 0;var hb=py,nae=Qt,iae=mr;function oae(){return nae.operate(function(e,r){e.subscribe(iae.createOperatorSubscriber(r,function(t){r.next(hb.Notification.createNext(t))},function(){r.next(hb.Notification.createComplete()),r.complete()},function(t){r.next(hb.Notification.createError(t)),r.complete()}))})}p_.materialize=oae;var d_={};Object.defineProperty(d_,"__esModule",{value:!0});d_.max=void 0;var aae=Dc,sae=ui;function uae(e){return aae.reduce(sae.isFunction(e)?function(r,t){return e(r,t)>0?r:t}:function(r,t){return r>t?r:t})}d_.max=uae;var g_={};Object.defineProperty(g_,"__esModule",{value:!0});g_.flatMap=void 0;var lae=Ku;g_.flatMap=lae.mergeMap;var m_={};Object.defineProperty(m_,"__esModule",{value:!0});m_.mergeMapTo=void 0;var vT=Ku,cae=ui;function hae(e,r,t){return t===void 0&&(t=1/0),cae.isFunction(r)?vT.mergeMap(function(){return e},r,t):(typeof r=="number"&&(t=r),vT.mergeMap(function(){return e},t))}m_.mergeMapTo=hae;var v_={};Object.defineProperty(v_,"__esModule",{value:!0});v_.mergeScan=void 0;var fae=Qt,pae=qf;function dae(e,r,t){return t===void 0&&(t=1/0),fae.operate(function(n,i){var l=r;return pae.mergeInternals(n,i,function(p,u){return e(l,p,u)},t,function(p){l=p},!1,void 0,function(){return l=null})})}v_.mergeScan=dae;var y_={},__={},gae=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},mae=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(__,"__esModule",{value:!0});__.merge=void 0;var vae=Qt,yae=tc,_ae=Eh,yT=qo,bae=Hu;function xae(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=yT.popScheduler(e),n=yT.popNumber(e,1/0);return e=yae.argsOrArgArray(e),vae.operate(function(i,l){_ae.mergeAll(n)(bae.from(mae([i],gae(e)),t)).subscribe(l)})}__.merge=xae;var wae=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},Eae=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(y_,"__esModule",{value:!0});y_.mergeWith=void 0;var Sae=__;function Pae(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Sae.merge.apply(void 0,Eae([],wae(e)))}y_.mergeWith=Pae;var b_={};Object.defineProperty(b_,"__esModule",{value:!0});b_.min=void 0;var Aae=Dc,Iae=ui;function Oae(e){return Aae.reduce(Iae.isFunction(e)?function(r,t){return e(r,t)<0?r:t}:function(r,t){return r<t?r:t})}b_.min=Oae;var Yf={};Object.defineProperty(Yf,"__esModule",{value:!0});Yf.multicast=void 0;var Cae=yh,_T=ui,Tae=Xf;function Mae(e,r){var t=_T.isFunction(e)?e:function(){return e};return _T.isFunction(r)?Tae.connect(r,{connector:t}):function(n){return new Cae.ConnectableObservable(n,t)}}Yf.multicast=Mae;var xf={},Lae=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},Rae=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(xf,"__esModule",{value:!0});xf.onErrorResumeNext=xf.onErrorResumeNextWith=void 0;var Dae=tc,Nae=ig;function MF(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=Dae.argsOrArgArray(e);return function(n){return Nae.onErrorResumeNext.apply(void 0,Rae([n],Lae(t)))}}xf.onErrorResumeNextWith=MF;xf.onErrorResumeNext=MF;var x_={};Object.defineProperty(x_,"__esModule",{value:!0});x_.pairwise=void 0;var Fae=Qt,kae=mr;function Bae(){return Fae.operate(function(e,r){var t,n=!1;e.subscribe(kae.createOperatorSubscriber(r,function(i){var l=t;t=i,n&&r.next([l,i]),n=!0}))})}x_.pairwise=Bae;var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.pluck=void 0;var zae=Pl;function jae(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=e.length;if(t===0)throw new Error("list of properties cannot be empty.");return zae.map(function(n){for(var i=n,l=0;l<t;l++){var p=i==null?void 0:i[e[l]];if(typeof p<"u")i=p;else return}return i})}w_.pluck=jae;var E_={};Object.defineProperty(E_,"__esModule",{value:!0});E_.publish=void 0;var Uae=ko,$ae=Yf,Gae=Xf;function qae(e){return e?function(r){return Gae.connect(e)(r)}:function(r){return $ae.multicast(new Uae.Subject)(r)}}E_.publish=qae;var S_={};Object.defineProperty(S_,"__esModule",{value:!0});S_.publishBehavior=void 0;var Vae=jd,Xae=yh;function Yae(e){return function(r){var t=new Vae.BehaviorSubject(e);return new Xae.ConnectableObservable(r,function(){return t})}}S_.publishBehavior=Yae;var P_={};Object.defineProperty(P_,"__esModule",{value:!0});P_.publishLast=void 0;var Wae=Bf,Zae=yh;function Hae(){return function(e){var r=new Wae.AsyncSubject;return new Zae.ConnectableObservable(e,function(){return r})}}P_.publishLast=Hae;var A_={};Object.defineProperty(A_,"__esModule",{value:!0});A_.publishReplay=void 0;var Jae=kf,Kae=Yf,bT=ui;function Qae(e,r,t,n){t&&!bT.isFunction(t)&&(n=t);var i=bT.isFunction(t)?t:void 0;return function(l){return Kae.multicast(new Jae.ReplaySubject(e,r,n),i)(l)}}A_.publishReplay=Qae;var I_={},ese=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},tse=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(I_,"__esModule",{value:!0});I_.raceWith=void 0;var rse=uh,nse=Qt,ise=ca;function ose(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.length?nse.operate(function(t,n){rse.raceInit(tse([t],ese(e)))(n)}):ise.identity}I_.raceWith=ose;var O_={};Object.defineProperty(O_,"__esModule",{value:!0});O_.repeat=void 0;var ase=Yu,sse=Qt,xT=mr,use=Tr,lse=Al;function cse(e){var r,t=1/0,n;return e!=null&&(typeof e=="object"?(r=e.count,t=r===void 0?1/0:r,n=e.delay):t=e),t<=0?function(){return ase.EMPTY}:sse.operate(function(i,l){var p=0,u,_=function(){if(u==null||u.unsubscribe(),u=null,n!=null){var S=typeof n=="number"?lse.timer(n):use.innerFrom(n(p)),P=xT.createOperatorSubscriber(l,function(){P.unsubscribe(),m()});S.subscribe(P)}else m()},m=function(){var S=!1;u=i.subscribe(xT.createOperatorSubscriber(l,void 0,function(){++p<t?u?_():S=!0:l.complete()})),S&&_()};m()})}O_.repeat=cse;var C_={};Object.defineProperty(C_,"__esModule",{value:!0});C_.repeatWhen=void 0;var hse=Tr,fse=ko,pse=Qt,wT=mr;function dse(e){return pse.operate(function(r,t){var n,i=!1,l,p=!1,u=!1,_=function(){return u&&p&&(t.complete(),!0)},m=function(){return l||(l=new fse.Subject,hse.innerFrom(e(l)).subscribe(wT.createOperatorSubscriber(t,function(){n?S():i=!0},function(){p=!0,_()}))),l},S=function(){u=!1,n=r.subscribe(wT.createOperatorSubscriber(t,void 0,function(){u=!0,!_()&&m().next()})),i&&(n.unsubscribe(),n=null,i=!1,S())};S()})}C_.repeatWhen=dse;var T_={};Object.defineProperty(T_,"__esModule",{value:!0});T_.retry=void 0;var gse=Qt,ET=mr,mse=ca,vse=Al,yse=Tr;function _se(e){e===void 0&&(e=1/0);var r;e&&typeof e=="object"?r=e:r={count:e};var t=r.count,n=t===void 0?1/0:t,i=r.delay,l=r.resetOnSuccess,p=l===void 0?!1:l;return n<=0?mse.identity:gse.operate(function(u,_){var m=0,S,P=function(){var O=!1;S=u.subscribe(ET.createOperatorSubscriber(_,function(M){p&&(m=0),_.next(M)},void 0,function(M){if(m++<n){var B=function(){S?(S.unsubscribe(),S=null,P()):O=!0};if(i!=null){var $=typeof i=="number"?vse.timer(i):yse.innerFrom(i(M,m)),q=ET.createOperatorSubscriber(_,function(){q.unsubscribe(),B()},function(){_.complete()});$.subscribe(q)}else B()}else _.error(M)})),O&&(S.unsubscribe(),S=null,P())};P()})}T_.retry=_se;var M_={};Object.defineProperty(M_,"__esModule",{value:!0});M_.retryWhen=void 0;var bse=Tr,xse=ko,wse=Qt,ST=mr;function Ese(e){return wse.operate(function(r,t){var n,i=!1,l,p=function(){n=r.subscribe(ST.createOperatorSubscriber(t,void 0,void 0,function(u){l||(l=new xse.Subject,bse.innerFrom(e(l)).subscribe(ST.createOperatorSubscriber(t,function(){return n?p():i=!0}))),l&&l.next(u)})),i&&(n.unsubscribe(),n=null,i=!1,p())};p()})}M_.retryWhen=Ese;var yg={};Object.defineProperty(yg,"__esModule",{value:!0});yg.sample=void 0;var Sse=Tr,Pse=Qt,Ase=la,PT=mr;function Ise(e){return Pse.operate(function(r,t){var n=!1,i=null;r.subscribe(PT.createOperatorSubscriber(t,function(l){n=!0,i=l})),Sse.innerFrom(e).subscribe(PT.createOperatorSubscriber(t,function(){if(n){n=!1;var l=i;i=null,t.next(l)}},Ase.noop))})}yg.sample=Ise;var L_={};Object.defineProperty(L_,"__esModule",{value:!0});L_.sampleTime=void 0;var Ose=Ys,Cse=yg,Tse=ng;function Mse(e,r){return r===void 0&&(r=Ose.asyncScheduler),Cse.sample(Tse.interval(e,r))}L_.sampleTime=Mse;var R_={};Object.defineProperty(R_,"__esModule",{value:!0});R_.scan=void 0;var Lse=Qt,Rse=lg;function Dse(e,r){return Lse.operate(Rse.scanInternals(e,r,arguments.length>=2,!0))}R_.scan=Dse;var D_={};Object.defineProperty(D_,"__esModule",{value:!0});D_.sequenceEqual=void 0;var Nse=Qt,Fse=mr,kse=Tr;function Bse(e,r){return r===void 0&&(r=function(t,n){return t===n}),Nse.operate(function(t,n){var i=AT(),l=AT(),p=function(_){n.next(_),n.complete()},u=function(_,m){var S=Fse.createOperatorSubscriber(n,function(P){var O=m.buffer,M=m.complete;O.length===0?M?p(!1):_.buffer.push(P):!r(P,O.shift())&&p(!1)},function(){_.complete=!0;var P=m.complete,O=m.buffer;P&&p(O.length===0),S==null||S.unsubscribe()});return S};t.subscribe(u(i,l)),kse.innerFrom(e).subscribe(u(l,i))})}D_.sequenceEqual=Bse;function AT(){return{buffer:[],complete:!1}}var _g={},zse=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},jse=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(_g,"__esModule",{value:!0});_g.share=void 0;var LF=Tr,Use=ko,RF=Ff,$se=Qt;function Gse(e){e===void 0&&(e={});var r=e.connector,t=r===void 0?function(){return new Use.Subject}:r,n=e.resetOnError,i=n===void 0?!0:n,l=e.resetOnComplete,p=l===void 0?!0:l,u=e.resetOnRefCountZero,_=u===void 0?!0:u;return function(m){var S,P,O,M=0,B=!1,$=!1,q=function(){P==null||P.unsubscribe(),P=void 0},X=function(){q(),S=O=void 0,B=$=!1},R=function(){var k=S;X(),k==null||k.unsubscribe()};return $se.operate(function(k,U){M++,!$&&!B&&q();var H=O=O??t();U.add(function(){M--,M===0&&!$&&!B&&(P=fb(R,_))}),H.subscribe(U),!S&&M>0&&(S=new RF.SafeSubscriber({next:function(ue){return H.next(ue)},error:function(ue){$=!0,q(),P=fb(X,i,ue),H.error(ue)},complete:function(){B=!0,q(),P=fb(X,p),H.complete()}}),LF.innerFrom(k).subscribe(S))})(m)}}_g.share=Gse;function fb(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];if(r===!0){e();return}if(r!==!1){var i=new RF.SafeSubscriber({next:function(){i.unsubscribe(),e()}});return LF.innerFrom(r.apply(void 0,jse([],zse(t)))).subscribe(i)}}var N_={};Object.defineProperty(N_,"__esModule",{value:!0});N_.shareReplay=void 0;var qse=kf,Vse=_g;function Xse(e,r,t){var n,i,l,p,u=!1;return e&&typeof e=="object"?(n=e.bufferSize,p=n===void 0?1/0:n,i=e.windowTime,r=i===void 0?1/0:i,l=e.refCount,u=l===void 0?!1:l,t=e.scheduler):p=e??1/0,Vse.share({connector:function(){return new qse.ReplaySubject(p,r,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:u})}N_.shareReplay=Xse;var F_={};Object.defineProperty(F_,"__esModule",{value:!0});F_.single=void 0;var Yse=El,Wse=Qd,Zse=Kd,Hse=Qt,Jse=mr;function Kse(e){return Hse.operate(function(r,t){var n=!1,i,l=!1,p=0;r.subscribe(Jse.createOperatorSubscriber(t,function(u){l=!0,(!e||e(u,p++,r))&&(n&&t.error(new Wse.SequenceError("Too many matching values")),n=!0,i=u)},function(){n?(t.next(i),t.complete()):t.error(l?new Zse.NotFoundError("No matching values"):new Yse.EmptyError)}))})}F_.single=Kse;var k_={};Object.defineProperty(k_,"__esModule",{value:!0});k_.skip=void 0;var Qse=rc;function eue(e){return Qse.filter(function(r,t){return e<=t})}k_.skip=eue;var B_={};Object.defineProperty(B_,"__esModule",{value:!0});B_.skipLast=void 0;var tue=ca,rue=Qt,nue=mr;function iue(e){return e<=0?tue.identity:rue.operate(function(r,t){var n=new Array(e),i=0;return r.subscribe(nue.createOperatorSubscriber(t,function(l){var p=i++;if(p<e)n[p]=l;else{var u=p%e,_=n[u];n[u]=l,t.next(_)}})),function(){n=null}})}B_.skipLast=iue;var z_={};Object.defineProperty(z_,"__esModule",{value:!0});z_.skipUntil=void 0;var oue=Qt,IT=mr,aue=Tr,sue=la;function uue(e){return oue.operate(function(r,t){var n=!1,i=IT.createOperatorSubscriber(t,function(){i==null||i.unsubscribe(),n=!0},sue.noop);aue.innerFrom(e).subscribe(i),r.subscribe(IT.createOperatorSubscriber(t,function(l){return n&&t.next(l)}))})}z_.skipUntil=uue;var j_={};Object.defineProperty(j_,"__esModule",{value:!0});j_.skipWhile=void 0;var lue=Qt,cue=mr;function hue(e){return lue.operate(function(r,t){var n=!1,i=0;r.subscribe(cue.createOperatorSubscriber(t,function(l){return(n||(n=!e(l,i++)))&&t.next(l)}))})}j_.skipWhile=hue;var U_={};Object.defineProperty(U_,"__esModule",{value:!0});U_.startWith=void 0;var OT=wh,fue=qo,pue=Qt;function due(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=fue.popScheduler(e);return pue.operate(function(n,i){(t?OT.concat(e,n,t):OT.concat(e,n)).subscribe(i)})}U_.startWith=due;var $_={},Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.switchMap=void 0;var gue=Tr,mue=Qt,CT=mr;function vue(e,r){return mue.operate(function(t,n){var i=null,l=0,p=!1,u=function(){return p&&!i&&n.complete()};t.subscribe(CT.createOperatorSubscriber(n,function(_){i==null||i.unsubscribe();var m=0,S=l++;gue.innerFrom(e(_,S)).subscribe(i=CT.createOperatorSubscriber(n,function(P){return n.next(r?r(_,P,S,m++):P)},function(){i=null,u()}))},function(){p=!0,u()}))})}Oh.switchMap=vue;Object.defineProperty($_,"__esModule",{value:!0});$_.switchAll=void 0;var yue=Oh,_ue=ca;function bue(){return yue.switchMap(_ue.identity)}$_.switchAll=bue;var G_={};Object.defineProperty(G_,"__esModule",{value:!0});G_.switchMapTo=void 0;var TT=Oh,xue=ui;function wue(e,r){return xue.isFunction(r)?TT.switchMap(function(){return e},r):TT.switchMap(function(){return e})}G_.switchMapTo=wue;var q_={};Object.defineProperty(q_,"__esModule",{value:!0});q_.switchScan=void 0;var Eue=Oh,Sue=Qt;function Pue(e,r){return Sue.operate(function(t,n){var i=r;return Eue.switchMap(function(l,p){return e(i,l,p)},function(l,p){return i=p,p})(t).subscribe(n),function(){i=null}})}q_.switchScan=Pue;var V_={};Object.defineProperty(V_,"__esModule",{value:!0});V_.takeUntil=void 0;var Aue=Qt,Iue=mr,Oue=Tr,Cue=la;function Tue(e){return Aue.operate(function(r,t){Oue.innerFrom(e).subscribe(Iue.createOperatorSubscriber(t,function(){return t.complete()},Cue.noop)),!t.closed&&r.subscribe(t)})}V_.takeUntil=Tue;var X_={};Object.defineProperty(X_,"__esModule",{value:!0});X_.takeWhile=void 0;var Mue=Qt,Lue=mr;function Rue(e,r){return r===void 0&&(r=!1),Mue.operate(function(t,n){var i=0;t.subscribe(Lue.createOperatorSubscriber(n,function(l){var p=e(l,i++);(p||r)&&n.next(l),!p&&n.complete()}))})}X_.takeWhile=Rue;var Y_={};Object.defineProperty(Y_,"__esModule",{value:!0});Y_.tap=void 0;var Due=ui,Nue=Qt,Fue=mr,kue=ca;function Bue(e,r,t){var n=Due.isFunction(e)||r||t?{next:e,error:r,complete:t}:e;return n?Nue.operate(function(i,l){var p;(p=n.subscribe)===null||p===void 0||p.call(n);var u=!0;i.subscribe(Fue.createOperatorSubscriber(l,function(_){var m;(m=n.next)===null||m===void 0||m.call(n,_),l.next(_)},function(){var _;u=!1,(_=n.complete)===null||_===void 0||_.call(n),l.complete()},function(_){var m;u=!1,(m=n.error)===null||m===void 0||m.call(n,_),l.error(_)},function(){var _,m;u&&((_=n.unsubscribe)===null||_===void 0||_.call(n)),(m=n.finalize)===null||m===void 0||m.call(n)}))}):kue.identity}Y_.tap=Bue;var bg={};Object.defineProperty(bg,"__esModule",{value:!0});bg.throttle=void 0;var zue=Qt,MT=mr,jue=Tr;function Uue(e,r){return zue.operate(function(t,n){var i=r??{},l=i.leading,p=l===void 0?!0:l,u=i.trailing,_=u===void 0?!1:u,m=!1,S=null,P=null,O=!1,M=function(){P==null||P.unsubscribe(),P=null,_&&(q(),O&&n.complete())},B=function(){P=null,O&&n.complete()},$=function(X){return P=jue.innerFrom(e(X)).subscribe(MT.createOperatorSubscriber(n,M,B))},q=function(){if(m){m=!1;var X=S;S=null,n.next(X),!O&&$(X)}};t.subscribe(MT.createOperatorSubscriber(n,function(X){m=!0,S=X,!(P&&!P.closed)&&(p?q():$(X))},function(){O=!0,!(_&&m&&P&&!P.closed)&&n.complete()}))})}bg.throttle=Uue;var W_={};Object.defineProperty(W_,"__esModule",{value:!0});W_.throttleTime=void 0;var $ue=Ys,Gue=bg,que=Al;function Vue(e,r,t){r===void 0&&(r=$ue.asyncScheduler);var n=que.timer(e,r);return Gue.throttle(function(){return n},t)}W_.throttleTime=Vue;var wf={};Object.defineProperty(wf,"__esModule",{value:!0});wf.TimeInterval=wf.timeInterval=void 0;var Xue=Ys,Yue=Qt,Wue=mr;function Zue(e){return e===void 0&&(e=Xue.asyncScheduler),Yue.operate(function(r,t){var n=e.now();r.subscribe(Wue.createOperatorSubscriber(t,function(i){var l=e.now(),p=l-n;n=l,t.next(new DF(i,p))}))})}wf.timeInterval=Zue;var DF=function(){function e(r,t){this.value=r,this.interval=t}return e}();wf.TimeInterval=DF;var Z_={};Object.defineProperty(Z_,"__esModule",{value:!0});Z_.timeoutWith=void 0;var Hue=Ys,Jue=$f,Kue=pv;function Que(e,r,t){var n,i,l;if(t=t??Hue.async,Jue.isValidDate(e)?n=e:typeof e=="number"&&(i=e),r)l=function(){return r};else throw new TypeError("No observable provided to switch to");if(n==null&&i==null)throw new TypeError("No timeout provided.");return Kue.timeout({first:n,each:i,scheduler:t,with:l})}Z_.timeoutWith=Que;var H_={};Object.defineProperty(H_,"__esModule",{value:!0});H_.timestamp=void 0;var ele=oy,tle=Pl;function rle(e){return e===void 0&&(e=ele.dateTimestampProvider),tle.map(function(r){return{value:r,timestamp:e.now()}})}H_.timestamp=rle;var J_={};Object.defineProperty(J_,"__esModule",{value:!0});J_.window=void 0;var LT=ko,nle=Qt,RT=mr,ile=la,ole=Tr;function ale(e){return nle.operate(function(r,t){var n=new LT.Subject;t.next(n.asObservable());var i=function(l){n.error(l),t.error(l)};return r.subscribe(RT.createOperatorSubscriber(t,function(l){return n==null?void 0:n.next(l)},function(){n.complete(),t.complete()},i)),ole.innerFrom(e).subscribe(RT.createOperatorSubscriber(t,function(){n.complete(),t.next(n=new LT.Subject)},ile.noop,i)),function(){n==null||n.unsubscribe(),n=null}})}J_.window=ale;var K_={},sle=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(K_,"__esModule",{value:!0});K_.windowCount=void 0;var DT=ko,ule=Qt,lle=mr;function cle(e,r){r===void 0&&(r=0);var t=r>0?r:e;return ule.operate(function(n,i){var l=[new DT.Subject],p=0;i.next(l[0].asObservable()),n.subscribe(lle.createOperatorSubscriber(i,function(u){var _,m;try{for(var S=sle(l),P=S.next();!P.done;P=S.next()){var O=P.value;O.next(u)}}catch($){_={error:$}}finally{try{P&&!P.done&&(m=S.return)&&m.call(S)}finally{if(_)throw _.error}}var M=p-e+1;if(M>=0&&M%t===0&&l.shift().complete(),++p%t===0){var B=new DT.Subject;l.push(B),i.next(B.asObservable())}},function(){for(;l.length>0;)l.shift().complete();i.complete()},function(u){for(;l.length>0;)l.shift().error(u);i.error(u)},function(){l=null}))})}K_.windowCount=cle;var Q_={};Object.defineProperty(Q_,"__esModule",{value:!0});Q_.windowTime=void 0;var hle=ko,fle=Ys,ple=aa,dle=Qt,gle=mr,mle=Zu,vle=qo,NT=Ju;function yle(e){for(var r,t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var l=(r=vle.popScheduler(n))!==null&&r!==void 0?r:fle.asyncScheduler,p=(t=n[0])!==null&&t!==void 0?t:null,u=n[1]||1/0;return dle.operate(function(_,m){var S=[],P=!1,O=function(q){var X=q.window,R=q.subs;X.complete(),R.unsubscribe(),mle.arrRemove(S,q),P&&M()},M=function(){if(S){var q=new ple.Subscription;m.add(q);var X=new hle.Subject,R={window:X,subs:q,seen:0};S.push(R),m.next(X.asObservable()),NT.executeSchedule(q,l,function(){return O(R)},e)}};p!==null&&p>=0?NT.executeSchedule(m,l,M,p,!0):P=!0,M();var B=function(q){return S.slice().forEach(q)},$=function(q){B(function(X){var R=X.window;return q(R)}),q(m),m.unsubscribe()};return _.subscribe(gle.createOperatorSubscriber(m,function(q){B(function(X){X.window.next(q),u<=++X.seen&&O(X)})},function(){return $(function(q){return q.complete()})},function(q){return $(function(X){return X.error(q)})})),function(){S=null}})}Q_.windowTime=yle;var e0={},_le=we&&we.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e0,"__esModule",{value:!0});e0.windowToggle=void 0;var ble=ko,xle=aa,wle=Qt,FT=Tr,pb=mr,kT=la,Ele=Zu;function Sle(e,r){return wle.operate(function(t,n){var i=[],l=function(p){for(;0<i.length;)i.shift().error(p);n.error(p)};FT.innerFrom(e).subscribe(pb.createOperatorSubscriber(n,function(p){var u=new ble.Subject;i.push(u);var _=new xle.Subscription,m=function(){Ele.arrRemove(i,u),u.complete(),_.unsubscribe()},S;try{S=FT.innerFrom(r(p))}catch(P){l(P);return}n.next(u.asObservable()),_.add(S.subscribe(pb.createOperatorSubscriber(n,m,kT.noop,l)))},kT.noop)),t.subscribe(pb.createOperatorSubscriber(n,function(p){var u,_,m=i.slice();try{for(var S=_le(m),P=S.next();!P.done;P=S.next()){var O=P.value;O.next(p)}}catch(M){u={error:M}}finally{try{P&&!P.done&&(_=S.return)&&_.call(S)}finally{if(u)throw u.error}}},function(){for(;0<i.length;)i.shift().complete();n.complete()},l,function(){for(;0<i.length;)i.shift().unsubscribe()}))})}e0.windowToggle=Sle;var t0={};Object.defineProperty(t0,"__esModule",{value:!0});t0.windowWhen=void 0;var Ple=ko,Ale=Qt,BT=mr,Ile=Tr;function Ole(e){return Ale.operate(function(r,t){var n,i,l=function(u){n.error(u),t.error(u)},p=function(){i==null||i.unsubscribe(),n==null||n.complete(),n=new Ple.Subject,t.next(n.asObservable());var u;try{u=Ile.innerFrom(e())}catch(_){l(_);return}u.subscribe(i=BT.createOperatorSubscriber(t,p,p,l))};p(),r.subscribe(BT.createOperatorSubscriber(t,function(u){return n.next(u)},function(){n.complete(),t.complete()},l,function(){i==null||i.unsubscribe(),n=null}))})}t0.windowWhen=Ole;var r0={},zT=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},jT=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(r0,"__esModule",{value:!0});r0.withLatestFrom=void 0;var Cle=Qt,UT=mr,Tle=Tr,Mle=ca,Lle=la,Rle=qo;function Dle(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=Rle.popResultSelector(e);return Cle.operate(function(n,i){for(var l=e.length,p=new Array(l),u=e.map(function(){return!1}),_=!1,m=function(P){Tle.innerFrom(e[P]).subscribe(UT.createOperatorSubscriber(i,function(O){p[P]=O,!_&&!u[P]&&(u[P]=!0,(_=u.every(Mle.identity))&&(u=null))},Lle.noop))},S=0;S<l;S++)m(S);n.subscribe(UT.createOperatorSubscriber(i,function(P){if(_){var O=jT([P],zT(p));i.next(t?t.apply(void 0,jT([],zT(O))):O)}}))})}r0.withLatestFrom=Dle;var n0={};Object.defineProperty(n0,"__esModule",{value:!0});n0.zipAll=void 0;var Nle=Vf,Fle=sg;function kle(e){return Fle.joinAllInternals(Nle.zip,e)}n0.zipAll=kle;var i0={},o0={},Ble=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},zle=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(o0,"__esModule",{value:!0});o0.zip=void 0;var jle=Vf,Ule=Qt;function $le(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Ule.operate(function(t,n){jle.zip.apply(void 0,zle([t],Ble(e))).subscribe(n)})}o0.zip=$le;var Gle=we&&we.__read||function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),i,l=[],p;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(u){p={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(p)throw p.error}}return l},qle=we&&we.__spreadArray||function(e,r){for(var t=0,n=r.length,i=e.length;t<n;t++,i++)e[i]=r[t];return e};Object.defineProperty(i0,"__esModule",{value:!0});i0.zipWith=void 0;var Vle=o0;function Xle(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Vle.zip.apply(void 0,qle([],Gle(e)))}i0.zipWith=Xle;(function(e){var r=we&&we.__createBinding||(Object.create?function(ds,di,Gi,qn){qn===void 0&&(qn=Gi),Object.defineProperty(ds,qn,{enumerable:!0,get:function(){return di[Gi]}})}:function(ds,di,Gi,qn){qn===void 0&&(qn=Gi),ds[qn]=di[Gi]}),t=we&&we.__exportStar||function(ds,di){for(var Gi in ds)Gi!=="default"&&!Object.prototype.hasOwnProperty.call(di,Gi)&&r(di,ds,Gi)};Object.defineProperty(e,"__esModule",{value:!0}),e.interval=e.iif=e.generate=e.fromEventPattern=e.fromEvent=e.from=e.forkJoin=e.empty=e.defer=e.connectable=e.concat=e.combineLatest=e.bindNodeCallback=e.bindCallback=e.UnsubscriptionError=e.TimeoutError=e.SequenceError=e.ObjectUnsubscribedError=e.NotFoundError=e.EmptyError=e.ArgumentOutOfRangeError=e.firstValueFrom=e.lastValueFrom=e.isObservable=e.identity=e.noop=e.pipe=e.NotificationKind=e.Notification=e.Subscriber=e.Subscription=e.Scheduler=e.VirtualAction=e.VirtualTimeScheduler=e.animationFrameScheduler=e.animationFrame=e.queueScheduler=e.queue=e.asyncScheduler=e.async=e.asapScheduler=e.asap=e.AsyncSubject=e.ReplaySubject=e.BehaviorSubject=e.Subject=e.animationFrames=e.observable=e.ConnectableObservable=e.Observable=void 0,e.filter=e.expand=e.exhaustMap=e.exhaustAll=e.exhaust=e.every=e.endWith=e.elementAt=e.distinctUntilKeyChanged=e.distinctUntilChanged=e.distinct=e.dematerialize=e.delayWhen=e.delay=e.defaultIfEmpty=e.debounceTime=e.debounce=e.count=e.connect=e.concatWith=e.concatMapTo=e.concatMap=e.concatAll=e.combineLatestWith=e.combineLatestAll=e.combineAll=e.catchError=e.bufferWhen=e.bufferToggle=e.bufferTime=e.bufferCount=e.buffer=e.auditTime=e.audit=e.config=e.NEVER=e.EMPTY=e.scheduled=e.zip=e.using=e.timer=e.throwError=e.range=e.race=e.partition=e.pairs=e.onErrorResumeNext=e.of=e.never=e.merge=void 0,e.switchMap=e.switchAll=e.subscribeOn=e.startWith=e.skipWhile=e.skipUntil=e.skipLast=e.skip=e.single=e.shareReplay=e.share=e.sequenceEqual=e.scan=e.sampleTime=e.sample=e.refCount=e.retryWhen=e.retry=e.repeatWhen=e.repeat=e.reduce=e.raceWith=e.publishReplay=e.publishLast=e.publishBehavior=e.publish=e.pluck=e.pairwise=e.onErrorResumeNextWith=e.observeOn=e.multicast=e.min=e.mergeWith=e.mergeScan=e.mergeMapTo=e.mergeMap=e.flatMap=e.mergeAll=e.max=e.materialize=e.mapTo=e.map=e.last=e.isEmpty=e.ignoreElements=e.groupBy=e.first=e.findIndex=e.find=e.finalize=void 0,e.zipWith=e.zipAll=e.withLatestFrom=e.windowWhen=e.windowToggle=e.windowTime=e.windowCount=e.window=e.toArray=e.timestamp=e.timeoutWith=e.timeout=e.timeInterval=e.throwIfEmpty=e.throttleTime=e.throttle=e.tap=e.takeWhile=e.takeUntil=e.takeLast=e.take=e.switchScan=e.switchMapTo=void 0;var n=mi;Object.defineProperty(e,"Observable",{enumerable:!0,get:function(){return n.Observable}});var i=yh;Object.defineProperty(e,"ConnectableObservable",{enumerable:!0,get:function(){return i.ConnectableObservable}});var l=vh;Object.defineProperty(e,"observable",{enumerable:!0,get:function(){return l.observable}});var p=iy;Object.defineProperty(e,"animationFrames",{enumerable:!0,get:function(){return p.animationFrames}});var u=ko;Object.defineProperty(e,"Subject",{enumerable:!0,get:function(){return u.Subject}});var _=jd;Object.defineProperty(e,"BehaviorSubject",{enumerable:!0,get:function(){return _.BehaviorSubject}});var m=kf;Object.defineProperty(e,"ReplaySubject",{enumerable:!0,get:function(){return m.ReplaySubject}});var S=Bf;Object.defineProperty(e,"AsyncSubject",{enumerable:!0,get:function(){return S.AsyncSubject}});var P=iF;Object.defineProperty(e,"asap",{enumerable:!0,get:function(){return P.asap}}),Object.defineProperty(e,"asapScheduler",{enumerable:!0,get:function(){return P.asapScheduler}});var O=Ys;Object.defineProperty(e,"async",{enumerable:!0,get:function(){return O.async}}),Object.defineProperty(e,"asyncScheduler",{enumerable:!0,get:function(){return O.asyncScheduler}});var M=sF;Object.defineProperty(e,"queue",{enumerable:!0,get:function(){return M.queue}}),Object.defineProperty(e,"queueScheduler",{enumerable:!0,get:function(){return M.queueScheduler}});var B=uF;Object.defineProperty(e,"animationFrame",{enumerable:!0,get:function(){return B.animationFrame}}),Object.defineProperty(e,"animationFrameScheduler",{enumerable:!0,get:function(){return B.animationFrameScheduler}});var $=bf;Object.defineProperty(e,"VirtualTimeScheduler",{enumerable:!0,get:function(){return $.VirtualTimeScheduler}}),Object.defineProperty(e,"VirtualAction",{enumerable:!0,get:function(){return $.VirtualAction}});var q=Ud;Object.defineProperty(e,"Scheduler",{enumerable:!0,get:function(){return q.Scheduler}});var X=aa;Object.defineProperty(e,"Subscription",{enumerable:!0,get:function(){return X.Subscription}});var R=Ff;Object.defineProperty(e,"Subscriber",{enumerable:!0,get:function(){return R.Subscriber}});var k=py;Object.defineProperty(e,"Notification",{enumerable:!0,get:function(){return k.Notification}}),Object.defineProperty(e,"NotificationKind",{enumerable:!0,get:function(){return k.NotificationKind}});var U=Hl;Object.defineProperty(e,"pipe",{enumerable:!0,get:function(){return U.pipe}});var H=la;Object.defineProperty(e,"noop",{enumerable:!0,get:function(){return H.noop}});var ue=ca;Object.defineProperty(e,"identity",{enumerable:!0,get:function(){return ue.identity}});var ie=yy;Object.defineProperty(e,"isObservable",{enumerable:!0,get:function(){return ie.isObservable}});var ee=_y;Object.defineProperty(e,"lastValueFrom",{enumerable:!0,get:function(){return ee.lastValueFrom}});var W=by;Object.defineProperty(e,"firstValueFrom",{enumerable:!0,get:function(){return W.firstValueFrom}});var J=Jd;Object.defineProperty(e,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return J.ArgumentOutOfRangeError}});var be=El;Object.defineProperty(e,"EmptyError",{enumerable:!0,get:function(){return be.EmptyError}});var Oe=Kd;Object.defineProperty(e,"NotFoundError",{enumerable:!0,get:function(){return Oe.NotFoundError}});var Ae=zd;Object.defineProperty(e,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return Ae.ObjectUnsubscribedError}});var ae=Qd;Object.defineProperty(e,"SequenceError",{enumerable:!0,get:function(){return ae.SequenceError}});var ct=pv;Object.defineProperty(e,"TimeoutError",{enumerable:!0,get:function(){return ct.TimeoutError}});var Pe=Fd;Object.defineProperty(e,"UnsubscriptionError",{enumerable:!0,get:function(){return Pe.UnsubscriptionError}});var V=xy;Object.defineProperty(e,"bindCallback",{enumerable:!0,get:function(){return V.bindCallback}});var Q=wy;Object.defineProperty(e,"bindNodeCallback",{enumerable:!0,get:function(){return Q.bindNodeCallback}});var he=Sc;Object.defineProperty(e,"combineLatest",{enumerable:!0,get:function(){return he.combineLatest}});var fe=wh;Object.defineProperty(e,"concat",{enumerable:!0,get:function(){return fe.concat}});var ye=Ey;Object.defineProperty(e,"connectable",{enumerable:!0,get:function(){return ye.connectable}});var se=Sh;Object.defineProperty(e,"defer",{enumerable:!0,get:function(){return se.defer}});var De=Yu;Object.defineProperty(e,"empty",{enumerable:!0,get:function(){return De.empty}});var ke=Sy;Object.defineProperty(e,"forkJoin",{enumerable:!0,get:function(){return ke.forkJoin}});var We=Hu;Object.defineProperty(e,"from",{enumerable:!0,get:function(){return We.from}});var He=Py;Object.defineProperty(e,"fromEvent",{enumerable:!0,get:function(){return He.fromEvent}});var dt=Ay;Object.defineProperty(e,"fromEventPattern",{enumerable:!0,get:function(){return dt.fromEventPattern}});var yt=Iy;Object.defineProperty(e,"generate",{enumerable:!0,get:function(){return yt.generate}});var Lt=Oy;Object.defineProperty(e,"iif",{enumerable:!0,get:function(){return Lt.iif}});var pt=ng;Object.defineProperty(e,"interval",{enumerable:!0,get:function(){return pt.interval}});var Ct=Cy;Object.defineProperty(e,"merge",{enumerable:!0,get:function(){return Ct.merge}});var mt=Ax;Object.defineProperty(e,"never",{enumerable:!0,get:function(){return mt.never}});var Ye=zf;Object.defineProperty(e,"of",{enumerable:!0,get:function(){return Ye.of}});var Zt=ig;Object.defineProperty(e,"onErrorResumeNext",{enumerable:!0,get:function(){return Zt.onErrorResumeNext}});var hr=Ty;Object.defineProperty(e,"pairs",{enumerable:!0,get:function(){return hr.pairs}});var $t=My;Object.defineProperty(e,"partition",{enumerable:!0,get:function(){return $t.partition}});var yr=uh;Object.defineProperty(e,"race",{enumerable:!0,get:function(){return yr.race}});var nn=Ry;Object.defineProperty(e,"range",{enumerable:!0,get:function(){return nn.range}});var rt=Hd;Object.defineProperty(e,"throwError",{enumerable:!0,get:function(){return rt.throwError}});var Se=Al;Object.defineProperty(e,"timer",{enumerable:!0,get:function(){return Se.timer}});var ce=Dy;Object.defineProperty(e,"using",{enumerable:!0,get:function(){return ce.using}});var ge=Vf;Object.defineProperty(e,"zip",{enumerable:!0,get:function(){return ge.zip}});var Be=$d;Object.defineProperty(e,"scheduled",{enumerable:!0,get:function(){return Be.scheduled}});var Xe=Yu;Object.defineProperty(e,"EMPTY",{enumerable:!0,get:function(){return Xe.EMPTY}});var $e=Ax;Object.defineProperty(e,"NEVER",{enumerable:!0,get:function(){return $e.NEVER}}),t(PF,e);var ht=Mc;Object.defineProperty(e,"config",{enumerable:!0,get:function(){return ht.config}});var Qe=og;Object.defineProperty(e,"audit",{enumerable:!0,get:function(){return Qe.audit}});var Vt=Ny;Object.defineProperty(e,"auditTime",{enumerable:!0,get:function(){return Vt.auditTime}});var ir=Fy;Object.defineProperty(e,"buffer",{enumerable:!0,get:function(){return ir.buffer}});var it=ky;Object.defineProperty(e,"bufferCount",{enumerable:!0,get:function(){return it.bufferCount}});var Tt=By;Object.defineProperty(e,"bufferTime",{enumerable:!0,get:function(){return Tt.bufferTime}});var Nt=zy;Object.defineProperty(e,"bufferToggle",{enumerable:!0,get:function(){return Nt.bufferToggle}});var Ar=jy;Object.defineProperty(e,"bufferWhen",{enumerable:!0,get:function(){return Ar.bufferWhen}});var Ir=Uy;Object.defineProperty(e,"catchError",{enumerable:!0,get:function(){return Ir.catchError}});var Rt=$y;Object.defineProperty(e,"combineAll",{enumerable:!0,get:function(){return Rt.combineAll}});var sn=ag;Object.defineProperty(e,"combineLatestAll",{enumerable:!0,get:function(){return sn.combineLatestAll}});var un=Gy;Object.defineProperty(e,"combineLatestWith",{enumerable:!0,get:function(){return un.combineLatestWith}});var Gn=Gf;Object.defineProperty(e,"concatAll",{enumerable:!0,get:function(){return Gn.concatAll}});var rn=cg;Object.defineProperty(e,"concatMap",{enumerable:!0,get:function(){return rn.concatMap}});var qr=Vy;Object.defineProperty(e,"concatMapTo",{enumerable:!0,get:function(){return qr.concatMapTo}});var Fn=Xy;Object.defineProperty(e,"concatWith",{enumerable:!0,get:function(){return Fn.concatWith}});var Lr=Xf;Object.defineProperty(e,"connect",{enumerable:!0,get:function(){return Lr.connect}});var Et=Zy;Object.defineProperty(e,"count",{enumerable:!0,get:function(){return Et.count}});var li=Hy;Object.defineProperty(e,"debounce",{enumerable:!0,get:function(){return li.debounce}});var Le=Jy;Object.defineProperty(e,"debounceTime",{enumerable:!0,get:function(){return Le.debounceTime}});var ne=Ph;Object.defineProperty(e,"defaultIfEmpty",{enumerable:!0,get:function(){return ne.defaultIfEmpty}});var pe=Ky;Object.defineProperty(e,"delay",{enumerable:!0,get:function(){return pe.delay}});var Ie=hg;Object.defineProperty(e,"delayWhen",{enumerable:!0,get:function(){return Ie.delayWhen}});var Ne=Qy;Object.defineProperty(e,"dematerialize",{enumerable:!0,get:function(){return Ne.dematerialize}});var Ue=e_;Object.defineProperty(e,"distinct",{enumerable:!0,get:function(){return Ue.distinct}});var et=dg;Object.defineProperty(e,"distinctUntilChanged",{enumerable:!0,get:function(){return et.distinctUntilChanged}});var Ve=t_;Object.defineProperty(e,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return Ve.distinctUntilKeyChanged}});var qe=r_;Object.defineProperty(e,"elementAt",{enumerable:!0,get:function(){return qe.elementAt}});var Ke=n_;Object.defineProperty(e,"endWith",{enumerable:!0,get:function(){return Ke.endWith}});var gt=i_;Object.defineProperty(e,"every",{enumerable:!0,get:function(){return gt.every}});var vt=o_;Object.defineProperty(e,"exhaust",{enumerable:!0,get:function(){return vt.exhaust}});var ft=gg;Object.defineProperty(e,"exhaustAll",{enumerable:!0,get:function(){return ft.exhaustAll}});var Ot=mg;Object.defineProperty(e,"exhaustMap",{enumerable:!0,get:function(){return Ot.exhaustMap}});var ur=a_;Object.defineProperty(e,"expand",{enumerable:!0,get:function(){return ur.expand}});var jt=rc;Object.defineProperty(e,"filter",{enumerable:!0,get:function(){return jt.filter}});var Xt=s_;Object.defineProperty(e,"finalize",{enumerable:!0,get:function(){return Xt.finalize}});var Ht=lh;Object.defineProperty(e,"find",{enumerable:!0,get:function(){return Ht.find}});var Ur=u_;Object.defineProperty(e,"findIndex",{enumerable:!0,get:function(){return Ur.findIndex}});var $r=l_;Object.defineProperty(e,"first",{enumerable:!0,get:function(){return $r.first}});var zr=c_;Object.defineProperty(e,"groupBy",{enumerable:!0,get:function(){return zr.groupBy}});var Cr=fg;Object.defineProperty(e,"ignoreElements",{enumerable:!0,get:function(){return Cr.ignoreElements}});var Zi=h_;Object.defineProperty(e,"isEmpty",{enumerable:!0,get:function(){return Zi.isEmpty}});var Ut=f_;Object.defineProperty(e,"last",{enumerable:!0,get:function(){return Ut.last}});var Fr=Pl;Object.defineProperty(e,"map",{enumerable:!0,get:function(){return Fr.map}});var _t=pg;Object.defineProperty(e,"mapTo",{enumerable:!0,get:function(){return _t.mapTo}});var Vr=p_;Object.defineProperty(e,"materialize",{enumerable:!0,get:function(){return Vr.materialize}});var vi=d_;Object.defineProperty(e,"max",{enumerable:!0,get:function(){return vi.max}});var ii=Eh;Object.defineProperty(e,"mergeAll",{enumerable:!0,get:function(){return ii.mergeAll}});var ci=g_;Object.defineProperty(e,"flatMap",{enumerable:!0,get:function(){return ci.flatMap}});var hi=Ku;Object.defineProperty(e,"mergeMap",{enumerable:!0,get:function(){return hi.mergeMap}});var Bo=m_;Object.defineProperty(e,"mergeMapTo",{enumerable:!0,get:function(){return Bo.mergeMapTo}});var ji=v_;Object.defineProperty(e,"mergeScan",{enumerable:!0,get:function(){return ji.mergeScan}});var Qn=y_;Object.defineProperty(e,"mergeWith",{enumerable:!0,get:function(){return Qn.mergeWith}});var Eo=b_;Object.defineProperty(e,"min",{enumerable:!0,get:function(){return Eo.min}});var Xo=Yf;Object.defineProperty(e,"multicast",{enumerable:!0,get:function(){return Xo.multicast}});var Xn=bh;Object.defineProperty(e,"observeOn",{enumerable:!0,get:function(){return Xn.observeOn}});var kn=xf;Object.defineProperty(e,"onErrorResumeNextWith",{enumerable:!0,get:function(){return kn.onErrorResumeNextWith}});var Ui=x_;Object.defineProperty(e,"pairwise",{enumerable:!0,get:function(){return Ui.pairwise}});var mo=w_;Object.defineProperty(e,"pluck",{enumerable:!0,get:function(){return mo.pluck}});var zo=E_;Object.defineProperty(e,"publish",{enumerable:!0,get:function(){return zo.publish}});var Ls=S_;Object.defineProperty(e,"publishBehavior",{enumerable:!0,get:function(){return Ls.publishBehavior}});var er=P_;Object.defineProperty(e,"publishLast",{enumerable:!0,get:function(){return er.publishLast}});var Rs=A_;Object.defineProperty(e,"publishReplay",{enumerable:!0,get:function(){return Rs.publishReplay}});var $i=I_;Object.defineProperty(e,"raceWith",{enumerable:!0,get:function(){return $i.raceWith}});var ha=Dc;Object.defineProperty(e,"reduce",{enumerable:!0,get:function(){return ha.reduce}});var Rr=O_;Object.defineProperty(e,"repeat",{enumerable:!0,get:function(){return Rr.repeat}});var Ds=C_;Object.defineProperty(e,"repeatWhen",{enumerable:!0,get:function(){return Ds.repeatWhen}});var Il=T_;Object.defineProperty(e,"retry",{enumerable:!0,get:function(){return Il.retry}});var Ws=M_;Object.defineProperty(e,"retryWhen",{enumerable:!0,get:function(){return Ws.retryWhen}});var Hi=Bd;Object.defineProperty(e,"refCount",{enumerable:!0,get:function(){return Hi.refCount}});var Yo=yg;Object.defineProperty(e,"sample",{enumerable:!0,get:function(){return Yo.sample}});var Zs=L_;Object.defineProperty(e,"sampleTime",{enumerable:!0,get:function(){return Zs.sampleTime}});var Qu=R_;Object.defineProperty(e,"scan",{enumerable:!0,get:function(){return Qu.scan}});var Pt=D_;Object.defineProperty(e,"sequenceEqual",{enumerable:!0,get:function(){return Pt.sequenceEqual}});var Hs=_g;Object.defineProperty(e,"share",{enumerable:!0,get:function(){return Hs.share}});var io=N_;Object.defineProperty(e,"shareReplay",{enumerable:!0,get:function(){return io.shareReplay}});var Wo=F_;Object.defineProperty(e,"single",{enumerable:!0,get:function(){return Wo.single}});var Js=k_;Object.defineProperty(e,"skip",{enumerable:!0,get:function(){return Js.skip}});var fi=B_;Object.defineProperty(e,"skipLast",{enumerable:!0,get:function(){return fi.skipLast}});var an=z_;Object.defineProperty(e,"skipUntil",{enumerable:!0,get:function(){return an.skipUntil}});var Xr=j_;Object.defineProperty(e,"skipWhile",{enumerable:!0,get:function(){return Xr.skipWhile}});var Bn=U_;Object.defineProperty(e,"startWith",{enumerable:!0,get:function(){return Bn.startWith}});var So=xh;Object.defineProperty(e,"subscribeOn",{enumerable:!0,get:function(){return So.subscribeOn}});var Ks=$_;Object.defineProperty(e,"switchAll",{enumerable:!0,get:function(){return Ks.switchAll}});var Ci=Oh;Object.defineProperty(e,"switchMap",{enumerable:!0,get:function(){return Ci.switchMap}});var Ua=G_;Object.defineProperty(e,"switchMapTo",{enumerable:!0,get:function(){return Ua.switchMapTo}});var Ji=q_;Object.defineProperty(e,"switchScan",{enumerable:!0,get:function(){return Ji.switchScan}});var Zr=Ah;Object.defineProperty(e,"take",{enumerable:!0,get:function(){return Zr.take}});var Oa=vg;Object.defineProperty(e,"takeLast",{enumerable:!0,get:function(){return Oa.takeLast}});var Yn=V_;Object.defineProperty(e,"takeUntil",{enumerable:!0,get:function(){return Yn.takeUntil}});var Ns=X_;Object.defineProperty(e,"takeWhile",{enumerable:!0,get:function(){return Ns.takeWhile}});var Ti=Y_;Object.defineProperty(e,"tap",{enumerable:!0,get:function(){return Ti.tap}});var Yr=bg;Object.defineProperty(e,"throttle",{enumerable:!0,get:function(){return Yr.throttle}});var Mi=W_;Object.defineProperty(e,"throttleTime",{enumerable:!0,get:function(){return Mi.throttleTime}});var fa=Ih;Object.defineProperty(e,"throwIfEmpty",{enumerable:!0,get:function(){return fa.throwIfEmpty}});var wi=wf;Object.defineProperty(e,"timeInterval",{enumerable:!0,get:function(){return wi.timeInterval}});var oo=pv;Object.defineProperty(e,"timeout",{enumerable:!0,get:function(){return oo.timeout}});var Gr=Z_;Object.defineProperty(e,"timeoutWith",{enumerable:!0,get:function(){return Gr.timeoutWith}});var pa=H_;Object.defineProperty(e,"timestamp",{enumerable:!0,get:function(){return pa.timestamp}});var Wn=ug;Object.defineProperty(e,"toArray",{enumerable:!0,get:function(){return Wn.toArray}});var bu=J_;Object.defineProperty(e,"window",{enumerable:!0,get:function(){return bu.window}});var Ki=K_;Object.defineProperty(e,"windowCount",{enumerable:!0,get:function(){return Ki.windowCount}});var Zn=Q_;Object.defineProperty(e,"windowTime",{enumerable:!0,get:function(){return Zn.windowTime}});var pi=e0;Object.defineProperty(e,"windowToggle",{enumerable:!0,get:function(){return pi.windowToggle}});var Ca=t0;Object.defineProperty(e,"windowWhen",{enumerable:!0,get:function(){return Ca.windowWhen}});var Ol=r0;Object.defineProperty(e,"withLatestFrom",{enumerable:!0,get:function(){return Ol.withLatestFrom}});var Fs=n0;Object.defineProperty(e,"zipAll",{enumerable:!0,get:function(){return Fs.zipAll}});var el=i0;Object.defineProperty(e,"zipWith",{enumerable:!0,get:function(){return el.zipWith}})})(DS);var NF={exports:{}};/**
 * tingle.js - A simple modal plugin written in pure JavaScript
 * @version v0.16.0
 * @link https://github.com/robinparisi/tingle#readme
 * @license MIT
 */(function(e,r){(function(t,n){e.exports=n()})(we,function(){var t=!1;function n(B){var $={onClose:null,onOpen:null,beforeOpen:null,beforeClose:null,stickyFooter:!1,footer:!1,cssClass:[],closeLabel:"Close",closeMethods:["overlay","button","escape"]};this.opts=M({},$,B),this.init()}n.prototype.init=function(){if(!this.modal)return p.call(this),_.call(this),document.body.appendChild(this.modal,document.body.firstChild),this.opts.footer&&this.addFooter(),this},n.prototype._busy=function(B){t=B},n.prototype._isBusy=function(){return t},n.prototype.destroy=function(){this.modal!==null&&(this.isOpen()&&this.close(!0),O.call(this),this.modal.parentNode.removeChild(this.modal),this.modal=null)},n.prototype.isOpen=function(){return!!this.modal.classList.contains("tingle-modal--visible")},n.prototype.open=function(){if(!this._isBusy()){this._busy(!0);var B=this;return typeof B.opts.beforeOpen=="function"&&B.opts.beforeOpen(),this.modal.style.removeProperty?this.modal.style.removeProperty("display"):this.modal.style.removeAttribute("display"),document.getSelection().removeAllRanges(),this._scrollPosition=window.pageYOffset,document.body.classList.add("tingle-enabled"),document.body.style.top=-this._scrollPosition+"px",this.setStickyFooter(this.opts.stickyFooter),this.modal.classList.add("tingle-modal--visible"),typeof B.opts.onOpen=="function"&&B.opts.onOpen.call(B),B._busy(!1),this.checkOverflow(),this}},n.prototype.close=function(B){if(!this._isBusy()){if(this._busy(!0),typeof this.opts.beforeClose=="function"){var $=this.opts.beforeClose.call(this);if(!$){this._busy(!1);return}}document.body.classList.remove("tingle-enabled"),document.body.style.top=null,window.scrollTo({top:this._scrollPosition,behavior:"instant"}),this.modal.classList.remove("tingle-modal--visible");var q=this;q.modal.style.display="none",typeof q.opts.onClose=="function"&&q.opts.onClose.call(this),q._busy(!1)}},n.prototype.setContent=function(B){return typeof B=="string"?this.modalBoxContent.innerHTML=B:(this.modalBoxContent.innerHTML="",this.modalBoxContent.appendChild(B)),this.isOpen()&&this.checkOverflow(),this},n.prototype.getContent=function(){return this.modalBoxContent},n.prototype.addFooter=function(){return u.call(this),this},n.prototype.setFooterContent=function(B){return this.modalBoxFooter.innerHTML=B,this},n.prototype.getFooterContent=function(){return this.modalBoxFooter},n.prototype.setStickyFooter=function(B){return this.isOverflow()||(B=!1),B?this.modalBox.contains(this.modalBoxFooter)&&(this.modalBox.removeChild(this.modalBoxFooter),this.modal.appendChild(this.modalBoxFooter),this.modalBoxFooter.classList.add("tingle-modal-box__footer--sticky"),l.call(this),this.modalBoxContent.style["padding-bottom"]=this.modalBoxFooter.clientHeight+20+"px"):this.modalBoxFooter&&(this.modalBox.contains(this.modalBoxFooter)||(this.modal.removeChild(this.modalBoxFooter),this.modalBox.appendChild(this.modalBoxFooter),this.modalBoxFooter.style.width="auto",this.modalBoxFooter.style.left="",this.modalBoxContent.style["padding-bottom"]="",this.modalBoxFooter.classList.remove("tingle-modal-box__footer--sticky"))),this},n.prototype.addFooterBtn=function(B,$,q){var X=document.createElement("button");return X.innerHTML=B,X.addEventListener("click",q),typeof $=="string"&&$.length&&$.split(" ").forEach(function(R){X.classList.add(R)}),this.modalBoxFooter.appendChild(X),X},n.prototype.resize=function(){},n.prototype.isOverflow=function(){var B=window.innerHeight,$=this.modalBox.clientHeight;return $>=B},n.prototype.checkOverflow=function(){this.modal.classList.contains("tingle-modal--visible")&&(this.isOverflow()?this.modal.classList.add("tingle-modal--overflow"):this.modal.classList.remove("tingle-modal--overflow"),!this.isOverflow()&&this.opts.stickyFooter?this.setStickyFooter(!1):this.isOverflow()&&this.opts.stickyFooter&&(l.call(this),this.setStickyFooter(!0)))};function i(){return'<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.3 9.7c.2.2.4.3.7.3.3 0 .5-.1.7-.3L5 6.4l3.3 3.3c.2.2.5.3.7.3.2 0 .5-.1.7-.3.4-.4.4-1 0-1.4L6.4 5l3.3-3.3c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0L5 3.6 1.7.3C1.3-.1.7-.1.3.3c-.4.4-.4 1 0 1.4L3.6 5 .3 8.3c-.4.4-.4 1 0 1.4z" fill="#000" fill-rule="nonzero"/></svg>'}function l(){this.modalBoxFooter&&(this.modalBoxFooter.style.width=this.modalBox.clientWidth+"px",this.modalBoxFooter.style.left=this.modalBox.offsetLeft+"px")}function p(){this.modal=document.createElement("div"),this.modal.classList.add("tingle-modal"),(this.opts.closeMethods.length===0||this.opts.closeMethods.indexOf("overlay")===-1)&&this.modal.classList.add("tingle-modal--noOverlayClose"),this.modal.style.display="none",this.opts.cssClass.forEach(function(B){typeof B=="string"&&this.modal.classList.add(B)},this),this.opts.closeMethods.indexOf("button")!==-1&&(this.modalCloseBtn=document.createElement("button"),this.modalCloseBtn.type="button",this.modalCloseBtn.classList.add("tingle-modal__close"),this.modalCloseBtnIcon=document.createElement("span"),this.modalCloseBtnIcon.classList.add("tingle-modal__closeIcon"),this.modalCloseBtnIcon.innerHTML=i(),this.modalCloseBtnLabel=document.createElement("span"),this.modalCloseBtnLabel.classList.add("tingle-modal__closeLabel"),this.modalCloseBtnLabel.innerHTML=this.opts.closeLabel,this.modalCloseBtn.appendChild(this.modalCloseBtnIcon),this.modalCloseBtn.appendChild(this.modalCloseBtnLabel)),this.modalBox=document.createElement("div"),this.modalBox.classList.add("tingle-modal-box"),this.modalBoxContent=document.createElement("div"),this.modalBoxContent.classList.add("tingle-modal-box__content"),this.modalBox.appendChild(this.modalBoxContent),this.opts.closeMethods.indexOf("button")!==-1&&this.modal.appendChild(this.modalCloseBtn),this.modal.appendChild(this.modalBox)}function u(){this.modalBoxFooter=document.createElement("div"),this.modalBoxFooter.classList.add("tingle-modal-box__footer"),this.modalBox.appendChild(this.modalBoxFooter)}function _(){this._events={clickCloseBtn:this.close.bind(this),clickOverlay:S.bind(this),resize:this.checkOverflow.bind(this),keyboardNav:m.bind(this)},this.opts.closeMethods.indexOf("button")!==-1&&this.modalCloseBtn.addEventListener("click",this._events.clickCloseBtn),this.modal.addEventListener("mousedown",this._events.clickOverlay),window.addEventListener("resize",this._events.resize),document.addEventListener("keydown",this._events.keyboardNav)}function m(B){this.opts.closeMethods.indexOf("escape")!==-1&&B.which===27&&this.isOpen()&&this.close()}function S(B){var $=this.modal.offsetWidth-this.modal.clientWidth,q=B.clientX>=this.modal.offsetWidth-15,X=this.modal.scrollHeight!==this.modal.offsetHeight;navigator.platform==="MacIntel"&&$===0&&q&&X||this.opts.closeMethods.indexOf("overlay")!==-1&&!P(B.target,"tingle-modal")&&B.clientX<this.modal.clientWidth&&this.close()}function P(B,$){for(;(B=B.parentElement)&&!B.classList.contains($););return B}function O(){this.opts.closeMethods.indexOf("button")!==-1&&this.modalCloseBtn.removeEventListener("click",this._events.clickCloseBtn),this.modal.removeEventListener("mousedown",this._events.clickOverlay),window.removeEventListener("resize",this._events.resize),document.removeEventListener("keydown",this._events.keyboardNav)}function M(){for(var B=1;B<arguments.length;B++)for(var $ in arguments[B])arguments[B].hasOwnProperty($)&&(arguments[0][$]=arguments[B][$]);return arguments[0]}return{modal:n}})})(NF);var Yle=NF.exports,_l={},a0=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(_l,"__esModule",{value:!0});_l.PolygonTitlesLineLayer=_l.PolygonTitlesLayer=_l.PolygonIconsLayer=_l.PolygonsLayer=void 0;var $T=bc,db=_c,Jp=xc,Wle=function(e){a0(r,e);function r(t){var n=e.call(this,t)||this;return n.id="shop-custom",n.type="fill-extrusion",n.minzoom=t.minZoom,n.maxzoom=t.maxZoom,n.source="main",n.filter=["all",["==",["get","type",["get","_dynamic"]],"shop-custom"],["==",["to-number",["get","level"]],0]],n.paint=new $T.PaintProperties({"fill-extrusion-height":["case",["boolean",["feature-state","selected"],!1],t.selectedPolygonHeight,["boolean",["feature-state","hover"],!1],t.hoverPolygonHeight,["boolean",["feature-state","active"],!1],t.hoverPolygonHeight,t.defaultPolygonHeight],"fill-extrusion-base":t.base,"fill-extrusion-opacity":t.opacity,"fill-extrusion-color":["case",["boolean",["feature-state","selected"],!1],t.selectedPolygonColor,["boolean",["feature-state","hover"],!1],t.hoverPolygonColor,["boolean",["feature-state","active"],!1],t.hoverPolygonColor,["boolean",["feature-state","disabled"],!1],"#8a8a8a",t.defaultPolygonColor]}),n}return r}($T.default);_l.PolygonsLayer=Wle;var Zle=function(e){a0(r,e);function r(t){var n=e.call(this,t)||this;return n.id="poi-custom-icons",n.type="symbol",n.minzoom=t.minZoom,n.maxzoom=t.maxZoom,n.source="main",n.filter=["all",["==",["get","type",["get","_dynamic"]],"poi-custom"],["any",["all",["!",["has","icon_only"]],["!",["has","text_only"]]],["all",["has","icon_only"],["==",["get","icon_only"],!0]],["all",["has","icon_only"],["has","text_only"],["==",["get","text_only"],!1],["==",["get","icon_only"],!1]]],["==",["to-number",["get","level"]],0]],n.layout=new Jp.LayoutProperties({"icon-image":"{amenity}","icon-size":["interpolate",["exponential",.5],["zoom"],17,.1,22,.5],"text-anchor":"top","text-offset":[0,2],"text-font":["Open Sans Regular"],"text-size":14,"symbol-placement":"point","icon-allow-overlap":!0,"text-allow-overlap":!0,visibility:!1}),n}return r}(Jp.default);_l.PolygonIconsLayer=Zle;var Hle=function(e){a0(r,e);function r(t){var n=e.call(this,t)||this;return n.id="shop-labels",n.type="symbol",n.minzoom=t.minZoom,n.maxzoom=t.maxZoom,n.source="main",n.filter=["all",["==",["get","type",["get","_dynamic"]],"shop-label"],["==",["to-number",["get","level"]],0]],n.layout=new Jp.LayoutProperties({"symbol-placement":t.symbolPlacement,"text-anchor":"top","text-ignore-placement":!0,"text-allow-overlap":!0,"text-field":"{title}","text-font":t.textFont,"text-size":t.labelFontSize,"text-letter-spacing":.005,"text-max-width":7}),n.paint=new Jp.PaintProperties({"text-color":["case",["boolean",["feature-state","selected"],!1],t.selectedLabelColor,["boolean",["feature-state","hover"],!1],t.hoverLabelColor,t.defaultLabelColor]}),n}return r}(Jp.default);_l.PolygonTitlesLayer=Hle;var Jle=function(e){a0(r,e);function r(t){var n=e.call(this,t)||this;return n.id="shop-labels-line",n.type="line",n.minzoom=t.minZoom,n.maxzoom=t.maxZoom,n.source="main",n.filter=["all",["==",["get","type",["get","_dynamic"]],"shop-label"],["==",["to-number",["get","level"]],0]],n.layout=new db.LayoutProperties({"line-join":"round","line-cap":"round"}),n.paint=new db.PaintProperties({"line-color":"#000","line-width":3}),n}return r}(db.default);_l.PolygonTitlesLineLayer=Jle;var jS={};Object.defineProperty(jS,"__esModule",{value:!0});var Kle=Wu,Qle=function(){function e(r){this.id=r.id?r.id:(0,Kle.uuidv4)(),this.lat=r.lat,this.lng=r.lng,this.level=r.level}return e.prototype.updatePosition=function(r){this.lat=r.lat,this.lng=r.lng,this.level=r.level},e}();jS.default=Qle;var US={},$S={},vm,ece=new Uint8Array(16);function FF(){if(!vm&&(vm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!vm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vm(ece)}const tce=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function s0(e){return typeof e=="string"&&tce.test(e)}var ka=[];for(var gb=0;gb<256;++gb)ka.push((gb+256).toString(16).substr(1));function u0(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(ka[e[r+0]]+ka[e[r+1]]+ka[e[r+2]]+ka[e[r+3]]+"-"+ka[e[r+4]]+ka[e[r+5]]+"-"+ka[e[r+6]]+ka[e[r+7]]+"-"+ka[e[r+8]]+ka[e[r+9]]+"-"+ka[e[r+10]]+ka[e[r+11]]+ka[e[r+12]]+ka[e[r+13]]+ka[e[r+14]]+ka[e[r+15]]).toLowerCase();if(!s0(t))throw TypeError("Stringified UUID is invalid");return t}var GT,mb,vb=0,yb=0;function rce(e,r,t){var n=r&&t||0,i=r||new Array(16);e=e||{};var l=e.node||GT,p=e.clockseq!==void 0?e.clockseq:mb;if(l==null||p==null){var u=e.random||(e.rng||FF)();l==null&&(l=GT=[u[0]|1,u[1],u[2],u[3],u[4],u[5]]),p==null&&(p=mb=(u[6]<<8|u[7])&16383)}var _=e.msecs!==void 0?e.msecs:Date.now(),m=e.nsecs!==void 0?e.nsecs:yb+1,S=_-vb+(m-yb)/1e4;if(S<0&&e.clockseq===void 0&&(p=p+1&16383),(S<0||_>vb)&&e.nsecs===void 0&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");vb=_,yb=m,mb=p,_+=122192928e5;var P=((_&268435455)*1e4+m)%4294967296;i[n++]=P>>>24&255,i[n++]=P>>>16&255,i[n++]=P>>>8&255,i[n++]=P&255;var O=_/4294967296*1e4&268435455;i[n++]=O>>>8&255,i[n++]=O&255,i[n++]=O>>>24&15|16,i[n++]=O>>>16&255,i[n++]=p>>>8|128,i[n++]=p&255;for(var M=0;M<6;++M)i[n+M]=l[M];return r||u0(i)}function kF(e){if(!s0(e))throw TypeError("Invalid UUID");var r,t=new Uint8Array(16);return t[0]=(r=parseInt(e.slice(0,8),16))>>>24,t[1]=r>>>16&255,t[2]=r>>>8&255,t[3]=r&255,t[4]=(r=parseInt(e.slice(9,13),16))>>>8,t[5]=r&255,t[6]=(r=parseInt(e.slice(14,18),16))>>>8,t[7]=r&255,t[8]=(r=parseInt(e.slice(19,23),16))>>>8,t[9]=r&255,t[10]=(r=parseInt(e.slice(24,36),16))/1099511627776&255,t[11]=r/4294967296&255,t[12]=r>>>24&255,t[13]=r>>>16&255,t[14]=r>>>8&255,t[15]=r&255,t}function nce(e){e=unescape(encodeURIComponent(e));for(var r=[],t=0;t<e.length;++t)r.push(e.charCodeAt(t));return r}var ice="6ba7b810-9dad-11d1-80b4-00c04fd430c8",oce="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function BF(e,r,t){function n(i,l,p,u){if(typeof i=="string"&&(i=nce(i)),typeof l=="string"&&(l=kF(l)),l.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var _=new Uint8Array(16+i.length);if(_.set(l),_.set(i,l.length),_=t(_),_[6]=_[6]&15|r,_[8]=_[8]&63|128,p){u=u||0;for(var m=0;m<16;++m)p[u+m]=_[m];return p}return u0(_)}try{n.name=e}catch{}return n.DNS=ice,n.URL=oce,n}function ace(e){if(typeof e=="string"){var r=unescape(encodeURIComponent(e));e=new Uint8Array(r.length);for(var t=0;t<r.length;++t)e[t]=r.charCodeAt(t)}return sce(uce(lce(e),e.length*8))}function sce(e){for(var r=[],t=e.length*32,n="0123456789abcdef",i=0;i<t;i+=8){var l=e[i>>5]>>>i%32&255,p=parseInt(n.charAt(l>>>4&15)+n.charAt(l&15),16);r.push(p)}return r}function zF(e){return(e+64>>>9<<4)+14+1}function uce(e,r){e[r>>5]|=128<<r%32,e[zF(r)-1]=r;for(var t=1732584193,n=-271733879,i=-1732584194,l=271733878,p=0;p<e.length;p+=16){var u=t,_=n,m=i,S=l;t=ss(t,n,i,l,e[p],7,-680876936),l=ss(l,t,n,i,e[p+1],12,-389564586),i=ss(i,l,t,n,e[p+2],17,606105819),n=ss(n,i,l,t,e[p+3],22,-1044525330),t=ss(t,n,i,l,e[p+4],7,-176418897),l=ss(l,t,n,i,e[p+5],12,1200080426),i=ss(i,l,t,n,e[p+6],17,-1473231341),n=ss(n,i,l,t,e[p+7],22,-45705983),t=ss(t,n,i,l,e[p+8],7,1770035416),l=ss(l,t,n,i,e[p+9],12,-1958414417),i=ss(i,l,t,n,e[p+10],17,-42063),n=ss(n,i,l,t,e[p+11],22,-1990404162),t=ss(t,n,i,l,e[p+12],7,1804603682),l=ss(l,t,n,i,e[p+13],12,-40341101),i=ss(i,l,t,n,e[p+14],17,-1502002290),n=ss(n,i,l,t,e[p+15],22,1236535329),t=us(t,n,i,l,e[p+1],5,-165796510),l=us(l,t,n,i,e[p+6],9,-1069501632),i=us(i,l,t,n,e[p+11],14,643717713),n=us(n,i,l,t,e[p],20,-373897302),t=us(t,n,i,l,e[p+5],5,-701558691),l=us(l,t,n,i,e[p+10],9,38016083),i=us(i,l,t,n,e[p+15],14,-660478335),n=us(n,i,l,t,e[p+4],20,-405537848),t=us(t,n,i,l,e[p+9],5,568446438),l=us(l,t,n,i,e[p+14],9,-1019803690),i=us(i,l,t,n,e[p+3],14,-187363961),n=us(n,i,l,t,e[p+8],20,1163531501),t=us(t,n,i,l,e[p+13],5,-1444681467),l=us(l,t,n,i,e[p+2],9,-51403784),i=us(i,l,t,n,e[p+7],14,1735328473),n=us(n,i,l,t,e[p+12],20,-1926607734),t=ls(t,n,i,l,e[p+5],4,-378558),l=ls(l,t,n,i,e[p+8],11,-2022574463),i=ls(i,l,t,n,e[p+11],16,1839030562),n=ls(n,i,l,t,e[p+14],23,-35309556),t=ls(t,n,i,l,e[p+1],4,-1530992060),l=ls(l,t,n,i,e[p+4],11,1272893353),i=ls(i,l,t,n,e[p+7],16,-155497632),n=ls(n,i,l,t,e[p+10],23,-1094730640),t=ls(t,n,i,l,e[p+13],4,681279174),l=ls(l,t,n,i,e[p],11,-358537222),i=ls(i,l,t,n,e[p+3],16,-722521979),n=ls(n,i,l,t,e[p+6],23,76029189),t=ls(t,n,i,l,e[p+9],4,-640364487),l=ls(l,t,n,i,e[p+12],11,-421815835),i=ls(i,l,t,n,e[p+15],16,530742520),n=ls(n,i,l,t,e[p+2],23,-995338651),t=cs(t,n,i,l,e[p],6,-198630844),l=cs(l,t,n,i,e[p+7],10,1126891415),i=cs(i,l,t,n,e[p+14],15,-1416354905),n=cs(n,i,l,t,e[p+5],21,-57434055),t=cs(t,n,i,l,e[p+12],6,1700485571),l=cs(l,t,n,i,e[p+3],10,-1894986606),i=cs(i,l,t,n,e[p+10],15,-1051523),n=cs(n,i,l,t,e[p+1],21,-2054922799),t=cs(t,n,i,l,e[p+8],6,1873313359),l=cs(l,t,n,i,e[p+15],10,-30611744),i=cs(i,l,t,n,e[p+6],15,-1560198380),n=cs(n,i,l,t,e[p+13],21,1309151649),t=cs(t,n,i,l,e[p+4],6,-145523070),l=cs(l,t,n,i,e[p+11],10,-1120210379),i=cs(i,l,t,n,e[p+2],15,718787259),n=cs(n,i,l,t,e[p+9],21,-343485551),t=vc(t,u),n=vc(n,_),i=vc(i,m),l=vc(l,S)}return[t,n,i,l]}function lce(e){if(e.length===0)return[];for(var r=e.length*8,t=new Uint32Array(zF(r)),n=0;n<r;n+=8)t[n>>5]|=(e[n/8]&255)<<n%32;return t}function vc(e,r){var t=(e&65535)+(r&65535),n=(e>>16)+(r>>16)+(t>>16);return n<<16|t&65535}function cce(e,r){return e<<r|e>>>32-r}function l0(e,r,t,n,i,l){return vc(cce(vc(vc(r,e),vc(n,l)),i),t)}function ss(e,r,t,n,i,l,p){return l0(r&t|~r&n,e,r,i,l,p)}function us(e,r,t,n,i,l,p){return l0(r&n|t&~n,e,r,i,l,p)}function ls(e,r,t,n,i,l,p){return l0(r^t^n,e,r,i,l,p)}function cs(e,r,t,n,i,l,p){return l0(t^(r|~n),e,r,i,l,p)}var hce=BF("v3",48,ace);const fce=hce;function pce(e,r,t){e=e||{};var n=e.random||(e.rng||FF)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var i=0;i<16;++i)r[t+i]=n[i];return r}return u0(n)}function dce(e,r,t,n){switch(e){case 0:return r&t^~r&n;case 1:return r^t^n;case 2:return r&t^r&n^t&n;case 3:return r^t^n}}function _b(e,r){return e<<r|e>>>32-r}function gce(e){var r=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){var n=unescape(encodeURIComponent(e));e=[];for(var i=0;i<n.length;++i)e.push(n.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var l=e.length/4+2,p=Math.ceil(l/16),u=new Array(p),_=0;_<p;++_){for(var m=new Uint32Array(16),S=0;S<16;++S)m[S]=e[_*64+S*4]<<24|e[_*64+S*4+1]<<16|e[_*64+S*4+2]<<8|e[_*64+S*4+3];u[_]=m}u[p-1][14]=(e.length-1)*8/Math.pow(2,32),u[p-1][14]=Math.floor(u[p-1][14]),u[p-1][15]=(e.length-1)*8&4294967295;for(var P=0;P<p;++P){for(var O=new Uint32Array(80),M=0;M<16;++M)O[M]=u[P][M];for(var B=16;B<80;++B)O[B]=_b(O[B-3]^O[B-8]^O[B-14]^O[B-16],1);for(var $=t[0],q=t[1],X=t[2],R=t[3],k=t[4],U=0;U<80;++U){var H=Math.floor(U/20),ue=_b($,5)+dce(H,q,X,R)+k+r[H]+O[U]>>>0;k=R,R=X,X=_b(q,30)>>>0,q=$,$=ue}t[0]=t[0]+$>>>0,t[1]=t[1]+q>>>0,t[2]=t[2]+X>>>0,t[3]=t[3]+R>>>0,t[4]=t[4]+k>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var mce=BF("v5",80,gce);const vce=mce,yce="00000000-0000-0000-0000-000000000000";function _ce(e){if(!s0(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}const bce=Object.freeze(Object.defineProperty({__proto__:null,NIL:yce,parse:kF,stringify:u0,v1:rce,v3:fce,v4:pce,v5:vce,validate:s0,version:_ce},Symbol.toStringTag,{value:"Module"})),xce=Ef(bce);Object.defineProperty($S,"__esModule",{value:!0});var bb=xce,wce=function(){function e(r){this.id=r.id?r.id:"".concat((0,bb.v4)(),":").concat((0,bb.v4)()),this.organization_id=r.organization_id,this.organization_name=r.organization_name,this.visitor_id=r.visitor_id?r.visitor_id:(0,bb.v4)(),this.createdAt=r.createdAt?r.createdAt:new Date}return e}();$S.default=wce;var Ece=we&&we.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(n[l]=i[l])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Sce=we&&we.__awaiter||function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(p){p(l)})}return new(t||(t=Promise))(function(l,p){function u(S){try{m(n.next(S))}catch(P){p(P)}}function _(S){try{m(n.throw(S))}catch(P){p(P)}}function m(S){S.done?l(S.value):i(S.value).then(u,_)}m((n=n.apply(e,r||[])).next())})},Pce=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;p&&(p=0,m[0]&&(t=0)),t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(US,"__esModule",{value:!0});var Ace=Wu,Ice=$S,Oce=function(e){Ece(r,e);function r(t){var n=e.call(this,t)||this;return n.startLngLat=t.startLngLat,n.startLevel=t.startLevel,n.startSegmentId=t.startSegmentId,n.startSegmentName=t.startSegmentName,n.startGeofenceId=t.startGeofenceId,n.startGeofenceName=t.startGeofenceName,n.destinationFeatureId=t.destinationFeatureId,n.destinationName=t.destinationName,n.destinationLngLat=t.destinationLngLat,n.destinationLevel=t.destinationLevel,n.foundPath=t.foundPath,n.optionAvoidBarrier=t.optionAvoidBarrier,n.optionAvoidElevators=t.optionAvoidElevators,n.optionAvoidEscalators=t.optionAvoidEscalators,n.optionAvoidNarrowPaths=t.optionAvoidNarrowPaths,n.optionAvoidRamps=t.optionAvoidRamps,n.optionAvoidStaircases=t.optionAvoidStaircases,n.optionAvoidTicketGates=t.optionAvoidTicketGates,n.route=t.route,n.rerouted=t.rerouted,n}return r.prototype.save=function(){return Sce(this,void 0,void 0,function(){var t;return Pce(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Ace.axios.post("v6/geo/wayfinding_logs",[this])];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),[3,3];case 3:return[2]}})})},r}(Ice.default);US.default=Oce;var c0={};Object.defineProperty(c0,"__esModule",{value:!0});c0.translations=void 0;c0.translations={en:{ELEVATOR:"Elevator",ESCALATOR:"Escalator",STAIRS:"Stairs",RAMP:"Ramp",UP:"up",DOWN:"down",TO_FLOOR:"to floor"},fi:{ELEVATOR:"Hissi",ESCALATOR:"Liukuportaat",STAIRS:"Portaat",RAMP:"Luiska",UP:"ylös",DOWN:"alas",TO_FLOOR:"kerrokseen"},ar:{ELEVATOR:"المصعد",ESCALATOR:"السلم الكهربائي",STAIRS:"الدرج",RAMP:"المنحدر",UP:"صعوداً",DOWN:"هبوطاً",TO_FLOOR:"إلى الطابق"},it:{ELEVATOR:"Ascensore",ESCALATOR:"Scala mobile",STAIRS:"Scale",RAMP:"Rampa",UP:"su",DOWN:"giù",TO_FLOOR:"al piano"}};var qT;function jF(){return qT||(qT=1,function(e){var r=we&&we.__assign||function(){return r=Object.assign||function(Pe){for(var V,Q=1,he=arguments.length;Q<he;Q++){V=arguments[Q];for(var fe in V)Object.prototype.hasOwnProperty.call(V,fe)&&(Pe[fe]=V[fe])}return Pe},r.apply(this,arguments)},t=we&&we.__awaiter||function(Pe,V,Q,he){function fe(ye){return ye instanceof Q?ye:new Q(function(se){se(ye)})}return new(Q||(Q=Promise))(function(ye,se){function De(He){try{We(he.next(He))}catch(dt){se(dt)}}function ke(He){try{We(he.throw(He))}catch(dt){se(dt)}}function We(He){He.done?ye(He.value):fe(He.value).then(De,ke)}We((he=he.apply(Pe,V||[])).next())})},n=we&&we.__generator||function(Pe,V){var Q={label:0,sent:function(){if(ye[0]&1)throw ye[1];return ye[1]},trys:[],ops:[]},he,fe,ye,se;return se={next:De(0),throw:De(1),return:De(2)},typeof Symbol=="function"&&(se[Symbol.iterator]=function(){return this}),se;function De(We){return function(He){return ke([We,He])}}function ke(We){if(he)throw new TypeError("Generator is already executing.");for(;se&&(se=0,We[0]&&(Q=0)),Q;)try{if(he=1,fe&&(ye=We[0]&2?fe.return:We[0]?fe.throw||((ye=fe.return)&&ye.call(fe),0):fe.next)&&!(ye=ye.call(fe,We[1])).done)return ye;switch(fe=0,ye&&(We=[We[0]&2,ye.value]),We[0]){case 0:case 1:ye=We;break;case 4:return Q.label++,{value:We[1],done:!1};case 5:Q.label++,fe=We[1],We=[0];continue;case 7:We=Q.ops.pop(),Q.trys.pop();continue;default:if(ye=Q.trys,!(ye=ye.length>0&&ye[ye.length-1])&&(We[0]===6||We[0]===2)){Q=0;continue}if(We[0]===3&&(!ye||We[1]>ye[0]&&We[1]<ye[3])){Q.label=We[1];break}if(We[0]===6&&Q.label<ye[1]){Q.label=ye[1],ye=We;break}if(ye&&Q.label<ye[2]){Q.label=ye[2],Q.ops.push(We);break}ye[2]&&Q.ops.pop(),Q.trys.pop();continue}We=V.call(Pe,Q)}catch(He){We=[6,He],fe=0}finally{he=ye=0}if(We[0]&5)throw We[1];return{value:We[0]?We[1]:void 0,done:!0}}},i=we&&we.__spreadArray||function(Pe,V,Q){if(Q||arguments.length===2)for(var he=0,fe=V.length,ye;he<fe;he++)(ye||!(he in V))&&(ye||(ye=Array.prototype.slice.call(V,0,he)),ye[he]=V[he]);return Pe.concat(ye||Array.prototype.slice.call(V))};Object.defineProperty(e,"__esModule",{value:!0}),e.Map=e.globalState=void 0;var l=cM,p=LZ(),u=Ox,_=PS(),m=dd,S=gd,P=vv,O=AS,M=OS,B=Ts,$=CS,q=LS,X=RS,R=Wu,k=ZN,U=Pf,H=pd,ue=DS,ie=vd,ee=Yle,W=gu,J=_l,be=jS,Oe=zt,Ae=US,ae=c0;e.globalState={initializing:!0,floor:new S.FloorModel({}),floors:[],place:new m.PlaceModel({}),places:[],style:new P.default({}),styles:[],amenities:[],features:new B.FeatureCollection({}),dynamicFeatures:new B.FeatureCollection({}),allFeatures:new B.FeatureCollection({}),latitude:0,longitude:0,loadingRoute:!1,noPlaces:!1,textNavigation:null,persons:[],user:null};var ct=function(){function Pe(V){var Q=this;this.geojsonSource=new O.default(new B.FeatureCollection({})),this.syntheticSource=new M.default(new B.FeatureCollection({})),this.routingSource=new $.default,this.clusterSource=new q.default,this.imageSourceManager=new X.default,this.onMapReadyListener=new ue.Subject,this.onPlaceSelectListener=new ue.Subject,this.onFloorSelectListener=new ue.Subject,this.onRouteFoundListener=new ue.Subject,this.onRouteFailedListener=new ue.Subject,this.onRouteCancelListener=new ue.Subject,this.onFeatureAddListener=new ue.Subject,this.onFeatureUpdateListener=new ue.Subject,this.onFeatureDeleteListener=new ue.Subject,this.onPolygonClickListener=new ue.Subject,this.onPoiClickListener=new ue.Subject,this.onPersonUpdateListener=new ue.Subject,this.onStepSetListener=new ue.Subject,this.defaultOptions={selector:"proximiioMap",allowNewFeatureModal:!1,newFeatureModalEvent:"click",enableTBTNavigation:!0,zoomIntoPlace:!0,isKiosk:!1,initPolygons:!1,polygonsOptions:{defaultPolygonColor:"#dbd7e8",hoverPolygonColor:"#a58dfa",selectedPolygonColor:"#6945ed",defaultLabelColor:"#6945ed",hoverLabelColor:"#fff",selectedLabelColor:"#fff",defaultPolygonHeight:3,hoverPolygonHeight:3,selectedPolygonHeight:3,base:0,opacity:1,removeOriginalPolygonsLayer:!0,minZoom:17,maxZoom:24,labelFontSize:["interpolate",["exponential",1.75],["zoom"],18,["interpolate",["linear"],["/",["get","length",["get","_dynamic"]],["length",["get","title"]]],1,5,5,10,10,20,15,30],22,["interpolate",["linear"],["/",["get","length",["get","_dynamic"]],["length",["get","title"]]],1,30,5,50,10,60,15,70]],textFont:["Amiri Bold"],symbolPlacement:"line-center",autoLabelLines:!0},considerVisibilityParam:!0,fitBoundsPadding:250,minFitBoundsDistance:15,showLevelDirectionIcon:!1,showRasterFloorplans:!1,animatedRoute:!1,animationLooping:!0,routeAnimation:{enabled:!1,type:"dash",looping:!0,followRoute:!0,durationMultiplier:30,fps:120,pointColor:"#1d8a9f",pointRadius:8,lineColor:"#6945ed",lineWidth:5,lineOpacity:.6},useRasterTiles:!1,handleUrlParams:!1,urlParams:{startFeauture:"startFeature",destinationFeature:"destinationFeature",defaultPlace:"defaultPlace"},useGpsLocation:!1,geolocationControlOptions:{autoTrigger:!0,autoLocate:!0,position:"top-right"},language:"en",routeWithDetails:!0,blockFeatureClickWhileRouting:!1,useTimerangeData:!1,sendAnalytics:!0},this.showStartPoint=!1,this.amenityIds=[],this.filteredFeatures=[],this.hiddenFeatures=[],this.filteredAmenities=[],this.amenityFilters=[],this.hiddenAmenities=[],this.amenityCategories={},this.currentStep=0,this.step=0,this.animateRoute=function(){var se;if(Q.routingSource&&Q.routingSource.route&&Q.routingSource.route["path-part-".concat(Q.currentStep)]){var De=Q.routingSource.route["path-part-".concat(Q.currentStep)]&&((se=Q.routingSource.route["path-part-".concat(Q.currentStep)].properties)===null||se===void 0?void 0:se.level)===Q.state.floor.level?Q.routingSource.route["path-part-".concat(Q.currentStep)]:(0,Oe.lineString)(Q.routingSource.levelPoints[Q.state.floor.level].map(function(yr){return yr.geometry.coordinates}));if(Q.defaultOptions.routeAnimation.type==="point"){clearInterval(Q.animationInterval),clearTimeout(Q.animationTimeout);var ke=ie.length(De)*1e3,We=1.4,He=ke/We,dt=Q.defaultOptions.routeAnimation.durationMultiplier,yt=Q.defaultOptions.routeAnimation.duration?Q.defaultOptions.routeAnimation.duration:He*(1/dt),Lt=Q.defaultOptions.routeAnimation.fps,pt=Math.round(Lt*yt),Ct=ie.length(De),mt=Ct/pt,Ye=yt/pt*1e3,Zt=0;Q.animationInterval=setInterval(function(){Q.updateData(De,mt,Zt,pt),Zt===pt+1?clearInterval(Q.animationInterval):Zt+=1},Ye)}if(Q.defaultOptions.routeAnimation.type==="dash"){var hr=[[0,4,3],[.5,4,2.5],[1,4,2],[1.5,4,1.5],[2,4,1],[2.5,4,.5],[3,4,0],[0,.5,3,3.5],[0,1,3,3],[0,1.5,3,2.5],[0,2,3,2],[0,2.5,3,1.5],[0,3,3,1],[0,3.5,3,.5]];Q.map.getSource("lineAlong").setData(De);var $t=function(yr){var nn=Math.floor(yr/50%hr.length);nn!==Q.step&&(Q.map.setPaintProperty("line-dashed","line-dasharray",hr[Q.step]),Q.step=nn),requestAnimationFrame($t)};requestAnimationFrame($t)}}},this.updateData=function(se,De,ke,We){var He=!1,dt=De*ke,yt=ie.along(se,dt),Lt=ie.lineSplit(se,yt).features[0];Q.map.getSource("pointAlong").setData(yt),Q.map.getSource("lineAlong").setData(Lt),Q.defaultOptions.routeAnimation.followRoute&&!He&&(He=!0,setTimeout(function(){Q.map.jumpTo({center:yt.geometry.coordinates}),He=!1},100)),ke===We&&Q.defaultOptions.routeAnimation.looping&&(Q.animationTimeout=setTimeout(function(){Q.animateRoute()},2e3))},V.isKiosk&&V.mapboxOptions&&V.kioskSettings&&!V.mapboxOptions.center&&(V.mapboxOptions.center=V.kioskSettings.coordinates);var he=r(r({},this.defaultOptions.urlParams),V.urlParams),fe=r(r({},this.defaultOptions.polygonsOptions),V.polygonsOptions),ye=r(r({},this.defaultOptions.routeAnimation),V.routeAnimation);if(this.defaultOptions=r(r({},this.defaultOptions),V),this.defaultOptions.urlParams=he,this.defaultOptions.polygonsOptions=fe,this.defaultOptions.routeAnimation=ye,this.state=e.globalState,this.defaultOptions.isKiosk&&this.defaultOptions.useGpsLocation)throw new Error("It's not possible to use both isKiosk and useGpsLocation options as enabled!");l.getRTLTextPluginStatus()!=="loaded"&&l.setRTLTextPlugin("https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.min.js",null,!0),this.map=new l.Map(r(r({},this.defaultOptions.mapboxOptions),{container:this.defaultOptions.selector?this.defaultOptions.selector:"map"})),this.map.on("load",function(se){Q.onMapReady(se)}),this.onSourceChange=this.onSourceChange.bind(this),this.onSyntheticChange=this.onSyntheticChange.bind(this),this.onStyleChange=this.onStyleChange.bind(this),this.onStyleSelect=this.onStyleSelect.bind(this),this.onRouteUpdate=this.onRouteUpdate.bind(this),this.onRouteChange=this.onRouteChange.bind(this),this.onRouteCancel=this.onRouteCancel.bind(this),this.initialize()}return Pe.prototype.initialize=function(){return t(this,void 0,void 0,function(){return n(this,function(V){switch(V.label){case 0:return this.geojsonSource.on(this.onSourceChange),this.syntheticSource.on(this.onSyntheticChange),this.routingSource.on(this.onRouteChange),[4,this.fetch()];case 1:return V.sent(),[2]}})})},Pe.prototype.cancelObservers=function(){return t(this,void 0,void 0,function(){return n(this,function(V){return this.geojsonSource.off(this.onSourceChange),this.syntheticSource.off(this.onSyntheticChange),this.state.style.off(this.onStyleChange),[2]})})},Pe.prototype.fetch=function(){var V,Q,he;return t(this,void 0,void 0,function(){var fe,ye,se,De,ke,We,He,dt,yt,Lt,pt,Ct,mt,Ye,Zt=this;return n(this,function(hr){switch(hr.label){case 0:return fe=null,this.defaultOptions.handleUrlParams&&(ye=new URLSearchParams(window.location.search),fe=ye.get(this.defaultOptions.urlParams.defaultPlace)),[4,p.default.getPackage({initPolygons:this.defaultOptions.initPolygons,autoLabelLines:this.defaultOptions.polygonsOptions.autoLabelLines,amenityIdProperty:this.defaultOptions.amenityIdProperty,hiddenAmenities:this.defaultOptions.hiddenAmenities,useTimerangeData:this.defaultOptions.useTimerangeData,filter:this.defaultOptions.defaultFilter,featuresMaxBounds:this.defaultOptions.featuresMaxBounds})];case 1:return se=hr.sent(),De=se.places,ke=se.style,We=se.styles,He=se.features,dt=se.amenities,yt=He.features.filter(function($t){return $t.properties.type==="elevator"||$t.properties.type==="escalator"||$t.properties.type==="staircase"}),[4,u.default.getCurrentUser()];case 2:return Lt=hr.sent(),pt=fe?De.find(function($t){return $t.id===fe||$t.name===fe}):De.find(function($t){return $t.id===Zt.defaultOptions.defaultPlaceId}),Ct=De.length>0?pt||De[0]:new m.PlaceModel({}),mt=[Ct.location.lng,Ct.location.lat],!((V=this.defaultOptions.mapboxOptions)===null||V===void 0)&&V.center&&(mt=this.defaultOptions.mapboxOptions.center),this.defaultOptions.isKiosk&&(mt=(Q=this.defaultOptions.kioskSettings)===null||Q===void 0?void 0:Q.coordinates),fe&&(mt=[Ct.location.lng,Ct.location.lat]),ke.center=mt,this.defaultOptions.mapboxOptions&&(this.defaultOptions.mapboxOptions.center=ke.center),this.defaultOptions.zoomLevel&&(ke.zoom=this.defaultOptions.zoomLevel),this.defaultOptions.language&&(this.geojsonSource.language=this.defaultOptions.language),this.defaultOptions.routeColor&&(Ye=ke.layers.find(function($t){return $t.id==="proximiio-routing-line-remaining"}),Ye&&(Ye.paint["line-color"]=this.defaultOptions.routeColor)),this.defaultOptions.forceFloorLevel!==null&&this.defaultOptions.forceFloorLevel!==void 0&&(this.routingSource.routing.forceFloorLevel=this.defaultOptions.forceFloorLevel),this.defaultOptions.routeWithDetails!==null&&this.defaultOptions.routeWithDetails!==void 0&&(this.routingSource.routing.routeWithDetails=this.defaultOptions.routeWithDetails),this.geojsonSource.fetch(He),this.routingSource.routing.setData(new B.FeatureCollection(He)),this.prepareStyle(ke),this.imageSourceManager.enabled=this.defaultOptions.showRasterFloorplans,this.imageSourceManager.belowLayer=ke.usesPrefixes()?"proximiio-floors":"floors",this.imageSourceManager.initialize(),this.state=r(r({},this.state),{initializing:!1,place:Ct,places:De,style:ke,styles:We,amenities:dt,features:He,allFeatures:new B.FeatureCollection(He),levelChangers:new B.FeatureCollection({features:yt}),latitude:mt[1],longitude:mt[0],zoom:this.defaultOptions.zoomLevel?this.defaultOptions.zoomLevel:(he=this.defaultOptions.mapboxOptions)===null||he===void 0?void 0:he.zoom,noPlaces:De.length===0,user:Lt}),ke.on(this.onStyleChange),this.map.setStyle(this.state.style),this.map.setCenter(mt),this.defaultOptions.allowNewFeatureModal&&this.map.on(this.defaultOptions.newFeatureModalEvent?this.defaultOptions.newFeatureModalEvent:"dblclick",function($t){Zt.featureDialog($t)}),[2]}})})},Pe.prototype.onMapReady=function(V){var Q,he;return t(this,void 0,void 0,function(){var fe,ye,se,De,ke,We,He,dt,yt,Lt,pt,Ct=this;return n(this,function(mt){switch(mt.label){case 0:return fe=V.target,fe?((Q=this.state.style)===null||Q===void 0||Q.togglePaths(!0),ye=fe.getLayer("routing-line-completed"),se=typeof ye>"u"&&typeof fe.getLayer("proximiio-routing-line-completed")<"u",De=fe.getLayer("shops"),se?(fe.moveLayer("proximiio-routing-line-completed","proximiio-outer_wall"),fe.moveLayer("proximiio-routing-line-remaining","proximiio-outer_wall"),fe.moveLayer("proximiio-paths","routing-line-completed")):ye&&(De&&(fe.moveLayer("routing-line-completed","proximiio-routing-symbols"),fe.moveLayer("routing-line-remaining","proximiio-routing-symbols")),fe.moveLayer("proximiio-paths","routing-line-completed")),ke=fe.getLayer("proximiio-routing-symbols"),ke&&(ke.filter.push(["match",["get","type"],["poi","poi-custom"],!1,!0]),this.state.style.getLayer("proximiio-routing-symbols").filter=ke.filter,fe.setFilter("proximiio-routing-symbols",ke.filter)),fe.setMaxZoom(30),[4,(0,R.getImageFromBase64)(k.chevron)]):[3,7];case 1:return We=mt.sent(),[4,(0,R.getImageFromBase64)(k.person)];case 2:return He=mt.sent(),[4,(0,R.getImageFromBase64)(k.floorchangeUpImage)];case 3:return dt=mt.sent(),[4,(0,R.getImageFromBase64)(k.floorchangeDownImage)];case 4:return yt=mt.sent(),[4,(0,R.getImageFromBase64)(k.popupImage)];case 5:return Lt=mt.sent(),fe.addImage("chevron_right",We),fe.addImage("pulsing-dot",k.pulsingDot,{pixelRatio:2}),fe.addImage("person",He),fe.addImage("floorchange-up-image",dt),fe.addImage("floorchange-down-image",yt),fe.addImage("popup",Lt,{stretchX:[[25,55],[85,115]],stretchY:[[25,100]],content:[25,25,115,100],pixelRatio:2}),this.onSourceChange(),this.updateMapSource(this.geojsonSource),this.updateMapSource(this.routingSource),this.updateCluster(),this.updateImages(),this.filteredAmenities=this.amenityIds,this.imageSourceManager.setLevel(fe,(he=this.state.floor)===null||he===void 0?void 0:he.level,this.state),[4,this.onPlaceSelect(this.state.place,this.defaultOptions.zoomIntoPlace)];case 6:mt.sent(),this.defaultOptions.useRasterTiles&&this.initRasterTiles(),this.defaultOptions.initPolygons&&this.initPolygons(),this.defaultOptions.isKiosk&&this.initKiosk(),this.defaultOptions.considerVisibilityParam&&this.handlePoiVisibility(),this.defaultOptions.showLevelDirectionIcon&&this.initDirectionIcon(),(this.defaultOptions.animatedRoute||this.defaultOptions.routeAnimation.enabled)&&(this.defaultOptions.animatedRoute,this.initAnimatedRoute()),this.defaultOptions.hiddenAmenities&&(pt=["proximiio-pois-icons","proximiio-pois-labels","pois-icons","pois-labels","poi-custom-icons"],pt.forEach(function(Ye){var Zt=Ct.map.getLayer(Ye);if(Zt){var hr=i([],Zt.filter,!0);hr.push(["!=",["get","hideIcon"],"hide"]),Ct.state.style.getLayer(Ye).filter=hr,Ct.map.setFilter(Ye,hr)}})),this.initPersonsMap(),this.defaultOptions.initPolygons||(this.map.on("click","proximiio-pois-icons",function(Ye){Ct.onShopClick(Ye)}),this.map.on("click","proximiio-pois-labels",function(Ye){Ct.onShopClick(Ye)}),this.map.on("click","pois-icons",function(Ye){Ct.onShopClick(Ye)})),this.onMapReadyListener.next(!0),this.defaultOptions.useGpsLocation&&this.initGeoLocation(),this.defaultOptions.handleUrlParams&&this.initUrlParams(),this.map.setStyle(this.state.style),mt.label=7;case 7:return[2]}})})},Pe.prototype.onRefetch=function(){return t(this,void 0,void 0,function(){var V,Q;return n(this,function(he){switch(he.label){case 0:return this.map?[4,p.default.getPackage({initPolygons:this.defaultOptions.initPolygons,autoLabelLines:this.defaultOptions.polygonsOptions.autoLabelLines,amenityIdProperty:this.defaultOptions.amenityIdProperty,hiddenAmenities:this.defaultOptions.hiddenAmenities,useTimerangeData:this.defaultOptions.useTimerangeData,filter:this.defaultOptions.defaultFilter,featuresMaxBounds:this.defaultOptions.featuresMaxBounds})]:[3,2];case 1:V=he.sent().features,Q=V.features.filter(function(fe){return fe.properties.type==="elevator"||fe.properties.type==="escalator"||fe.properties.type==="staircase"}),this.state=r(r({},this.state),{features:V,allFeatures:new B.FeatureCollection(V),levelChangers:new B.FeatureCollection({features:Q})}),this.geojsonSource.fetch(this.state.features),this.onFeaturesChange(),he.label=2;case 2:return[2]}})})},Pe.prototype.initKiosk=function(){this.map&&(this.showStartPoint=!1,this.defaultOptions.kioskSettings&&(this.startPoint=ie.point(this.defaultOptions.kioskSettings.coordinates,{level:this.defaultOptions.kioskSettings.level}),this.showStartPoint=!0,this.state.style.addSource("my-location",{type:"geojson",data:{type:"FeatureCollection",features:[this.startPoint]}}),this.state.style.addLayer({id:"my-location-layer",type:"symbol",source:"my-location",layout:{"icon-image":"pulsing-dot"},filter:["all",["==",["to-number",["get","level"]],this.state.floor.level]]}),this.centerOnPoi(this.startPoint)))},Pe.prototype.onSetKiosk=function(V,Q,he){this.map&&this.defaultOptions.isKiosk&&(this.defaultOptions.kioskSettings={coordinates:[Q,V],level:he},this.startPoint=ie.point(this.defaultOptions.kioskSettings.coordinates,{level:this.defaultOptions.kioskSettings.level}),this.state.style.sources["my-location"].data={type:"FeatureCollection",features:[this.startPoint]},this.map.setFilter("my-location-layer",["all",["==",["to-number",["get","level"]],he]]),this.map.setStyle(this.state.style),this.centerOnPoi(this.startPoint))},Pe.prototype.initGeoLocation=function(){var V=this;if(this.map&&this.defaultOptions.useGpsLocation){var Q=new l.GeolocateControl({positionOptions:{enableHighAccuracy:!0},showAccuracyCircle:!1,trackUserLocation:!0});this.map.addControl(Q,this.defaultOptions.geolocationControlOptions.position),this.defaultOptions.geolocationControlOptions.autoTrigger&&setTimeout(function(){Q.trigger()},300),this.defaultOptions.geolocationControlOptions.autoLocate===!1&&setTimeout(function(){Q._watchState="BACKGROUND",Q._geolocateButton&&(Q._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),Q._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active")),Q.fire(new Event("trackuserlocationend"))}),Q.on("geolocate",function(he){V.startPoint=ie.point([he.coords.longitude,he.coords.latitude],{level:V.state.floor.level})})}},Pe.prototype.initDirectionIcon=function(){var V=this;if(this.map){var Q=this.map.getLayer("proximiio-levelchangers"),he=this.map.getLayoutProperty("proximiio-levelchangers","icon-size"),fe=50;this.state.style.addSource("direction-icon-source",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.state.style.addLayer({id:"direction-halo-layer",type:"circle",source:"direction-icon-source",minzoom:Q.minzoom,maxzoom:Q.maxzoom,paint:{"circle-radius":he[0]==="interpolate"?[he[0],he[1],he[2],he[3],he[4]*(fe||50),he[5],he[6]*(fe||50)]:fe,"circle-color":"#000"},filter:["all",["==",["to-number",["get","level"]],this.state.floor.level]]},"proximiio-paths-names"),this.state.style.addLayer({id:"direction-popup-layer",type:"symbol",source:"direction-icon-source",minzoom:Q.minzoom,maxzoom:Q.maxzoom,layout:{"text-field":["get","description"],"icon-text-fit":"both","icon-image":["get","popupImage"],"icon-allow-overlap":!0,"text-allow-overlap":!0,"icon-anchor":"bottom","text-anchor":"bottom","text-offset":[0,-2.4],"text-font":this.defaultOptions.polygonsOptions.textFont},paint:{"text-color":"#fff"},filter:["all",["==",["to-number",["get","level"]],this.state.floor.level]]},"proximiio-polygons-above-paths"),this.map.on("click","proximiio-levelchangers",function(ye){if(V.routingSource.points){var se=V.state.style.getSource("direction-icon-source").data.features.find(function(De){return De.properties.level===V.state.floor.level});se&&se.properties&&!isNaN(se.properties.destinationLevel)&&ye.features[0].properties.id===se.properties.levelChangerId&&(V.setFloorByLevel(se.properties.destinationLevel),V.setNavStep("next"))}}),this.map.on("click","direction-popup-layer",function(ye){V.routingSource.points&&ye.features[0].properties&&!isNaN(ye.features[0].properties.destinationLevel)&&(V.setFloorByLevel(ye.features[0].properties.destinationLevel),V.setNavStep("next"))})}},Pe.prototype.addDirectionFeatures=function(){var V=this,Q=this.state.textNavigation.steps.filter(function(he,fe,ye){var se,De=he.direction.split("_")[0];if(he.levelChangerId&&(De==="UP"||De==="DOWN"))return he.destinationLevel=ye[fe+1]?(se=ye[fe+1])===null||se===void 0?void 0:se.level:null,he}).map(function(he){var fe=V.state.allFeatures.features.find(function(ke){return ke.id===he.levelChangerId}),ye=he.direction.split("_")[0],se=he.direction.split("_")[1],De=V.state.floors.filter(function(ke){return ke.level===he.destinationLevel})?V.state.floors.filter(function(ke){return ke.level===he.destinationLevel})[0]:V.state.floor;return new B.default({type:"Feature",geometry:fe.geometry,properties:{usecase:"floor-change-symbol",icon:ye==="UP"?"floorchange-up-image":"floorchange-down-image",iconOffset:ye==="UP"?[4,-90]:[4,90],popupImage:"popup",description:"".concat(ae.translations[V.defaultOptions.language][se],` 
 `).concat(ae.translations[V.defaultOptions.language][ye]," ").concat(ae.translations[V.defaultOptions.language].TO_FLOOR," ").concat(De.name?V.getFloorName(De):he.destinationLevel),level:he.level,destinationLevel:he.destinationLevel,levelChangerId:fe.properties.id}})});this.state.style.sources["direction-icon-source"].data={type:"FeatureCollection",features:Q},this.map.setStyle(this.state.style)},Pe.prototype.onSetFeaturesHighlight=function(V,Q,he,fe){var ye=this.map,se=this.state.allFeatures.features.filter(function(We){return V.includes(We.id||We.properties.id)}),De=this.map.getLayer("proximiio-pois-icons"),ke=this.map.getLayoutProperty("proximiio-pois-icons","icon-size");ye&&(ye.getLayer("highlight-icon-layer")||this.state.style.addLayer({id:"highlight-icon-layer",type:"circle",source:"highlight-icon-source",minzoom:De.minzoom,maxzoom:De.maxzoom,paint:{"circle-radius":ke[0]==="interpolate"?[ke[0],ke[1],ke[2],ke[3],ke[4]*(he||50),ke[5],ke[6]*(he||50)]:he,"circle-color":Q||"#000","circle-blur":fe??.8},filter:["all",["==",["to-number",["get","level"]],this.state.floor.level]]},this.defaultOptions.initPolygons?"shop-custom":"proximiio-shop"),ye.getSource("highlight-icon-source")||this.state.style.addSource("highlight-icon-source",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.state.style.sources["highlight-icon-source"].data.features=se||[],this.map.setStyle(this.state.style))},Pe.prototype.initAnimatedRoute=function(){this.map&&(this.defaultOptions.routeAnimation.type==="point"&&(this.state.style.addSource("lineAlong",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.state.style.addLayer({id:"lineAlong",type:"line",source:"lineAlong",minzoom:17,maxzoom:24,paint:{"line-width":this.defaultOptions.routeAnimation.lineWidth,"line-color":this.defaultOptions.routeAnimation.lineColor,"line-opacity":this.defaultOptions.routeAnimation.lineOpacity},filter:["all",["==",["to-number",["get","level"]],this.state.floor.level]]},"proximiio-routing-line-remaining"),this.state.style.addSource("pointAlong",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.state.style.addLayer({id:"pointAlong",type:"circle",source:"pointAlong",minzoom:17,maxzoom:24,paint:{"circle-color":this.defaultOptions.routeAnimation.pointColor,"circle-radius":this.defaultOptions.routeAnimation.pointRadius},filter:["all",["==",["to-number",["get","level"]],this.state.floor.level]]},"lineAlong")),this.defaultOptions.routeAnimation.type==="dash"&&(this.state.style.getLayer("proximiio-routing-line-remaining")&&this.state.style.removeLayer("proximiio-routing-line-remaining"),this.state.style.addSource("lineAlong",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.state.style.addLayer({type:"line",source:"lineAlong",id:"line-background",paint:{"line-color":this.defaultOptions.routeAnimation.lineColor,"line-width":this.defaultOptions.routeAnimation.lineWidth,"line-opacity":this.defaultOptions.routeAnimation.lineOpacity}}),this.state.style.addLayer({type:"line",source:"lineAlong",id:"line-dashed",paint:{"line-color":this.defaultOptions.routeAnimation.lineColor,"line-width":this.defaultOptions.routeAnimation.lineWidth,"line-dasharray":[0,4,3]}})))},Pe.prototype.initRasterTiles=function(){var V,Q,he,fe,ye,se;if(this.map){var De=this.state.style.metadata;this.state.style.addSource("raster-tiles",{type:"raster",tiles:!((V=this.defaultOptions.rasterTilesOptions)===null||V===void 0)&&V.tilesUrl?["https://api.proximi.fi/imageproxy/source=".concat(this.defaultOptions.rasterTilesOptions.tilesUrl)]:["https://api.proximi.fi/imageproxy/source=".concat(De["proximiio:raster:tileurl"])],tileSize:!((Q=this.defaultOptions.rasterTilesOptions)===null||Q===void 0)&&Q.tileSize?this.defaultOptions.rasterTilesOptions.tileSize:De["proximiio:raster:tilesize"]?De["proximiio:raster:tilesize"]:256,attribution:!((he=this.defaultOptions.rasterTilesOptions)===null||he===void 0)&&he.attribution?this.defaultOptions.rasterTilesOptions.attribution:De["proximiio:raster:attribution"]?De["proximiio:raster:attribution"]:""}),this.state.style.addLayer({id:"raster-tiles",type:"raster",source:"raster-tiles",minzoom:!((fe=this.defaultOptions.rasterTilesOptions)===null||fe===void 0)&&fe.minZoom?this.defaultOptions.rasterTilesOptions.minZoom:De["proximiio:raster:minzoom"]?De["proximiio:raster:minzoom"]:15,maxzoom:!((ye=this.defaultOptions.rasterTilesOptions)===null||ye===void 0)&&ye.maxZoom?this.defaultOptions.rasterTilesOptions.maxZoom:De["proximiio:raster:maxzoom"]?De["proximiio:raster:maxzoom"]:22},!((se=this.defaultOptions.rasterTilesOptions)===null||se===void 0)&&se.beforeLayer?this.defaultOptions.rasterTilesOptions.beforeLayer:De["proximiio:raster:beforelayer"]?De["proximiio:raster:beforelayer"]:"osm-country_label-en")}},Pe.prototype.initPolygons=function(){var V=this;if(this.map){var Q=new J.PolygonTitlesLayer(this.defaultOptions.polygonsOptions);Q.setFilterLevel(this.state.floor.level),this.state.style.addLayer(Q.json,"proximiio-paths");var he=new J.PolygonIconsLayer(this.defaultOptions.polygonsOptions);he.setFilterLevel(this.state.floor.level),this.state.style.addLayer(he.json,"proximiio-paths");var fe=new J.PolygonsLayer(this.defaultOptions.polygonsOptions);fe.setFilterLevel(this.state.floor.level),this.state.style.addLayer(fe.json,"proximiio-paths"),this.state.style.getLayer("proximiio-shop")&&this.defaultOptions.polygonsOptions.removeOriginalPolygonsLayer&&this.state.style.removeLayer("proximiio-shop"),this.map.on("click","proximiio-pois-icons",function(ye){V.onShopClick(ye)}),this.map.on("mousemove","proximiio-pois-icons",function(ye){V.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","proximiio-pois-icons",function(ye){V.map.getCanvas().style.cursor=""}),this.map.on("click","pois-icons",function(ye){V.onShopClick(ye)}),this.map.on("mousemove","pois-icons",function(ye){V.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","pois-icons",function(ye){V.map.getCanvas().style.cursor=""}),this.map.on("click","shop-custom",function(ye){V.onShopClick(ye)}),this.map.on("mouseenter","shop-custom",function(){V.onShopMouseEnter()}),this.map.on("mousemove","shop-custom",function(ye){V.onShopMouseMove(ye)}),this.map.on("mouseleave","shop-custom",function(ye){V.onShopMouseLeave(ye)})}},Pe.prototype.onShopClick=function(V){if((!this.defaultOptions.blockFeatureClickWhileRouting||this.defaultOptions.blockFeatureClickWhileRouting&&!this.routingSource.route)&&V.features&&V.features[0]&&V.features[0].properties)if(V.features[0].properties._dynamic=V.features[0].properties._dynamic?JSON.parse(V.features[0].properties._dynamic):{},this.defaultOptions.initPolygons){var Q=this.state.allFeatures.features.find(function(fe){var ye;return fe.properties.id===((ye=V.features[0].properties._dynamic)===null||ye===void 0?void 0:ye.poi_id)}),he=this.state.allFeatures.features.find(function(fe){var ye,se;return!((ye=V.features[0].properties._dynamic)===null||ye===void 0)&&ye.id?fe.id===((se=V.features[0].properties._dynamic)===null||se===void 0?void 0:se.id):fe.properties.id===V.features[0].properties.id});Q&&this.handlePolygonSelection(Q),this.onPolygonClickListener.next(Q||he)}else{var he=this.state.allFeatures.features.find(function(ye){return ye.properties.id===V.features[0].properties.id});this.onPoiClickListener.next(he)}},Pe.prototype.handlePolygonSelection=function(V){var Q=V&&V.properties._dynamic?V.properties._dynamic.polygon_id:null;this.selectedPolygon&&(this.map.setFeatureState({source:"main",id:this.selectedPolygon.id},{selected:!1}),this.selectedPolygon.properties._dynamic.label_id&&this.map.setFeatureState({source:"main",id:this.selectedPolygon.properties._dynamic.label_id},{selected:!1})),Q&&(this.selectedPolygon=this.state.allFeatures.features.find(function(he){var fe,ye;return((fe=he.properties._dynamic)===null||fe===void 0?void 0:fe.id)===Q&&((ye=he.properties._dynamic)===null||ye===void 0?void 0:ye.type)==="shop-custom"}),this.selectedPolygon&&(this.map.setFeatureState({source:"main",id:this.selectedPolygon.id},{selected:!0}),this.selectedPolygon.properties._dynamic.label_id&&this.map.setFeatureState({source:"main",id:this.selectedPolygon.properties._dynamic.label_id},{selected:!0})))},Pe.prototype.onShopMouseEnter=function(){this.map.getCanvas().style.cursor="pointer"},Pe.prototype.onShopMouseMove=function(V){V.features&&V.features.length>0&&(V.features[0].properties._dynamic=JSON.parse(V.features[0].properties._dynamic?V.features[0].properties._dynamic:{}),this.hoveredPolygon&&(this.map.setFeatureState({source:"main",id:this.hoveredPolygon.id},{hover:!1}),this.hoveredPolygon.properties._dynamic.label_id&&this.map.setFeatureState({source:"main",id:this.hoveredPolygon.properties._dynamic.label_id},{hover:!1})),this.hoveredPolygon=V.features[0],this.map.setFeatureState({source:"main",id:this.hoveredPolygon.id},{hover:!0}),this.hoveredPolygon.properties._dynamic.label_id&&this.map.setFeatureState({source:"main",id:this.hoveredPolygon.properties._dynamic.label_id},{hover:!0}))},Pe.prototype.onShopMouseLeave=function(V){this.map.getCanvas().style.cursor="",this.hoveredPolygon&&(this.map.setFeatureState({source:"main",id:this.hoveredPolygon.id},{hover:!1}),this.hoveredPolygon.properties._dynamic.label_id&&this.map.setFeatureState({source:"main",id:this.hoveredPolygon.properties._dynamic.label_id},{hover:!1})),this.hoveredPolygon=null},Pe.prototype.initUrlParams=function(){var V=new URLSearchParams(window.location.search),Q=V.get(this.defaultOptions.urlParams.startFeauture),he=V.get(this.defaultOptions.urlParams.destinationFeature),fe=V.get(this.defaultOptions.urlParams.defaultPlace),ye=fe?this.state.places.find(function(ke){var We;return ke.id===fe||((We=ke.name)===null||We===void 0?void 0:We.toLowerCase())===(fe==null?void 0:fe.toLowerCase())}):this.state.place,se=Q?this.state.allFeatures.features.find(function(ke){var We;return ke.properties.title&&ke.properties.place_id===ye.id&&(ke.id===Q||ke.properties.id===Q||((We=ke.properties.title)===null||We===void 0?void 0:We.toLowerCase())===(Q==null?void 0:Q.toLowerCase()))}):this.startPoint,De=he?this.state.allFeatures.features.find(function(ke){var We;return ke.properties.title&&ke.properties.place_id===ye.id&&(ke.id===he||ke.properties.id===he||((We=ke.properties.title)===null||We===void 0?void 0:We.toLowerCase())===(he==null?void 0:he.toLowerCase()))}):void 0;se&&se.id&&!De&&(this.centerToFeature(se.id),this.map&&this.defaultOptions.isKiosk&&this.setKiosk(se.geometry.coordinates[1],se.geometry.coordinates[0],se.properties.level)),!se&&De&&this.centerToFeature(De.id),se&&De&&this.onRouteUpdate(se,De)},Pe.prototype.featureDialog=function(V){var Q=this,he,fe=this.map.queryRenderedFeatures(V.point,{layers:["proximiio-pois-icons","proximiio-pois-labels"]}),ye=fe.length>0,se=new ee.modal({footer:!0,stickyFooter:!1,closeMethods:["overlay","button","escape"],closeLabel:"Close",onClose:function(){se.destroy()}});se.setContent(ye?(0,W.EDIT_FEATURE_DIALOG)(V,fe[0]):(0,W.NEW_FEATURE_DIALOG)(V,(he=this.state.floor)===null||he===void 0?void 0:he.level)),se.addFooterBtn("Submit","tingle-btn tingle-btn--primary",function(){return t(Q,void 0,void 0,function(){var De,ke,We,He;return n(this,function(dt){switch(dt.label){case 0:return De=new FormData(document.querySelector("#modal-form")),He={id:"".concat(De.get("id")),title:"".concat(De.get("title")),level:De.get("level"),lat:De.get("lat"),lng:De.get("lng")},De.get("icon").size?[4,(0,R.getBase64FromImage)(De.get("icon"))]:[3,2];case 1:return We=dt.sent(),[3,3];case 2:We=void 0,dt.label=3;case 3:return ke=(He.icon=We,He),ke.title&&ke.level&&ke.lat&&ke.lng?ye?[4,this.onUpdateFeature(ke.id,ke.title,+ke.level,+ke.lat,+ke.lng,ke.icon)]:[3,5]:[3,8];case 4:return dt.sent(),[3,7];case 5:return[4,this.onAddNewFeature(ke.title,+ke.level,+ke.lat,+ke.lng,ke.icon,ke.id)];case 6:dt.sent(),dt.label=7;case 7:return se.close(),[3,9];case 8:alert("Please fill all the required fields!"),dt.label=9;case 9:return[2]}})})}),ye&&se.addFooterBtn("Delete","tingle-btn tingle-btn--danger",function(){var De,ke;Q.onDeleteFeature((ke=(De=fe[0])===null||De===void 0?void 0:De.properties)===null||ke===void 0?void 0:ke.id),se.close()}),se.addFooterBtn("Cancel","tingle-btn tingle-btn--default tingle-btn--pull-right",function(){se.close()}),se.open()},Pe.prototype.onAddNewFeature=function(V,Q,he,fe,ye,se,De,ke,We,He){return He===void 0&&(He=!0),t(this,void 0,void 0,function(){var dt,yt,Lt;return n(this,function(pt){switch(pt.label){case 0:if(dt=se||(0,R.uuidv4)(),this.state.allFeatures.features.findIndex(function(Ct){return Ct.id===dt||Ct.properties.id===dt})>0)throw new Error("Create feature failed: Feature with id '".concat(dt,"' already exists!"));return yt=new B.default({type:"Feature",id:dt,geometry:new B.Geometry({type:"Point",coordinates:[fe,he]}),properties:r({type:"poi",usecase:"poi",id:dt,minzoom:15,visibility:"visible",amenity:ye?se:"default",title:V,level:Q,images:[ye],place_id:De,floor_id:ke},We)}),ye&&ye.length>0?[4,(0,R.getImageFromBase64)(ye)]:[3,2];case 1:Lt=pt.sent(),this.map.addImage(dt,Lt),pt.label=2;case 2:return He?[3,4]:(this.state.features.features.push(yt),[4,(0,_.addFeatures)({type:"FeatureCollection",features:[yt.json]})]);case 3:return pt.sent(),[3,5];case 4:this.state.dynamicFeatures.features.push(yt),pt.label=5;case 5:return this.geojsonSource.create(yt),this.onFeaturesChange(),this.onFeatureAddListener.next(yt),[2,yt]}})})},Pe.prototype.onUpdateFeature=function(V,Q,he,fe,ye,se,De,ke,We,He){return He===void 0&&(He=!0),t(this,void 0,void 0,function(){var dt,yt,Lt,pt,Ct;return n(this,function(mt){switch(mt.label){case 0:if(dt=this.state.allFeatures.features.find(function(Ye){return Ye.id===V||Ye.properties.id===V}),!dt)throw new Error("Update feature failed: Feature with id '".concat(V,"' has not been found!"));return yt=new B.default(dt),yt.geometry.coordinates=[ye||yt.geometry.coordinates[0],fe||yt.geometry.coordinates[1]],yt.properties=r(r(r({},yt.properties),{title:Q||yt.properties.title,level:he||yt.properties.level,amenity:se?V:yt.properties.amenity,images:se?[se]:yt.properties.images,place_id:De||yt.properties.place_id,floor_id:ke||yt.properties.floor_id}),We),se&&se.length>0?[4,(0,R.getImageFromBase64)(se)]:[3,2];case 1:Lt=mt.sent(),this.map.addImage(V,Lt),mt.label=2;case 2:return He?[3,4]:(pt=this.state.features.features.findIndex(function(Ye){return Ye.id===yt.id||Ye.properties.id===yt.id}),this.state.features.features[pt]=yt,[4,(0,_.addFeatures)({type:"FeatureCollection",features:[yt.json]})]);case 3:return mt.sent(),[3,5];case 4:Ct=this.state.dynamicFeatures.features.findIndex(function(Ye){return Ye.id===yt.id||Ye.properties.id===yt.id}),this.state.dynamicFeatures.features[Ct]=yt,mt.label=5;case 5:return this.geojsonSource.update(yt),this.onFeaturesChange(),this.onFeatureUpdateListener.next(yt),[2,yt]}})})},Pe.prototype.onDeleteFeature=function(V,Q){return Q===void 0&&(Q=!0),t(this,void 0,void 0,function(){var he,fe,ye;return n(this,function(se){switch(se.label){case 0:if(he=this.state.allFeatures.features.find(function(De){return De.id===V||De.properties.id===V}),!he)throw new Error("Deleting feature failed: Feature with id '".concat(V,"' has not been found!"));return Q?[3,2]:(fe=this.state.features.features.findIndex(function(De){return De.id===V||De.properties.id===V}),this.state.features.features.splice(fe,1),[4,(0,_.deleteFeatures)({type:"FeatureCollection",features:[he]})]);case 1:return se.sent(),[3,3];case 2:ye=this.state.dynamicFeatures.features.findIndex(function(De){return De.id===V||De.properties.id===V}),this.state.dynamicFeatures.features.splice(ye,1),se.label=3;case 3:return this.geojsonSource.delete(V),this.onFeaturesChange(),this.onFeatureDeleteListener.next(he),[2]}})})},Pe.prototype.onFeaturesChange=function(){this.state.allFeatures.features=i(i([],this.state.features.features,!0),this.state.dynamicFeatures.features,!0),this.geojsonSource.language=this.defaultOptions.language,this.geojsonSource.fetch(this.state.features),this.onSourceChange(),this.routingSource.routing.setData(this.state.allFeatures),this.updateMapSource(this.routingSource)},Pe.prototype.onSetFeatureFilter=function(V,Q){for(var he=this.state.allFeatures.features.filter(function(We){return We.properties.id===V||We.id===V||We.properties.title===V}),fe=function(We){Q&&ye.hiddenFeatures.findIndex(function(He){return He===We.properties.id})===-1?ye.hiddenFeatures.push(We.properties.id):!Q&&ye.filteredFeatures.findIndex(function(He){return He===We.properties.id})===-1&&ye.filteredFeatures.push(We.properties.id)},ye=this,se=0,De=he;se<De.length;se++){var ke=De[se];fe(ke)}this.filterOutFeatures()},Pe.prototype.onRemoveFeatureFilter=function(V,Q){for(var he=this.state.allFeatures.features.filter(function(We){return We.properties.id===V||We.id===V||We.properties.title===V}),fe=function(We){Q&&ye.hiddenFeatures.findIndex(function(He){return He===We.properties.id})!==-1?ye.hiddenFeatures.splice(ye.hiddenFeatures.findIndex(function(He){return He===We.properties.id}),1):!Q&&ye.filteredFeatures.findIndex(function(He){return He===We.properties.id})!==-1&&ye.filteredFeatures.splice(ye.filteredFeatures.findIndex(function(He){return He===We.properties.id}),1)},ye=this,se=0,De=he;se<De.length;se++){var ke=De[se];fe(ke)}this.filteredFeatures=this.filteredFeatures.length>0?this.filteredFeatures:[],this.hiddenFeatures=this.hiddenFeatures.length>0?this.hiddenFeatures:[],this.filterOutFeatures()},Pe.prototype.onHidePois=function(){this.hiddenFeatures=this.state.allFeatures.features.filter(function(V){return V.properties.type==="poi"||V.properties.usecase==="poi"}).map(function(V){return V.properties.id}),this.filterOutFeatures()},Pe.prototype.onResetFeatureFilters=function(){this.filteredFeatures=[],this.hiddenFeatures=[],this.filterOutFeatures()},Pe.prototype.onSetAmenityFilter=function(V,Q,he){if(Q&&he)throw new Error("It's not possible to use both category and inverted options in setAmenityFilter function!");if(Q){this.amenityCategories[Q].active=!0,this.amenityCategories[Q].activeId=V;var fe=[],ye=function(ke){if(se.amenityCategories.hasOwnProperty(ke)){var We=se.amenityCategories[ke];We.active&&(fe=Array.isArray(V)?fe.concat(We.amenities.filter(function(He){return!We.activeId.includes(He)})):fe.concat(We.amenities.filter(function(He){return He!==We.activeId})))}},se=this;for(var De in this.amenityCategories)ye(De);this.amenityFilters=this.amenityIds.filter(function(ke){return!fe.includes(ke)})}else he&&this.hiddenAmenities.findIndex(function(ke){return ke===V})===-1?(Array.isArray(V)?this.hiddenAmenities.concat(V):this.hiddenAmenities.push(V),this.filteredAmenities=this.filteredAmenities.filter(function(ke){return ke!==V})):!he&&this.amenityFilters.findIndex(function(ke){return ke===V})===-1&&(Array.isArray(V)?this.amenityFilters.concat(V):this.amenityFilters.push(V));this.filteredAmenities=this.amenityFilters,this.filterOutFeatures(),he||this.setActivePolygons(V)},Pe.prototype.onRemoveAmenityFilter=function(V,Q,he){if(Q&&he)throw new Error("It's not possible to use both category and inverted options in removeAmenityFilter function!");if(Q&&this.amenityCategories[Q].active&&JSON.stringify(this.amenityCategories[Q].activeId)===JSON.stringify(V)){var fe=Array.isArray(V)?this.amenityCategories[Q].amenities.filter(function(ye){return!V.includes(ye)}):this.amenityCategories[Q].amenities.filter(function(ye){return ye!==V});this.amenityFilters=this.amenityFilters.concat(fe),this.amenityCategories[Q].active=!1}else Q||(he?(this.hiddenAmenities=this.hiddenAmenities.filter(function(ye){return ye!==V}),this.filteredAmenities.findIndex(function(ye){return ye===V})===-1&&(Array.isArray(V)?this.filteredAmenities.concat(V):this.filteredAmenities.push(V))):this.amenityFilters=this.amenityFilters.filter(function(ye){return ye!==V}));this.filteredAmenities=this.amenityFilters.length>0?this.amenityFilters:this.amenityIds,this.hiddenAmenities=this.hiddenAmenities.length>0?this.hiddenAmenities:[],this.filterOutFeatures(),this.setActivePolygons(null)},Pe.prototype.onResetAmenityFilters=function(){this.amenityFilters=[],this.hiddenAmenities=[];for(var V in this.amenityCategories)this.amenityCategories.hasOwnProperty(V)&&(this.amenityCategories[V].active=!1);this.filteredAmenities=this.amenityIds,this.filterOutFeatures(),this.setActivePolygons(null)},Pe.prototype.filterOutFeatures=function(){var V=this,Q=["proximiio-pois-icons","proximiio-pois-labels","pois-icons","pois-labels"];this.defaultOptions.initPolygons&&Q.push("poi-custom-icons","shop-labels"),Q.forEach(function(he){if(V.map.getLayer(he)){var fe=V.map.getLayer(he),ye=i([],fe.filter,!0),se=ye.findIndex(function(ke){return ke[1][1]&&ke[1][1][1]==="amenity"}),De=ye.findIndex(function(ke){return ke[1][1]==="id"});V.filteredAmenities.length>0&&(se!==-1?ye[se]=["any",["in",["get","amenity"],["literal",V.filteredAmenities]],["in",["get","amenity",["get","_dynamic"]],["literal",V.filteredAmenities]]]:ye.push(["any",["in",["get","amenity"],["literal",V.filteredAmenities]],["in",["get","amenity",["get","_dynamic"]],["literal",V.filteredAmenities]]])),V.filteredFeatures.length>0?De!==-1?ye[De]=["match",["get","id"],V.filteredFeatures,!0,!1]:ye.push(["match",["get","id"],V.filteredFeatures,!0,!1]):De!==-1&&ye.splice(De,1),V.hiddenFeatures.length>0?De!==-1?ye[De]=["match",["get","id"],V.hiddenFeatures,!1,!0]:ye.push(["match",["get","id"],V.hiddenFeatures,!1,!0]):De!==-1&&ye.splice(De,1),V.state.style.getLayer(he).filter=ye,V.map.setFilter(he,ye)}}),this.state.style.notify("filter-change")},Pe.prototype.setActivePolygons=function(V){var Q=this;if(this.defaultOptions.initPolygons){var he=this.activePolygonsAmenity?this.state.allFeatures.features.filter(function(pt){var Ct;return(Array.isArray(Q.activePolygonsAmenity)?Q.activePolygonsAmenity.includes(pt.properties.amenity):pt.properties.amenity===Q.activePolygonsAmenity)&&((Ct=pt.properties._dynamic)===null||Ct===void 0?void 0:Ct.polygon_id)&&pt.geometry.type==="Point"}):[],fe=V?this.state.allFeatures.features.filter(function(pt){var Ct;return(Array.isArray(V)?V.includes(pt.properties.amenity):pt.properties.amenity===V)&&((Ct=pt.properties._dynamic)===null||Ct===void 0?void 0:Ct.polygon_id)&&pt.geometry.type==="Point"}):[];if(he.length>0)for(var ye=function(pt){var Ct=se.state.allFeatures.features.find(function(mt){var Ye,Zt,hr;return((Ye=mt.properties._dynamic)===null||Ye===void 0?void 0:Ye.id)===((Zt=pt.properties._dynamic)===null||Zt===void 0?void 0:Zt.polygon_id)&&((hr=mt.properties._dynamic)===null||hr===void 0?void 0:hr.type)==="shop-custom"});Ct&&se.map.setFeatureState({source:"main",id:Ct.id},{active:!1})},se=this,De=0,ke=he;De<ke.length;De++){var We=ke[De];ye(We)}if(fe.length>0)for(var He=function(pt){var Ct=dt.state.allFeatures.features.find(function(mt){var Ye,Zt,hr;return((Ye=mt.properties._dynamic)===null||Ye===void 0?void 0:Ye.id)===((Zt=pt.properties._dynamic)===null||Zt===void 0?void 0:Zt.polygon_id)&&((hr=mt.properties._dynamic)===null||hr===void 0?void 0:hr.type)==="shop-custom"});Ct&&dt.map.setFeatureState({source:"main",id:Ct.id},{active:!0})},dt=this,yt=0,Lt=fe;yt<Lt.length;yt++){var We=Lt[yt];He(We)}}this.activePolygonsAmenity=V},Pe.prototype.handlePoiVisibility=function(){var V=this,Q=["proximiio-pois-icons","proximiio-pois-labels","pois-icons","pois-labels"];this.defaultOptions.initPolygons&&Q.push("poi-custom-icons","shop-labels"),Q.forEach(function(he){V.map.getLayer(he)&&setTimeout(function(){var fe=V.map.getLayer(he);if(fe){var ye=i([],fe.filter,!0),se=ye.findIndex(function(De){return De[1][1]==="visibility"});se!==-1?ye[se][0]==="!="?ye[se]=["match",["get","visibility"],["visible","hidden","undefined"],!0,!1]:ye[se]=["!=",["get","visibility"],"hidden"]:ye.push(["!=",["get","visibility"],"hidden"]),V.state.style.getLayer(he).filter=ye,V.map.setFilter(he,ye)}})}),this.state.style.notify("filter-change")},Pe.prototype.onToggleHiddenPois=function(){this.handlePoiVisibility()},Pe.prototype.onSetPerson=function(V,Q,he,fe){var ye=new be.default({lat:V,lng:Q,level:he,id:fe});this.state=r(r({},this.state),{persons:[ye]}),this.initPersonsMap()},Pe.prototype.onAddPerson=function(V,Q,he,fe){var ye=new be.default({lat:V,lng:Q,level:he,id:fe});this.state.persons=i(i([],this.state.persons,!0),[ye],!1),this.initPersonsMap()},Pe.prototype.onUpdatePerson=function(V,Q,he,fe){V.updatePosition({lat:Q,lng:he,level:fe}),this.initPersonsMap()},Pe.prototype.initPersonsMap=function(){var V=this.map;V.getLayer("persons-layer")||this.state.style.addLayer({id:"persons-layer",type:"symbol",source:"persons-source",layout:{"icon-image":"person","icon-size":["interpolate",["exponential",.3],["zoom"],17,.1,22,.3]},filter:["all",["==",["to-number",["get","level"]],this.state.floor.level]]}),V.getSource("persons-source")||this.state.style.addSource("persons-source",{type:"geojson",data:{type:"FeatureCollection",features:[]}});var Q=this.state.persons.map(function(he){return ie.point([he.lng,he.lat],{level:he.level})});this.state.style.sources["persons-source"].data={type:"FeatureCollection",features:Q},this.onPersonUpdateListener.next(this.state.persons)},Pe.prototype.prepareStyle=function(V){V.setSource("main",this.geojsonSource),V.setSource("synthetic",this.syntheticSource),V.setSource("route",this.routingSource),V.setSource("clusters",this.clusterSource),V.setLevel(0)},Pe.prototype.onRouteChange=function(V){return t(this,void 0,void 0,function(){var Q,he,fe,ye,se=this;return n(this,function(De){switch(De.label){case 0:return V==="loading-start"?(this.state=r(r({},this.state),{loadingRoute:!0}),[2]):V!=="loading-finished"?[3,3]:this.routingSource.route?(this.currentStep=0,Q=this.routingSource.lines[0],he={steps:this.routingSource.steps,destination:this.endPoint,start:this.startPoint},this.state=r(r({},this.state),{loadingRoute:!1,textNavigation:he}),this.defaultOptions.showLevelDirectionIcon&&this.addDirectionFeatures(),(this.defaultOptions.animatedRoute||this.defaultOptions.routeAnimation.enabled)&&(this.defaultOptions.animatedRoute,this.animateRoute()),this.defaultOptions.forceFloorLevel!==null&&this.defaultOptions.forceFloorLevel!==void 0&&(this.routingSource.data.features=this.routingSource.data.features.map(function(ke){return ke.properties.level!==se.defaultOptions.forceFloorLevel&&(ke.properties.level=se.defaultOptions.forceFloorLevel),ke})),this.centerOnRoute(Q),this.onRouteFoundListener.next({route:this.routingSource.route,TBTNav:this.defaultOptions.enableTBTNavigation?he:null,details:this.defaultOptions.routeWithDetails?this.routingSource.details:null,start:this.startPoint,end:this.endPoint}),this.defaultOptions.sendAnalytics?(fe=new Ae.default({organization_id:this.state.user.organization.id,organization_name:this.state.user.organization.name,startLngLat:this.routingSource.start.geometry.coordinates,startLevel:this.routingSource.start.properties.level,startSegmentId:this.routingSource.start.id,startSegmentName:this.defaultOptions.isKiosk?"kioskPoint":this.routingSource.start.properties.title,destinationFeatureId:this.routingSource.finish.id,destinationName:this.routingSource.finish.properties.title,destinationLngLat:this.routingSource.finish.geometry.coordinates,destinationLevel:this.routingSource.finish.properties.level,foundPath:this.routingSource.lines.length>0,optionAvoidBarrier:this.routingSource.routing.wayfinding.configuration.avoidBarriers,optionAvoidElevators:this.routingSource.routing.wayfinding.configuration.avoidElevators,optionAvoidEscalators:this.routingSource.routing.wayfinding.configuration.avoidEscalators,optionAvoidNarrowPaths:this.routingSource.routing.wayfinding.configuration.avoidNarrowPaths,optionAvoidRamps:this.routingSource.routing.wayfinding.configuration.avoidRamps,optionAvoidStaircases:this.routingSource.routing.wayfinding.configuration.avoidStaircases,optionAvoidTicketGates:this.routingSource.routing.wayfinding.configuration.avoidTicketGates,route:this.routingSource.points.map(function(ke){return[ke.geometry.coordinates[0],ke.geometry.coordinates[1],ke.properties.level]}),rerouted:!1}),[4,fe.save()]):[3,2]):[3,2];case 1:De.sent(),De.label=2;case 2:return[2];case 3:return V==="route-undefined"?(this.state=r(r({},this.state),{loadingRoute:!1}),this.onRouteFailedListener.next("route not found"),[2]):(ye=this.state.style,ye.setSource("route",this.routingSource),this.state=r(r({},this.state),{style:ye}),this.updateMapSource(this.routingSource),[2])}})})},Pe.prototype.onSourceChange=function(){this.state=r(r({},this.state),{style:this.state.style}),this.updateMapSource(this.geojsonSource),this.updateCluster()},Pe.prototype.onSyntheticChange=function(){this.state.style.setSource("synthetic",this.syntheticSource),this.updateMapSource(this.syntheticSource)},Pe.prototype.updateMapSource=function(V){var Q=this.map;if(Q&&Q.getSource(V.id)){var he=Q.getSource(V.id);he&&he.setData(V.data)}},Pe.prototype.onStyleSelect=function(V){var Q=this.map;Q&&(this.prepareStyle(V),Q.setStyle(V.json)),this.state=r(r({},this.state),{style:V})},Pe.prototype.onStyleChange=function(V,Q){var he=this.map;if(he){if(V==="overlay-toggled"){var fe=this.state.style.overlay?"visible":"none";he.setLayoutProperty("main-polygon-fill","visibility",fe),he.setLayoutProperty("main-polygon-outline","visibility",fe)}if(V==="segments-toggled"){var ye=this.state.style.segments?"visible":"none";he.setLayoutProperty("main-segment-fill","visibility",ye),he.setLayoutProperty("main-segment-outline","visibility",ye)}if(V==="routable-toggled"){var se=this.state.style.segments?"visible":"none";he.setLayoutProperty("main-routable-fill","visibility",se),he.setLayoutProperty("main-routable-outline","visibility",se)}if(V==="cluster-toggled"){var De=this.state.style.cluster?"visible":"none";he.setLayoutProperty("clusters-circle","visibility",De)}}if(V==="layer-update"&&Q){var ke=Q.layer,We=Q.changes,He=We.filter(function(pt){return pt.kind==="E"&&pt.path[0]==="layout"}),dt=We.filter(function(pt){return pt.kind==="E"&&pt.path[0]==="paint"}),yt=this.map;yt&&(He.forEach(function(pt){pt.kind==="E"&&yt.setLayoutProperty(ke.id,pt.path[1],pt.rhs)}),dt.forEach(function(pt){pt.kind==="E"&&yt.setPaintProperty(ke.id,pt.path[1],pt.rhs)}))}if(V==="filter-change"){var Lt=this.map;this.state.style.getLayers("main").forEach(function(pt){Lt.getLayer(pt.id)&&Lt.removeLayer(pt.id),Lt.addLayer(pt)})}this.map.setStyle(this.state.style),this.state=r(r({},this.state),{style:this.state.style})},Pe.prototype.onToggleRasterFloorplans=function(){this.imageSourceManager.enabled=!this.imageSourceManager.enabled;var V=this.map;V&&this.imageSourceManager.setLevel(V,this.state.floor.level,this.state)},Pe.prototype.updateCluster=function(){var V=this,Q=this.map;if(Q){var he={type:"FeatureCollection",features:this.geojsonSource.data.features.filter(function(ye){return ye.isPoint&&ye.hasLevel(V.state.floor.level)}).map(function(ye){return ye.json})},fe=Q.getSource("clusters");fe&&fe.setData(he)}},Pe.prototype.onPlaceSelect=function(V,Q,he){return t(this,void 0,void 0,function(){var fe,ye,se,De;return n(this,function(ke){switch(ke.label){case 0:return this.state=r(r({},this.state),{place:V}),[4,(0,U.getPlaceFloors)(V.id)];case 1:return fe=ke.sent(),ye={floors:fe.sort(function(We,He){return We.level-He.level})},fe.length>0&&(se=he?fe.find(function(We){return We.level===he}):fe.find(function(We){return We.level===0}),se?ye.floor=se:ye.floor=fe[0]),this.state=r(r({},this.state),ye),De=this.map,De&&Q&&De.flyTo({center:[V.location.lng,V.location.lat]}),this.onPlaceSelectListener.next(V),ye.floor&&this.onFloorSelect(ye.floor),[2]}})})},Pe.prototype.onFloorSelect=function(V){var Q=this,he,fe=this.map,ye=this.routingSource.levelPoints&&this.routingSource.levelPoints[V.level]?this.routingSource.levelPoints[V.level]:null;if(fe){if(this.state.style.setLevel(V.level),fe.setStyle(this.state.style),setTimeout(function(){i(i([],Q.state.style.getLayers("main"),!0),Q.state.style.getLayers("route"),!0).forEach(function(He){fe.getLayer(He.id)&&fe.setFilter(He.id,He.filter)}),Q.imageSourceManager.setLevel(fe,V.level,Q.state)}),ye){var se=this.routingSource.route["path-part-".concat(this.currentStep)]&&((he=this.routingSource.route["path-part-".concat(this.currentStep)].properties)===null||he===void 0?void 0:he.level)===V.level?this.routingSource.route["path-part-".concat(this.currentStep)]:(0,Oe.lineString)(this.routingSource.levelPoints[V.level].map(function(He){return He.geometry.coordinates})),De=ie.length(se,{units:"kilometers"})*1e3,ke=ie.bbox(se);De>=this.defaultOptions.minFitBoundsDistance?fe.fitBounds(ke,{padding:this.defaultOptions.fitBoundsPadding,bearing:this.map.getBearing(),pitch:this.map.getPitch()}):this.map.flyTo({center:ie.center(se).geometry.coordinates})}if(this.defaultOptions.isKiosk&&fe.getLayer("my-location-layer")){var We=["all",["==",["to-number",["get","level"]],V.level]];fe.setFilter("my-location-layer",We),this.state.style.getLayer("my-location-layer").filter=We}if(this.defaultOptions.useGpsLocation&&this.startPoint&&(this.startPoint.properties=r(r({},this.startPoint.properties),{level:V.level})),fe.getLayer("persons-layer")){var We=["all",["==",["to-number",["get","level"]],V.level]];fe.setFilter("persons-layer",We),this.state.style.getLayer("persons-layer").filter=We}if(this.defaultOptions.showLevelDirectionIcon&&fe.getLayer("direction-halo-layer")){var We=["all",["==",["to-number",["get","level"]],V.level]];fe.setFilter("direction-halo-layer",We),this.state.style.getLayer("direction-halo-layer").filter=We,fe.setFilter("direction-popup-layer",We),this.state.style.getLayer("direction-popup-layer").filter=We}if(fe.getLayer("highlight-icon-layer")){var We=["all",["==",["to-number",["get","level"]],V.level]];fe.setFilter("highlight-icon-layer",We),this.state.style.getLayer("highlight-icon-layer").filter=We}}this.state=r(r({},this.state),{floor:V,style:this.state.style}),(this.defaultOptions.animatedRoute||this.defaultOptions.routeAnimation.enabled&&ye)&&(this.defaultOptions.animatedRoute,this.animateRoute()),this.updateCluster(),this.onFloorSelectListener.next(V)},Pe.prototype.onRouteUpdate=function(V,Q){this.startPoint=V,this.endPoint=Q;try{Q&&this.defaultOptions.initPolygons&&this.handlePolygonSelection(Q),Q&&this.defaultOptions.animatedRoute&&(this.defaultOptions.animatedRoute,clearInterval(this.animationInterval)),this.routingSource.update(V,Q)}catch{}this.state=r(r({},this.state),{style:this.state.style})},Pe.prototype.onRouteCancel=function(){this.state=r(r({},this.state),{textNavigation:null}),this.defaultOptions.initPolygons&&this.handlePolygonSelection(),this.defaultOptions.showLevelDirectionIcon&&(this.state.style.sources["direction-icon-source"].data={type:"FeatureCollection",features:[]}),(this.defaultOptions.animatedRoute||this.defaultOptions.routeAnimation.enabled)&&(this.defaultOptions.animatedRoute,this.defaultOptions.routeAnimation.type==="point"&&(clearInterval(this.animationInterval),this.map.getSource("pointAlong").setData({type:"FeatureCollection",features:[]}),this.map.getSource("lineAlong").setData({type:"FeatureCollection",features:[]}))),this.map.setStyle(this.state.style),this.routingSource.cancel(),this.onRouteCancelListener.next("route cancelled")},Pe.prototype.centerOnPoi=function(V){if(this.state.floor.level!==parseInt(V.properties.level,0)){var Q=this.state.floors.find(function(he){return he.level===V.properties.level});Q&&this.onFloorSelect(Q)}this.map&&this.map.flyTo({center:V.geometry.coordinates})},Pe.prototype.centerOnRoute=function(V){var Q;if(V&&V.properties){if(this.state.floor.level!==+V.properties.level){var he=this.state.floors.find(function(De){return De.level===+V.properties.level});he&&this.onFloorSelect(he)}if(this.map){var fe=this.routingSource.route["path-part-".concat(this.currentStep)]&&((Q=this.routingSource.route["path-part-".concat(this.currentStep)].properties)===null||Q===void 0?void 0:Q.level)===this.state.floor.level?this.routingSource.route["path-part-".concat(this.currentStep)]:(0,Oe.lineString)(this.routingSource.levelPoints[this.state.floor.level].map(function(De){return De.geometry.coordinates})),ye=ie.length(fe,{units:"kilometers"})*1e3,se=ie.bbox(fe);ye>=this.defaultOptions.minFitBoundsDistance?this.map.fitBounds(se,{padding:this.defaultOptions.fitBoundsPadding,bearing:this.map.getBearing(),pitch:this.map.getPitch()}):this.map.flyTo({center:ie.center(fe).geometry.coordinates})}}},Pe.prototype.centerOnCoords=function(V,Q,he){this.map&&this.map.flyTo({center:[Q,V],zoom:he||18})},Pe.prototype.updateImages=function(){var V=this;this.state.amenities.forEach(function(Q){V.amenityIds.push(Q.id),Q.icon&&V.map.loadImage(Q.icon,function(he,fe){if(he)throw he;V.map.addImage(Q.id,fe)})})},Pe.prototype.getUpcomingFloorNumber=function(V){var Q=this;if(this.routingSource.lines&&this.routingSource.route){var he=this.routingSource.lines.findIndex(function(De){return+De.properties.level===Q.state.floor.level}),fe=this.routingSource.lines[he],ye=this.routingSource.lines.findIndex(function(De){return V==="up"?+De.properties.level>fe.properties.level:+De.properties.level<fe.properties.level}),se=this.routingSource.lines[ye];return se&&(V==="up"&&+se.properties.level>this.state.floor.level||V==="down"&&+se.properties.level<this.state.floor.level)?+se.properties.level:this.state.floor.level}},Pe.prototype.getClosestFeature=function(V,Q){var he=this,fe=this.state.allFeatures.features.filter(function(De){return De.properties.amenity===V&&De.geometry.type==="Point"&&De.properties.level===(Q?Q.properties.level:he.startPoint.properties.level)}),ye=this.state.allFeatures.features.filter(function(De){return De.properties.amenity===V&&De.geometry.type==="Point"});this.defaultOptions.defaultPlaceId&&(fe=fe.filter(function(De){return De.properties.place_id===he.defaultOptions.defaultPlaceId}),ye=ye.filter(function(De){return De.properties.place_id===he.defaultOptions.defaultPlaceId}));var se=ie.point(Q?Q.geometry.coordinates:this.startPoint.geometry.coordinates);return fe.length>0||ye.length>0?ie.nearestPoint(se,ie.featureCollection(fe.length>0?fe:ye)):!1},Pe.prototype.getFloorName=function(V){return V.metadata&&V.metadata["title_"+this.defaultOptions.language]?V.metadata["title_"+this.defaultOptions.language]:V.name},Pe.prototype.getMapboxInstance=function(){return this.map},Pe.prototype.getMapState=function(){return this.state},Pe.prototype.getMapReadyListener=function(){return this.onMapReadyListener.asObservable()},Pe.prototype.setLanguage=function(V){this.defaultOptions.language=V,this.onFeaturesChange()},Pe.prototype.setPlace=function(V,Q,he){return t(this,void 0,void 0,function(){var fe,ye;return n(this,function(se){switch(se.label){case 0:return[4,(0,H.getPlaceById)(V)];case 1:return fe=se.sent(),ye=typeof Q<"u"?Q:!0,[4,this.onPlaceSelect(fe,ye,he)];case 2:return se.sent(),[2,fe]}})})},Pe.prototype.getPlaceSelectListener=function(){return this.onPlaceSelectListener.asObservable()},Pe.prototype.setFloorById=function(V){var Q=this.state.floors.filter(function(he){return he.id===V})?this.state.floors.filter(function(he){return he.id===V})[0]:this.state.floor;return Q&&this.onFloorSelect(new S.FloorModel(Q)),Q},Pe.prototype.setFloorByLevel=function(V){var Q=this.state.floors.filter(function(he){return he.level===V})?this.state.floors.filter(function(he){return he.level===V})[0]:this.state.floor;return Q&&this.onFloorSelect(new S.FloorModel(Q)),Q},Pe.prototype.setFloorByWay=function(V){var Q,he=V==="up"?this.state.floor.level+1:this.state.floor.level-1;return this.routingSource.route&&(he=this.getUpcomingFloorNumber(V)),Q=this.state.floors.filter(function(fe){return fe.level===he})?this.state.floors.filter(function(fe){return fe.level===he})[0]:this.state.floor,Q&&this.onFloorSelect(new S.FloorModel(Q)),Q},Pe.prototype.getFloorSelectListener=function(){return this.onFloorSelectListener.asObservable()},Pe.prototype.findRouteByIds=function(V,Q,he,fe){var ye=Q?this.state.allFeatures.features.find(function(De){return De.id===Q||De.properties.id===Q}):this.startPoint,se=this.state.allFeatures.features.find(function(De){return De.id===V||De.properties.id===V});this.routingSource.toggleAccessible(he),fe&&this.routingSource.setConfig(fe),this.onRouteUpdate(ye,se)},Pe.prototype.findRouteByTitle=function(V,Q,he,fe){var ye=Q?this.state.allFeatures.features.find(function(De){return De.properties.title===Q}):this.startPoint,se=this.state.allFeatures.features.find(function(De){return De.properties.title===V});this.routingSource.toggleAccessible(he),fe&&this.routingSource.setConfig(fe),this.onRouteUpdate(ye,se)},Pe.prototype.findRouteByCoords=function(V,Q,he,fe,ye,se,De,ke){var We=fe&&ye&&se?ie.feature({type:"Point",coordinates:[ye,fe]},{level:se}):this.startPoint,He=ie.feature({type:"Point",coordinates:[Q,V]},{level:he});this.routingSource.toggleAccessible(De),ke&&this.routingSource.setConfig(ke),this.onRouteUpdate(We,He)},Pe.prototype.findRouteToNearestFeature=function(V,Q,he,fe){var ye=Q?this.state.allFeatures.features.find(function(De){return De.id===Q||De.properties.id===Q}):this.startPoint,se=this.getClosestFeature(V,ye);if(se)this.routingSource.toggleAccessible(he),fe&&this.routingSource.setConfig(fe),this.onRouteUpdate(ye,se);else throw new Error("Feature not found")},Pe.prototype.cancelRoute=function(){this.onRouteCancel()},Pe.prototype.setNavStep=function(V){var Q=0;if((0,Oe.isNumber)(V)&&(Q=+V),V==="next"&&(Q=this.currentStep+1),V==="next"&&Object.keys(this.routingSource.route).length-1===this.currentStep&&(Q=0),V==="previous"&&this.currentStep>0&&(Q=this.currentStep-1),Q!==this.currentStep&&this.routingSource&&this.routingSource.route&&this.routingSource.route["path-part-".concat(Q)])return this.currentStep=Q,this.centerOnRoute(this.routingSource.route["path-part-".concat(Q)]),this.onStepSetListener.next(this.currentStep),V},Pe.prototype.getNavStepSetListener=function(){return this.onStepSetListener.asObservable()},Pe.prototype.getTBTNav=function(){return this.state.textNavigation},Pe.prototype.getRouteFoundListener=function(){return this.onRouteFoundListener.asObservable()},Pe.prototype.getRouteFailedListener=function(){return this.onRouteFailedListener.asObservable()},Pe.prototype.getRouteCancelListener=function(){return this.onRouteCancelListener.asObservable()},Pe.prototype.centerToRoute=function(){if(this.routingSource&&this.routingSource.route&&this.routingSource.route["path-part-0"]){var V=this.routingSource.route["path-part-0"];return this.centerOnRoute(V),V}else throw new Error("Route not found")},Pe.prototype.centerToFeature=function(V){var Q=this.state.allFeatures.features.find(function(he){return he.id===V||he.properties.id===V});if(Q)return this.centerOnPoi(Q),Q;throw new Error("Feature not found")},Pe.prototype.centerToCoordinates=function(V,Q,he){this.centerOnCoords(V,Q,he)},Pe.prototype.addCustomFeature=function(V,Q,he,fe,ye,se,De,ke,We,He){return t(this,void 0,void 0,function(){return n(this,function(dt){switch(dt.label){case 0:return[4,this.onAddNewFeature(V,+Q,+he,+fe,ye,se,De,ke,We,He)];case 1:return[2,dt.sent()]}})})},Pe.prototype.updateFeature=function(V,Q,he,fe,ye,se,De,ke,We,He){return t(this,void 0,void 0,function(){return n(this,function(dt){switch(dt.label){case 0:return[4,this.onUpdateFeature(V,Q,he,fe,ye,se,De,ke,We,He)];case 1:return[2,dt.sent()]}})})},Pe.prototype.deleteFeature=function(V,Q){return this.onDeleteFeature(V,Q)},Pe.prototype.getCustomFeaturesList=function(){return this.state.dynamicFeatures},Pe.prototype.getFeatureAddListener=function(){return this.onFeatureAddListener.asObservable()},Pe.prototype.getFeatureUpdateListener=function(){return this.onFeatureUpdateListener.asObservable()},Pe.prototype.getFeatureDeleteListener=function(){return this.onFeatureDeleteListener.asObservable()},Pe.prototype.setKiosk=function(V,Q,he){if(this.defaultOptions.isKiosk)this.onSetKiosk(V,Q,he);else throw new Error("Map is not initiated as kiosk")},Pe.prototype.setBoundsPadding=function(V){this.defaultOptions.fitBoundsPadding=V},Pe.prototype.setFiltering=function(V){V?this.defaultOptions.defaultFilter=V:delete this.defaultOptions.defaultFilter,this.onRefetch()},Pe.prototype.setFeatureFilter=function(V,Q){this.onSetFeatureFilter(V,Q)},Pe.prototype.removeFeatureFilter=function(V,Q){this.onRemoveFeatureFilter(V,Q)},Pe.prototype.hidePois=function(){this.onHidePois()},Pe.prototype.resetFeatureFilters=function(){this.onResetFeatureFilters()},Pe.prototype.setAmenityFilter=function(V,Q,he){if(!Q||Q&&this.amenityCategories[Q])this.onSetAmenityFilter(V,Q,he);else throw new Error("It seems there is no '".concat(Q,"' amenities category created, please set category with 'setAmenitiesCategory()' method"))},Pe.prototype.removeAmenityFilter=function(V,Q,he){if(!Q||Q&&this.amenityCategories[Q])this.onRemoveAmenityFilter(V,Q,he);else throw new Error("It seems there is no '".concat(Q,"' amenities category created, please set category with 'setAmenitiesCategory()' method"))},Pe.prototype.resetAmenityFilters=function(){this.onResetAmenityFilters()},Pe.prototype.setAmenitiesCategory=function(V,Q){this.amenityCategories[V]={amenities:Q}},Pe.prototype.removeAmenitiesCategory=function(V){if(this.amenityCategories[V])delete this.amenityCategories[V];else throw new Error("It seems there is no '".concat(V,"' amenities category created, please set category with 'setAmenitiesCategory()' method"))},Pe.prototype.resetAmenitiesCategory=function(){this.amenityCategories={}},Pe.prototype.getPolygonClickListener=function(){return this.onPolygonClickListener.asObservable()},Pe.prototype.getPoiClickListener=function(){return this.onPoiClickListener.asObservable()},Pe.prototype.setPerson=function(V,Q,he,fe){this.onSetPerson(V,Q,he,fe)},Pe.prototype.upsertPerson=function(V,Q,he,fe){var ye=fe?this.state.persons.find(function(se){return se.id===fe}):null;ye?this.onUpdatePerson(ye,V,Q,he):this.onAddPerson(V,Q,he,fe)},Pe.prototype.getPersonUpdateListener=function(){return this.onPersonUpdateListener.asObservable()},Pe.prototype.toggleHiddenPois=function(){this.onToggleHiddenPois()},Pe.prototype.toggleRasterFloorplans=function(){this.onToggleRasterFloorplans()},Pe.prototype.setFeaturesHighlight=function(V,Q,he,fe){this.onSetFeaturesHighlight(V,Q,he,fe)},Pe.prototype.refetch=function(){this.onRefetch()},Pe}();e.Map=ct}(v1)),v1}var h0={},UF={exports:{}};(function(e,r){var t;t=function(){function n(V,Q){var he=Object.keys(V);if(Object.getOwnPropertySymbols){var fe=Object.getOwnPropertySymbols(V);Q&&(fe=fe.filter(function(ye){return Object.getOwnPropertyDescriptor(V,ye).enumerable})),he.push.apply(he,fe)}return he}function i(V){for(var Q=1;Q<arguments.length;Q++){var he=arguments[Q]!=null?arguments[Q]:{};Q%2?n(Object(he),!0).forEach(function(fe){p(V,fe,he[fe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(V,Object.getOwnPropertyDescriptors(he)):n(Object(he)).forEach(function(fe){Object.defineProperty(V,fe,Object.getOwnPropertyDescriptor(he,fe))})}return V}function l(V){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},l(V)}function p(V,Q,he){return Q in V?Object.defineProperty(V,Q,{value:he,enumerable:!0,configurable:!0,writable:!0}):V[Q]=he,V}function u(V){return function(Q){if(Array.isArray(Q))return m(Q)}(V)||function(Q){if(typeof Symbol<"u"&&Q[Symbol.iterator]!=null||Q["@@iterator"]!=null)return Array.from(Q)}(V)||_(V)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function _(V,Q){if(V){if(typeof V=="string")return m(V,Q);var he=Object.prototype.toString.call(V).slice(8,-1);return he==="Object"&&V.constructor&&(he=V.constructor.name),he==="Map"||he==="Set"?Array.from(V):he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he)?m(V,Q):void 0}}function m(V,Q){(Q==null||Q>V.length)&&(Q=V.length);for(var he=0,fe=new Array(Q);he<Q;he++)fe[he]=V[he];return fe}var S=function(V){return typeof V=="string"?document.querySelector(V):V()},P=function(V,Q){var he=typeof V=="string"?document.createElement(V):V;for(var fe in Q){var ye=Q[fe];if(fe==="inside")ye.append(he);else if(fe==="dest")S(ye[0]).insertAdjacentElement(ye[1],he);else if(fe==="around"){var se=ye;se.parentNode.insertBefore(he,se),he.append(se),se.getAttribute("autofocus")!=null&&se.focus()}else fe in he?he[fe]=ye:he.setAttribute(fe,ye)}return he},O=function(V,Q){return V=String(V).toLowerCase(),Q?V.normalize("NFD").replace(/[\u0300-\u036f]/g,"").normalize("NFC"):V},M=function(V,Q){return P("mark",i({innerHTML:V},typeof Q=="string"&&{class:Q})).outerHTML},B=function(V,Q){Q.input.dispatchEvent(new CustomEvent(V,{bubbles:!0,detail:Q.feedback,cancelable:!0}))},$=function(V,Q,he){var fe=he||{},ye=fe.mode,se=fe.diacritics,De=fe.highlight,ke=O(Q,se);if(Q=String(Q),V=O(V,se),ye==="loose"){var We=(V=V.replace(/ /g,"")).length,He=0,dt=Array.from(Q).map(function(Lt,pt){return He<We&&ke[pt]===V[He]&&(Lt=De?M(Lt,De):Lt,He++),Lt}).join("");if(He===We)return dt}else{var yt=ke.indexOf(V);if(~yt)return V=Q.substring(yt,yt+V.length),yt=De?Q.replace(V,M(V,De)):Q}},q=function(V,Q){return new Promise(function(he,fe){var ye;return(ye=V.data).cache&&ye.store?he():new Promise(function(se,De){return typeof ye.src=="function"?ye.src(Q).then(se,De):se(ye.src)}).then(function(se){try{return V.feedback=ye.store=se,B("response",V),he()}catch(De){return fe(De)}},fe)})},X=function(V,Q){var he=Q.data,fe=Q.searchEngine,ye=[];he.store.forEach(function(De,ke){var We=function(yt){var Lt=yt?De[yt]:De,pt=typeof fe=="function"?fe(V,Lt):$(V,Lt,{mode:fe,diacritics:Q.diacritics,highlight:Q.resultItem.highlight});if(pt){var Ct={match:pt,value:De};yt&&(Ct.key=yt),ye.push(Ct)}};if(he.keys){var He,dt=function(yt,Lt){var pt=typeof Symbol<"u"&&yt[Symbol.iterator]||yt["@@iterator"];if(!pt){if(Array.isArray(yt)||(pt=_(yt))||Lt&&yt&&typeof yt.length=="number"){pt&&(yt=pt);var Ct=0,mt=function(){};return{s:mt,n:function(){return Ct>=yt.length?{done:!0}:{done:!1,value:yt[Ct++]}},e:function($t){throw $t},f:mt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ye,Zt=!0,hr=!1;return{s:function(){pt=pt.call(yt)},n:function(){var $t=pt.next();return Zt=$t.done,$t},e:function($t){hr=!0,Ye=$t},f:function(){try{Zt||pt.return==null||pt.return()}finally{if(hr)throw Ye}}}}(he.keys);try{for(dt.s();!(He=dt.n()).done;)We(He.value)}catch(yt){dt.e(yt)}finally{dt.f()}}else We()}),he.filter&&(ye=he.filter(ye));var se=ye.slice(0,Q.resultsList.maxResults);Q.feedback={query:V,matches:ye,results:se},B("results",Q)},R="aria-expanded",k="aria-activedescendant",U="aria-selected",H=function(V,Q){V.feedback.selection=i({index:Q},V.feedback.results[Q])},ue=function(V){V.isOpen||((V.wrapper||V.input).setAttribute(R,!0),V.list.removeAttribute("hidden"),V.isOpen=!0,B("open",V))},ie=function(V){V.isOpen&&((V.wrapper||V.input).setAttribute(R,!1),V.input.setAttribute(k,""),V.list.setAttribute("hidden",""),V.isOpen=!1,B("close",V))},ee=function(V,Q){var he=Q.resultItem,fe=Q.list.getElementsByTagName(he.tag),ye=!!he.selected&&he.selected.split(" ");if(Q.isOpen&&fe.length){var se,De,ke=Q.cursor;V>=fe.length&&(V=0),V<0&&(V=fe.length-1),Q.cursor=V,ke>-1&&(fe[ke].removeAttribute(U),ye&&(De=fe[ke].classList).remove.apply(De,u(ye))),fe[V].setAttribute(U,!0),ye&&(se=fe[V].classList).add.apply(se,u(ye)),Q.input.setAttribute(k,fe[Q.cursor].id),Q.list.scrollTop=fe[V].offsetTop-Q.list.clientHeight+fe[V].clientHeight+5,Q.feedback.cursor=Q.cursor,H(Q,V),B("navigate",Q)}},W=function(V){ee(V.cursor+1,V)},J=function(V){ee(V.cursor-1,V)},be=function(V,Q,he){(he=he>=0?he:V.cursor)<0||(V.feedback.event=Q,H(V,he),B("selection",V),ie(V))};function Oe(V,Q){var he=this;return new Promise(function(fe,ye){var se,De;return se=Q||((De=V.input)instanceof HTMLInputElement||De instanceof HTMLTextAreaElement?De.value:De.innerHTML),function(We,He,dt){return He?He(We):We.length>=dt}(se=V.query?V.query(se):se,V.trigger,V.threshold)?q(V,se).then(function(We){try{return V.feedback instanceof Error?fe():(X(se,V),V.resultsList&&function(He){var dt=He.resultsList,yt=He.list,Lt=He.resultItem,pt=He.feedback,Ct=pt.matches,mt=pt.results;if(He.cursor=-1,yt.innerHTML="",Ct.length||dt.noResults){var Ye=new DocumentFragment;mt.forEach(function(Zt,hr){var $t=P(Lt.tag,i({id:"".concat(Lt.id,"_").concat(hr),role:"option",innerHTML:Zt.match,inside:Ye},Lt.class&&{class:Lt.class}));Lt.element&&Lt.element($t,Zt)}),yt.append(Ye),dt.element&&dt.element(yt,pt),ue(He)}else ie(He)}(V),ke.call(he))}catch(He){return ye(He)}},ye):(ie(V),ke.call(he));function ke(){return fe()}})}var Ae=function(V,Q){for(var he in V)for(var fe in V[he])Q(he,fe)},ae=function(V){var Q,he,fe,ye=V.events,se=(Q=function(){return Oe(V)},he=V.debounce,function(){clearTimeout(fe),fe=setTimeout(function(){return Q()},he)}),De=V.events=i({input:i({},ye&&ye.input)},V.resultsList&&{list:ye?i({},ye.list):{}}),ke={input:{input:function(){se()},keydown:function(We){(function(He,dt){switch(He.keyCode){case 40:case 38:He.preventDefault(),He.keyCode===40?W(dt):J(dt);break;case 13:dt.submit||He.preventDefault(),dt.cursor>=0&&be(dt,He);break;case 9:dt.resultsList.tabSelect&&dt.cursor>=0&&be(dt,He);break;case 27:dt.input.value="",ie(dt)}})(We,V)},blur:function(){ie(V)}},list:{mousedown:function(We){We.preventDefault()},click:function(We){(function(He,dt){var yt=dt.resultItem.tag.toUpperCase(),Lt=Array.from(dt.list.querySelectorAll(yt)),pt=He.target.closest(yt);pt&&pt.nodeName===yt&&be(dt,He,Lt.indexOf(pt))})(We,V)}}};Ae(ke,function(We,He){(V.resultsList||He==="input")&&(De[We][He]||(De[We][He]=ke[We][He]))}),Ae(De,function(We,He){V[We].addEventListener(He,De[We][He])})};function ct(V){var Q=this;return new Promise(function(he,fe){var ye,se,De;if(ye=V.placeHolder,De={role:"combobox","aria-owns":(se=V.resultsList).id,"aria-haspopup":!0,"aria-expanded":!1},P(V.input,i(i({"aria-controls":se.id,"aria-autocomplete":"both"},ye&&{placeholder:ye}),!V.wrapper&&i({},De))),V.wrapper&&(V.wrapper=P("div",i({around:V.input,class:V.name+"_wrapper"},De))),se&&(V.list=P(se.tag,i({dest:[se.destination,se.position],id:se.id,role:"listbox",hidden:"hidden"},se.class&&{class:se.class}))),ae(V),V.data.cache)return q(V).then(function(We){try{return ke.call(Q)}catch(He){return fe(He)}},fe);function ke(){return B("init",V),he()}return ke.call(Q)})}function Pe(V){var Q=V.prototype;Q.init=function(){ct(this)},Q.start=function(he){Oe(this,he)},Q.unInit=function(){if(this.wrapper){var he=this.wrapper.parentNode;he.insertBefore(this.input,this.wrapper),he.removeChild(this.wrapper)}var fe;Ae((fe=this).events,function(ye,se){fe[ye].removeEventListener(se,fe.events[ye][se])})},Q.open=function(){ue(this)},Q.close=function(){ie(this)},Q.goTo=function(he){ee(he,this)},Q.next=function(){W(this)},Q.previous=function(){J(this)},Q.select=function(he){be(this,null,he)},Q.search=function(he,fe,ye){return $(he,fe,ye)}}return function V(Q){this.options=Q,this.id=V.instances=(V.instances||0)+1,this.name="autoComplete",this.wrapper=1,this.threshold=1,this.debounce=0,this.resultsList={position:"afterend",tag:"ul",maxResults:5},this.resultItem={tag:"li"},function(he){var fe=he.name,ye=he.options,se=he.resultsList,De=he.resultItem;for(var ke in ye)if(l(ye[ke])==="object")for(var We in he[ke]||(he[ke]={}),ye[ke])he[ke][We]=ye[ke][We];else he[ke]=ye[ke];he.selector=he.selector||"#"+fe,se.destination=se.destination||he.selector,se.id=se.id||fe+"_list_"+he.id,De.id=De.id||fe+"_result",he.input=S(he.selector)}(this),Pe.call(this,V),ct(this)}},e.exports=t()})(UF);var Cce=UF.exports,Ix=we&&we.__assign||function(){return Ix=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Ix.apply(this,arguments)},xb=we&&we.__awaiter||function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(p){p(l)})}return new(t||(t=Promise))(function(l,p){function u(S){try{m(n.next(S))}catch(P){p(P)}}function _(S){try{m(n.throw(S))}catch(P){p(P)}}function m(S){S.done?l(S.value):i(S.value).then(u,_)}m((n=n.apply(e,r||[])).next())})},wb=we&&we.__generator||function(e,r){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,i,l,p;return p={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function u(m){return function(S){return _([m,S])}}function _(m){if(n)throw new TypeError("Generator is already executing.");for(;p&&(p=0,m[0]&&(t=0)),t;)try{if(n=1,i&&(l=m[0]&2?i.return:m[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,m[1])).done)return l;switch(i=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){t.label=m[1];break}if(m[0]===6&&t.label<l[1]){t.label=l[1],l=m;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(m);break}l[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(S){m=[6,S],i=0}finally{n=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(h0,"__esModule",{value:!0});h0.Select=void 0;var VT=pd,XT=Pf,Tce=PS(),Mce=Cce,Lce=DS,Rce=function(){function e(r,t,n){var i=this;this.useApiSearch=!1,this.onSelectListener=new Lce.Subject;var l=t!=null&&t.selector?"".concat(t.selector):"#proximiioSelect";this.useApiSearch=n!==void 0?n:!1,this.ac=new Mce(Ix({data:this.getData(r),selector:l},t)),document.querySelector(l).addEventListener("selection",function(p){var u=p.detail;document.querySelector(l).blur();var _=u.selection.value[u.selection.key];document.querySelector(l).value=_,i.onSelectListener.next(u.selection.value)})}return e.prototype.getData=function(r){if(r==="Places")return this.getPlaces();if(r==="Floors")return this.getFloors();if(r==="Pois")return this.getPois()},e.prototype.getPlaces=function(){var r=this;return{src:function(t){return xb(r,void 0,void 0,function(){var n,i,l;return wb(this,function(p){switch(p.label){case 0:return p.trys.push([0,5,,6]),this.useApiSearch?[4,VT.default.getPlaces(10,0,void 0,void 0,"name",t)]:[3,2];case 1:return i=p.sent(),[3,4];case 2:return[4,VT.default.getPlaces(100)];case 3:i=p.sent(),p.label=4;case 4:return n=i,[2,n.data];case 5:return l=p.sent(),[2,l];case 6:return[2]}})})},keys:["name"],cache:!1}},e.prototype.getFloors=function(){var r=this;return{src:function(t){return xb(r,void 0,void 0,function(){var n,i,l;return wb(this,function(p){switch(p.label){case 0:return p.trys.push([0,5,,6]),this.useApiSearch?[4,XT.default.getFloors(10,0,void 0,void 0,"name",t)]:[3,2];case 1:return i=p.sent(),[3,4];case 2:return[4,XT.default.getFloors(100)];case 3:i=p.sent(),p.label=4;case 4:return n=i,[2,n.data];case 5:return l=p.sent(),[2,l];case 6:return[2]}})})},keys:["name"],cache:!1}},e.prototype.getPois=function(){var r=this;return{src:function(t){return xb(r,void 0,void 0,function(){var n;return wb(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Tce.default.getPois()];case 1:return[2,i.sent()];case 2:return n=i.sent(),[2,n];case 3:return[2]}})})},keys:["getTitleWithLevel"],cache:!1}},e.prototype.getSelectListener=function(){return this.onSelectListener.asObservable()},e}();h0.Select=Rce;Object.defineProperty(YT,"__esModule",{value:!0});var Dce=Ox,Nce=pd,Fce=Pf,kce=jF(),Bce=h0,jce=YT.default={Auth:Dce.default,Places:Nce.default,Floors:Fce.default,Map:kce.Map,Select:Bce.Select};export{jce as _,we as c,N3 as g,zce as m};
//# sourceMappingURL=proximiio-2787758d.js.map
